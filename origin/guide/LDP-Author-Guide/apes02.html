<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>2. OpenOffice.org to DocBook</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="LDP Author Guide"><link rel="up" href="ape.html" title="Appendix E. Converting Documents to DocBook XML"><link rel="prev" href="apes01.html" title="1. Text to DocBook"><link rel="next" href="apes03.html" title="3. Microsoft Word to DocBook"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2. OpenOffice.org to DocBook</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="apes01.html">Prev</a> </td><th width="60%" align="center">Appendix E. Converting Documents to DocBook XML</th><td width="20%" align="right"> <a accesskey="n" href="apes03.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="oo2docbook"></a>2. OpenOffice.org to DocBook</h2></div></div></div><p>As of <a class="ulink" href="http://www.openoffice.org" target="_top">OpenOffice.org (OOo)</a> 1.1RC there has been support for
	exporting files to DocBook format.</p><p>Although OOo uses the full DocBook document type declaration,
	it does not actually export the full list of DocBook elements. It
	uses a <span class="quote">&#8220;<span class="quote">simplified</span>&#8221;</span> DocBook tag set which is geared
	to on-the-fly rendering. (Although it is not the official
	Simplified DocBook which is described in <a class="xref" href="apbs05.html" title="5. DocBook DTD">Section 5, &#8220;DocBook DTD&#8221;</a>.)
  The OpenOffice simplified (or <span class="quote">&#8220;<span class="quote">special</span>&#8221;</span> docbook) is available from
	<a class="ulink" href="http://www.chez.com/ebellot/ooo2sdbk/" target="_top">http://www.chez.com/ebellot/ooo2sdbk/</a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ooo-1-0"></a>2.1. Open Office 1.0.x</h3></div></div></div><p>
	OOo has been tested by LDP volunteers with mostly positive
	results. Thanks to Charles Curley
		(<a class="ulink" href="http://www.charlescurley.com" target="_top">charlescurley.com</a>)
	for the following notes on using OOo version 1.0.x:
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Check the version of your OpenOffice</h3><p>
		These notes may not apply to the version of OOo you
		are using.
	</p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	To be able to export to DocBook, you must have a Java runtime
  environment (JRE) installed and registered with OOo--a minimum of
  version 4.2.x is recommended. The configuration instructions will
  depend on how you installed your JRE.  Visit the OOo web site for
  help with your setup.
</p><p>
  Contrary to the OOo documentation, the Linux OOo did not come with
  a JRE. I got one from Sun.
</p></li><li class="listitem"><p>The exported file has lots of empty lines. My 54 line exported
	file
  had 5 lines of actual XML code.</p></li><li class="listitem"><p>There was no effort at pretty printing.</p></li><li class="listitem"><p> The header is:
    <code class="computeroutput">
	 &lt;?xml version="1.0" encoding="UTF-8"?&gt;
    &lt;!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
	 "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd"&gt;
	</code>
</p></li><li class="listitem"><p> The pull-down menu in the <span class="guimenu">File</span> &#8594; <span class="guimenuitem">Save
As</span> dialog box for
file format
  indicates that the export format is <span class="quote">&#8220;<span class="quote">DocBook (simplified).</span>&#8221;</span> There is
  no explanation of what that <span class="quote">&#8220;<span class="quote">simplified</span>&#8221;</span> indicates. Does OOo export
  a subset of DocBook? If so, which elements are ignored? Is there any
  way to enter any of them manually?
</p></li><li class="listitem"><p> There is NO documentation on the DocBook export filter
or whether
  OOo will import it again.
</p></li></ul></div><p>
	Conclusions: OOo 1.1RC is worth looking at if you want a word
	processor for preparing DocBook documents.
</p><p>However, I hope they cure the lack of documentation.  For one
	thing, it would be nice to know which native OOo styles map to
	which DocBook elements. It would also be nice to know how to
	map one's own OOo styles to DocBook elements.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ooo-1-1"></a>2.2. Open Office 1.1</h3></div></div></div><p>
	<a class="ulink" href="http://www.merlinmonroe.com" target="_top">Tabatha Marshall</a>
	offers the following additional information for OOo 1.1.
</p><div class="blockquote"><blockquote class="blockquote"><p> The first problem was when I tried to do everything on version
	1.0.1.	That was
obviously a problem.  I have RH8, and it was installed via rpm packages,
so I ripped it out and did a full, new install of OpenOffice 1.1.
It took a while to find out 1.1 was a requirement for XML to work.
	</p><p>
During the install process I believe I was offered the choice to install
the XML features.  I have a tendency to do full installs of my office
programs, so I selected everything.
	</p><p>
I can't offer any advice to those trying to update their current
OO 1.1.  Their <span class="quote">&#8220;<span class="quote">3 ways</span>&#8221;</span> aren't documented very well at the site
(<a class="ulink" href="http://xml.openoffice.org" target="_top">xml.openoffice.org</a>) and as of this writing, I can't even find THAT
on their site anymore.	I think more current documentation is needed
there to walk people through the process.  Most of this was unclear
and I had to pretty much experiment to get things working.
	</p><p>
Well, after I installed everything I had some configuration to do.
I opened the application, and got started by opening a new file,
choosing templates, then selecting the DocBook template.  A nice menu
of <span class="guisubmenu">Paragraph Styles</span> popped up for me, which are the names for all those
tags, I noticed (you can see I don't use WYSIWYG often).
	</p><p>
		With a blank doc before me (couldn't get to the <span class="guisubmenu">XML Filter
		Settings</span> menu unless some type of doc was opened), I went into
		<span class="guimenu">Tools</span> &#8594; <span class="guimenuitem">XML
		Filter Settings</span>, and edited the entry for DocBook file.
		I configured mine as follows:
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
			<span class="guilabel">Doctype</span>  
			<strong class="userinput"><code>-//OASIS//DTD DocBook XML V4.2//EN</code></strong>
		</p></li><li class="listitem"><p>
			<span class="guilabel">DTD</span>
			<strong class="userinput"><code>http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd</code></strong>
		</p></li><li class="listitem"><p>
			<span class="guilabel">XSLT for export</span>
			<strong class="userinput"><code>/usr/local/OpenOffice.org1.1.0/share/xslt/docbook/ldp-html.xsl</code></strong>
		</p></li><li class="listitem"><p>
			<span class="guilabel">XSLT for import</span>
			<strong class="userinput"><code>/usr/local/OpenOffice.org1.1.0/share/xslt/docbook/docbooktosoffheadings.xsl</code></strong>
			(this is the default)
		</p></li><li class="listitem"><p>
			<span class="guilabel">Template for import</span>
			<strong class="userinput"><code>/home/tabatha/OpenOffice/user/template/DocBook
			File/DocBookTemplate.stw</code></strong>
		</p></li></ul></div><p>
At first, if I opened an XML file that had even one parsing error, it
would just open the file anyway and display the markup in OO.  I have
many XML files that use &amp;copy; and other types of entities which show
up as parse errors (depending on the encoding) even though they can be
processed through.  But today I was unable to open any of those files.
I got input/output errors instead.  Still investigating that one.
	</p><p>
However when you do successfully open a document (one parsing with no
errors), it puts it automatically into WYSIWYG based on the markup,
and you can then work from the paragraph styles menu like any other
such editor.
	</p><p>
To validate the document, I used <span class="guimenu">Tools</span> &#8594; <span class="guimenuitem">XML
Filter Settings</span>, then
clicked the <span class="guibutton">Test XSLTs</span> button.  On my screen, I set up the XSLT
for export to be <code class="filename">ldp-html.xsl</code>.	If you test and there are errors,
a new window pops up with error messages at the bottom, and the lines
that need to be changed up at the top.	You can change them there and
progress through the errors until they're all gone, and keep testing
until they're gone.
	</p><p>
If you want to open a file to see the source instead of the processed
results, go to <span class="guimenu">Tools</span> &#8594; <span class="guimenuitem">XML Filter
Settings</span> &#8594; <span class="guisubmenu">Test XSLTs</span>, and then
under the <span class="guimenu">Import</span> section, check the
<span class="guilabel">Display Source</span> box.  My import XSLT
is currently <code class="filename">docbooktosoffheadings.xsl</code> (the default) and the template
for import is <code class="filename">DocBookTemplate.stw</code> (also default).
	</p><p>
I think this might work for some people, but unfortunately not for me.
I've never used WYSIWYG to edit markup.  <span class="application">Emacs with
PSGML</span> can tell me
what my next tag is no matter where I am, validate by moving through
the trouble spots, and I can parse and process from command line.
	</p><p>
With OpenOffice, you have to visit <a class="ulink" href="http://xml.openoffice.org/filters.html" target="_top">http://xml.openoffice.org/filters.html</a>
to find conversion tools.
	</p></blockquote></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="apes01.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ape.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="apes03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">1. Text to DocBook </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 3. Microsoft Word to DocBook</td></tr></table></div></body></html>
