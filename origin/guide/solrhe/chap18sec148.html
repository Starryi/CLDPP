<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>5. Tripwire in Interactive Checking Mode</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="RedHat, redhat, maddy, linus, linux, Linux, Securing, Optimising, security, secure, openna, gerhard"><link rel="home" href="index.html" title="Securing and Optimizing Linux"><link rel="up" href="tripwireASR.html" title="Chapter 18. Linux Tripwire ASR 1.3.1"><link rel="prev" href="chap18sec147.html" title="4. Configure the /etc/cron.daily/tripwire.verify script"><link rel="next" href="chap18sec149.html" title="6. Run Tripwire in Database Update Mode"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5. Tripwire in <code class="literal">Interactive Checking Mode</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="chap18sec147.html">Prev</a> </td><th width="60%" align="center">Chapter 18. Linux Tripwire ASR 1.3.1</th><td width="20%" align="right"> <a accesskey="n" href="chap18sec149.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm9889"></a>5. Tripwire in <code class="literal">Interactive Checking Mode</code></h2></div></div></div><p>
          In <code class="literal">Interactive Checking Mode</code> feature, Tripwire verifies files or directories that have been added, deleted, or changed from the original database and asks the user whether the database entry 
          should be updated. This mode is the most convenient way of keeping your database up-to-date, but it requires that the user be <em class="wordasword">at the console</em>. If you intend to use this mode, then follow 
          the simple steps below.
          </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>
          
          Tripwire must have a database to compare against so we first create the file information database. This action will create a file called <code class="filename">tw.db_[hostname]</code> in the directory you specified to hold your 
          databases where <code class="literal">[hostname]</code> will be replaced with your machine hostname.

          To create the file information database for Tripwire, use the command:
          </p><pre class="screen">
          [root@deep] /# <span class="command"><strong>cd</strong></span> /var/spool/tripwire/
          [root@deep ]/tripwire# /usr/sbin/tripwire --initialize
          </pre><p>
          We move to the directory we specified to hold our database, and then we create the file information database, which is used for all subsequent Integrity Checking.

          </p></li><li class="step"><p>
          Once the file information database of Tripwire has been created, we can now run Tripwire in <code class="literal">Interactive Checking Mode</code>. This mode will prompt the user for whether or not each changed entry on the 
          system should be updated to reflect the current state of the file.
          To run in Interactive Checking Mode, use the command:
          </p><pre class="screen">
          [root@deep] /# <span class="command"><strong>cd</strong></span> /var/spool/tripwire/database/
          [root@deep ]/database# <span class="command"><strong>cp</strong></span> tw.db_myserverhostname /var/spool/tripwire/          
          [root@deep ]/database# <span class="command"><strong>cd ..</strong></span>          
          [root@deep ]/tripwire# <span class="command"><strong>/usr/sbin/tripwire</strong></span> --interactive
          </pre><p>
          </p><pre class="literallayout"><code class="computeroutput">
          Tripwire(tm) ASR (Academic Source Release) 1.3.1
          File Integrity Assessment Software
          (c) 1992, Purdue Research Foundation, (c) 1997, 1999 Tripwire
          Security Systems, Inc. All Rights Reserved. Use Restricted to
          Authorized Licensees.
          ### Phase 1:   	Reading configuration file
          ### Phase 2:   	Generating file list
          ### Phase 3:   	Creating file information database
          ### Phase 4:   	Searching for inconsistencies
          ###
          ###                   Total files scanned:   	15722
          ###                   Files added:   		34
          ###                   Files deleted: 		42
          ###                   Files changed:         	321
          ### 
          ###                   Total file violations: 	397
          ### added:   -rwx------ root        22706 Dec 31 06:25:02 1999 /root/tmp/firewall
          ---&gt; File: '/root/tmp/firewall'
          ---&gt; Update entry?  [YN(y)nh?]
          </code>
          </pre><p>
          </p></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><span class="inlinemediaobject"><img src="./images/Note.gif" alt="Note"></span></h3><p>
          In interactive mode, Tripwire first reports all added, deleted, and changed files, then allows the user to update the entry in the database.
          </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chap18sec147.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="tripwireASR.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="chap18sec149.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">4. Configure the <code class="filename">/etc/cron.daily/tripwire.verify</code> script </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 6. Run Tripwire in <em class="wordasword">Database Update Mode</em></td></tr></table></div></body></html>
