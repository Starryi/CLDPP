<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>5. Automatic or Manual Key connections</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="RedHat, redhat, maddy, linus, linux, Linux, Securing, Optimising, security, secure, openna, gerhard"><link rel="home" href="index.html" title="Securing and Optimizing Linux"><link rel="up" href="fSWAn.html" title="Chapter 25. Linux FreeS/WAN VPN"><link rel="prev" href="chap25sec202.html" title="4. Configure to optimise"><link rel="next" href="chap25sec203e.html" title="6. The /etc/ipsec.conf file"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5. Automatic or Manual Key connections</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="chap25sec202.html">Prev</a> </td><th width="60%" align="center">Chapter 25. Linux FreeS/WAN VPN</th><td width="20%" align="right"> <a accesskey="n" href="chap25sec203e.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm14737"></a>5. Automatic or Manual Key connections</h2></div></div></div><p>
The configuration file for FreeS/WAN <code class="filename">/etc/ipsec.conf</code> allows you to configure your <acronym class="acronym">IPSEC</acronym> configurations, control information and connections types. <acronym class="acronym">IPSEC</acronym> currently 
supports two types of connections: 
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Manually keyed </span></dt><dd><p>
 Manually keyed connections use keys stored in the <code class="filename">/etc/ipsec.conf</code> file. This type of connection is less secure then automatically keyed. 
 </p></dd><dt><span class="term">Automatically keyed. </span></dt><dd><p>
Automatically keyed connections use keys automatically generated by the Pluto key negotiation daemon. The key negotiation protocol, used by default and named IKE, authenticates the other system using shared secrets stored in <code class="filename">/etc/ipsec.secrets</code> file. 

</p></dd></dl></div><p>
The difference is strictly in how they are keyed. For these reasons, we will use and show you the automatically keyed connection that is more secure then the manually keyed connection. <span class="emphasis"><em>Once again, it is highly recommended that 
you use the automatically keyed connection</em></span>.
</p><p>
In our example configuration below, we configure a sample tunnel with a firewall-penetrating tunnel, and we assume that firewalling is being done on the left and right side. We choose to show you this configuration 
since we assume it is what most users and companies will use. Also, it allows us to play with more options in the configuration file <code class="filename">ipsec.conf</code> for automatically keyed connections. Different 
configurations exist and you may consult the <code class="filename">doc/examples</code> file under the subdirectory <code class="filename">doc</code> of the frees/WAN source directory for more information and other 
possible configurations.
</p><pre class="programlisting">
SubnetDeep======Deep------Deepgate..........Mailgate-------Mail======SubnetMail
                                       Untrusted net

leftsubnet = SubnetDeep (192.168.1.0/24)
left = Deep (deep.openna.com)
leftnexthop = Deepgate (the first router in the direction or ISP router for deep.openna.com)
Internet = Untrusted net
rightnexthop = Mailgate (the first router in the direction or ISP router for mail.openna.com)
right = Mail (mail.openna.com)
rightsubnet = SubnetMail (192.168.1.0/24)
</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
    </p><div class="literallayout"><p><br>
       SubnetDeep<br>
  \ 192.168.1.0/24 /<br>
  +--------------------+<br>
                |<br>
</p></div><p>            
SubnetDeep is the <acronym class="acronym">IP</acronym> network address of your private internal network on the first gateway. eth1 is attached to the internal network.        
        </p></li><li class="listitem"><p>
  </p><div class="literallayout"><p><br>
            Deep<br>
   \ 208.164.186.1 /<br>
   +-------------------+<br>
                |<br>
</p></div><p>
Deep is the <acronym class="acronym">IP</acronym> address of your first Gateway. eth0 is attached to the Internet.
</p></li><li class="listitem"><p>
  </p><div class="literallayout"><p><br>
         Deepgate<br>
 \ 205.151.222.250 /<br>
 +----------------------+<br>
                |<br>
<br>
</p></div><p>
Deepgate is the <acronym class="acronym">IP</acronym> address of the first router in the direction of your second gateway <code class="literal">mail.openna.com</code> or your <acronym class="acronym">ISP</acronym> router.
</p></li><li class="listitem"><p>
  </p><div class="literallayout"><p><br>
 I  N  T  E  R  N  E  T<br>
                |<br>
<br>
</p></div><p>
INTERNET is the untrusted network.
</p></li><li class="listitem"><p>
  </p><div class="literallayout"><p><br>
          Mailgate<br>
 / 205.151.222.251 \<br>
+------------------------+<br>
                |<br>
</p></div><p>
Mailgate is the <acronym class="acronym">IP</acronym> address of the first router in the direction of your first gateway <code class="literal">deep.openna.com</code> or your <acronym class="acronym">ISP</acronym> router.
</p></li><li class="listitem"><p>
  </p><div class="literallayout"><p><br>
             Mail<br>
   / 208.164.186.2 \<br>
  +---------------------+<br>
                |<br>
<br>
</p></div><p> 
Mail is the <acronym class="acronym">IP</acronym> address of your second Gateway. eth0 is attached to the Internet.
</p></li><li class="listitem"><p>
  </p><div class="literallayout"><p><br>
       SubnetMail<br>
  / 192.168.1.0/24 \<br>
 +----------------------+<br>
</p></div><p>
SubnetMail is the <acronym class="acronym">IP</acronym> network address of your private internal network on the second gateway. eth1 is attached to the internal network.
</p></li></ul></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chap25sec202.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="fSWAn.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="chap25sec203e.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">4. Configure to optimise </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 6. The <code class="filename">/etc/ipsec.conf</code> file</td></tr></table></div></body></html>
