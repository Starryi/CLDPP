<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>7. Test fire your PortSentry</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="RedHat, redhat, maddy, linus, linux, Linux, Securing, Optimising, security, secure, openna, gerhard"><link rel="home" href="index.html" title="Securing and Optimizing Linux"><link rel="up" href="soft-secmonitor.html" title="Chapter 14. Software -Security/Monitoring"><link rel="prev" href="chap14sec117.html" title="6. Configure and Optimise Portsentry"><link rel="next" href="soft-net.html" title="Part 6. Software -Networking"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7. Test fire your PortSentry</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="chap14sec117.html">Prev</a> </td><th width="60%" align="center">Chapter 14. Software -Security/Monitoring</th><td width="20%" align="right"> <a accesskey="n" href="soft-net.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm7774"></a>7. Test fire your PortSentry</h2></div></div></div><p>
         The PortSentry program can be configured in six different modes of operation, but be aware that only one protocol mode type can be started at a time. To be more accurate, you can start one <acronym class="acronym">TCP</acronym> mode and one <acronym class="acronym">UDP</acronym> mode, so 
         two <acronym class="acronym">TCP</acronym> modes and one <acronym class="acronym">UDP</acronym> modes, for example, doesn't work. The available modes are:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
         <span class="command"><strong>portsentry</strong></span> -tcp</span></dt><dd><p>
         basic port-bound <acronym class="acronym">TCP</acronym> mode
         </p></dd><dt><span class="term">
         <span class="command"><strong>portsentry</strong></span> -udp</span></dt><dd><p>
         basic port-bound <acronym class="acronym">UDP</acronym> mode
         </p></dd><dt><span class="term">
         <span class="command"><strong>portsentry</strong></span> -stcp</span></dt><dd><p>
         Stealth <acronym class="acronym">TCP</acronym> scan detection
         </p></dd><dt><span class="term">
         <span class="command"><strong>portsentry</strong></span> -atcp</span></dt><dd><p>
         Advanced <acronym class="acronym">TCP</acronym> stealth scan detection
         </p></dd><dt><span class="term">
         <span class="command"><strong>portsentry</strong></span> -sudp</span></dt><dd><p>
         Stealth <acronym class="acronym">UDP</acronym> scan detection
         </p></dd><dt><span class="term">
         <span class="command"><strong>portsentry</strong></span> -audp</span></dt><dd><p>
         Advanced Stealth <acronym class="acronym">UDP</acronym> scan detection
         </p></dd></dl></div><p>
         </p><p>
         In my case I prefer to start <acronym class="acronym">TCP</acronym> in Advanced <acronym class="acronym">TCP</acronym> stealth scan detection protocol mode and <acronym class="acronym">UDP</acronym> in Stealth <acronym class="acronym">UDP</acronym> scan detection protocol 
         mode. For information about the other protocol modes, please refer to the <code class="filename">README.install</code> and <code class="filename">README.stealth</code> file under the PortSentry source directory.
         For <acronym class="acronym">TCP</acronym> mode I choose:
         </p><div class="glosslist"><dl><dt><span class="glossterm">
          -atcp
         </span></dt><dd class="glossdef"><p>
         Advanced <acronym class="acronym">TCP</acronym> stealth scan detection mode
         </p></dd></dl></div><p>
         With the Advanced <acronym class="acronym">TCP</acronym> stealth scan detection mode  -atcp protocol mode type, PortSentry will first check to see what ports you have running on your server, then remove 
         these ports from monitoring and will begin watching the remaining ports. This is very powerful and reacts exceedingly quickly for port scanners. It also uses very little <acronym class="acronym">CPU</acronym> time.
         </p><p>
         For <acronym class="acronym">UDP</acronym> mode I choose:
         </p><div class="glosslist"><dl><dt><span class="glossterm">
          -sudp
         </span></dt><dd class="glossdef"><p>
         Stealth <acronym class="acronym">UDP</acronym> scan detection mode
         </p></dd></dl></div><p>
         With the Stealth <acronym class="acronym">UDP</acronym> scan detection mode  -sudp protocol mode type, the <acronym class="acronym">UDP</acronym> ports will be listed and then monitored.
         </p><p>
         To start PortSentry in the two modes selected above, use the commands:
         </p><pre class="screen">
         [root@deep] /#  /usr/psionic/portsentry/portsentry -atcp
         [root@deep] /#  /usr/psionic/portsentry/portsentry -sudp
         </pre><p>
         </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">
<span class="inlinemediaobject"><img src="./images/Tip.gif" alt="Tip"></span>
</h3><p>
         You can add the above lines to your <code class="filename">/etc/rc.d/rc.local</code> script file and PortSentry software will be automatically started if you reboot your system.
         </p></div><p>
         These are the files Installed by Portsentry on your system:
         </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="filename">
         /usr/psionic
         </code></td></tr><tr><td><code class="filename">
         /usr/psionic/portsentry
         </code></td></tr><tr><td><code class="filename">
         /usr/psionic/portsentry/portsentry.conf
         </code></td></tr><tr><td><code class="filename">
         /usr/psionic/portsentry/portsentry.ignore
         </code></td></tr><tr><td><code class="filename">
         /usr/psionic/portsentry/portsentry
         </code></td></tr></table><p>
         </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chap14sec117.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="soft-secmonitor.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="soft-net.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">6. Configure and Optimise Portsentry </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Part 6. Software -Networking</td></tr></table></div></body></html>
