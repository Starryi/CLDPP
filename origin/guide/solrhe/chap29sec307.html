<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>4. Restore files with tar</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="RedHat, redhat, maddy, linus, linux, Linux, Securing, Optimising, security, secure, openna, gerhard"><link rel="home" href="index.html" title="Securing and Optimizing Linux"><link rel="up" href="whywhen.html" title="Chapter 33. Why's and When's of Backup and Restore"><link rel="prev" href="chap29sec306.html" title="3. Automating backups with tar"><link rel="next" href="back-dump.html" title="5. The dump backup program"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. Restore files with <span class="command"><strong>tar</strong></span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="chap29sec306.html">Prev</a> </td><th width="60%" align="center">Chapter 33. Why's and When's of Backup and Restore</th><td width="20%" align="right"> <a accesskey="n" href="back-dump.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm23684"></a>4. Restore files with <span class="command"><strong>tar</strong></span></h2></div></div></div><p>
More important than performing regular backups is having them available when we need to recover important files! In this section, we will discuss methods for restoring files, which have been backed up with <span class="command"><strong>tar</strong></span> command.
</p><p>
The following command will restore all files from the <code class="literal">full-backup-Day-Month-Year.tar</code> archive, which is an example backup of our <code class="filename">home</code> directory created from the 
example <span class="command"><strong>tar</strong></span> commands shown above.
</p><pre class="screen">
[root@deep] /# <span class="command"><strong>cd</strong></span> /
[root@deep] /# <span class="command"><strong>tar</strong></span> xpf /dev/st0/full-backup-Day-Month-Year.<span class="command"><strong>tar</strong></span>
</pre><p>
The above command extracts all files contained in the compressed archive, preserving original file ownership and permissions.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
The   x option stands for extract.
</p></li><li class="listitem"><p>
The <code class="literal">p</code> option preserve permissions; file protection information will be <span class="emphasis"><em>remembered.</em></span>
</p></li><li class="listitem"><p>
The <code class="literal">f</code> option states that the very next argument will be the name of the archive file or device.
</p></li></ul></div><p>
</p><p>
If you do not need to restore all the files contained in the archive, you can specify one or more files that you wish to restore:

To specify one or more files that you wish to restore, use the following command:
</p><pre class="screen">
[root@deep]# <span class="command"><strong>cd</strong></span> /
[root@deep]# <span class="command"><strong>tar</strong></span> xpf /dev/st0/full-backup-Day-Month-Year.<span class="command"><strong>tar</strong></span> \
 home/wahib/Personal/Contents.doc home/quota.user
 </pre><p>

The above command restores the <code class="filename">/home/wahib/Personal/Contents.doc</code> and <code class="filename">/home/quota.user</code> files from the archive.

</p><p>
If you just want to see what files are in the backup volume, Use the <code class="literal">--list</code> or <code class="literal">-t</code> option:
</p><pre class="screen">
[root@deep] /# <span class="command"><strong>tar</strong></span> tf /dev/st0
</pre><p>
</p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">
<span class="inlinemediaobject"><img src="./images/Caution.gif" alt="Caution"></span>
</h3><p>
If you have files on your system set with the immutable bit, using the <span class="command"><strong>chattr</strong></span> command, these files will not be remembered with the immutable bit from your restored backup. You must reset it immutable with the 
command <span class="command"><strong>chattr</strong></span>  +i after the backup is completed.
</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Test the ability to recover</h3><div class="mediaobject"><img src="./images/Note.gif" alt="Note"></div><p>
Dont forget to test the ability to recover from backups, for many system administrators, recovering a file from a backup is an uncommon activity. This step assures that if you need to recover a file, the tools and processes will work. Performing 
this test periodically will help you to discover problems with the backup procedures so you can correct them before losing data. Some backup restoration software does not accurately recover the correct file protection and file ownership controls. 
Check the attributes of restored files to ensure they are being set correctly. Periodically test to ensure that you can perform a full system recovery from your backups.
</p></div><p>
Further documentation, for more details, there is man page you can read:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<span class="citerefentry"><span class="refentrytitle">tar</span>(1)</span></span></dt><dd><p>
- The GNU version of the <span class="command"><strong>tar</strong></span> archiving utility
</p></dd></dl></div><p>
</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chap29sec306.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="whywhen.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="back-dump.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">3. Automating backups with <span class="command"><strong>tar</strong></span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 5. The dump backup program</td></tr></table></div></body></html>
