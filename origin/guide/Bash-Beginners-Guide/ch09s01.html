<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>1. The for loop</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="Linux, Scripts, linux, Bash, guide, Guide, Exercises, exercises, bash, scripting, Scripting, awk, sed, variables, functions, loops, conditionals"><link rel="home" href="index.html" title="Bash Guide for Beginners"><link rel="up" href="ch09.html" title="Chapter 9. Repetitive tasks"><link rel="prev" href="ch09.html" title="Chapter 9. Repetitive tasks"><link rel="next" href="ch09s02.html" title="2. The while loop"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1. The for loop</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch09.html">Prev</a> </td><th width="60%" align="center">Chapter 9. Repetitive tasks</th><td width="20%" align="right"> <a accesskey="n" href="ch09s02.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_01"></a>1. The for loop</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_01_01"></a>1.1. How does it work?</h3></div></div></div><p>The <span class="command"><strong>for</strong></span> loop is the first of the three shell looping constructs.  This loop allows for specification of a list of values.  A list of commands is executed for each value in the list.</p><p>The syntax for this loop is:</p><div class="cmdsynopsis"><p><code class="command">for <code class="varname">NAME</code> [in LIST ]; do COMMANDS; done</code> </p></div><p>If <span class="command"><strong>[in LIST]</strong></span> is not present, it is replaced with <span class="command"><strong>in <code class="varname">$@</code></strong></span> and <span class="command"><strong>for</strong></span> executes the <span class="command"><strong>COMMANDS</strong></span> once for each positional parameter that is set (see <a class="xref" href="ch03s02.html#sect_03_02_05" title="2.5. Special parameters">Section 2.5, &#8220;Special parameters&#8221;</a> and <a class="xref" href="ch07s02.html#sect_07_02_01_02" title="2.1.2. Checking command line arguments">Section 2.1.2, &#8220;Checking command line arguments&#8221;</a>).</p><p>The return status is the exit status of the last command that executes.  If no commands are executed because <code class="varname">LIST</code> does not expand to any items, the return status is zero.</p><p><code class="varname">NAME</code> can be any variable name, although <code class="varname">i</code> is used very often.  <code class="varname">LIST</code> can be any list of words, strings or numbers, which can be literal or generated by any command.  The <span class="command"><strong>COMMANDS</strong></span> to execute can also be any operating system commands, script, program or shell statement.  The first time through the loop, <code class="varname">NAME</code> is set to the first item in <code class="varname">LIST</code>.  The second time, its value is set to the second item in the list, and so on.  The loop terminates when <code class="varname">NAME</code> has taken on each of the values from <code class="varname">LIST</code> and no items are left in <code class="varname">LIST</code>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_01_02"></a>1.2. Examples</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_01_02_03"></a>1.2.1. Using command substitution for specifying LIST items</h4></div></div></div><p>The first is a command line example, demonstrating the use of a <span class="command"><strong>for</strong></span> loop that makes a backup copy of each <code class="filename">.xml</code> file.  After issuing the command, it is safe to start working on your sources:</p><pre class="screen">
<code class="prompt">[carol@octarine ~/articles]</code> <span class="command"><strong>ls <code class="filename">*.xml</code></strong></span>
file1.xml  file2.xml  file3.xml

<code class="prompt">[carol@octarine ~/articles]</code> <span class="command"><strong>ls <code class="filename">*.xml</code> &gt; <code class="filename">list</code></strong></span>

<code class="prompt">[carol@octarine ~/articles]</code> <span class="command"><strong>for <code class="varname">i</code> in <em class="parameter"><code>`cat list`</code></em>; do cp <code class="filename">"$i" "$i".bak</code> ; done</strong></span>

<code class="prompt">[carol@octarine ~/articles]</code> <span class="command"><strong>ls <code class="filename">*.xml*</code></strong></span>
file1.xml  file1.xml.bak  file2.xml  file2.xml.bak  file3.xml  file3.xml.bak
</pre><p>This one lists the files in <code class="filename">/sbin</code> that are just plain text files, and possibly scripts:</p><pre class="screen">
<span class="command"><strong>for <code class="varname">i</code> in <em class="parameter"><code>`ls /sbin`</code></em>; do file <code class="filename">/sbin/$i</code> | grep <em class="parameter"><code>ASCII</code></em>; done</strong></span>
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_01_02_02"></a>1.2.2. Using the content of a variable to specify LIST items</h4></div></div></div><p>The following is a specific application script for converting HTML files, compliant with a certain scheme, to PHP files.  The conversion is done by taking out the first 25 and the last 21 lines, replacing these with two PHP tags that provide header and footer lines:</p><pre class="screen">
<code class="prompt">[carol@octarine ~/html]</code> <span class="command"><strong>cat <code class="filename">html2php.sh</code></strong></span>
#!/bin/bash
# specific conversion script for my html files to php
LIST="$(ls *.html)"
for i in "$LIST"; do
     NEWNAME=$(ls "$i" | sed -e 's/html/php/')
     cat beginfile &gt; "$NEWNAME"
     cat "$i" | sed -e '1,25d' | tac | sed -e '1,21d'| tac &gt;&gt; "$NEWNAME"
     cat endfile &gt;&gt; "$NEWNAME"
done
</pre><p>Since we don't do a line count here, there is no way of knowing the line number from which to start deleting lines until reaching the end.  The problem is solved using <span class="command"><strong>tac</strong></span>, which reverses the lines in a file.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">The basename command</h3><p>Instead of using <span class="command"><strong>sed</strong></span> to replace the <code class="filename">html</code> suffix with <code class="filename">php</code>, it would be cleaner to use the <span class="command"><strong>basename</strong></span> command.  Read the man page for more info.</p></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Odd characters</h3><p>You will run into problems if the list expands to file names containing spaces and other irregular characters.  A more ideal construct to obtain the list would be to use the shell's globbing feature, like this:</p><pre class="screen">
for i in $PATHNAME/*; do
	commands
done
</pre></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch09.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch09.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch09s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 9. Repetitive tasks </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 2. The while loop</td></tr></table></div></body></html>
