<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Bash Guide for Beginners</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="Linux, Scripts, linux, Bash, guide, Guide, Exercises, exercises, bash, scripting, Scripting, awk, sed, variables, functions, loops, conditionals"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="Bash-Beginners-Guide"></a>Bash Guide for Beginners</h1></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Machtelt</span> <span class="surname">Garrels</span></h3><div class="affiliation"><span class="orgname">Garrels BVBA
<br></span><div class="address"><p><br>
<code class="email">&lt;<a class="email" href="mailto:tille%20wants%20no%20spam%20_at_%20garrels%20dot%20be">tille wants no spam _at_ garrels dot be</a>&gt;</code><br>
</p></div></div></div></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="preface"><a href="#idm32">Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#intro_01">1. Why this guide?</a></span></dt><dt><span class="section"><a href="#intro_02">2. Who should read this book?</a></span></dt><dt><span class="section"><a href="#intro_03">3. New versions, translations and availability</a></span></dt><dt><span class="section"><a href="#intro_04">4. Revision History</a></span></dt><dt><span class="section"><a href="#intro_05">5. Contributions</a></span></dt><dt><span class="section"><a href="#intro_06">6. Feedback</a></span></dt><dt><span class="section"><a href="#intro_07">7. Copyright information</a></span></dt><dt><span class="section"><a href="#intro_08">8. What do you need?</a></span></dt><dt><span class="section"><a href="#intro_09">9. Conventions used in this document</a></span></dt><dt><span class="section"><a href="#intro_10">10. Organization of this document</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_01">1. Bash and Bash scripts</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_01_01">1. Common shell programs</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_01_01">1.1. General shell functions</a></span></dt><dt><span class="sect2"><a href="#sect_01_01_02">1.2. Shell types</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_02">2. Advantages of the Bourne Again SHell</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_02_01">2.1. Bash is the GNU shell</a></span></dt><dt><span class="sect2"><a href="#sect_01_02_02">2.2. Features only found in bash</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_03">3. Executing commands</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_03_01">3.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_01_03_02">3.2. Shell built-in commands</a></span></dt><dt><span class="sect2"><a href="#sect_01_03_03">3.3. Executing programs from a script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_04">4. Building blocks</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_04_01">4.1. Shell building blocks</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_05">5. Developing good scripts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_05_01">5.1. Properties of good scripts</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_02">5.2. Structure</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_03">5.3. Terminology</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_04">5.4. A word on order and logic</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_05">5.5. An example Bash script: mysystem.sh</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_06">5.6. Example init script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_06">6. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_01_07">7. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_02">2. Writing and debugging scripts</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_02_01">1. Creating and running a script</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_02_01_01">1.1. Writing and naming</a></span></dt><dt><span class="sect2"><a href="#sect_02_01_02">1.2. script1.sh</a></span></dt><dt><span class="sect2"><a href="#sect_02_01_03">1.3. Executing the script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_02_02">2. Script basics</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_02_02_01">2.1. Which shell will run the script?</a></span></dt><dt><span class="sect2"><a href="#sect_02_02_02">2.2. Adding comments</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_02_03">3. Debugging Bash scripts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_02_03_01">3.1. Debugging on the entire script</a></span></dt><dt><span class="sect2"><a href="#sect_02_03_02">3.2. Debugging on part(s) of the script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_02_05">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_02_06">5. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_03">3. The Bash environment</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_03_01">1. Shell initialization files</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_01_01">1.1. System-wide configuration files</a></span></dt><dt><span class="sect2"><a href="#sect_03_01_02">1.2. Individual user configuration files</a></span></dt><dt><span class="sect2"><a href="#sect_03_01_03">1.3. Changing shell configuration files</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_02">2. Variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_02_01">2.1. Types of variables</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_02">2.2. Creating variables</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_03">2.3. Exporting variables</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_04">2.4. Reserved variables</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_05">2.5. Special parameters</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_06">2.6. Script recycling with variables</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_03">3. Quoting characters</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_03_01">3.1. Why?</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_02">3.2. Escape characters</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_03">3.3. Single quotes</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_04">3.4. Double quotes</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_05">3.5. ANSI-C quoting</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_06">3.6. Locales</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_04">4. Shell expansion</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_04_0">4.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_01">4.2. Brace expansion</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_02">4.3. Tilde expansion</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_03">4.4. Shell parameter and variable expansion</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_04">4.5. Command substitution</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_05">4.6. Arithmetic expansion</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_06">4.7. Process substitution</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_07">4.8. Word splitting</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_08">4.9. File name expansion</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_05">5. Aliases</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_05_01">5.1. What are aliases?</a></span></dt><dt><span class="sect2"><a href="#sect_03_05_02">5.2. Creating and removing aliases</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_06">6. More Bash options</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_06_01">6.1. Displaying options</a></span></dt><dt><span class="sect2"><a href="#sect_03_06_02">6.2. Changing options</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_07">7. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_03_08">8. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_04">4. Regular expressions</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_04_01">1. Regular expressions</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_04_01_01">1.1. What are regular expressions?</a></span></dt><dt><span class="sect2"><a href="#sect_04_01_02">1.2. Regular expression metacharacters</a></span></dt><dt><span class="sect2"><a href="#sect_04_01_03">1.3. Basic versus extended regular expressions</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_04_02">2. Examples using grep</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_04_02_01">2.1. What is grep?</a></span></dt><dt><span class="sect2"><a href="#sect_04_02_02">2.2. Grep and regular expressions</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_04_03">3. Pattern matching using Bash features</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_04_03_01">3.1. Character ranges</a></span></dt><dt><span class="sect2"><a href="#sect_04_03_02">3.2. Character classes</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_04_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_04_05">5. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_05">5. The GNU sed stream editor</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_05_01">1. Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_05_01_01">1.1. What is sed?</a></span></dt><dt><span class="sect2"><a href="#sect_05_01_02">1.2. sed commands</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_05_02">2. Interactive editing</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_05_02_01">2.1. Printing lines containing a pattern</a></span></dt><dt><span class="sect2"><a href="#sect_05_02_02">2.2. Deleting lines of input containing a pattern</a></span></dt><dt><span class="sect2"><a href="#sect_05_02_03">2.3. Ranges of lines</a></span></dt><dt><span class="sect2"><a href="#sect_05_02_04">2.4. Find and replace with sed</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_05_03">3. Non-interactive editing</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_05_03_01">3.1. Reading sed commands from a file</a></span></dt><dt><span class="sect2"><a href="#sect_05_03_02">3.2. Writing output files</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_05_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_05_05">5. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_06">6. The GNU awk programming language</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_06_01">1. Getting started with gawk</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_06_01_01">1.1. What is gawk?</a></span></dt><dt><span class="sect2"><a href="#sect_06_01_02">1.2. Gawk commands</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_06_02">2. The print program</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_06_02_01">2.1. Printing selected fields</a></span></dt><dt><span class="sect2"><a href="#sect_06_02_02">2.2. Formatting fields</a></span></dt><dt><span class="sect2"><a href="#sect_06_02_03">2.3. The print command and regular expressions</a></span></dt><dt><span class="sect2"><a href="#sect_06_02_04">2.4. Special patterns</a></span></dt><dt><span class="sect2"><a href="#sect_06_02_05">2.5. Gawk scripts</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_06_03">3. Gawk variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_06_03_01">3.1. The input field separator</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_02">3.2. The output separators</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_03">3.3. The number of records</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_04">3.4. User defined variables</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_05">3.5. More examples</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_06">3.6. The printf program</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_06_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_06_05">5. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_07">7. Conditional statements</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_07_01">1. Introduction to if</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_07_01_01">1.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_07_01_02">1.2. Simple applications of if</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_07_02">2. More advanced if usage</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_07_02_01">2.1. if/then/else constructs</a></span></dt><dt><span class="sect2"><a href="#sect_07_02_02">2.2. if/then/elif/else constructs</a></span></dt><dt><span class="sect2"><a href="#sect_07_02_03">2.3. Nested if statements</a></span></dt><dt><span class="sect2"><a href="#sect_07_02_04">2.4. Boolean operations</a></span></dt><dt><span class="sect2"><a href="#sect_07_02_05">2.5. Using the exit statement and if</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_07_03">3. Using case statements</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_07_03_01">3.1. Simplified conditions</a></span></dt><dt><span class="sect2"><a href="#sect_07_03_02">3.2. Initscript example</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_07_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_07_05">5. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_08">8. Writing interactive scripts</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_08_01">1. Displaying user messages</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_08_01_01">1.1. Interactive or not?</a></span></dt><dt><span class="sect2"><a href="#sect_08_01_02">1.2. Using the echo built-in command</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_08_02">2. Catching user input</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_08_02_01">2.1. Using the read built-in command</a></span></dt><dt><span class="sect2"><a href="#sect_08_02_02">2.2. Prompting for user input</a></span></dt><dt><span class="sect2"><a href="#sect_08_02_03">2.3. Redirection and file descriptors</a></span></dt><dt><span class="sect2"><a href="#sect_08_02_04">2.4. File input and output</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_08_03">3. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_08_04">4. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_09">9. Repetitive tasks</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_09_01">1. The for loop</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_01_01">1.1. How does it work?</a></span></dt><dt><span class="sect2"><a href="#sect_09_01_02">1.2. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_02">2. The while loop</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_02_01">2.1. What is it?</a></span></dt><dt><span class="sect2"><a href="#sect_09_02_02">2.2. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_03">3. The until loop</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_03_01">3.1. What is it?</a></span></dt><dt><span class="sect2"><a href="#sect_09_03_02">3.2. Example</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_04">4. I/O redirection and loops</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_04_01">4.1. Input redirection</a></span></dt><dt><span class="sect2"><a href="#sect_09_04_02">4.2. Output redirection</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_05">5. Break and continue</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_05_01">5.1. The break built-in</a></span></dt><dt><span class="sect2"><a href="#sect_09_05_02">5.2. The continue built-in</a></span></dt><dt><span class="sect2"><a href="#sect_09_05_03">5.3. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_06">6. Making menus with the select built-in</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_06_01">6.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_09_06_02">6.2. Submenus</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_07">7. The shift built-in</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_07_01">7.1. What does it do?</a></span></dt><dt><span class="sect2"><a href="#sect_09_07_02">7.2. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_08">8. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_09_09">9. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_10">10. More on variables</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_10_01">1. Types of variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_10_01_01">1.1. General assignment of values</a></span></dt><dt><span class="sect2"><a href="#sect_10_01_02">1.2. Using the declare built-in</a></span></dt><dt><span class="sect2"><a href="#sect_10_01_03">1.3. Constants</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_10_02">2. Array variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_10_02_01">2.1. Creating arrays</a></span></dt><dt><span class="sect2"><a href="#sect_10_02_02">2.2. Dereferencing the variables in an array</a></span></dt><dt><span class="sect2"><a href="#sect_10_02_03">2.3. Deleting array variables</a></span></dt><dt><span class="sect2"><a href="#sect_10_02_04">2.4. Examples of arrays</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_10_03">3. Operations on variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_10_03_01">3.1. Arithmetic on variables</a></span></dt><dt><span class="sect2"><a href="#sect_10_03_02">3.2. Length of a variable</a></span></dt><dt><span class="sect2"><a href="#sect_10_03_03">3.3. Transformations of variables</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_10_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_10_05">5. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_11">11. Functions</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_11_01">1. Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_11_01_01">1.1. What are functions?</a></span></dt><dt><span class="sect2"><a href="#sect_11_01_02">1.2. Function syntax</a></span></dt><dt><span class="sect2"><a href="#sect_11_01_03">1.3. Positional parameters in functions</a></span></dt><dt><span class="sect2"><a href="#sect_11_01_04">1.4. Displaying functions</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_11_02">2. Examples of functions in scripts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_11_02_01">2.1. Recycling</a></span></dt><dt><span class="sect2"><a href="#sect_11_02_02">2.2. Setting the path</a></span></dt><dt><span class="sect2"><a href="#sect_11_02_03">2.3. Remote backups</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_11_03">3. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_11_04">4. Exercises</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap_12">12. Catching signals</a></span></dt><dd><dl><dt><span class="sect1"><a href="#sect_12_01">1. Signals</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_12_01_01">1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#sect_12_01_02">1.2. Usage of signals with kill</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_12_02">2. Traps</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_12_02_01">2.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_12_02_02">2.2. How Bash interprets traps</a></span></dt><dt><span class="sect2"><a href="#sect_12_02_03">2.3. More examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_12_03">3. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_12_04">4. Exercises</a></span></dt></dl></dd><dt><span class="appendix"><a href="#app3">A. Shell Features</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idm7242">1. Common features</a></span></dt><dt><span class="sect1"><a href="#idm7368">2. Differing features</a></span></dt></dl></dd><dt><span class="glossary"><a href="#glossary">Glossary</a></span></dt><dt><span class="glossary"><a href="#index-gloss-glossary">Index</a></span></dt></dl></div><div class="list-of-figures"><p><b>List of Figures</b></p><dl><dt>1. <a href="#idm71">Bash Guide for Beginners front cover</a></dt><dt>2.1. <a href="#idm1408">script1.sh</a></dt><dt>3.1. <a href="#idm1877">Different prompts for different users</a></dt><dt>6.1. <a href="#idm4110">Fields in awk</a></dt><dt>7.1. <a href="#idm5028">Testing of a command line argument with if</a></dt><dt>7.2. <a href="#idm5143">Example using Boolean operators</a></dt></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>1. <a href="#conventions">Typographic and usage conventions</a></dt><dt>1.1. <a href="#table_01_01">Overview of programming terms</a></dt><dt>2.1. <a href="#table_02_01">Overview of set debugging options</a></dt><dt>3.1. <a href="#table_03_01">Reserved Bourne shell variables</a></dt><dt>3.2. <a href="#table_03_02">Reserved Bash variables</a></dt><dt>3.3. <a href="#table_03_03">Special bash variables</a></dt><dt>3.4. <a href="#table_03_04">Arithmetic operators</a></dt><dt>4.1. <a href="#table_04_01">Regular expression operators</a></dt><dt>5.1. <a href="#tab_05_01">Sed editing commands</a></dt><dt>5.2. <a href="#tab_05_02">Sed options</a></dt><dt>6.1. <a href="#tab_06_01">Formatting characters for gawk</a></dt><dt>7.1. <a href="#tab_07_01">Primary expressions</a></dt><dt>7.2. <a href="#tab_07_02">Combining expressions</a></dt><dt>8.1. <a href="#tab_08_01">Escape sequences used by the echo command</a></dt><dt>8.2. <a href="#tab_08_02">Options to the read built-in</a></dt><dt>10.1. <a href="#tab_10_01">Options to the declare built-in</a></dt><dt>12.1. <a href="#tab_12_01">Control signals in Bash</a></dt><dt>12.2. <a href="#tab_12_02">Common kill signals</a></dt><dt>A.1. <a href="#idm7245">Common Shell Features</a></dt><dt>A.2. <a href="#idm7386">Differing Shell Features</a></dt></dl></div><div class="preface"><div class="titlepage"><div><div><h1 class="title"><a name="idm32"></a>Introduction</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#intro_01">1. Why this guide?</a></span></dt><dt><span class="section"><a href="#intro_02">2. Who should read this book?</a></span></dt><dt><span class="section"><a href="#intro_03">3. New versions, translations and availability</a></span></dt><dt><span class="section"><a href="#intro_04">4. Revision History</a></span></dt><dt><span class="section"><a href="#intro_05">5. Contributions</a></span></dt><dt><span class="section"><a href="#intro_06">6. Feedback</a></span></dt><dt><span class="section"><a href="#intro_07">7. Copyright information</a></span></dt><dt><span class="section"><a href="#intro_08">8. What do you need?</a></span></dt><dt><span class="section"><a href="#intro_09">9. Conventions used in this document</a></span></dt><dt><span class="section"><a href="#intro_10">10. Organization of this document</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_01"></a>1. Why this guide?</h2></div></div></div><p>The primary reason for writing this document is that a lot of readers feel the existing <a class="ulink" href="http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html" target="_top">HOWTO</a> to be too short and incomplete, while the <a class="ulink" href="http://tldp.org/LDP/abs/html/" target="_top">Bash Scripting</a> guide is too much of a reference work.  There is nothing in between these two extremes.  I also wrote this guide on the general principle that not enough free basic courses are available, though they should be.</p><p>This is a practical guide which, while not always being too serious, tries to give real-life instead of theoretical examples.  I partly wrote it because I don't get excited with stripped down and over-simplified examples written by people who know what they are talking about, showing some really cool Bash feature so much out of its context that you cannot ever use it in practical circumstances.  You can read that sort of stuff after finishing this book, which contains exercises and examples that will help you survive in the real world.</p><p>From my experience as UNIX/Linux user, system administrator and trainer, I know that people can have years of daily interaction with their systems, without having the slightest knowledge of task automation.  Thus they often think that UNIX is not user-friendly, and even worse, they get the impression that it is slow and old-fashioned.  This problem is another one that can be remedied by this guide.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_02"></a>2. Who should read this book?</h2></div></div></div><p>Everybody working on a UNIX or UNIX-like system who wants to make life easier on themselves, power users and sysadmins alike, can benefit from reading this book.  Readers who already have a grasp of working the system using the command line will learn the ins and outs of shell scripting that ease execution of daily tasks.  System administration relies a great deal on shell scripting; common tasks are often automated using simple scripts.  This document is full of examples that will encourage you to write your own and that will inspire you to improve on existing scripts.</p><p>Prerequisites/not in this course:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>You should be an experienced UNIX or Linux user, familiar with basic commands, man pages and documentation</p></li><li class="listitem"><p>Being able to use a text editor</p></li><li class="listitem"><p>Understand system boot and shutdown processes, init and initscripts</p></li><li class="listitem"><p>Create users and groups, set passwords</p></li><li class="listitem"><p>Permissions, special modes</p></li><li class="listitem"><p>Understand naming conventions for devices, partitioning, mounting/unmounting file systems</p></li><li class="listitem"><p>Adding/removing software on your system</p></li></ul></div><p>See <a class="ulink" href="http://tldp.org/LDP/intro-linux/html/" target="_top">Introduction to Linux</a> (or your local <a class="ulink" href="http://www.tldp.org/mirrors.html" target="_top">TLDP mirror</a>) if you haven't mastered one or more of these topics.  Additional information can be found in your system documentation (man and info pages), or at <a class="ulink" href="http://tldp.org" target="_top">the Linux Documentation Project</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_03"></a>3. New versions, translations and availability</h2></div></div></div><p>The most recent edition can be found at <a class="ulink" href="http://tille.garrels.be/training/bash/" target="_top">http://tille.garrels.be/training/bash/</a>.  You should find the same version at <a class="ulink" href="http://tldp.org/LDP/Bash-Beginners-Guide/html/index.html" target="_top">http://tldp.org/LDP/Bash-Beginners-Guide/html/index.html</a>.</p><p>This guide is available in print from <a class="ulink" href="http://store.fultus.com/product_info.php?products_id=66" target="_top">Fultus.com</a>.</p><div class="figure"><a name="idm71"></a><p class="title"><b>Figure 1. Bash Guide for Beginners front cover</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/bgb.jpg" alt="Front cover of the Bash guide, red highlighted code on blue background."></div></div></div><br class="figure-break"><p>This guide has been translated:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Chinese translation at <a class="ulink" href="http://xiaowang.net/bgb-cn/" target="_top">http://xiaowang.net/bgb-cn/</a>, by Wang Wei.</p></li><li class="listitem"><p>Ukrainian translation at <a class="ulink" href="http://docs.linux.org.ua/index.php/LDP:Bash_beginners_guide" target="_top">http://docs.linux.org.ua/index.php/LDP:Bash_beginners_guide</a>, by Yaroslav Fedevych and his team.</p></li></ul></div><p>A french translation is in the making and will be linked to as soon as it is finished.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_04"></a>4. Revision History</h2></div></div></div><p>
</p><div class="revhistory"><table style="border-style:solid; width:100%;" summary="Revision History"><tr><th align="left" valign="top" colspan="3"><b>Revision History</b></th></tr><tr><td align="left">Revision 1.11</td><td align="left">2008-12-27</td><td align="left">MG</td></tr><tr><td align="left" colspan="3">Processed input from readers.</td></tr><tr><td align="left">Revision 1.10</td><td align="left">2008-06-06</td><td align="left">MG</td></tr><tr><td align="left" colspan="3">address change</td></tr><tr><td align="left">Revision 1.9</td><td align="left">2006-10-10</td><td align="left">MG</td></tr><tr><td align="left" colspan="3">Incorporated reader remarks, added index using DocBook tags.</td></tr><tr><td align="left">Revision 1.8</td><td align="left">2006-03-15</td><td align="left">MG</td></tr><tr><td align="left" colspan="3">clarified example in Chap4, corrected here doc in chap9, general checks and correction of typos, added link to Chinese and Ukrainian translation, note and stuff to know about awk in chap6.</td></tr><tr><td align="left">Revision 1.7</td><td align="left">2005-09-05</td><td align="left">MG</td></tr><tr><td align="left" colspan="3">Corrected typos in chapter 3, 6 and 7, incorporated user remarks, added a note in chap7.</td></tr><tr><td align="left">Revision 1.6</td><td align="left">2005-03-01</td><td align="left">MG</td></tr><tr><td align="left" colspan="3">Minor debugging, added more keywords, info about new Bash 3.0, took out blank image.</td></tr><tr><td align="left">Revision 1.0</td><td align="left">2004-04-27</td><td align="left">TM</td></tr><tr><td align="left" colspan="3">Initial release for LDP; more exercises, more markup, less errors and abuse; added glossary.</td></tr><tr><td align="left">Revision 1.0-beta</td><td align="left">2003-04-20</td><td align="left">MG</td></tr><tr><td align="left" colspan="3">Pre-release</td></tr></table></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_05"></a>5. Contributions</h2></div></div></div><p>
Thanks to all the friends who helped (or tried to) and to my husband; your encouraging words made this work possible.  Thanks to all the people who submitted bug reports, examples and remarks - among many, many others:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Hans Bol, one of the groupies</p></li><li class="listitem"><p>Mike Sim, remarks on style</p></li><li class="listitem"><p>Dan Richter, for array examples</p></li><li class="listitem"><p>Gerg Ferguson, for ideas on the title</p></li><li class="listitem"><p>Mendel Leo Cooper, for making room</p></li><li class="listitem"><p>#linux.be, for keeping my feet on the ground</p></li><li class="listitem"><p>Frank Wang, for his detailed remarks on all the things I did wrong ;-)</p></li></ul></div><p>Special thanks to Tabatha Marshall, who volunteered to do a complete review and spell and grammar check.  We make a great team: she works when I sleep.  And vice versa ;-)</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_06"></a>6. Feedback</h2></div></div></div><p>
Missing information, missing links, missing characters, remarks?  Mail it to 
</p><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:tille%20wants%20no%20spam%20_at_%20garrels%20dot%20be">tille wants no spam _at_ garrels dot be</a>&gt;</code></p></div><p>
the maintainer of this document.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_07"></a>7. Copyright information</h2></div></div></div><pre class="screen">
* Copyright (c) 2002-2007, Machtelt Garrels
* All rights reserved.
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions are met:
*
*     * Redistributions of source code must retain the above copyright
*       notice, this list of conditions and the following disclaimer.
*     * Redistributions in binary form must reproduce the above copyright
*       notice, this list of conditions and the following disclaimer in the
*       documentation and/or other materials provided with the distribution.
*     * Neither the name of the author, Machtelt Garrels, nor the
*       names of its contributors may be used to endorse or promote products
*       derived from this software without specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS "AS IS" AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
* DISCLAIMED. IN NO EVENT SHALL THE AUTHOR AND CONTRIBUTORS BE LIABLE FOR ANY
* DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
* LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
* ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
</pre><p>The author and publisher have made every effort in the preparation of this book to ensure the accuracy of the information.  However, the information contained in this book is offered without warranty, either express or implied.  Neither the author nor the publisher nor any dealer or distributor will be held liable for any damages caused or alleged to be caused either directly or indirectly by this book.</p><p>The logos, trademarks and symbols used in this book are the properties of
their respective owners.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_08"></a>8. What do you need?</h2></div></div></div><p><span class="command"><strong>bash</strong></span>, available from <a class="ulink" href="http://www.gnu.org/directory/GNU/" target="_top">http://www.gnu.org/directory/GNU/</a>.  The Bash shell is available on nearly every Linux system, and can these days be found on a wide variety of UNIX systems.</p><p>Compiles easily if you need to make your own, tested on a wide variety of UNIX, Linux, MS Windows and other systems.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_09"></a>9. Conventions used in this document</h2></div></div></div><p>The following typographic and usage conventions occur in this text:
</p><div class="table"><a name="conventions"></a><p class="title"><b>Table 1. Typographic and usage conventions</b></p><div class="table-contents"><table class="table" summary="Typographic and usage conventions" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Text type</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><span class="quote">&#8220;<span class="quote">Quoted text</span>&#8221;</span></td><td align="left">Quotes from people, quoted computer output.</td></tr><tr><td align="left"><pre class="screen">terminal view</pre></td><td align="left">Literal computer input and output captured from the terminal,
usually rendered with a light grey background.</td></tr><tr><td align="left"><span class="command"><strong>command</strong></span></td><td align="left">Name of a command that can be entered on the command line.</td></tr><tr><td align="left"><code class="varname">VARIABLE</code></td><td align="left">Name of a variable or pointer to content of a variable, as in
<code class="varname">$VARNAME</code>.</td></tr><tr><td align="left"><code class="option">option</code></td><td align="left">Option to a command, as in <span class="quote">&#8220;<span class="quote">the <code class="option">-a</code> option to the
<span class="command"><strong>ls</strong></span> command</span>&#8221;</span>.</td></tr><tr><td align="left"><em class="parameter"><code>argument</code></em></td><td align="left">Argument to a command, as in <span class="quote">&#8220;<span class="quote">read
<span class="command"><strong>man <em class="parameter"><code>ls</code></em></strong></span></span>&#8221;</span>.</td></tr><tr><td align="left"><div class="cmdsynopsis"><p><code class="command">command <code class="option">options</code>
<em class="parameter"><code>arguments</code></em></code> </p></div></td><td align="left">Command synopsis or general usage, on a separated line.</td></tr><tr><td align="left"><code class="filename">filename</code></td><td align="left">Name of a file or directory, for example <span class="quote">&#8220;<span class="quote">Change to the
<code class="filename">/usr/bin</code> directory.</span>&#8221;</span></td></tr><tr><td align="left"><span class="keycap"><strong>Key</strong></span></td><td align="left">Keys to hit on the keyboard, such as <span class="quote">&#8220;<span class="quote">type <span class="keycap"><strong>Q</strong></span>
to quit</span>&#8221;</span>.</td></tr><tr><td align="left"><span class="guibutton">Button</span></td><td align="left">Graphical button to click, like the <span class="guibutton">OK</span>
button.</td></tr><tr><td align="left"><span class="guimenu">Menu</span> &#8594; <span class="guimenuitem">Choice</span></td><td align="left">Choice to select from a graphical menu, for instance: <span class="quote">&#8220;<span class="quote">Select
<span class="guimenu">Help</span> &#8594; <span class="guimenuitem">About Mozilla</span> in your browser.</span>&#8221;</span></td></tr><tr><td align="left"><span class="emphasis"><em>Terminology</em></span></td><td align="left">Important term or concept: <span class="quote">&#8220;<span class="quote">The Linux <span class="emphasis"><em>kernel</em></span>
is the heart of the system.</span>&#8221;</span></td></tr><tr><td align="left"><pre class="screen">\</pre></td><td align="left">The backslash in a terminal view or command synopsis indicates an unfinished line.  In other words, if you see a long command that is cut into multiple lines, \ means <span class="quote">&#8220;<span class="quote">Don't press <span class="keycap"><strong>Enter</strong></span> yet!</span>&#8221;</span></td></tr><tr><td align="left">See <a class="xref" href="#chap_01" title="Chapter 1. Bash and Bash scripts">Chapter 1, <i>Bash and Bash scripts</i></a></td><td align="left">link to related subject
within this guide.</td></tr><tr><td align="left"><a class="ulink" href="http://tille.garrels.be" target="_top">The author</a></td><td align="left">Clickable link to an external web resource.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intro_10"></a>10. Organization of this document</h2></div></div></div><p>This guide discusses concepts useful in the daily life of the serious Bash user.  While a basic knowledge of the usage of the shell is required, we start with a discussion of the basic shell components and practices in the first three chapters.</p><p>Chapters four to six are discussions of basic tools that are commonly used in shell scripts.</p><p>Chapters eight to twelve discuss the most common constructs in shell scripts.</p><p>All chapters come with exercises that will test your preparedness for the
next chapter.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#chap_01" title="Chapter 1. Bash and Bash scripts">Chapter 1, <i>Bash and Bash scripts</i></a>: Bash basics: why Bash is so good, building blocks, first guidelines on developing good scripts.</p></li><li class="listitem"><p><a class="xref" href="#chap_02" title="Chapter 2. Writing and debugging scripts">Chapter 2, <i>Writing and debugging scripts</i></a>: Script basics: writing and debugging.</p></li><li class="listitem"><p><a class="xref" href="#chap_03" title="Chapter 3. The Bash environment">Chapter 3, <i>The Bash environment</i></a>: The Bash Environment: initialization files, variables, quoting characters, shell expansion order, aliases, options.</p></li><li class="listitem"><p><a class="xref" href="#chap_04" title="Chapter 4. Regular expressions">Chapter 4, <i>Regular expressions</i></a>: Regular expressions: an introduction.</p></li><li class="listitem"><p><a class="xref" href="#chap_05" title="Chapter 5. The GNU sed stream editor">Chapter 5, <i>The GNU sed stream editor</i></a>: Sed: an introduction to the sed line editor.</p></li><li class="listitem"><p><a class="xref" href="#chap_06" title="Chapter 6. The GNU awk programming language">Chapter 6, <i>The GNU awk programming language</i></a>:Awk: introduction to the awk programming language.</p></li><li class="listitem"><p><a class="xref" href="#chap_07" title="Chapter 7. Conditional statements">Chapter 7, <i>Conditional statements</i></a>: Conditional statements: constructs used in Bash to test conditions.</p></li><li class="listitem"><p><a class="xref" href="#chap_08" title="Chapter 8. Writing interactive scripts">Chapter 8, <i>Writing interactive scripts</i></a>: Interactive scripts: making scripts user-friendly, catching user input.</p></li><li class="listitem"><p><a class="xref" href="#chap_09" title="Chapter 9. Repetitive tasks">Chapter 9, <i>Repetitive tasks</i></a>: Executing commands repetitively: constructs used in Bash to automate command execution.</p></li><li class="listitem"><p><a class="xref" href="#chap_10" title="Chapter 10. More on variables">Chapter 10, <i>More on variables</i></a>: Advanced variables: specifying variable types, introduction to arrays of variables, operations on variables.</p></li><li class="listitem"><p><a class="xref" href="#chap_11" title="Chapter 11. Functions">Chapter 11, <i>Functions</i></a>: Functions: an introduction.</p></li><li class="listitem"><p><a class="xref" href="#chap_12" title="Chapter 12. Catching signals">Chapter 12, <i>Catching signals</i></a>: Catching signals: introduction to process signalling, trapping user-sent signals.</p></li></ul></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_01"></a>Chapter 1. Bash and Bash scripts</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_01_01">1. Common shell programs</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_01_01">1.1. General shell functions</a></span></dt><dt><span class="sect2"><a href="#sect_01_01_02">1.2. Shell types</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_02">2. Advantages of the Bourne Again SHell</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_02_01">2.1. Bash is the GNU shell</a></span></dt><dt><span class="sect2"><a href="#sect_01_02_02">2.2. Features only found in bash</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_03">3. Executing commands</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_03_01">3.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_01_03_02">3.2. Shell built-in commands</a></span></dt><dt><span class="sect2"><a href="#sect_01_03_03">3.3. Executing programs from a script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_04">4. Building blocks</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_04_01">4.1. Shell building blocks</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_05">5. Developing good scripts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_01_05_01">5.1. Properties of good scripts</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_02">5.2. Structure</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_03">5.3. Terminology</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_04">5.4. A word on order and logic</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_05">5.5. An example Bash script: mysystem.sh</a></span></dt><dt><span class="sect2"><a href="#sect_01_05_06">5.6. Example init script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_01_06">6. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_01_07">7. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this introduction module we</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Describe some common shells</p></li><li class="listitem"><p>Point out GNU Bash advantages and features</p></li><li class="listitem"><p>Describe the shell's building blocks</p></li><li class="listitem"><p>Discuss Bash initialization files</p></li><li class="listitem"><p>See how the shell executes commands</p></li><li class="listitem"><p>Look into some simple script examples</p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_01_01"></a>1. Common shell programs</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_01_01"></a>1.1. General shell functions</h3></div></div></div><p>The UNIX shell<a class="indexterm" name="idm331"></a> program interprets user commands, which are either directly entered by the user, or which can be read from a file called the shell script or shell program.  Shell scripts are interpreted, not compiled.  The shell reads commands from the script line per line and searches for those commands on the system (see <a class="xref" href="#sect_01_02" title="2. Advantages of the Bourne Again SHell">Section 2, &#8220;Advantages of the Bourne Again SHell&#8221;</a>), while a compiler converts a program into machine readable form, an executable file - which may then be used in a shell script.</p><p>Apart from passing commands to the kernel, the main task of a shell is providing a user environment, which can be configured individually using shell resource configuration files.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_01_02"></a>1.2. Shell types</h3></div></div></div><p>Just like people know different languages and dialects, your UNIX system will usually offer a variety of shell<a class="indexterm" name="idm339"></a> types:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="command"><strong>sh</strong></span> or Bourne Shell: the original shell still
used on UNIX systems and in UNIX-related environments.  This is the basic shell, a small program with few features.  While this is not the standard shell, it is still available on every Linux system for compatibility with UNIX programs.</p></li><li class="listitem"><p><span class="command"><strong>bash</strong></span> or Bourne Again shell: the standard GNU
shell, intuitive and flexible.  Probably most advisable for beginning users while being at the same time a powerful tool for the advanced and professional user.  On Linux, <span class="command"><strong>bash</strong></span> is the standard shell for common users.  This shell is a so-called <span class="emphasis"><em>superset</em></span> of the Bourne shell, a set
of add-ons and plug-ins.  This means that the Bourne Again shell is compatible with the Bourne shell: commands that work in <span class="command"><strong>sh</strong></span>, also work in
<span class="command"><strong>bash</strong></span>.  However, the reverse is not always the case.  All examples and exercises in this book use <span class="command"><strong>bash</strong></span>.</p></li><li class="listitem"><p><span class="command"><strong>csh</strong></span> or C shell: the syntax of this shell resembles that of the C programming language.  Sometimes asked for by programmers.</p></li><li class="listitem"><p><span class="command"><strong>tcsh</strong></span> or TENEX C shell: a superset of the common C shell, enhancing user-friendliness and speed.  That is why some also call it the Turbo C shell.</p></li><li class="listitem"><p><span class="command"><strong>ksh</strong></span> or the Korn shell: sometimes appreciated
by people with a UNIX background.  A superset of the Bourne shell; with standard configuration a nightmare for beginning users.</p></li></ul></div><p>The file <code class="filename">/etc/shells</code> gives an overview of known shells on a Linux system<a class="indexterm" name="idm365"></a>:</p><pre class="screen">
<code class="prompt">mia:~&gt;</code> <span class="command"><strong>cat <code class="filename">/etc/shells</code></strong></span>
/bin/bash
/bin/sh
/bin/tcsh
/bin/csh
</pre><p>Your default shell is set in the <code class="filename">/etc/passwd</code> file<a class="indexterm" name="idm374"></a>, like this line for user <span class="emphasis"><em>mia</em></span>:</p><pre class="screen">
mia:L2NOfqdlPrHwE:504:504:Mia Maya:/home/mia:/bin/bash
</pre><p>To switch<a class="indexterm" name="idm380"></a> from one shell to another, just enter the name of the new shell
in the active terminal.  The system finds the directory where the name occurs using the <code class="varname">PATH</code> settings, and since a shell is an executable file (program), the current shell activates it and it gets executed.  A new prompt is usually shown, because each shell has its typical appearance:</p><pre class="screen">
<code class="prompt">mia:~&gt;</code> <span class="command"><strong>tcsh</strong></span>
[mia@post21 ~]$
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_01_02"></a>2. Advantages of the Bourne Again SHell</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_02_01"></a>2.1. Bash is the GNU shell</h3></div></div></div><p>The GNU project (GNU's Not UNIX) provides tools for UNIX-like system administration which are free software and comply to UNIX standards.</p><p>Bash<a class="indexterm" name="idm393"></a> is an sh-compatible shell that incorporates useful features from the Korn shell (ksh) and C shell (csh). It is intended to conform to the IEEE POSIX P1003.2/ISO 9945.2 Shell and Tools standard. It offers functional improvements over sh for both programming and interactive use; these include command line editing, unlimited size command history, job control, shell functions and aliases, indexed arrays of unlimited size, and integer arithmetic in any base from two to sixty-four. Bash can run most sh scripts without modification.</p><p>Like the other GNU projects, the bash initiative was started to preserve, protect and promote the freedom to use, study, copy, modify and redistribute software.  It is generally known that such conditions stimulate creativity.  This was also the case with the bash program, which has a lot of extra features that other shells can't offer.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_02_02"></a>2.2. Features only found in bash</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_01"></a>2.2.1. Invocation</h4></div></div></div><p>In addition<a class="indexterm" name="idm402"></a> to the single-character shell command line options which can generally be configured using the <span class="command"><strong>set</strong></span> shell built-in command, there are several multi-character options that you can use.  We will come across a couple of the more popular options<a class="indexterm" name="idm406"></a> in this and the following chapters; the complete list can be found in the Bash info pages, <span class="guimenu">Bash features</span> &#8594; <span class="guimenuitem">Invoking Bash</span>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_02"></a>2.2.2. Bash startup files</h4></div></div></div><p>Startup<a class="indexterm" name="idm415"></a> files are scripts that are read and executed by Bash when it starts.  The following subsections<a class="indexterm" name="idm418"></a> describe different ways to start the shell, and the startup files that are read consequently.</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_02_01"></a>2.2.2.1. Invoked as an interactive login shell, or with `--login'</h5></div></div></div><p>Interactive<a class="indexterm" name="idm424"></a> means you can enter commands.  The shell is not running because a script has been activated.  A login shell means that you got the shell after authenticating to the system, usually by giving your user name and password.</p><p>Files read:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">/etc/profile</code></p></li><li class="listitem"><p><code class="filename">~/.bash_profile</code>, <code class="filename">~/.bash_login</code> or <code class="filename">~/.profile</code>: first existing readable file is read</p></li><li class="listitem"><p><code class="filename">~/.bash_logout</code> upon logout.</p></li></ul></div><p>Error messages are printed if configuration files exist but are not readable.  If a file does not exist, bash searches for the next.</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_02_02"></a>2.2.2.2. Invoked as an interactive non-login shell</h5></div></div></div><p>A non-login<a class="indexterm" name="idm444"></a> shell means that you did not have to authenticate to the system.  For instance, when you open a terminal using an icon, or a menu item, that is a non-login shell.</p><p>Files read:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">~/.bashrc</code></p></li></ul></div><p>This file is usually referred to in <code class="filename">~/.bash_profile</code>:</p><div class="cmdsynopsis"><p><code class="command">if <code class="function">[ -f <code class="filename">~/.bashrc</code> ]</code>; then . <code class="filename">~/.bashrc</code>; fi</code> </p></div><p>See <a class="xref" href="#chap_07" title="Chapter 7. Conditional statements">Chapter 7, <i>Conditional statements</i></a> for more information on the <span class="command"><strong>if</strong></span> construct.</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_02_03"></a>2.2.2.3. Invoked non-interactively</h5></div></div></div><p>All scripts use non-interactive<a class="indexterm" name="idm465"></a> shells.  They are programmed to do certain tasks and cannot be instructed to do other jobs than those for which they are programmed.</p><p>Files read:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>defined<a class="indexterm" name="idm472"></a> by <code class="varname">BASH_ENV</code></p></li></ul></div><p><code class="varname">PATH</code> is not used to search for this file, so if you want to use it, best refer to it by giving the full path and file name.</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_02_04"></a>2.2.2.4. Invoked with the sh command</h5></div></div></div><p>Bash<a class="indexterm" name="idm481"></a> tries to behave as the historical Bourne <span class="command"><strong>sh</strong></span> program while conforming to the POSIX standard as well.</p><p>Files read:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">/etc/profile</code></p></li><li class="listitem"><p><code class="filename">~/.profile</code></p></li></ul></div><p>When invoked interactively, the <code class="varname">ENV</code> variable<a class="indexterm" name="idm495"></a> can point to extra startup information.</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_02_05"></a>2.2.2.5. POSIX mode</h5></div></div></div><p>This option<a class="indexterm" name="idm501"></a> is enabled either using the <span class="command"><strong>set</strong></span> built-in:</p><div class="cmdsynopsis"><p><code class="command">set <code class="option">-o posix</code></code> </p></div><p>or by calling the <span class="command"><strong>bash</strong></span> program with the <code class="option">--posix</code> option.  Bash will then try to behave as compliant as possible to the POSIX standard for shells.  Setting the <code class="varname">POSIXLY_CORRECT</code> variable<a class="indexterm" name="idm512"></a> does the same.</p><p>Files read:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>defined by <code class="varname">ENV</code> variable.</p></li></ul></div></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_02_06"></a>2.2.2.6. Invoked remotely</h5></div></div></div><p>Files read when invoked<a class="indexterm" name="idm523"></a> by <span class="command"><strong>rshd</strong></span>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">~/.bashrc</code></p></li></ul></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Avoid use of r-tools</h3><p>Be aware of the dangers when using tools such as <span class="command"><strong>rlogin</strong></span>, <span class="command"><strong>telnet</strong></span>, <span class="command"><strong>rsh</strong></span> and <span class="command"><strong>rcp</strong></span>.  They are intrinsically insecure because confidential data is sent over the network unencrypted.  If you need tools for remote execution, file transfer and so on, use an implementation of Secure SHell, generally known as SSH, freely available from <a class="ulink" href="http://www.openssh.org" target="_top">http://www.openssh.org</a>.  Different client programs are available for non-UNIX systems as well, see your local software mirror.</p></div></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_02_07"></a>2.2.2.7. Invoked when UID is not equal to EUID</h5></div></div></div><p>No startup<a class="indexterm" name="idm542"></a> files are read in this case.</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_03"></a>2.2.3. Interactive shells</h4></div></div></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_03_01"></a>2.2.3.1. What is an interactive shell?</h5></div></div></div><p>An interactive<a class="indexterm" name="idm550"></a> shell generally reads from, and writes to, a user's terminal: input and output are connected to a terminal.  Bash interactive behavior<a class="indexterm" name="idm553"></a> is started when the <span class="command"><strong>bash</strong></span> command is called upon without non-option arguments, except when the option is a string to read from or when the shell is invoked to read from standard input, which allows for positional parameters to be set (see <a class="xref" href="#chap_03" title="Chapter 3. The Bash environment">Chapter 3, <i>The Bash environment</i></a> ).</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_03_02"></a>2.2.3.2. Is this shell interactive?</h5></div></div></div><p>Test by looking at the content of the special parameter <code class="varname">-</code>, it contains an 'i' when the shell is interactive:</p><pre class="screen">
<code class="prompt">eddy:~&gt;</code> <span class="command"><strong>echo <code class="varname">$-</code></strong></span>
himBH
</pre><p>In non-interactive shells, the prompt, <code class="varname">PS1</code>, is unset.</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_01_02_02_03_03"></a>2.2.3.3. Interactive shell behavior</h5></div></div></div><p>Differences in interactive<a class="indexterm" name="idm571"></a> mode:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Bash reads startup files.</p></li><li class="listitem"><p>Job control enabled by default.</p></li><li class="listitem"><p>Prompts are set, <code class="varname">PS2</code> is enabled for multi-line<a class="indexterm" name="idm582"></a> commands, it is usually set to <span class="quote">&#8220;<span class="quote">&gt;</span>&#8221;</span>.  This is also the prompt you get when the shell thinks you entered an unfinished command, for instance when you forget quotes, command structures that cannot be left out, etc.</p></li><li class="listitem"><p>Commands are by default read from the command line using <span class="command"><strong>readline</strong></span>.</p></li><li class="listitem"><p>Bash interprets the shell option <code class="option">ignoreeof<a class="indexterm" name="idm592"></a></code> instead of exiting immediately upon receiving EOF (End Of File).</p></li><li class="listitem"><p>Command history and history expansion are enabled by default.  History is saved in the file pointed to by<a class="indexterm" name="idm597"></a> <code class="varname">HISTFILE</code> when the shell exits.  By default, <code class="varname">HISTFILE</code> points to <code class="filename">~/.bash_history</code>.</p></li><li class="listitem"><p>Alias expansion is enabled.</p></li><li class="listitem"><p>In the absence of traps, the <code class="option">SIGTERM</code> signal is ignored.</p></li><li class="listitem"><p>In the absence of traps, <code class="option">SIGINT</code> is caught and handled.  Thus, typing <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span>, for example, will not quit your interactive shell.</p></li><li class="listitem"><p>Sending <code class="option">SIGHUP</code> signals to all jobs on exit is configured with the <code class="option">huponexit</code> option.</p></li><li class="listitem"><p>Commands are executed upon read.</p></li><li class="listitem"><p>Bash checks for mail periodically.</p></li><li class="listitem"><p>Bash can be configured to exit when it encounters unreferenced variables.  In interactive mode this behavior is disabled.</p></li><li class="listitem"><p>When shell built-in commands encounter redirection errors, this will not cause the shell to exit.</p></li><li class="listitem"><p>Special built-ins returning errors when used in POSIX mode don't cause the shell to exit.  The built-in commands are listed in <a class="xref" href="#sect_01_03_02" title="3.2. Shell built-in commands">Section 3.2, &#8220;Shell built-in commands&#8221;</a>.</p></li><li class="listitem"><p>Failure of <span class="command"><strong>exec</strong></span> will not exit the shell.</p></li><li class="listitem"><p>Parser syntax errors don't cause the shell to exit.</p></li><li class="listitem"><p>Simple spell check for the arguments to the <span class="command"><strong>cd</strong></span> built-in is enabled by default.</p></li><li class="listitem"><p>Automatic exit after the length of time specified in the <code class="varname">TMOUT</code> variable has passed, is enabled.</p></li></ul></div><p>More information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#sect_03_02" title="2. Variables">Section 2, &#8220;Variables&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#sect_03_06" title="6. More Bash options">Section 6, &#8220;More Bash options&#8221;</a></p></li><li class="listitem"><p>See <a class="xref" href="#chap_12" title="Chapter 12. Catching signals">Chapter 12, <i>Catching signals</i></a> for more about signals.</p></li><li class="listitem"><p><a class="xref" href="#sect_03_04" title="4. Shell expansion">Section 4, &#8220;Shell expansion&#8221;</a> discusses the various expansions performed upon entering a command.</p></li></ul></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_04"></a>2.2.4. Conditionals</h4></div></div></div><p>Conditional<a class="indexterm" name="idm656"></a> expressions are used by the <span class="command"><strong>[[</strong></span> compound command and by the <span class="command"><strong>test</strong></span> and <span class="command"><strong>[</strong></span> built-in commands.</p><p>Expressions may be unary or binary.  Unary expressions are often used to examine the status of a file.  You only need one object, for instance a file, to do the operation on.</p><p>There are string operators and numeric comparison operators as well; these are binary operators, requiring two objects to do the operation on.  If the <code class="option">FILE</code> argument to one of the primaries is in the form <code class="filename">/dev/fd/N</code>, then file descriptor N is checked.  If the <code class="option">FILE</code> argument to one of the primaries is one of <code class="filename">/dev/stdin</code>, <code class="filename">/dev/stdout</code> or <code class="filename">/dev/stderr</code>, then file descriptor 0, 1 or 2 respectively is checked.</p><p>Conditionals are discussed in detail in <a class="xref" href="#chap_07" title="Chapter 7. Conditional statements">Chapter 7, <i>Conditional statements</i></a>.</p><p>More information about the file descriptors in <a class="xref" href="#sect_08_02_03" title="2.3. Redirection and file descriptors">Section 2.3, &#8220;Redirection and file descriptors&#8221;</a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_05"></a>2.2.5. Shell arithmetic</h4></div></div></div><p>The shell allows arithmetic<a class="indexterm" name="idm677"></a> expressions to be evaluated, as one of
the shell expansions or by the <span class="command"><strong>let</strong></span> built-in.</p><p>Evaluation is done in fixed-width integers with no check for overflow, though division by 0 is trapped and flagged as an error.  The operators and their precedence and associativity are the same as in the C language, see <a class="xref" href="#chap_03" title="Chapter 3. The Bash environment">Chapter 3, <i>The Bash environment</i></a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_06"></a>2.2.6. Aliases</h4></div></div></div><p>Aliases<a class="indexterm" name="idm686"></a> allow a string to be substituted for a word when it is used as the first word of a simple command.  The shell maintains a list of aliases that may be set and unset with the <span class="command"><strong>alias</strong></span> and <span class="command"><strong>unalias</strong></span> commands.</p><p>Bash always reads at least one complete line of input before executing any of the commands on that line.  Aliases are expanded when a command is read, not when it is executed.  Therefore, an alias definition appearing on the same line as another command does not take effect until the next line of input is read.  The commands following the alias definition on that line are not affected by the new alias.</p><p>Aliases are expanded when a function definition is read, not when the function is executed, because a function definition is itself a compound command.  As a consequence, aliases defined in a function are not available until after that function is executed.</p><p>We will discuss aliases in detail in <a class="xref" href="#sect_03_05" title="5. Aliases">Section 5, &#8220;Aliases&#8221;</a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_07"></a>2.2.7. Arrays</h4></div></div></div><p>Bash provides one-dimensional array<a class="indexterm" name="idm698"></a> variables.  Any variable may be used as an array; the <span class="command"><strong>declare</strong></span> built-in will explicitly declare an array.  There is no maximum limit on the size of an array, nor any requirement that members be indexed or assigned contiguously.  Arrays are zero-based.  See <a class="xref" href="#chap_10" title="Chapter 10. More on variables">Chapter 10, <i>More on variables</i></a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_08"></a>2.2.8. Directory stack</h4></div></div></div><p>The directory stack<a class="indexterm" name="idm706"></a> is a list of recently-visited directories.  The <span class="command"><strong>pushd</strong></span> built-in<a class="indexterm" name="idm710"></a> adds directories to the stack as it changes the current directory, and the <span class="command"><strong>popd</strong></span> built-in<a class="indexterm" name="idm714"></a> removes specified directories from the stack and changes the current directory to the directory removed.</p><p>Content can be displayed issuing the <span class="command"><strong>dirs</strong></span> command or by checking the content of the <code class="varname">DIRSTACK<a class="indexterm" name="idm720"></a></code> variable.</p><p>More information about the workings of this mechanism can be found in the Bash info pages.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_09"></a>2.2.9. The prompt</h4></div></div></div><p>Bash makes playing with the prompt<a class="indexterm" name="idm727"></a> even more fun.  See the section <span class="emphasis"><em>Controlling the Prompt</em></span> in the Bash info pages.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_02_02_10"></a>2.2.10. The restricted shell</h4></div></div></div><p>When invoked as <span class="command"><strong>rbash<a class="indexterm" name="idm735"></a></strong></span> or with the <code class="option">--restricted<a class="indexterm" name="idm739"></a></code> or <code class="option">-r</code> option, the following happens<a class="indexterm" name="idm743"></a>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The <span class="command"><strong>cd</strong></span> built-in is disabled.</p></li><li class="listitem"><p>Setting or unsetting <code class="varname">SHELL<a class="indexterm" name="idm753"></a></code>, <code class="varname">PATH<a class="indexterm" name="idm757"></a></code>, <code class="varname">ENV<a class="indexterm" name="idm761"></a></code> or <code class="varname">BASH_ENV<a class="indexterm" name="idm765"></a></code> is not possible.</p></li><li class="listitem"><p>Command names can no longer contain slashes.</p></li><li class="listitem"><p>Filenames containing a slash are not allowed with the <span class="command"><strong>.</strong></span> (<span class="command"><strong>source</strong></span>) built-in<a class="indexterm" name="idm774"></a> command.</p></li><li class="listitem"><p>The <span class="command"><strong>hash</strong></span> built-in<a class="indexterm" name="idm780"></a> does not accept slashes with the <code class="option">-p</code> option.</p></li><li class="listitem"><p>Import of functions<a class="indexterm" name="idm786"></a> at startup is disabled.</p></li><li class="listitem"><p><code class="varname">SHELLOPTS<a class="indexterm" name="idm792"></a></code> is ignored at startup.</p></li><li class="listitem"><p>Output redirection using <span class="command"><strong>&gt;</strong></span>, <span class="command"><strong>&gt;|</strong></span>, <span class="command"><strong>&gt;&lt;</strong></span>, <span class="command"><strong>&gt;&amp;</strong></span>, <span class="command"><strong>&amp;&gt;</strong></span> and <span class="command"><strong>&gt;&gt;</strong></span> is disabled.</p></li><li class="listitem"><p>The <span class="command"><strong>exec</strong></span> built-in is disabled.</p></li><li class="listitem"><p>The <code class="option">-f</code> and <code class="option">-d</code> options are disabled for the <span class="command"><strong>enable</strong></span> built-in<a class="indexterm" name="idm811"></a>.</p></li><li class="listitem"><p>A default <code class="varname">PATH</code> cannot be specified with the <span class="command"><strong>command</strong></span> built-in.</p></li><li class="listitem"><p>Turning off restricted mode is not possible.</p></li></ul></div><p>When a command that is found to be a shell script is executed, <span class="command"><strong>rbash</strong></span> turns off any restrictions in the shell spawned to execute the script.</p><p>More information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#sect_03_02" title="2. Variables">Section 2, &#8220;Variables&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#sect_03_06" title="6. More Bash options">Section 6, &#8220;More Bash options&#8221;</a></p></li><li class="listitem"><p><span class="guimenu">Info Bash</span> &#8594; <span class="guisubmenu">Basic Shell Features</span> &#8594; <span class="guimenuitem">Redirections</span></p></li><li class="listitem"><p><a class="xref" href="#sect_08_02_03" title="2.3. Redirection and file descriptors">Section 2.3, &#8220;Redirection and file descriptors&#8221;</a>: advanced redirection</p></li></ul></div></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_01_03"></a>3. Executing commands</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_03_01"></a>3.1. General</h3></div></div></div><p>Bash determines the type of program that is to be execute<a class="indexterm" name="idm844"></a>d.  Normal programs are system commands that exist in compiled form on your system.  When such a program is executed, a new process is created because Bash makes an exact copy of itself.  This child process has the same environment as its parent, only the process ID number is different.  This procedure is called <span class="emphasis"><em>forking</em></span>.</p><p>After the forking process, the address space of the child process is overwritten with the new process data.  This is done through an <span class="emphasis"><em>exec</em></span> call to the system.</p><p>The <span class="emphasis"><em>fork-and-exec</em></span> mechanism<a class="indexterm" name="idm852"></a> thus switches an old command with a new, while the environment in which the new program is executed remains the same, including configuration of input and output devices, environment variables and priority.  This mechanism is used to create all UNIX processes, so it also applies to the Linux operating system.  Even the first process, <span class="command"><strong>init</strong></span>, with process ID 1, is forked during the boot procedure in the so-called <span class="emphasis"><em>bootstrapping</em></span> procedure.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_03_02"></a>3.2. Shell built-in commands</h3></div></div></div><p>Built-in commands<a class="indexterm" name="idm860"></a> are contained within the shell itself.  When the name of a built-in command is used as the first word of a simple command, the shell executes the command directly, without creating a new process.  Built-in commands are necessary to implement functionality impossible or inconvenient to obtain with separate utilities.</p><p>Bash supports 3 types of built-in commands:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Bourne<a class="indexterm" name="idm867"></a> Shell built-ins:</p><p><span class="command"><strong>:</strong></span>, <span class="command"><strong>.</strong></span>, <span class="command"><strong>break</strong></span>, <span class="command"><strong>cd</strong></span>, <span class="command"><strong>continue</strong></span>, <span class="command"><strong>eval</strong></span>, <span class="command"><strong>exec</strong></span>, <span class="command"><strong>exit</strong></span>, <span class="command"><strong>export</strong></span>, <span class="command"><strong>getopts</strong></span>, <span class="command"><strong>hash</strong></span>, <span class="command"><strong>pwd</strong></span>, <span class="command"><strong>readonly</strong></span>, <span class="command"><strong>return</strong></span>, <span class="command"><strong>set</strong></span>, <span class="command"><strong>shift</strong></span>, <span class="command"><strong>test</strong></span>, <span class="command"><strong>[</strong></span>, <span class="command"><strong>times</strong></span>, <span class="command"><strong>trap</strong></span>, <span class="command"><strong>umask</strong></span> and <span class="command"><strong>unset</strong></span>.</p></li><li class="listitem"><p>Bash<a class="indexterm" name="idm895"></a> built-in commands:</p><p><span class="command"><strong>alias</strong></span>, <span class="command"><strong>bind</strong></span>, <span class="command"><strong>builtin</strong></span>, <span class="command"><strong>command</strong></span>, <span class="command"><strong>declare</strong></span>, <span class="command"><strong>echo</strong></span>, <span class="command"><strong>enable</strong></span>, <span class="command"><strong>help</strong></span>, <span class="command"><strong>let</strong></span>, <span class="command"><strong>local</strong></span>, <span class="command"><strong>logout</strong></span>, <span class="command"><strong>printf</strong></span>, <span class="command"><strong>read</strong></span>, <span class="command"><strong>shopt</strong></span>, <span class="command"><strong>type</strong></span>, <span class="command"><strong>typeset</strong></span>, <span class="command"><strong>ulimit</strong></span> and <span class="command"><strong>unalias</strong></span>.</p></li><li class="listitem"><p>Special<a class="indexterm" name="idm919"></a> built-in commands:</p><p>When Bash is executing in POSIX mode, the special built-ins differ from other built-in commands in three respects:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Special built-ins are found before shell functions during command lookup.</p></li><li class="listitem"><p>If a special built-in returns an error status, a non-interactive shell exits.</p></li><li class="listitem"><p>Assignment statements preceding the command stay in effect in the shell environment after the command completes.</p></li></ol></div><p>The POSIX special built-ins are <span class="command"><strong>:</strong></span>, <span class="command"><strong>.</strong></span>, <span class="command"><strong>break</strong></span>, <span class="command"><strong>continue</strong></span>, <span class="command"><strong>eval</strong></span>, <span class="command"><strong>exec</strong></span>, <span class="command"><strong>exit</strong></span>, <span class="command"><strong>export</strong></span>, <span class="command"><strong>readonly</strong></span>, <span class="command"><strong>return</strong></span>, <span class="command"><strong>set</strong></span>, <span class="command"><strong>shift</strong></span>, <span class="command"><strong>trap</strong></span> and <span class="command"><strong>unset</strong></span>.</p></li></ul></div><p>Most of these built-ins will be discussed in the next chapters.  For those commands for which this is not the case, we refer to the Info pages.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_03_03"></a>3.3. Executing programs from a script</h3></div></div></div><p>When the program<a class="indexterm" name="idm949"></a> being executed is a shell script, bash will create a new bash process using a <span class="emphasis"><em>fork</em></span>.  This subshell reads the lines from the shell script one line at a time.  Commands on each line are read, interpreted and executed as if they would have come directly from the keyboard.</p><p>While the subshell processes each line of the script, the parent shell waits for its child process to finish.  When there are no more lines in the shell script to read, the subshell terminates.  The parent shell awakes and displays a new prompt.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_01_04"></a>4. Building blocks</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_04_01"></a>4.1. Shell building blocks</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_04_01_01"></a>4.1.1. Shell syntax</h4></div></div></div><p>If input is not commented, the shell reads<a class="indexterm" name="idm961"></a> it and divides it into words and operators, employing quoting rules to define the meaning of each character of input.  Then these words and operators are translated into commands and other constructs, which return an exit status available for inspection or processing.  The above fork-and-exec scheme is only applied after the shell has analyzed input in the following<a class="indexterm" name="idm964"></a> way:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The shell reads its input from a file, from a string or from the user's terminal.</p></li><li class="listitem"><p>Input is broken up into words and operators, obeying the quoting rules, see <a class="xref" href="#chap_03" title="Chapter 3. The Bash environment">Chapter 3, <i>The Bash environment</i></a>.  These tokens are separated by <span class="emphasis"><em>metacharacters</em></span>.  Alias expansion is performed.</p></li><li class="listitem"><p>The shell <span class="emphasis"><em>parses</em></span> (analyzes and substitutes) the tokens into simple and compound commands.</p></li><li class="listitem"><p>Bash performs various shell expansions, breaking the expanded tokens into lists of filenames and commands and arguments.</p></li><li class="listitem"><p>Redirection is performed if necessary, redirection operators and their operands are removed from the argument list.</p></li><li class="listitem"><p>Commands are executed.</p></li><li class="listitem"><p>Optionally the shell waits for the command to complete and collects its exit status.</p></li></ul></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_04_01_02"></a>4.1.2. Shell commands</h4></div></div></div><p>A simple shell command such as <span class="command"><strong>touch <code class="filename">file1</code> <code class="filename">file2</code> <code class="filename">file3</code></strong></span> consists of the command itself followed by arguments<a class="indexterm" name="idm992"></a>, separated by spaces.</p><p>More complex shell commands are composed of simple commands arranged together in a variety of ways: in a pipeline in which the output of one command becomes the input of a second, in a loop or conditional construct, or in some other grouping.  A couple of examples:</p><div class="cmdsynopsis"><p><code class="command">ls | more</code> </p></div><div class="cmdsynopsis"><p><code class="command">gunzip <code class="filename">file.tar.gz</code> | tar <code class="option">xvf</code> <em class="parameter"><code>-</code></em></code> </p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_04_01_03"></a>4.1.3. Shell functions</h4></div></div></div><p>Shell functions<a class="indexterm" name="idm1006"></a> are a way to group commands for later execution using a single name for the group.  They are executed just like a <span class="quote">&#8220;<span class="quote">regular</span>&#8221;</span> command.  When the name of a shell function is used as a simple command name, the list of commands associated with that function name is executed.</p><p>Shell functions are executed in the current shell context; no new process is created to interpret them.</p><p>Functions are explained in <a class="xref" href="#chap_11" title="Chapter 11. Functions">Chapter 11, <i>Functions</i></a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_04_01_04"></a>4.1.4. Shell parameters</h4></div></div></div><p>A parameter<a class="indexterm" name="idm1016"></a> is an entity that stores values.  It can be a name, a number or a special value.  For the shell's purpose, a variable<a class="indexterm" name="idm1019"></a> is a parameter that stores a name.  A variable has a value and zero or more attributes.  Variables are created with the <span class="command"><strong>declare<a class="indexterm" name="idm1023"></a></strong></span> shell built-in command.</p><p>If no value is given, a variable is assigned the null string.  Variables can only be removed with the <span class="command"><strong>unset</strong></span> built-in.</p><p>Assigning variables is discussed in <a class="xref" href="#sect_03_02" title="2. Variables">Section 2, &#8220;Variables&#8221;</a>, advanced use of variables in <a class="xref" href="#chap_10" title="Chapter 10. More on variables">Chapter 10, <i>More on variables</i></a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_04_01_05"></a>4.1.5. Shell expansions</h4></div></div></div><p>Shell expansion<a class="indexterm" name="idm1034"></a> is performed after each command line has been split into tokens.  These are the expansions performed:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Brace expansion</p></li><li class="listitem"><p>Tilde expansion</p></li><li class="listitem"><p>Parameter and variable expansion</p></li><li class="listitem"><p>Command substitution</p></li><li class="listitem"><p>Arithmetic expansion</p></li><li class="listitem"><p>Word splitting</p></li><li class="listitem"><p>Filename expansion</p></li></ul></div><p>We'll discuss these expansion types in detail in <a class="xref" href="#sect_03_04" title="4. Shell expansion">Section 4, &#8220;Shell expansion&#8221;</a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_04_01_06"></a>4.1.6. Redirections</h4></div></div></div><p>Before a command is executed, its input and output may be redirected<a class="indexterm" name="idm1057"></a> using a special notation interpreted by the shell.  Redirection may also be used to open and close files for the current shell execution environment.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_04_01_07"></a>4.1.7. Executing commands</h4></div></div></div><p>When executing a command, the words that the parser has marked as variable assignments (preceding the command name) and redirections are saved for later reference.  Words that are not variable assignments or redirections are expanded; the first remaining word after expansion is taken to be the name of the command and the rest are arguments<a class="indexterm" name="idm1063"></a> to that command.  Then redirections are performed, then strings assigned to variables are expanded.  If no command name results, variables will affect the current shell environment.</p><p>An important part of the tasks of the shell is to search<a class="indexterm" name="idm1067"></a> for commands.  Bash does this as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Check whether the command contains slashes.  If not, first check with the function list to see if it contains a command by the name we are looking for.</p></li><li class="listitem"><p>If command is not a function, check for it in the built-in list.</p></li><li class="listitem"><p>If command is neither a function nor a built-in, look for it analyzing the directories listed in <code class="varname">PATH<a class="indexterm" name="idm1078"></a></code>.  Bash uses a <span class="emphasis"><em>hash table</em></span> (data storage area in memory) to remember the full path names of executables so extensive <code class="varname">PATH</code> searches can be avoided.</p></li><li class="listitem"><p>If the search is unsuccessful, bash prints an error message and returns an exit status of 127.</p></li><li class="listitem"><p>If the search was successful or if the command contains slashes, the shell executes the command in a separate execution environment.</p></li><li class="listitem"><p>If execution fails because the file is not executable and not a directory, it is assumed to be a shell script.</p></li><li class="listitem"><p>If the command was not begun asynchronously, the shell waits for the command to complete and collects its exit status.</p></li></ul></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_01_04_01_08"></a>4.1.8. Shell scripts</h4></div></div></div><p>When a file containing<a class="indexterm" name="idm1094"></a> shell commands is used as the first non-option argument when invoking Bash (without <code class="option">-c</code> or <code class="option">-s</code>, this will create a non-interactive shell.  This shell first searches for the script file in the current directory, then looks in <code class="varname">PATH</code> if the file cannot be found there.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_01_05"></a>5. Developing good scripts</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_05_01"></a>5.1. Properties of good scripts</h3></div></div></div><p>This guide is mainly about the last shell building block, scripts.  Some general considerations<a class="indexterm" name="idm1105"></a> before we continue:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>A script should run without errors.</p></li><li class="listitem"><p>It should perform the task for which it is intended.</p></li><li class="listitem"><p>Program logic is clearly defined and apparent.</p></li><li class="listitem"><p>A script does not do unnecessary work.</p></li><li class="listitem"><p>Scripts should be reusable.</p></li></ol></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_05_02"></a>5.2. Structure</h3></div></div></div><p>The structure<a class="indexterm" name="idm1122"></a> of a shell script is very flexible.  Even though in Bash a lot of freedom is granted, you must ensure correct logic, flow control and efficiency so that users executing the script can do so easily and correctly.</p><p>When starting on a new script, ask yourself the following questions:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Will I be needing any information from the user or from the user's environment?</p></li><li class="listitem"><p>How will I store that information?</p></li><li class="listitem"><p>Are there any files that need to be created?  Where and with which permissions and ownerships?</p></li><li class="listitem"><p>What commands will I use?  When using the script on different systems, do all these systems have these commands in the required versions?</p></li><li class="listitem"><p>Does the user need any notifications?  When and why?</p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_05_03"></a>5.3. Terminology</h3></div></div></div><p>The table below gives an overview of programming terms<a class="indexterm" name="idm1140"></a> that you need to be familiar with:</p><div class="table"><a name="table_01_01"></a><p class="title"><b>Table 1.1. Overview of programming terms</b></p><div class="table-contents"><table class="table" summary="Overview of programming terms" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Term</th><th align="left">What is it?</th></tr></thead><tbody><tr><td align="left">Command control</td><td align="left">Testing exit status of a command in order to determine whether a portion of the program should be executed.</td></tr><tr><td align="left">Conditional branch</td><td align="left">Logical point in the program when a condition determines what happens next.</td></tr><tr><td align="left">Logic flow</td><td align="left">The overall design of the program.  Determines logical sequence of tasks so that the result is successful and controlled.</td></tr><tr><td align="left">Loop</td><td align="left">Part of the program that is performed zero or more times.</td></tr><tr><td align="left">User input</td><td align="left">Information provided by an external source while the program is running, can be stored and recalled when needed.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_05_04"></a>5.4. A word on order and logic</h3></div></div></div><p>In order to speed up the developing process, the logical<a class="indexterm" name="idm1169"></a> order of a program should be thought over in advance.  This is your first step when developing a script.</p><p>A number of methods can be used; one of the most common is working with lists.  Itemizing the list of tasks involved in a program allows you to describe each process.  Individual tasks can be referenced by their item number.</p><p>Using your own spoken language to pin down the tasks to be executed by your program will help you to create an understandable form of your program.  Later, you can replace the everyday language statements with shell language words and constructs.</p><p>The example<a class="indexterm" name="idm1175"></a> below shows such a logic flow design.  It describes the rotation of log files.  This example shows a possible repetitive loop, controlled by the number of base log files you want to rotate:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Do you want to rotate logs?</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>If yes:</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p>Enter directory name containing the logs to be rotated.</p></li><li class="listitem"><p>Enter base name of the log file.</p></li><li class="listitem"><p>Enter number of days logs should be kept.</p></li><li class="listitem"><p>Make settings permanent in user's crontab file.</p></li></ol></div></li><li class="listitem"><p>If no, go to step 3.</p></li></ol></div></li><li class="listitem"><p>Do you want to rotate another set of logs?</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>If yes: repeat step 1.</p></li><li class="listitem"><p>If no: go to step 3.</p></li></ol></div></li><li class="listitem"><p>Exit</p></li></ol></div><p>The user should provide information for the program to do something.  Input from the user must be obtained and stored.  The user should be notified that his crontab will change.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_05_05"></a>5.5. An example<a class="indexterm" name="idm1207"></a> Bash script: mysystem.sh</h3></div></div></div><p>The <code class="filename">mysystem.sh</code> script below executes some well-known commands (<span class="command"><strong>date</strong></span>, <span class="command"><strong>w</strong></span>, <span class="command"><strong>uname</strong></span>, <span class="command"><strong>uptime</strong></span>) to display information about you and your machine.</p><pre class="screen">
<code class="prompt">tom:~&gt;</code> <span class="command"><strong>cat <code class="option">-n</code> <code class="filename">mysystem.sh</code></strong></span>
     1  #!/bin/bash
     2  clear
     3  echo "This is information provided by mysystem.sh.  Program starts now."
     4
     5  echo "Hello, $USER"
     6  echo
     7
     8  echo "Today's date is `date`, this is week `date +"%V"`."
     9  echo
    10
    11  echo "These users are currently connected:"
    12  w | cut -d " " -f 1 - | grep -v USER | sort -u
    13  echo
    14
    15  echo "This is `uname -s` running on a `uname -m` processor."
    16  echo
    17
    18  echo "This is the uptime information:"
    19  uptime
    20  echo
    21
    22  echo "That's all folks!"
</pre><p>A script always starts with the same two characters, <span class="quote">&#8220;<span class="quote">#!</span>&#8221;</span>.  After that, the shell that will execute the commands following the first line is defined.  This script starts with clearing the screen on line 2.  Line 3 makes it print a message, informing the user about what is going to happen.  Line 5 greets the user.  Lines 6, 9, 13, 16 and 20 are only there for orderly output display purposes.  Line 8 prints the current date and the number of the week.  Line 11 is again an informative message, like lines 3, 18 and 22.  Line 12 formats the output of the <span class="command"><strong>w</strong></span>; line 15 shows operating system and CPU information.  Line 19 gives the uptime and load information.</p><p>Both <span class="command"><strong>echo</strong></span> and <span class="command"><strong>printf</strong></span> are Bash built-in commands.  The first always exits with a 0 status, and simply prints arguments followed by an end of line character on the standard output, while the latter allows for definition of a formatting string and gives a non-zero exit status code upon failure.</p><p>This is the same script using the <span class="command"><strong>printf</strong></span> built-in:</p><pre class="screen">
<code class="prompt">tom:~&gt;</code> <span class="command"><strong>cat <code class="filename">mysystem.sh</code></strong></span>
#!/bin/bash
clear
printf "This is information provided by mysystem.sh.  Program starts now.\n"

printf "Hello, $USER.\n\n"

printf "Today's date is `date`, this is week `date +"%V"`.\n\n"

printf "These users are currently connected:\n"
w | cut -d " " -f 1 - | grep -v USER | sort -u
printf "\n"

printf "This is `uname -s` running on a `uname -m` processor.\n\n"

printf "This is the uptime information:\n"
uptime
printf "\n"

printf "That's all folks!\n"
</pre><p>Creating user friendly scripts by means of inserting messages is treated in <a class="xref" href="#chap_08" title="Chapter 8. Writing interactive scripts">Chapter 8, <i>Writing interactive scripts</i></a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Standard location of the Bourne Again shell</h3><p>This implies that the <span class="command"><strong>bash</strong></span> program is installed in <code class="filename">/bin</code>.</p></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">If stdout is not available</h3><p>If you execute a script from cron, supply full path names and redirect output and errors.  Since the shell runs in non-interactive mode, any errors will cause the script to exit prematurely if you don't think about this.</p></div><p>The following chapters will discuss the details of the above scripts.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_01_05_06"></a>5.6. Example init script</h3></div></div></div><p>An init script<a class="indexterm" name="idm1247"></a> starts system services on UNIX and Linux machines.  The system log daemon, the power management daemon, the name and mail daemons are common examples.  These scripts, also known as startup scripts, are stored in a specific location on your system, such as <code class="filename">/etc/rc.d/init.d</code> or <code class="filename">/etc/init.d</code>.  Init, the initial process, reads its configuration files and decides which services to start or stop in each run level.  A run level is a configuration of processes; each system has a single user run level, for instance, for performing administrative tasks, for which the system has to be in an unused state as much as possible, such as recovering a critical file system from a backup.  Reboot and shutdown run levels are usually also configured.</p><p>The tasks to be executed upon starting a service or stopping it are listed in the startup scripts.  It is one of the system administrator's tasks to configure <span class="command"><strong>init</strong></span>, so that services are started and stopped at the correct moment.  When confronted with this task, you need a good understanding of the startup and shutdown procedures on your system.  We therefore advise that you read the man pages for <span class="command"><strong>init</strong></span> and <code class="filename">inittab</code> before starting on your own initialization scripts.</p><p>Here is a very simple example, that will play a sound upon starting<a class="indexterm" name="idm1257"></a> and stopping your machine:</p><pre class="screen">
#!/bin/bash

# This script is for /etc/rc.d/init.d
# Link in rc3.d/S99audio-greeting and rc0.d/K01audio-greeting

case "$1" in
'start')
  cat /usr/share/audio/at_your_service.au &gt; /dev/audio
  ;;
'stop')
  cat /usr/share/audio/oh_no_not_again.au &gt; /dev/audio
  ;;
esac
exit 0
</pre><p>The <span class="command"><strong>case</strong></span> statement often used in this kind of script is described in <a class="xref" href="#sect_07_02_05" title="2.5. Using the exit statement and if">Section 2.5, &#8220;Using the exit statement and if&#8221;</a>.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_01_06"></a>6. Summary</h2></div></div></div><p>Bash is the GNU shell, compatible with the Bourne shell and incorporating many useful features from other shells.  When the shell is started, it reads its configuration files.  The most important are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">/etc/profile</code></p></li><li class="listitem"><p><code class="filename">~/.bash_profile</code></p></li><li class="listitem"><p><code class="filename">~/.bashrc</code></p></li></ul></div><p>Bash behaves different when in interactive mode and also has a POSIX compliant and a restricted mode.</p><p>Shell commands can be split up in three groups: the shell functions, shell built-ins and existing commands in a directory on your system.  Bash supports additional built-ins not found in the plain Bourne shell.</p><p>Shell scripts consist of these commands arranged as shell syntax dictates.  Scripts are read and executed line per line and should have a logical structure.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_01_07"></a>7. Exercises</h2></div></div></div><p>These are some exercises to warm you up for the next chapter:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Where is the <span class="command"><strong>bash</strong></span> program located on your system?</p></li><li class="listitem"><p>Use the <code class="option">--version</code> option to find out which version you are running.</p></li><li class="listitem"><p>Which shell configuration files are read when you login to your system using the graphical user interface and then opening a terminal window?</p></li><li class="listitem"><p>Are the following shells interactive shells?  Are they login shells?</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A shell opened by clicking on the background of your graphical desktop, selecting <span class="quote">&#8220;<span class="quote">Terminal</span>&#8221;</span> or such from a menu.</p></li><li class="listitem"><p>A shell that you get after issuing the command <span class="command"><strong>ssh <em class="parameter"><code>localhost</code></em></strong></span>.</p></li><li class="listitem"><p>A shell that you get when logging in to the console in text mode.</p></li><li class="listitem"><p>A shell obtained by the command <span class="command"><strong>xterm &amp;</strong></span>.</p></li><li class="listitem"><p>A shell opened by the <span class="command"><strong>mysystem.sh</strong></span> script.</p></li><li class="listitem"><p>A shell that you get on a remote host, for which you didn't have to give the login and/or password because you use SSH and maybe SSH keys.</p></li></ul></div></li><li class="listitem"><p>Can you explain why <span class="command"><strong>bash</strong></span> does not exit when you type <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span> on the command line?</p></li><li class="listitem"><p>Display directory stack content.</p></li><li class="listitem"><p>If it is not yet the case, set your prompt so that it displays your location in the file system hierarchy, for instance add this line to <code class="filename">~/.bashrc</code>:</p><div class="cmdsynopsis"><p><code class="command">export <code class="varname">PS1</code>="<em class="parameter"><code>\u@\h \w&gt; </code></em>"</code> </p></div></li><li class="listitem"><p>Display hashed commands for your current shell session.</p></li><li class="listitem"><p>How many processes are currently running on your system?  Use <span class="command"><strong>ps</strong></span> and <span class="command"><strong>wc</strong></span>, the first line of output of <span class="command"><strong>ps</strong></span> is not a process!</p></li><li class="listitem"><p>How to display the system hostname?  Only the name, nothing more!</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_02"></a>Chapter 2. Writing and debugging scripts</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_02_01">1. Creating and running a script</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_02_01_01">1.1. Writing and naming</a></span></dt><dt><span class="sect2"><a href="#sect_02_01_02">1.2. script1.sh</a></span></dt><dt><span class="sect2"><a href="#sect_02_01_03">1.3. Executing the script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_02_02">2. Script basics</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_02_02_01">2.1. Which shell will run the script?</a></span></dt><dt><span class="sect2"><a href="#sect_02_02_02">2.2. Adding comments</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_02_03">3. Debugging Bash scripts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_02_03_01">3.1. Debugging on the entire script</a></span></dt><dt><span class="sect2"><a href="#sect_02_03_02">3.2. Debugging on part(s) of the script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_02_05">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_02_06">5. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>After going through this chapter, you will be able to:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Write a simple script</p></li><li class="listitem"><p>Define the shell type that should execute the script</p></li><li class="listitem"><p>Put comments in a script</p></li><li class="listitem"><p>Change permissions on a script</p></li><li class="listitem"><p>Execute and debug a script</p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_02_01"></a>1. Creating and running a script</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_02_01_01"></a>1.1. Writing and naming</h3></div></div></div><p>A shell script is a sequence of commands for which you have a repeated use.  This sequence is typically executed by entering the name of the script on the command line.  Alternatively, you can use scripts to automate tasks using the cron facility.  Another use for scripts is in the UNIX boot and shutdown procedure, where operation of daemons and services are defined in init scripts.</p><p>To create<a class="indexterm" name="idm1357"></a> a shell script, open a new empty file in your editor.  Any text editor will do: <span class="command"><strong>vim</strong></span>, <span class="command"><strong>emacs</strong></span>, <span class="command"><strong>gedit</strong></span>, <span class="command"><strong>dtpad</strong></span> et cetera are all valid.  You might want to chose a more advanced editor like <span class="command"><strong>vim</strong></span> or <span class="command"><strong>emacs</strong></span>, however, because these can be configured to recognize shell and Bash syntax and can be a great help in preventing those errors that beginners frequently make, such as forgetting brackets and semi-colons.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Syntax highlighting in vim</h3><p>In order to activate syntax highlighting in <span class="command"><strong>vim</strong></span>, use the command</p><div class="cmdsynopsis"><p><code class="command">:syntax enable</code> </p></div><p>or</p><div class="cmdsynopsis"><p><code class="command">:sy enable</code> </p></div><p>or</p><div class="cmdsynopsis"><p><code class="command">:syn enable</code> </p></div><p>You can add this setting to your <code class="filename">.vimrc</code> file to make it permanent.</p></div><p>Put UNIX commands in the new empty file, like you would enter them on the command line.   As discussed in the previous chapter (see <a class="xref" href="#sect_01_03" title="3. Executing commands">Section 3, &#8220;Executing commands&#8221;</a>), commands can be shell functions, shell built-ins, UNIX commands and other scripts.</p><p>Give your script a sensible name<a class="indexterm" name="idm1383"></a> that gives a hint about what the script does.  Make sure that your script name does not conflict with existing commands.  In order to ensure that no confusion can rise, script names often end in <code class="filename">.sh</code>; even so, there might be other scripts on your system with the same name as the one you chose.  Check using <span class="command"><strong>which</strong></span>, <span class="command"><strong>whereis</strong></span> and other commands for finding information about programs and files:</p><div class="cmdsynopsis"><p><code class="command">which <code class="option">-a</code> <code class="filename">script_name</code></code> </p></div><div class="cmdsynopsis"><p><code class="command">whereis <code class="filename">script_name</code></code> </p></div><div class="cmdsynopsis"><p><code class="command">locate <code class="filename">script_name</code></code> </p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_02_01_02"></a>1.2. script1.sh</h3></div></div></div><p>In this example<a class="indexterm" name="idm1402"></a> we use the <span class="command"><strong>echo</strong></span> Bash built-in to inform the user about what is going to happen, before the task that will create the output is executed.  It is strongly advised to inform users about what a script is doing, in order to prevent them from becoming nervous <span class="emphasis"><em>because the script is not doing anything</em></span>.  We will return to the subject of notifying users in <a class="xref" href="#chap_08" title="Chapter 8. Writing interactive scripts">Chapter 8, <i>Writing interactive scripts</i></a>.</p><div class="figure"><a name="idm1408"></a><p class="title"><b>Figure 2.1. script1.sh</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/script1.sh.png" alt='Example script using statements like "echo hello", "echo hello $USER" and "VARIABLE=value".'></div></div></div><br class="figure-break"><p>Write this script for yourself as well.  It might be a good idea to create a directory <code class="filename">~/scripts</code> to hold your scripts.  Add the directory to the contents of the <code class="varname">PATH</code> variable<a class="indexterm" name="idm1420"></a>:</p><div class="cmdsynopsis"><p><code class="command">export <code class="varname">PATH</code>="<code class="varname">$PATH</code>:<code class="filename">~/scripts</code>"</code> </p></div><p>If you are just getting started with Bash, use a text editor that uses different colours for different shell constructs.  Syntax highlighting is supported by <span class="command"><strong>vim</strong></span>, <span class="command"><strong>gvim</strong></span>, <span class="command"><strong>(x)emacs</strong></span>, <span class="command"><strong>kwrite</strong></span> and many other editors; check the documentation of your favorite editor.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Different prompts</h3><p>The prompts throughout this course vary depending on the author's mood.  This resembles much more real life situations than the standard educational <span class="emphasis"><em>$</em></span> prompt.  The only convention we stick to, is that the <span class="emphasis"><em>root</em></span> prompt ends in a hash mark (#).</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_02_01_03"></a>1.3. Executing the script</h3></div></div></div><p>The script should have execute<a class="indexterm" name="idm1441"></a> permissions for the correct owners in order to be runnable.  When setting permissions<a class="indexterm" name="idm1444"></a>, check that you really obtained the permissions that you want.  When this is done, the script can run like any other command:</p><pre class="screen">
<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>chmod <code class="option">u+x</code> <code class="filename">script1.sh</code></strong></span>

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> <code class="filename">script1.sh</code></strong></span>
-rwxrw-r--    1 willy	willy		456 Dec 24 17:11 script1.sh

<code class="prompt">willy:~&gt;</code> <span class="command"><strong>script1.sh</strong></span>
The script starts now.
Hi, willy!

I will now fetch you a list of connected users:

  3:38pm  up 18 days,  5:37,  4 users,  load average: 0.12, 0.22, 0.15
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU  WHAT
root     tty2     -                Sat 2pm  4:25m  0.24s  0.05s  -bash
willy	 :0       -                Sat 2pm   ?     0.00s   ?     -
willy    pts/3    -                Sat 2pm  3:33m 36.39s 36.39s  BitchX willy ir
willy    pts/2    -                Sat 2pm  3:33m  0.13s  0.06s  /usr/bin/screen

I'm setting two variables now.
This is a string: black
And this is a number: 9

I'm giving you back your prompt now.

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>echo <code class="varname">$COLOUR</code></strong></span>

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>echo <code class="varname">$VALUE</code></strong></span>

<code class="prompt">willy:~/scripts&gt;</code>
</pre><p>This is the most common way to execute a script.  It is preferred to execute the script like this in a subshell.  The variables, functions and aliases created in this subshell are only known to the particular bash session of that subshell.  When that shell exits and the parent regains control, everything is cleaned up and all changes to the state of the shell made by the script, are forgotten.</p><p>If you did not put the <code class="filename">scripts</code> directory in your <code class="varname">PATH</code>, and <code class="filename">.</code> (the current directory) is not in the <code class="varname">PATH</code> either, you can activate the script like this:</p><div class="cmdsynopsis"><p><code class="command">./script_name.sh</code> </p></div><p>A script can also explicitly be executed by a given shell, but generally we only do this if we want to obtain special behavior, such as checking if the script works with another shell or printing traces for debugging:</p><div class="cmdsynopsis"><p><code class="command">rbash <code class="filename">script_name.sh</code></code> </p></div><div class="cmdsynopsis"><p><code class="command">sh <code class="filename">script_name.sh</code></code> </p></div><div class="cmdsynopsis"><p><code class="command">bash <code class="option">-x</code> <code class="filename">script_name.sh</code></code> </p></div><p>The specified shell will start as a subshell of your current shell and execute the script.  This is done when you want the script to start up with specific options or under specific conditions which are not specified in the script.</p><p>If you don't want to start a new shell but execute the script in the current shell, you <span class="emphasis"><em>source<a class="indexterm" name="idm1487"></a></em></span> it:</p><div class="cmdsynopsis"><p><code class="command">source <code class="filename">script_name.sh</code></code> </p></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">source = .</h3><p>The Bash <span class="command"><strong>source</strong></span> built-in is a synonym for the Bourne shell <span class="command"><strong>.</strong></span> (dot) command.</p></div><p>The script does not need execute permission in this case.  Commands are executed in the current shell context, so any changes made to your environment will be visible when the script finishes execution:</p><pre class="screen">
<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>source <code class="filename">script1.sh</code></strong></span>
--output ommitted--

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>echo <code class="varname">$VALUE</code></strong></span>
9

<code class="prompt">willy:~/scripts&gt;</code>
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_02_02"></a>2. Script basics</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_02_02_01"></a>2.1. Which shell will run the script?</h3></div></div></div><p>When running a script in a subshell<a class="indexterm" name="idm1512"></a>, you should define which shell should run the script.  The shell type in which you wrote the script might not be the default on your system, so commands you entered might result in errors when executed by the wrong shell.</p><p>The first line of the script determines the shell to start.  The first two characters of the first line should be <span class="emphasis"><em>#!</em></span>, then follows the path to the shell that should interpret the commands that follow.  Blank lines are also considered to be lines, so don't start your script with an empty line.</p><p>For the purpose of this course, all scripts will start with the line</p><div class="cmdsynopsis"><p><code class="command">#!/bin/bash</code> </p></div><p>As noted before, this implies that the Bash executable can be found in <code class="filename">/bin</code>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_02_02_02"></a>2.2. Adding comments</h3></div></div></div><p>You should be aware of the fact that you might not be the only person reading your code.  A lot of users and system administrators run scripts that were written by other people.  If they want to see how you did it, comments<a class="indexterm" name="idm1525"></a> are useful to enlighten the reader.</p><p>Comments<a class="indexterm" name="idm1529"></a> also make your own life easier.  Say that you had to read a lot of man pages in order to achieve a particular result with some command that you used in your script.   You won't remember how it worked if you need to change your script after a few weeks or months, unless you have commented what you did, how you did it and/or why you did it.</p><p>Take the <code class="filename">script1.sh</code> example and copy it to <code class="filename">commented-script1.sh</code>, which we edit so that the comments reflect what the script does.  Everything the shell encounters after a hash mark on a line is ignored and only visible upon opening the shell script file:</p><pre class="screen">
#!/bin/bash
# This script clears the terminal, displays a greeting and gives information
# about currently connected users.  The two example variables are set and displayed.

clear				# clear terminal window

echo "The script starts now."

echo "Hi, $USER!"		# dollar sign is used to get content of variable
echo

echo "I will now fetch you a list of connected users:"
echo							
w				# show who is logged on and
echo				# what they are doing

echo "I'm setting two variables now."
COLOUR="black"					# set a local shell variable
VALUE="9"					# set a local shell variable
echo "This is a string: $COLOUR"		# display content of variable 
echo "And this is a number: $VALUE"		# display content of variable
echo

echo "I'm giving you back your prompt now."
echo
</pre><p>In a decent script, the first lines are usually comment about what to expect.  Then each big chunk of commands will be commented as needed for clarity's sake.  Linux init scripts, as an example, in your system's <code class="filename">init.d</code> directory, are usually well commented since they have to be readable and editable by everyone running Linux.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_02_03"></a>3. Debugging Bash scripts</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_02_03_01"></a>3.1. Debugging on the entire script</h3></div></div></div><p>When things<a class="indexterm" name="idm1543"></a> don't go according to plan, you need to determine what exactly causes the script to fail.  Bash provides extensive debugging<a class="indexterm" name="idm1546"></a> features.  The most common is to start up the subshell with the <code class="option">-x</code> option, which will run the entire script in debug mode.  Traces of each command plus its arguments are printed to standard output after the commands have been expanded but before they are executed.</p><p>This is the <code class="filename">commented-script1.sh</code> script ran in debug mode<a class="indexterm" name="idm1551"></a>.  Note again that the added comments are not visible in the output of the script.</p><pre class="screen">
<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>bash <code class="option">-x</code> <code class="filename">script1.sh</code></strong></span>
+ clear

+ echo 'The script starts now.'
The script starts now.
+ echo 'Hi, willy!'
Hi, willy!
+ echo

+ echo 'I will now fetch you a list of connected users:'
I will now fetch you a list of connected users:
+ echo

+ w
  4:50pm  up 18 days,  6:49,  4 users,  load average: 0.58, 0.62, 0.40
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU  WHAT
root     tty2     -                Sat 2pm  5:36m  0.24s  0.05s  -bash
willy	 :0       -                Sat 2pm   ?     0.00s   ?     -
willy	 pts/3    -                Sat 2pm 43:13  36.82s 36.82s  BitchX willy ir
willy    pts/2    -                Sat 2pm 43:13   0.13s  0.06s  /usr/bin/screen
+ echo

+ echo 'I'\''m setting two variables now.'
I'm setting two variables now.
+ COLOUR=black
+ VALUE=9
+ echo 'This is a string: '
This is a string:
+ echo 'And this is a number: '
And this is a number:
+ echo

+ echo 'I'\''m giving you back your prompt now.'
I'm giving you back your prompt now.
+ echo
</pre><p>There is now a full-fledged debugger for Bash, available at <a class="ulink" href="http://bashdb.sourceforge.net" target="_top">SourceForge</a>.  These debugging features are available in most modern versions of Bash, starting from 3.x.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_02_03_02"></a>3.2. Debugging on part(s) of the script</h3></div></div></div><p>Using the <span class="command"><strong>set</strong></span> Bash built-in you can run in normal mode those portions<a class="indexterm" name="idm1565"></a> of the script of which you are sure they are without fault, and display debugging information only for troublesome zones.  Say we are not sure what the <span class="command"><strong>w</strong></span> command will do in the example <code class="filename">commented-script1.sh</code>, then we could enclose it in the script like this:</p><pre class="screen">
set -x			# activate debugging from here
w
set +x			# stop debugging from here
</pre><p>Output then looks like this:</p><pre class="screen">
<code class="prompt">willy: ~/scripts&gt;</code> <span class="command"><strong>script1.sh</strong></span>
The script starts now.
Hi, willy!

I will now fetch you a list of connected users:

+ w
  5:00pm  up 18 days,  7:00,  4 users,  load average: 0.79, 0.39, 0.33
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU  WHAT
root     tty2     -                Sat 2pm  5:47m  0.24s  0.05s  -bash
willy    :0       -                Sat 2pm   ?     0.00s   ?     -
willy    pts/3    -                Sat 2pm 54:02  36.88s 36.88s  BitchX willyke
willy    pts/2    -                Sat 2pm 54:02   0.13s  0.06s  /usr/bin/screen
+ set +x

I'm setting two variables now.
This is a string:
And this is a number:

I'm giving you back your prompt now.

<code class="prompt">willy: ~/scripts&gt;</code>
</pre><p>You can switch debugging mode on and off as many times as you want within the same script.</p><p>The table below gives an overview of other useful Bash options<a class="indexterm" name="idm1578"></a>:</p><div class="table"><a name="table_02_01"></a><p class="title"><b>Table 2.1. Overview of set debugging options</b></p><div class="table-contents"><table class="table" summary="Overview of set debugging options" border="1"><colgroup><col><col><col></colgroup><thead><tr><th align="left">Short notation</th><th align="left">Long notation</th><th align="left">Result</th></tr></thead><tbody><tr><td align="left">set -f</td><td align="left">set -o noglob</td><td align="left">Disable file name generation using metacharacters (globbing).</td></tr><tr><td align="left">set -v</td><td align="left">set -o verbose</td><td align="left">Prints shell input lines as they are read.</td></tr><tr><td align="left">set -x</td><td align="left">set -o xtrace</td><td align="left">Print command traces before executing command.</td></tr></tbody></table></div></div><br class="table-break"><p>The dash is used to activate a shell option and a plus to deactivate it.  Don't let this confuse you!</p><p>In the example below, we demonstrate these options on the command line:</p><pre class="screen">
<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>set <code class="option">-v</code></strong></span>

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>ls</strong></span>
ls 
commented-scripts.sh	script1.sh

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>set <code class="option">+v</code></strong></span>
set +v

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>ls <em class="parameter"><code>*</code></em></strong></span>
commented-scripts.sh    script1.sh

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>set <code class="option">-f</code></strong></span>

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>ls <code class="filename">*</code></strong></span>
ls: *: No such file or directory

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>touch <code class="filename">*</code></strong></span>

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>ls</strong></span>
*   commented-scripts.sh    script1.sh

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>rm <code class="filename">*</code></strong></span>

<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>ls</strong></span>
commented-scripts.sh    script1.sh
</pre><p>Alternatively, these modes can be specified in the script itself, by adding the desired options to the first line shell declaration.  Options can be combined, as is usually the case with UNIX commands:</p><div class="cmdsynopsis"><p><code class="command">#!/bin/bash <code class="option">-xv</code></code> </p></div><p>Once you found the buggy<a class="indexterm" name="idm1637"></a> part of your script, you can add <span class="command"><strong>echo</strong></span> statements before each command of which you are unsure, so that you will see exactly where and why things don't work.  In the example <code class="filename">commented-script1.sh</code> script, it could be done like this, still assuming that the displaying of users gives us problems:</p><pre class="screen">
echo "debug message: now attempting to start w command"; w
</pre><p>In more advanced scripts, the <span class="command"><strong>echo</strong></span> can be inserted to display the content of variables at different stages in the script, so that flaws can be detected:</p><pre class="screen">
echo "Variable VARNAME is now set to $VARNAME."
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_02_05"></a>4. Summary</h2></div></div></div><p>A shell script is a reusable series of commands put in an executable text file.  Any text editor can be used to write scripts.</p><p>Scripts start with <span class="emphasis"><em>#!</em></span> followed by the path to the shell executing the commands from the script.  Comments are added to a script for your own future reference, and also to make it understandable for other users.  It is better to have too many explanations than not enough.</p><p>Debugging a script can be done using shell options.  Shell options can be used for partial debugging or for analyzing the entire script.  Inserting <span class="command"><strong>echo</strong></span> commands at strategic locations is also a common troubleshooting technique.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_02_06"></a>5. Exercises</h2></div></div></div><p>This exercise will help you to create your first script.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Write a script using your favorite editor.  The script should display the path to your homedirectory and the terminal type that you are using.  Additionally it shows all the services started up in runlevel 3 on your system.  (hint: use <code class="varname">HOME</code>, <code class="varname">TERM</code> and <span class="command"><strong>ls <code class="filename">/etc/rc3.d/S*</code></strong></span>)</p></li><li class="listitem"><p>Add comments in your script.</p></li><li class="listitem"><p>Add information for the users of your script.</p></li><li class="listitem"><p>Change permissions on your script so that you can run it.</p></li><li class="listitem"><p>Run the script in normal mode and in debug mode.  It should run without errors.</p></li><li class="listitem"><p>Make errors in your script: see what happens if you misspell commands, if you leave out the first line or put something unintelligible there, or if you misspell shell variable names or write them in lower case characters after they have been declared in capitals.  Check what the debug comments say about this.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_03"></a>Chapter 3. The Bash environment</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_03_01">1. Shell initialization files</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_01_01">1.1. System-wide configuration files</a></span></dt><dt><span class="sect2"><a href="#sect_03_01_02">1.2. Individual user configuration files</a></span></dt><dt><span class="sect2"><a href="#sect_03_01_03">1.3. Changing shell configuration files</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_02">2. Variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_02_01">2.1. Types of variables</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_02">2.2. Creating variables</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_03">2.3. Exporting variables</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_04">2.4. Reserved variables</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_05">2.5. Special parameters</a></span></dt><dt><span class="sect2"><a href="#sect_03_02_06">2.6. Script recycling with variables</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_03">3. Quoting characters</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_03_01">3.1. Why?</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_02">3.2. Escape characters</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_03">3.3. Single quotes</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_04">3.4. Double quotes</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_05">3.5. ANSI-C quoting</a></span></dt><dt><span class="sect2"><a href="#sect_03_03_06">3.6. Locales</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_04">4. Shell expansion</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_04_0">4.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_01">4.2. Brace expansion</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_02">4.3. Tilde expansion</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_03">4.4. Shell parameter and variable expansion</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_04">4.5. Command substitution</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_05">4.6. Arithmetic expansion</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_06">4.7. Process substitution</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_07">4.8. Word splitting</a></span></dt><dt><span class="sect2"><a href="#sect_03_04_08">4.9. File name expansion</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_05">5. Aliases</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_05_01">5.1. What are aliases?</a></span></dt><dt><span class="sect2"><a href="#sect_03_05_02">5.2. Creating and removing aliases</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_06">6. More Bash options</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_03_06_01">6.1. Displaying options</a></span></dt><dt><span class="sect2"><a href="#sect_03_06_02">6.2. Changing options</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_03_07">7. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_03_08">8. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this chapter we will discuss the various ways in which the Bash environment can be influenced:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Editing shell initialization files</p></li><li class="listitem"><p>Using variables</p></li><li class="listitem"><p>Using different quote styles</p></li><li class="listitem"><p>Perform arithmetic calculations</p></li><li class="listitem"><p>Assigning aliases</p></li><li class="listitem"><p>Using expansion and substitution</p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_03_01"></a>1. Shell initialization files</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_01_01"></a>1.1. System-wide configuration files</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_01_01_01"></a>1.1.1. /etc/profile</h4></div></div></div><p>When invoked<a class="indexterm" name="idm1698"></a> interactively with the <code class="option">--login</code> option or when invoked as <span class="command"><strong>sh</strong></span>, Bash reads the <code class="filename">/etc/profile</code> instructions.  These usually set the shell variables <code class="varname">PATH<a class="indexterm" name="idm1705"></a></code>, <code class="varname">USER<a class="indexterm" name="idm1709"></a></code>, <code class="varname">MAIL<a class="indexterm" name="idm1713"></a></code>, <code class="varname">HOSTNAME<a class="indexterm" name="idm1717"></a></code> and <code class="varname">HISTSIZE<a class="indexterm" name="idm1721"></a></code>.</p><p>On some systems, the <span class="command"><strong>umask</strong></span> value is configured in <code class="filename">/etc/profile</code>; on other systems this file holds pointers to other configuration files such as:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">/etc/inputrc<a class="indexterm" name="idm1731"></a></code>, the system-wide Readline initialization file where you can configure the command line bell-style.</p></li><li class="listitem"><p>the <code class="filename">/etc/profile.d</code> directory<a class="indexterm" name="idm1737"></a>, which contains files configuring system-wide behavior of specific programs.</p></li></ul></div><p>All settings that you want to apply to all your users' environments should be in this file.  It might look like this<a class="indexterm" name="idm1741"></a>:</p><pre class="screen">
# /etc/profile

# System wide environment and startup programs, for login setup

PATH=$PATH:/usr/X11R6/bin

# No core files by default
ulimit -S -c 0 &gt; /dev/null 2&gt;&amp;1

USER="`id -un`"
LOGNAME=$USER
MAIL="/var/spool/mail/$USER"

HOSTNAME=`/bin/hostname`
HISTSIZE=1000

# Keyboard, bell, display style: the readline config file:
if [ -z "$INPUTRC" -a ! -f "$HOME/.inputrc" ]; then
    INPUTRC=/etc/inputrc
fi

PS1="\u@\h \W"

export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE INPUTRC PS1

# Source initialization files for specific programs (ls, vim, less, ...)
for i in /etc/profile.d/*.sh ; do
    if [ -r "$i" ]; then
        . $i
    fi
done

# Settings for program initialization
source /etc/java.conf
export NPX_PLUGIN_PATH="$JRE_HOME/plugin/ns4plugin/:/usr/lib/netscape/plugins"

PAGER="/usr/bin/less"

unset i
</pre><p>This configuration file sets some basic shell environment variables as well as some variables required by users running Java and/or Java applications in their web browser.  See <a class="xref" href="#sect_03_02" title="2. Variables">Section 2, &#8220;Variables&#8221;</a>.</p><p>See <a class="xref" href="#chap_07" title="Chapter 7. Conditional statements">Chapter 7, <i>Conditional statements</i></a> for more on the conditional <span class="command"><strong>if</strong></span> used in this file; <a class="xref" href="#chap_09" title="Chapter 9. Repetitive tasks">Chapter 9, <i>Repetitive tasks</i></a> discusses loops such as the <span class="command"><strong>for</strong></span> construct.</p><p>The Bash source contains sample <code class="filename">profile</code> files for general or individual use.  These and the one in the example above need changes in order for them to work in your environment!</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_01_01_02"></a>1.1.2. /etc/bashrc</h4></div></div></div><p>On systems offering multiple types of shells, it might be better to put Bash-specific configurations in this file<a class="indexterm" name="idm1757"></a>, since <code class="filename">/etc/profile</code> is also read by other shells, such as the Bourne shell.  Errors generated by shells that don't understand the Bash syntax are prevented by splitting the configuration files for the different types of shells.  In such cases, the user's <code class="filename">~/.bashrc</code> might point to <code class="filename">/etc/bashrc</code> in order to include it in the shell initialization process upon login.</p><p>You might also find that <code class="filename">/etc/profile</code> on your system only holds shell environment and program startup settings, while <code class="filename">/etc/bashrc</code> contains system-wide definitions for shell functions and aliases<a class="indexterm" name="idm1766"></a>.  The <code class="filename">/etc/bashrc</code> file might be referred to in <code class="filename">/etc/profile</code> or in individual user shell initialization files.</p><p>The source contains sample <code class="filename">bashrc</code> files, or you might find a copy in <code class="filename">/usr/share/doc/bash-2.05b/startup-files</code>.  This is part of the <code class="filename">bashrc</code> that comes with the Bash documentation<a class="indexterm" name="idm1775"></a>:</p><pre class="screen">
alias ll='ls -l'
alias dir='ls -ba'
alias c='clear'
alias ls='ls --color'

alias mroe='more'
alias pdw='pwd'
alias sl='ls --color'

pskill()
{
        local pid

        pid=$(ps -ax | grep $1 | grep -v grep | gawk '{ print $1 }')
        echo -n "killing $1 (process $pid)..."
        kill -9 $pid
        echo "slaughtered."
}

</pre><p>Apart from general aliases, it contains useful aliases which make commands work even if you misspell<a class="indexterm" name="idm1780"></a> them.  We will discuss aliases in <a class="xref" href="#sect_03_05_02" title="5.2. Creating and removing aliases">Section 5.2, &#8220;Creating and removing aliases&#8221;</a>.  This file contains a function, <span class="command"><strong>pskill</strong></span>; functions will be studied in detail in <a class="xref" href="#chap_11" title="Chapter 11. Functions">Chapter 11, <i>Functions</i></a>.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_01_02"></a>1.2. Individual user configuration files</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">I don't have these files?!</h3><p>These files might not be in your home directory by default; create them if needed.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_01_02_01"></a>1.2.1. ~/.bash_profile</h4></div></div></div><p>This is the preferred configuration file for configuring user environments individually<a class="indexterm" name="idm1794"></a>.  In this file, users can add extra configuration options or change default settings:</p><pre class="screen">
<code class="prompt">franky~&gt;</code> <span class="command"><strong>cat <code class="filename">.bash_profile<a class="indexterm" name="idm1801"></a></code></strong></span>
#################################################################
#                                                               #
#   .bash_profile file                                          #
#                                                               #
#   Executed from the bash shell when you log in.               #
#                                                               #
#################################################################

source ~/.bashrc
source ~/.bash_login
case "$OS" in
  IRIX)
    stty sane dec
    stty erase
    ;;
#  SunOS)
#    stty erase
#    ;;
  *)
    stty sane
    ;;
esac
</pre><p>This user configures the backspace character for login on different operating systems.  Apart from that, the user's <code class="filename">.bashrc</code> and <code class="filename">.bash_login</code> are read.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_01_02_02"></a>1.2.2. ~/.bash_login</h4></div></div></div><p>This file<a class="indexterm" name="idm1810"></a> contains specific settings that are normally only executed when you log in to the system.  In the example, we use it to configure the <span class="command"><strong>umask</strong></span> value and to show a list of connected users upon login.  This user also gets the calendar for the current month<a class="indexterm" name="idm1814"></a>:</p><pre class="screen">
#######################################################################
#                                                                     #
#   Bash_login file                                                   #
#                                                                     #
#   commands to perform from the bash shell at login time             #
#   (sourced from .bash_profile)                                      #
#                                                                     #
#######################################################################
#   file protection
umask 002       # all to me, read to group and others
#   miscellaneous
w
cal `date +"%m"` `date +"%Y"`
</pre><p>In the absence of <code class="filename">~/.bash_profile</code>, this file will be read.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_01_02_03"></a>1.2.3. ~/.profile</h4></div></div></div><p>In the absence<a class="indexterm" name="idm1823"></a> of <code class="filename">~/.bash_profile</code> and <code class="filename">~/.bash_login</code>, <code class="filename">~/.profile</code> is read.  It can hold the same configurations, which are then also accessible by other shells.  Mind that other shells might not understand the Bash syntax.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_01_02_04"></a>1.2.4. ~/.bashrc</h4></div></div></div><p>Today, it is more common<a class="indexterm" name="idm1832"></a> to use a non-login shell, for instance when logged in graphically using X terminal windows.  Upon opening such a window, the user does not have to provide a user name or password; no authentication is done.  Bash searches for <code class="filename">~/.bashrc</code> when this happens, so it is referred to in the files read upon login as well, which means you don't have to enter the same settings in multiple files.</p><p>In this user's <code class="filename">.bashrc</code> a couple of aliases<a class="indexterm" name="idm1838"></a> are defined and variables for specific programs are set after the system-wide <code class="filename">/etc/bashrc</code> is read<a class="indexterm" name="idm1842"></a>:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>cat <code class="filename">.bashrc</code></strong></span>
# /home/franky/.bashrc

# Source global definitions
if [ -f /etc/bashrc ]; then
       . /etc/bashrc

fi

# shell options

set -o noclobber

# my shell variables

export PS1="\[\033[1;44m\]\u \w\[\033[0m\] "
export PATH="$PATH:~/bin:~/scripts"

# my aliases

alias cdrecord='cdrecord -dev 0,0,0 -speed=8'
alias ss='ssh octarine'
alias ll='ls -la'

# mozilla fix

MOZILLA_FIVE_HOME=/usr/lib/mozilla
LD_LIBRARY_PATH=/usr/lib/mozilla:/usr/lib/mozilla/plugins
MOZ_DIST_BIN=/usr/lib/mozilla
MOZ_PROGRAM=/usr/lib/mozilla/mozilla-bin
export MOZILLA_FIVE_HOME LD_LIBRARY_PATH MOZ_DIST_BIN MOZ_PROGRAM

# font fix
alias xt='xterm -bg black -fg white &amp;'

# BitchX settings
export IRCNAME="frnk"

# THE END
<code class="prompt">franky ~&gt;</code>
</pre><p>More examples can be found in the Bash package.  Remember that sample files might need changes in order to work in your environment.</p><p>Aliases are discussed in <a class="xref" href="#sect_03_05" title="5. Aliases">Section 5, &#8220;Aliases&#8221;</a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_01_02_05"></a>1.2.5. ~/.bash_logout</h4></div></div></div><p>This file contains specific instructions for the logout<a class="indexterm" name="idm1856"></a> procedure.  In the example<a class="indexterm" name="idm1859"></a>, the terminal window is cleared upon logout.  This is useful for remote connections, which will leave a clean window after closing them.</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>cat <code class="filename">.bash_logout</code></strong></span>
#######################################################################
#                                                                     #
#   Bash_logout file                                                  #
#                                                                     #
#   commands to perform from the bash shell at logout time            #
#                                                                     #
#######################################################################
clear
<code class="prompt">franky ~&gt;</code>
</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_01_03"></a>1.3. Changing shell configuration files</h3></div></div></div><p>When making changes<a class="indexterm" name="idm1870"></a> to any of the above files, users have to either reconnect to the system or <span class="command"><strong>source</strong></span> the altered file for the changes to take effect.  By interpreting the script this way, changes<a class="indexterm" name="idm1874"></a> are applied to the current shell session:</p><div class="figure"><a name="idm1877"></a><p class="title"><b>Figure 3.1. Different prompts for different users</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/prompt.png" alt='Prompt 1 is "franky ~&gt;; prompt is then changed with "export PS1="\[\033[1;42m\]$USER is in \w\[\033[0m\] " resulting in a green reverse video prompt displaying username and present working directory in humanly readable form. Prompt for root is set using a similar PS1 configuration to be bright red reverse video.'></div></div></div><br class="figure-break"><p>Most shell scripts execute in a private environment: variables are not inherited by child processes unless they are exported by the parent shell.  Sourcing a file containing shell commands is a way of applying changes to your own environment and setting variables in the current shell.</p><p>This example also demonstrates the use of different prompt settings by different users.  In this case, red means danger.  When you have a green prompt, don't worry too much.</p><p>Note that <span class="command"><strong>source <code class="filename">resourcefile</code></strong></span> is the same as <span class="command"><strong>. <code class="filename">resourcefile</code></strong></span>.</p><p>Should you get lost in all these configuration files, and find yourself confronted with settings of which the origin is not clear, use <span class="command"><strong>echo</strong></span> statements, just like for debugging scripts; see <a class="xref" href="#sect_02_03_02" title="3.2. Debugging on part(s) of the script">Section 3.2, &#8220;Debugging on part(s) of the script&#8221;</a>.  You might add lines like this:</p><pre class="screen">
echo "Now executing .bash_profile.."
</pre><p>or like this:</p><pre class="screen">
echo "Now setting PS1 in .bashrc:"
export PS1="[some value]"
echo "PS1 is now set to $PS1"
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_03_02"></a>2. Variables</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_02_01"></a>2.1. Types of variables</h3></div></div></div><p>As seen in the examples above, shell variables<a class="indexterm" name="idm1904"></a> are in uppercase
characters by convention.  Bash keeps a list of two types of variables:</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_02_01_01"></a>2.1.1. Global variables</h4></div></div></div><p>Global variables<a class="indexterm" name="idm1910"></a> or environment<a class="indexterm" name="idm1913"></a> variables are available in all shells.  The <span class="command"><strong>env<a class="indexterm" name="idm1917"></a></strong></span> or <span class="command"><strong>printenv<a class="indexterm" name="idm1921"></a></strong></span> commands can be used to display environment variables.  These programs come with the <span class="emphasis"><em>sh-utils</em></span> package<a class="indexterm" name="idm1925"></a>.</p><p>Below is a typical output<a class="indexterm" name="idm1929"></a>:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>printenv</strong></span>
CC=gcc
CDPATH=.:~:/usr/local:/usr:/
CFLAGS=-O2 -fomit-frame-pointer
COLORTERM=gnome-terminal
CXXFLAGS=-O2 -fomit-frame-pointer
DISPLAY=:0
DOMAIN=hq.garrels.be
e=
TOR=vi
FCEDIT=vi
FIGNORE=.o:~
G_BROKEN_FILENAMES=1
GDK_USE_XFT=1
GDMSESSION=Default
GNOME_DESKTOP_SESSION_ID=Default
GTK_RC_FILES=/etc/gtk/gtkrc:/nethome/franky/.gtkrc-1.2-gnome2
GWMCOLOR=darkgreen
GWMTERM=xterm
HISTFILESIZE=5000
history_control=ignoredups
HISTSIZE=2000
HOME=/nethome/franky
HOSTNAME=octarine.hq.garrels.be
INPUTRC=/etc/inputrc
IRCNAME=franky
JAVA_HOME=/usr/java/j2sdk1.4.0
LANG=en_US
LDFLAGS=-s
LD_LIBRARY_PATH=/usr/lib/mozilla:/usr/lib/mozilla/plugins
LESSCHARSET=latin1
LESS=-edfMQ
LESSOPEN=|/usr/bin/lesspipe.sh %s
LEX=flex
LOCAL_MACHINE=octarine
LOGNAME=franky
LS_COLORS=no=00:fi=00:di=01;34:ln=01;36:pi=40;33:so=01;35:bd=40;33;01:cd=40;33;01:or=01;05;37;41:mi=01;05;37;41:ex=01;32:*.cmd=01;32:*.exe=01;32:*.com=01;32:*.btm=01;32:*.bat=01;32:*.sh=01;32:*.csh=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.gz=01;31:*.bz2=01;31:*.bz=01;31:*.tz=01;31:*.rpm=01;31:*.cpio=01;31:*.jpg=01;35:*.gif=01;35:*.bmp=01;35:*.xbm=01;35:*.xpm=01;35:*.png=01;35:*.tif=01;35:
MACHINES=octarine
MAILCHECK=60
MAIL=/var/mail/franky
MANPATH=/usr/man:/usr/share/man/:/usr/local/man:/usr/X11R6/man
MEAN_MACHINES=octarine
MOZ_DIST_BIN=/usr/lib/mozilla
MOZILLA_FIVE_HOME=/usr/lib/mozilla
MOZ_PROGRAM=/usr/lib/mozilla/mozilla-bin
MTOOLS_FAT_COMPATIBILITY=1
MYMALLOC=0
NNTPPORT=119
NNTPSERVER=news
NPX_PLUGIN_PATH=/plugin/ns4plugin/:/usr/lib/netscape/plugins
OLDPWD=/nethome/franky
OS=Linux
PAGER=less
PATH=/nethome/franky/bin.Linux:/nethome/franky/bin:/usr/local/bin:/usr/local/sbin:/usr/X11R6/bin:/usr/bin:/usr/sbin:/bin:/sbin:.
PS1=\[\033[1;44m\]franky is in \w\[\033[0m\]
PS2=More input&gt;
PWD=/nethome/franky
SESSION_MANAGER=local/octarine.hq.garrels.be:/tmp/.ICE-unix/22106
SHELL=/bin/bash
SHELL_LOGIN=--login
SHLVL=2
SSH_AGENT_PID=22161
SSH_ASKPASS=/usr/libexec/openssh/gnome-ssh-askpass
SSH_AUTH_SOCK=/tmp/ssh-XXmhQ4fC/agent.22106
START_WM=twm
TERM=xterm
TYPE=type
USERNAME=franky
USER=franky
_=/usr/bin/printenv
VISUAL=vi
WINDOWID=20971661
XAPPLRESDIR=/nethome/franky/app-defaults
XAUTHORITY=/nethome/franky/.Xauthority
XENVIRONMENT=/nethome/franky/.Xdefaults
XFILESEARCHPATH=/usr/X11R6/lib/X11/%L/%T/%N%C%S:/usr/X11R6/lib/X11/%l/%T/%N%C%S:/usr/X11R6/lib/X11/%T/%N%C%S:/usr/X11R6/lib/X11/%L/%T/%N%S:/usr/X11R6/lib/X11/%l/%T/%N%S:/usr/X11R6/lib/X11/%T/%N%S
XKEYSYMDB=/usr/X11R6/lib/X11/XKeysymDB
XMODIFIERS=@im=none
XTERMID=
XWINHOME=/usr/X11R6
X=X11R6
YACC=bison -y
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_02_01_02"></a>2.1.2. Local variables</h4></div></div></div><p>Local variables<a class="indexterm" name="idm1938"></a> are only available in the current shell.  Using the <span class="command"><strong>set</strong></span> built-in command without any options will display a list of all variables (including environment variables) and functions.  The output will be sorted according to the current locale and displayed in a reusable format.</p><p>Below is a diff file made by comparing <span class="command"><strong>printenv</strong></span> and <span class="command"><strong>set</strong></span> output, after leaving out the functions which are also displayed by the <span class="command"><strong>set</strong></span> command:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>diff <code class="filename">set.sorted</code> <code class="filename">printenv.sorted</code></strong></span> | <span class="command"><strong>grep <em class="parameter"><code>"&lt;"</code></em></strong></span> | <span class="command"><strong>awk <em class="parameter"><code>'{ print $2 }'</code></em></strong></span>
BASE=/nethome/franky/.Shell/hq.garrels.be/octarine.aliases
BASH=/bin/bash
BASH_VERSINFO=([0]="2"
BASH_VERSION='2.05b.0(1)-release'
COLUMNS=80
DIRSTACK=()
DO_FORTUNE=
EUID=504
GROUPS=()
HERE=/home/franky
HISTFILE=/nethome/franky/.bash_history
HOSTTYPE=i686
IFS=$'
LINES=24
MACHTYPE=i686-pc-linux-gnu
OPTERR=1
OPTIND=1
OSTYPE=linux-gnu
PIPESTATUS=([0]="0")
PPID=10099
PS4='+
PWD_REAL='pwd
SHELLOPTS=braceexpand:emacs:hashall:histexpand:history:interactive-comments:monitor
THERE=/home/franky
UID=504
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Awk</h3><p>the GNU Awk programming language is explained in <a class="xref" href="#chap_06" title="Chapter 6. The GNU awk programming language">Chapter 6, <i>The GNU awk programming language</i></a>.</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_02_01_03"></a>2.1.3. Variables by content</h4></div></div></div><p>Apart from dividing variables in local and global variables, we can also divide them in categories according to the sort of content the variable contains.  In this respect, variables come in 4 types<a class="indexterm" name="idm1962"></a>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>String variables</p></li><li class="listitem"><p>Integer variables</p></li><li class="listitem"><p>Constant variables</p></li><li class="listitem"><p>Array variables</p></li></ul></div><p>We'll discuss these types in <a class="xref" href="#chap_10" title="Chapter 10. More on variables">Chapter 10, <i>More on variables</i></a>.  For now, we will work with integer and string values for our variables.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_02_02"></a>2.2. Creating variables</h3></div></div></div><p>Variables<a class="indexterm" name="idm1979"></a> are case sensitive and capitalized by default.  Giving local variables a lowercase name is a convention which is sometimes applied.  However, you are free to use the names you want or to mix cases.  Variables can also contain digits, but a name starting with a digit is not allowed:</p><pre class="screen">
<code class="prompt">prompt&gt;</code> <span class="command"><strong>export <code class="varname">1number</code>=<em class="parameter"><code>1</code></em></strong></span>
bash: export: `1number=1': not a valid identifier
</pre><p>To set a variable in the shell, use</p><div class="cmdsynopsis"><p><code class="command"><code class="varname">VARNAME</code>="value"</code> </p></div><p>Putting spaces around the equal sign will cause errors.  It is a good habit to quote content strings when assigning values to variables: this will reduce the chance that you make errors.</p><p>Some examples using upper and lower cases, numbers and spaces:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong><code class="varname">MYVAR1</code>=<em class="parameter"><code>"2"</code></em></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$MYVAR1</code></strong></span>
2

<code class="prompt">franky ~&gt;</code> <span class="command"><strong><code class="varname">first_name</code>=<em class="parameter"><code>"Franky"</code></em></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$first_name</code></strong></span>
Franky

<code class="prompt">franky ~&gt;</code> <span class="command"><strong><code class="varname">full_name</code>=<em class="parameter"><code>"Franky M. Singh"</code></em></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$full_name</code></strong></span>
Franky M. Singh

<code class="prompt">franky ~&gt;</code> <span class="command"><strong><code class="varname">MYVAR-2</code>=<em class="parameter"><code>"2"</code></em></strong></span>
bash: MYVAR-2=2: command not found

<code class="prompt">franky ~&gt;</code> <span class="command"><strong><code class="varname">MYVAR1</code> =<em class="parameter"><code>"2"</code></em></strong></span>
bash: MYVAR1: command not found

<code class="prompt">franky ~&gt;</code> <span class="command"><strong><code class="varname">MYVAR1</code>= <em class="parameter"><code>"2"</code></em></strong></span>
bash: 2: command not found

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>unset <code class="varname">MYVAR1</code> <code class="varname">first_name</code> <code class="varname">full_name</code></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$MYVAR1</code> <code class="varname">$first_name</code> <code class="varname">$full_name</code></strong></span>
&lt;--no output--&gt;

<code class="prompt">franky ~&gt;</code>
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_02_03"></a>2.3. Exporting variables</h3></div></div></div><p>A variable<a class="indexterm" name="idm2041"></a> created like the ones in the example above is only available to the current shell.  It is a local variable: child processes of the current shell will not be aware of this variable.  In order to pass variables to a subshell, we need to <span class="emphasis"><em>export</em></span> them using the <span class="command"><strong>export<a class="indexterm" name="idm2046"></a></strong></span> built-in command.  Variables that are exported are referred to as environment variables.  Setting and exporting is usually done in one step:</p><div class="cmdsynopsis"><p><code class="command">export <code class="varname">VARNAME</code>="<em class="parameter"><code>value</code></em>"</code> </p></div><p>A subshell<a class="indexterm" name="idm2054"></a> can change variables it inherited from the parent, but the changes made by the child don't affect the parent.  This is demonstrated in the example:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong><code class="varname">full_name</code>=<em class="parameter"><code>"Franky M. Singh"</code></em></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>bash</strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$full_name</code></strong></span>


<code class="prompt">franky ~&gt;</code> <span class="command"><strong>exit</strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>export <code class="varname">full_name</code></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>bash</strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$full_name</code></strong></span>
Franky M. Singh

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>export <code class="varname">full_name</code>=<em class="parameter"><code>"Charles the Great"</code></em></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$full_name</code></strong></span>
Charles the Great

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>exit</strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$full_name</code></strong></span>
Franky M. Singh

<code class="prompt">franky ~&gt;</code>
</pre><p>When first trying to read the value of <code class="varname">full_name</code> in a subshell, it is not there (<span class="command"><strong>echo</strong></span> shows a null string).  The subshell quits, and <code class="varname">full_name</code> is exported in the parent - a variable can be exported after it has been assigned a value.  Then a new subshell is started, in which the variable exported from the parent is visible.  The variable is changed to hold another name, but the value for this variable in the parent stays the same.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_02_04"></a>2.4. Reserved variables</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_02_04_01"></a>2.4.1. Bourne shell reserved variables</h4></div></div></div><p>Bash uses certain shell variables<a class="indexterm" name="idm2099"></a> in the same way as the Bourne shell.  In some cases, Bash assigns a default value to the variable.  The table below gives an overview of these plain shell variables:</p><div class="table"><a name="table_03_01"></a><p class="title"><b>Table 3.1. Reserved Bourne shell variables</b></p><div class="table-contents"><table class="table" summary="Reserved Bourne shell variables" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Variable name</th><th align="left">Definition</th></tr></thead><tbody><tr><td align="left">CDPATH</td><td align="left">A colon-separated list of directories used as a search path for the <span class="command"><strong>cd</strong></span> built-in command.</td></tr><tr><td align="left">HOME</td><td align="left">The current user's home directory; the default for the <span class="command"><strong>cd</strong></span> built-in.  The value of this variable is also used by tilde expansion.</td></tr><tr><td align="left">IFS</td><td align="left">A list of characters that separate fields; used when the shell splits words as part of expansion.</td></tr><tr><td align="left">MAIL</td><td align="left">If this parameter is set to a file name and the <code class="varname">MAILPATH</code> variable is not set, Bash informs the user of the arrival of mail in the specified file.</td></tr><tr><td align="left">MAILPATH</td><td align="left">A colon-separated list of file names which the shell periodically checks for new mail.</td></tr><tr><td align="left">OPTARG</td><td align="left">The value of the last option argument processed by the <span class="command"><strong>getopts</strong></span> built-in.</td></tr><tr><td align="left">OPTIND</td><td align="left">The index of the last option argument processed by the <span class="command"><strong>getopts</strong></span> built-in.</td></tr><tr><td align="left">PATH</td><td align="left">A colon-separated list of directories in which the shell looks for commands.</td></tr><tr><td align="left">PS1</td><td align="left">The primary prompt string.  The default value is <span class="quote">&#8220;<span class="quote">'\s-\v\$ '</span>&#8221;</span>.  </td></tr><tr><td align="left">PS2</td><td align="left">The secondary prompt string.  The default value is <span class="quote">&#8220;<span class="quote">'&gt; '</span>&#8221;</span>.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_03_02_04_02"></a>2.4.2. Bash reserved variables</h4></div></div></div><p>These variables are set or used by Bash<a class="indexterm" name="idm2150"></a>, but other shells do not normally treat them specially.</p><div class="table"><a name="table_03_02"></a><p class="title"><b>Table 3.2. Reserved Bash variables</b></p><div class="table-contents"><table class="table" summary="Reserved Bash variables" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Variable name</th><th align="left">Definition</th></tr></thead><tbody><tr><td align="left">auto_resume</td><td align="left">This variable controls how the shell interacts with the user and job control.</td></tr><tr><td align="left">BASH</td><td align="left">The full pathname used to execute the current instance of Bash.</td></tr><tr><td align="left">BASH_ENV</td><td align="left">If this variable is set when Bash is invoked to execute a shell script, its value is expanded and used as the name of a startup file to read before executing the script.</td></tr><tr><td align="left">BASH_VERSION</td><td align="left">The version number of the current instance of Bash.</td></tr><tr><td align="left">BASH_VERSINFO</td><td align="left">A read-only array variable whose members hold version information for this instance of Bash.</td></tr><tr><td align="left">COLUMNS</td><td align="left">Used by the <span class="command"><strong>select</strong></span> built-in to determine the terminal width when printing selection lists.  Automatically set upon receipt of a <span class="emphasis"><em>SIGWINCH</em></span> signal.</td></tr><tr><td align="left">COMP_CWORD</td><td align="left">An index into <code class="varname">${COMP_WORDS}</code> of the word containing the current cursor position.</td></tr><tr><td align="left">COMP_LINE</td><td align="left">The current command line.</td></tr><tr><td align="left">COMP_POINT</td><td align="left">The index of the current cursor position relative to the beginning of the current command.</td></tr><tr><td align="left">COMP_WORDS</td><td align="left">An array variable consisting of the individual words in the current command line.</td></tr><tr><td align="left">COMPREPLY</td><td align="left">An array variable from which Bash reads the possible completions generated by a shell function invoked by the programmable completion facility.</td></tr><tr><td align="left">DIRSTACK</td><td align="left">An array variable containing the current contents of the directory stack.</td></tr><tr><td align="left">EUID</td><td align="left">The numeric effective user ID of the current user.</td></tr><tr><td align="left">FCEDIT</td><td align="left">The editor used as a default by the <code class="option">-e</code> option to the <span class="command"><strong>fc</strong></span> built-in command.</td></tr><tr><td align="left">FIGNORE</td><td align="left">A colon-separated list of suffixes to ignore when performing file name completion.</td></tr><tr><td align="left">FUNCNAME</td><td align="left">The name of any currently-executing shell function.</td></tr><tr><td align="left">GLOBIGNORE</td><td align="left">A colon-separated list of patterns defining the set of file names to be ignored by file name expansion.</td></tr><tr><td align="left">GROUPS</td><td align="left">An array variable containing the list of groups of which the current user is a member.</td></tr><tr><td align="left">histchars</td><td align="left">Up to three characters which control history expansion, quick substitution, and <span class="emphasis"><em>tokenization</em></span>.</td></tr><tr><td align="left">HISTCMD</td><td align="left">The history number, or index in the history list, of the current command.</td></tr><tr><td align="left">HISTCONTROL</td><td align="left">Defines whether a command is added to the history file.</td></tr><tr><td align="left">HISTFILE</td><td align="left">The name of the file to which the command history is saved.  The default value is <code class="filename">~/.bash_history</code>.</td></tr><tr><td align="left">HISTFILESIZE</td><td align="left">The maximum number of lines contained in the history file, defaults to 500.</td></tr><tr><td align="left">HISTIGNORE</td><td align="left">A colon-separated list of patterns used to decide which command lines should be saved in the history list.</td></tr><tr><td align="left">HISTSIZE</td><td align="left">The maximum number of commands to remember on the history list, default is 500.</td></tr><tr><td align="left">HOSTFILE</td><td align="left">Contains the name of a file in the same format as <code class="filename">/etc/hosts</code> that should be read when the shell needs to complete a hostname.</td></tr><tr><td align="left">HOSTNAME</td><td align="left">The name of the current host.</td></tr><tr><td align="left">HOSTTYPE</td><td align="left">A string describing the machine Bash is running on.</td></tr><tr><td align="left">IGNOREEOF</td><td align="left">Controls the action of the shell on receipt of an <span class="emphasis"><em>EOF</em></span> character as the sole input.</td></tr><tr><td align="left">INPUTRC</td><td align="left">The name of the Readline initialization file, overriding the default <code class="filename">/etc/inputrc</code>.</td></tr><tr><td align="left">LANG</td><td align="left">Used to determine the locale category for any category not specifically selected with a variable starting with <code class="varname">LC_</code>.</td></tr><tr><td align="left">LC_ALL</td><td align="left">This variable overrides the value of <code class="varname">LANG</code> and any other <code class="varname">LC_</code> variable specifying a locale category.</td></tr><tr><td align="left">LC_COLLATE</td><td align="left">This variable determines the collation order used when sorting the results of file name expansion, and determines the behavior of range expressions, equivalence classes, and collating sequences within file name expansion and pattern matching.</td></tr><tr><td align="left">LC_CTYPE</td><td align="left">This variable determines the interpretation of characters and the behavior of character classes within file name expansion and pattern matching.</td></tr><tr><td align="left">LC_MESSAGES</td><td align="left">This variable determines the locale used to translate double-quoted strings preceded by a <span class="quote">&#8220;<span class="quote">$</span>&#8221;</span> sign.</td></tr><tr><td align="left">LC_NUMERIC</td><td align="left">This variable determines the locale category used for number formatting.</td></tr><tr><td align="left">LINENO</td><td align="left">The line number in the script or shell function currently executing.</td></tr><tr><td align="left">LINES</td><td align="left">Used by the <span class="command"><strong>select</strong></span> built-in to determine the column length for printing selection lists.</td></tr><tr><td align="left">MACHTYPE</td><td align="left">A string that fully describes the system type on which Bash is executing, in the standard GNU CPU-COMPANY-SYSTEM format.</td></tr><tr><td align="left">MAILCHECK</td><td align="left">How often (in seconds) that the shell should check for mail in the files specified in the <code class="varname">MAILPATH</code> or <code class="varname">MAIL</code> variables.</td></tr><tr><td align="left">OLDPWD</td><td align="left">The previous working directory as set by the <span class="command"><strong>cd</strong></span> built-in.</td></tr><tr><td align="left">OPTERR</td><td align="left">If set to the value 1, Bash displays error messages generated by the <span class="command"><strong>getopts</strong></span> built-in.</td></tr><tr><td align="left">OSTYPE</td><td align="left">A string describing the operating system Bash is running on.</td></tr><tr><td align="left">PIPESTATUS</td><td align="left">An array variable containing a list of exit status values from the processes in the most recently executed foreground pipeline (which may contain only a single command).</td></tr><tr><td align="left">POSIXLY_CORRECT</td><td align="left">If this variable is in the environment when <span class="command"><strong>bash</strong></span> starts, the shell enters POSIX mode.</td></tr><tr><td align="left">PPID</td><td align="left">The process ID of the shell's parent process.</td></tr><tr><td align="left">PROMPT_COMMAND</td><td align="left">If set, the value is interpreted as a command to execute before the printing of each primary prompt (<code class="varname">PS1</code>).</td></tr><tr><td align="left">PS3</td><td align="left">The value of this variable is used as the prompt for the <span class="command"><strong>select</strong></span> command.  Defaults to <span class="quote">&#8220;<span class="quote">'#? '</span>&#8221;</span></td></tr><tr><td align="left">PS4</td><td align="left">The value is the prompt printed before the command line is echoed when the <code class="option">-x</code> option is set; defaults to <span class="quote">&#8220;<span class="quote">'+ '</span>&#8221;</span>.</td></tr><tr><td align="left">PWD</td><td align="left">The current working directory as set by the <span class="command"><strong>cd</strong></span> built-in command.</td></tr><tr><td align="left">RANDOM</td><td align="left">Each time this parameter is referenced, a random integer between 0 and 32767 is generated.  Assigning a value to this variable seeds the random number generator.</td></tr><tr><td align="left">REPLY</td><td align="left">The default variable for the <span class="command"><strong>read</strong></span> built-in.</td></tr><tr><td align="left">SECONDS</td><td align="left">This variable expands to the number of seconds since the shell was started.</td></tr><tr><td align="left">SHELLOPTS</td><td align="left">A colon-separated list of enabled shell options.</td></tr><tr><td align="left">SHLVL</td><td align="left">Incremented by one each time a new instance of Bash is started.</td></tr><tr><td align="left">TIMEFORMAT</td><td align="left">The value of this parameter is used as a format string specifying
     how the timing information for pipelines prefixed with the <span class="command"><strong>time</strong></span> reserved word should be displayed.</td></tr><tr><td align="left">TMOUT</td><td align="left">If set to a value greater than zero, <code class="varname">TMOUT</code> is treated as the default timeout for the <span class="command"><strong>read</strong></span> built-in.  In an interative shell, the value is interpreted as the number of seconds to wait for input after issuing the primary prompt when the shell is interactive.  Bash terminates after that number of seconds if input does not arrive.</td></tr><tr><td align="left">UID</td><td align="left">The numeric, real user ID of the current user.</td></tr></tbody></table></div></div><br class="table-break"><p>Check the Bash man, info or doc pages for extended information.  Some variables are read-only, some are set automatically and some lose their meaning when set to a different value than the default.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_02_05"></a>2.5. Special parameters</h3></div></div></div><p>The shell treats several parameters<a class="indexterm" name="idm2369"></a> specially.  These parameters may only be referenced; assignment to them is not allowed.</p><div class="table"><a name="table_03_03"></a><p class="title"><b>Table 3.3. Special bash variables</b></p><div class="table-contents"><table class="table" summary="Special bash variables" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Character</th><th align="left">Definition</th></tr></thead><tbody><tr><td align="left"><code class="varname">$*</code></td><td align="left">Expands to the positional parameters, starting from one.  When the expansion occurs within double quotes, it expands to a single word with the value of each parameter separated by the first character of the <code class="varname">IFS</code> special variable.</td></tr><tr><td align="left"><code class="varname">$@</code></td><td align="left">Expands to the positional parameters, starting from one.  When the expansion occurs within double quotes, each parameter expands to a separate word.</td></tr><tr><td align="left"><code class="varname">$#</code></td><td align="left">Expands to the number of positional parameters in decimal.</td></tr><tr><td align="left"><code class="varname">$?</code></td><td align="left">Expands to the exit status of the most recently executed foreground pipeline.</td></tr><tr><td align="left"><code class="varname">$-</code></td><td align="left">A hyphen expands to the current option flags as specified upon invocation, by the <span class="command"><strong>set</strong></span> built-in command, or those set by the shell itself (such as the <code class="option">-i</code>).</td></tr><tr><td align="left"><code class="varname">$$</code></td><td align="left">Expands to the process ID of the shell.</td></tr><tr><td align="left"><code class="varname">$!</code></td><td align="left">Expands to the process ID of the most recently executed background (asynchronous) command.</td></tr><tr><td align="left"><code class="varname">$0</code></td><td align="left">Expands to the name of the shell or shell script.</td></tr><tr><td align="left"><code class="varname">$_</code></td><td align="left">The underscore variable is set at shell startup and contains the absolute file name of the shell or script being executed as passed in the argument list.  Subsequently, it expands to the last argument to the previous command, after expansion.  It is also set to the full pathname of each command executed and placed in the environment exported to that command.  When checking mail, this parameter holds the name of the mail file.
</td></tr></tbody></table></div></div><br class="table-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">$* vs. $@</h3><p>The implementation of <span class="quote">&#8220;<span class="quote">$*</span>&#8221;</span> has always been a problem and realistically should have been replaced with the behavior of <span class="quote">&#8220;<span class="quote">$@</span>&#8221;</span>.  In almost every case where coders use <span class="quote">&#8220;<span class="quote">$*</span>&#8221;</span>, they mean <span class="quote">&#8220;<span class="quote">$@</span>&#8221;</span>.  <span class="quote">&#8220;<span class="quote">$*</span>&#8221;</span> Can cause bugs and even security holes in your software.</p></div><p>The positional parameters<a class="indexterm" name="idm2428"></a> are the words following the name of a shell script.  They are put into the variables <code class="varname">$1</code>, <code class="varname">$2</code>, <code class="varname">$3</code> and so on.  As long as needed, variables are added to an internal array.  <code class="varname">$#</code> holds the total number of parameters, as is demonstrated with this simple<a class="indexterm" name="idm2435"></a> script:</p><pre class="screen">
#!/bin/bash

# positional.sh
# This script reads 3 positional parameters and prints them out.

POSPAR1="$1"
POSPAR2="$2"
POSPAR3="$3"

echo "$1 is the first positional parameter, \$1."
echo "$2 is the second positional parameter, \$2."
echo "$3 is the third positional parameter, \$3."
echo
echo "The total number of positional parameters is $#."
</pre><p>Upon execution one could give any numbers of arguments<a class="indexterm" name="idm2440"></a>:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>positional.sh <em class="parameter"><code>one two three four five</code></em></strong></span>
one is the first positional parameter, $1.
two is the second positional parameter, $2.
three is the third positional parameter, $3.

The total number of positional parameters is 5.

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>positional.sh <em class="parameter"><code>one two</code></em></strong></span>
one is the first positional parameter, $1.
two is the second positional parameter, $2.
 is the third positional parameter, $3.

The total number of positional parameters is 2.
</pre><p>More on evaluating these parameters is in <a class="xref" href="#chap_07" title="Chapter 7. Conditional statements">Chapter 7, <i>Conditional statements</i></a> and <a class="xref" href="#sect_09_07" title="7. The shift built-in">Section 7, &#8220;The shift built-in&#8221;</a>.</p><p>Some examples on the other special parameters<a class="indexterm" name="idm2454"></a>:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>dictionary</code></em> <code class="filename">/usr/share/dict/words</code></strong></span>
dictionary

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$_</code></strong></span>
/usr/share/dict/words

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$$</code></strong></span>
10662

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>mozilla &amp;</strong></span>
[1] 11064

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$!</code></strong></span>
11064

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$0</code></strong></span>
bash

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$?</code></strong></span>
0

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>ls <code class="filename">doesnotexist</code></strong></span>
ls: doesnotexist: No such file or directory

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$?</code></strong></span>
1

<code class="prompt">franky ~&gt;</code>
</pre><p>User <span class="emphasis"><em>franky</em></span> starts entering the <span class="command"><strong>grep</strong></span> command, which results in the assignment of the <code class="varname">_</code> variable.  The process ID of his shell is 10662.  After putting a job in the background, the <code class="varname">!</code> holds the process ID of the backgrounded job.  The shell running is <span class="command"><strong>bash</strong></span>.  When a mistake is made, <code class="varname">?</code> holds an exit code different from 0 (zero).</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_02_06"></a>2.6. Script recycling with variables</h3></div></div></div><p>Apart<a class="indexterm" name="idm2496"></a> from making the script more readable, variables will also enable you to faster apply a script in another environment or for another purpose.  Consider the following example, a very simple script that makes a backup of <span class="emphasis"><em>franky</em></span>'s home directory to a remote server:</p><pre class="screen">
#!/bin/bash

# This script makes a backup of my home directory.

cd /home

# This creates the archive
tar cf /var/tmp/home_franky.tar franky &gt; /dev/null 2&gt;&amp;1

# First remove the old bzip2 file.  Redirect errors because this generates some if the archive
# does not exist.  Then create a new compressed file.
rm /var/tmp/home_franky.tar.bz2 2&gt; /dev/null
bzip2 /var/tmp/home_franky.tar

# Copy the file to another host - we have ssh keys for making this work without intervention.
scp /var/tmp/home_franky.tar.bz2 bordeaux:/opt/backup/franky &gt; /dev/null 2&gt;&amp;1

# Create a timestamp in a logfile.
date &gt;&gt; /home/franky/log/home_backup.log
echo backup succeeded &gt;&gt; /home/franky/log/home_backup.log
</pre><p>First of all, you are more likely to make errors if you name files and directories manually each time you need them.  Secondly, suppose <span class="emphasis"><em>franky</em></span> wants to give this script to <span class="emphasis"><em>carol</em></span>, then carol will have to do quite some editing before she can use the script to back up her home directory.  The same is true if <span class="emphasis"><em>franky</em></span> wants to use this script for backing up other directories.  For easy recycling, make all files, directories, usernames, servernames etcetera variable.  Thus, you only need to edit a value once, without having to go through the entire script to check where a parameter occurs.  This is an example:</p><pre class="screen">
#!/bin/bash
                                                                                                 
# This script makes a backup of my home directory.

# Change the values of the variables to make the script work for you:
BACKUPDIR=/home
BACKUPFILES=franky
TARFILE=/var/tmp/home_franky.tar
BZIPFILE=/var/tmp/home_franky.tar.bz2
SERVER=bordeaux
REMOTEDIR=/opt/backup/franky
LOGFILE=/home/franky/log/home_backup.log

cd $BACKUPDIR

# This creates the archive
tar cf $TARFILE $BACKUPFILES &gt; /dev/null 2&gt;&amp;1
                                                                                                 
# First remove the old bzip2 file.  Redirect errors because this generates some if the archive 
# does not exist.  Then create a new compressed file.
rm $BZIPFILE 2&gt; /dev/null
bzip2 $TARFILE

# Copy the file to another host - we have ssh keys for making this work without intervention.
scp $BZIPFILE $SERVER:$REMOTEDIR &gt; /dev/null 2&gt;&amp;1

# Create a timestamp in a logfile.
date &gt;&gt; $LOGFILE
echo backup succeeded &gt;&gt; $LOGFILE
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Large directories and low bandwidth</h3><p>The above is purely an example that everybody can understand, using a small directory and a host on the same subnet.  Depending on your bandwidth, the size of the directory and the location of the remote server, it can take an awful lot of time to make backups using this mechanism.  For larger directories and lower bandwidth, use <span class="command"><strong>rsync</strong></span> to keep the directories at both ends synchronized.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_03_03"></a>3. Quoting characters</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_03_01"></a>3.1. Why?</h3></div></div></div><p>A lot of keys have special meanings in some context or other.  Quoting is used to remove the special meaning of characters or words: quotes can disable special treatment for special characters, they can prevent reserved words from being recognized as such and they can disable parameter expansion.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_03_02"></a>3.2. Escape characters</h3></div></div></div><p>Escape characters<a class="indexterm" name="idm2518"></a> are used to remove the special meaning from a single character.  A non-quoted backslash, \, is used as an escape character in Bash.  It preserves the literal value of the next character that follows, with the exception of <span class="emphasis"><em>newline</em></span>.  If a newline character appears immediately after the backslash, it marks the continuation of a line when it is longer that the width of the terminal; the backslash is removed from the input stream and effectively ignored.</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong><code class="varname">date</code>=<em class="parameter"><code>20021226</code></em></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$date</code></strong></span>
20021226

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>\$date</code></em></strong></span>
$date
</pre><p>In this example, the variable <code class="varname">date</code> is created and set to hold a value.  The first <span class="command"><strong>echo</strong></span> displays the value of the variable, but for the second, the dollar sign is escaped.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_03_03"></a>3.3. Single quotes</h3></div></div></div><p>Single<a class="indexterm" name="idm2539"></a> quotes ('') are used to preserve the literal value of each character enclosed within the quotes.  A single quote may not occur between single quotes, even when preceded by a backslash.</p><p>We continue with the previous example:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>'$date'</code></em></strong></span>
$date
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_03_04"></a>3.4. Double quotes</h3></div></div></div><p>Using double<a class="indexterm" name="idm2550"></a> quotes the literal value of all characters enclosed is preserved, except for the dollar sign, the backticks (backward single quotes, ``) and the backslash.</p><p>The dollar sign and the backticks retain their special meaning within the double quotes.</p><p>The backslash retains its meaning only when followed by dollar, backtick, double quote, backslash or newline.  Within double quotes, the backslashes are removed from the input stream when followed by one of these characters.  Backslashes preceding characters that don't have a special meaning are left unmodified for processing by the shell interpreter.</p><p>A double quote may be quoted within double quotes by preceding it with a backslash.</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">"$date"</code></strong></span>
20021226

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>"`date`"</code></em></strong></span>
Sun Apr 20 11:22:06 CEST 2003

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>"I'd say: \"Go for it!\""</code></em></strong></span>
I'd say: "Go for it!"

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>"\"</code></em></strong></span>
<code class="prompt">More input&gt;</code><span class="command"><strong>"</strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>"\\"</code></em></strong></span>
\
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_03_05"></a>3.5. ANSI-C quoting</h3></div></div></div><p>Words<a class="indexterm" name="idm2577"></a> in the form <span class="quote">&#8220;<span class="quote">$'STRING'</span>&#8221;</span> are treated in a special way.  The word expands to a string, with backslash-escaped characters replaced as specified by the ANSI-C<a class="indexterm" name="idm2581"></a> standard.  Backslash escape sequences can be found in the Bash documentation.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_03_06"></a>3.6. Locales</h3></div></div></div><p>A double-quoted<a class="indexterm" name="idm2587"></a> string preceded by a dollar sign will cause the string to be translated according to the current locale.  If the current locale is <span class="quote">&#8220;<span class="quote">C</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">POSIX</span>&#8221;</span>, the dollar sign is ignored.  If the string is translated and replaced, the replacement is double-quoted.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_03_04"></a>4. Shell expansion</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_0"></a>4.1. General</h3></div></div></div><p>After the command has been split into <span class="emphasis"><em>tokens</em></span> (see <a class="xref" href="#sect_01_04_01_01" title="4.1.1. Shell syntax">Section 4.1.1, &#8220;Shell syntax&#8221;</a>), these tokens or words are expanded or resolved.  There are eight kinds of expansion performed, which we will discuss in the next sections, in the order that they are expanded.</p><p>After all expansions, quote removal is performed.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_01"></a>4.2. Brace expansion</h3></div></div></div><p>Brace expansion<a class="indexterm" name="idm2603"></a> is a mechanism by which arbitrary strings may be generated.  Patterns to be brace-expanded take the form of an optional <span class="emphasis"><em>PREAMBLE</em></span>, followed by a series of comma-separated strings between a pair of braces, followed by an optional <span class="emphasis"><em>POSTSCRIPT</em></span>.  The preamble is prefixed to each string contained within the braces, and the postscript is then appended to each resulting string, expanding left to right.</p><p>Brace expansions<a class="indexterm" name="idm2609"></a> may be nested.  The results of each expanded string are not sorted; left to right order is preserved:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>sp{el,il,al}l</code></em></strong></span>
spell spill spall
</pre><p>Brace expansion is performed before any other expansions, and any characters special to other expansions are preserved in the result.  It is strictly textual.  Bash does not apply any syntactic interpretation to the context of the expansion or the text between the braces.  To avoid conflicts with parameter expansion, the string <span class="quote">&#8220;<span class="quote">${</span>&#8221;</span> is not considered eligible for brace expansion.</p><p>A correctly-formed brace expansion must contain unquoted opening and closing braces, and at least one unquoted comma.  Any incorrectly formed brace expansion is left unchanged.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_02"></a>4.3. Tilde expansion</h3></div></div></div><p>If a word begins with an unquoted tilde character<a class="indexterm" name="idm2622"></a> (<span class="quote">&#8220;<span class="quote">~</span>&#8221;</span>), all of the characters up to the first unquoted slash (or all characters, if there is no unquoted slash) are considered a <span class="emphasis"><em>tilde-prefix</em></span>.  If none of the characters in the tilde-prefix are quoted, the characters in the tilde-prefix following the tilde are treated as a possible login name.  If this login name is the null string, the tilde is replaced with the value of the <code class="varname">HOME</code> shell variable.  If <code class="varname">HOME</code> is unset, the home directory of the user executing the shell is substituted instead.  Otherwise, the tilde-prefix is replaced with the home directory associated with the specified login name.</p><p>If the tilde-prefix<a class="indexterm" name="idm2630"></a> is <span class="quote">&#8220;<span class="quote">~+</span>&#8221;</span>, the value of the shell variable <code class="varname">PWD</code> replaces the tilde-prefix.  If the tilde-prefix is <span class="quote">&#8220;<span class="quote">~-</span>&#8221;</span>, the value of the shell variable <code class="varname">OLDPWD</code>, if it is set, is substituted.</p><p>If the characters following the tilde in the tilde-prefix consist of a number N, optionally prefixed by a <span class="quote">&#8220;<span class="quote">+</span>&#8221;</span> or a <span class="quote">&#8220;<span class="quote">-</span>&#8221;</span>, the tilde-prefix is replaced with the corresponding element from the directory stack, as it would be displayed by the <span class="command"><strong>dirs</strong></span> built-in invoked with the characters following tilde in the tilde-prefix as an argument.  If the tilde-prefix, without the tilde, consists of a number without a leading <span class="quote">&#8220;<span class="quote">+</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">-</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">+</span>&#8221;</span> is assumed.</p><p>If the login name is invalid, or the tilde expansion fails, the word
is left unchanged.</p><p>Each variable assignment is checked for unquoted tilde-prefixes immediately following a <span class="quote">&#8220;<span class="quote">:</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">=</span>&#8221;</span>.  In these cases, tilde expansion is also performed.  Consequently, one may use file names with tildes in assignments to <code class="varname">PATH</code>, <code class="varname">MAILPATH</code>, and <code class="varname">CDPATH</code>, and the shell assigns the expanded value.</p><p>Example:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>export <code class="varname">PATH</code>=<em class="parameter"><code>"$PATH:~/testdir"</code></em></strong></span>
</pre><p><code class="filename">~/testdir</code> will be expanded to <code class="varname">$HOME</code><code class="filename">/testdir</code>, so if <code class="varname">$HOME</code> is <code class="filename">/var/home/franky</code>, the directory <code class="filename">/var/home/franky/testdir</code> will be added to the content of the <code class="varname">PATH</code> variable.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_03"></a>4.4. Shell parameter and variable expansion</h3></div></div></div><p>The <span class="quote">&#8220;<span class="quote">$</span>&#8221;</span> character<a class="indexterm" name="idm2669"></a> introduces parameter expansion, command substitution, or arithmetic expansion.  The parameter name or symbol to be expanded may be enclosed in braces, which are optional but serve to protect the variable to be expanded from characters immediately following it which could be interpreted as part of the name.</p><p>When braces are used, the matching ending brace is the first <span class="quote">&#8220;<span class="quote">}</span>&#8221;</span> not escaped by a backslash or within a quoted string, and not within an embedded arithmetic expansion, command substitution, or parameter expansion.</p><p>The basic form of parameter expansion is <span class="quote">&#8220;<span class="quote">${PARAMETER}</span>&#8221;</span>.  The value of <span class="quote">&#8220;<span class="quote">PARAMETER</span>&#8221;</span> is substituted.  The braces are required when <span class="quote">&#8220;<span class="quote">PARAMETER</span>&#8221;</span> is a positional parameter with more than one digit, or when <span class="quote">&#8220;<span class="quote">PARAMETER</span>&#8221;</span> is followed by a character that is not to be interpreted as part of its name.</p><p>If the first character of <span class="quote">&#8220;<span class="quote">PARAMETER</span>&#8221;</span> is an exclamation point,  Bash uses the value of the variable formed from the rest of <span class="quote">&#8220;<span class="quote">PARAMETER</span>&#8221;</span> as the name of the variable; this variable is then expanded and that value is used in the rest of the substitution, rather than the value of <span class="quote">&#8220;<span class="quote">PARAMETER</span>&#8221;</span> itself.  This is known as <span class="emphasis"><em>indirect expansion</em></span>.</p><p>You are certainly familiar with straight parameter expansion, since it happens all the time, even in the simplest of cases, such as the one above or the following<a class="indexterm" name="idm2685"></a>:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$SHELL</code></strong></span>
/bin/bash
</pre><p>The following is an example of indirect expansion<a class="indexterm" name="idm2693"></a>:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">${!N*}</code></strong></span>
NNTPPORT NNTPSERVER NPX_PLUGIN_PATH
</pre><p>Note that this is not the same as <span class="command"><strong>echo <code class="varname">$N*</code></strong></span>.</p><p>The following construct allows for creation of the named variable if it does not yet exist:</p><div class="cmdsynopsis"><p><code class="command">${<code class="varname">VAR</code>:=<em class="parameter"><code>value</code></em>}</code> </p></div><p>Example:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <code class="varname">$FRANKY</code></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>${FRANKY:=Franky}</code></em></strong></span>
Franky
</pre><p>Special parameters, among others the positional parameters, may not be assigned this way, however.</p><p>We will further discuss the use of the curly braces for treatment of variables in <a class="xref" href="#chap_10" title="Chapter 10. More on variables">Chapter 10, <i>More on variables</i></a>.  More information can also be found in the Bash info pages.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_04"></a>4.5. Command substitution</h3></div></div></div><p>Command substitution<a class="indexterm" name="idm2722"></a> allows the output of a command to replace the
command itself.  Command substitution<a class="indexterm" name="idm2725"></a> occurs when a command is enclosed like this:</p><div class="cmdsynopsis"><p><code class="command">$(command)</code> </p></div><p>or like this using backticks:</p><div class="cmdsynopsis"><p><code class="command">`command`</code> </p></div><p>Bash performs the expansion by executing COMMAND and replacing the command substitution with the standard output of the command, with any trailing newlines deleted.  Embedded newlines are not deleted, but they may be removed during word splitting.</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>`date`</code></em></strong></span>
Thu Feb 6 10:06:20 CET 2003
</pre><p>When the old-style backquoted form of substitution is used, backslash retains its literal meaning except when followed by <span class="quote">&#8220;<span class="quote">$</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">`</span>&#8221;</span>, or <span class="quote">&#8220;<span class="quote">\</span>&#8221;</span>.  The first backticks not preceded by a backslash terminates the command substitution.  When using the <span class="quote">&#8220;<span class="quote">$(COMMAND)</span>&#8221;</span> form, all characters between the parentheses make up the command; none are treated specially.</p><p>Command substitutions may be nested.  To nest when using the backquoted form, escape the inner backticks with backslashes.</p><p>If the substitution appears within double quotes, word splitting and file name expansion are not performed on the results.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_05"></a>4.6. Arithmetic expansion</h3></div></div></div><p>Arithmetic expansion<a class="indexterm" name="idm2748"></a> allows the evaluation of an arithmetic expression<a class="indexterm" name="idm2751"></a> and the substitution of the result.  The format for arithmetic expansion is:</p><div class="cmdsynopsis"><p><code class="command">$(( EXPRESSION ))</code> </p></div><p>The expression is treated as if it were within double quotes, but a double quote inside the parentheses is not treated specially.  All tokens in the expression undergo parameter expansion, command substitution, and quote removal.  Arithmetic substitutions may be nested.</p><p>Evaluation of arithmetic expressions is done in fixed-width integers with no check for overflow - although division by zero is trapped and recognized as an error.  The operators are roughly the same as in the C programming language.  In order of decreasing precedence<a class="indexterm" name="idm2758"></a>, the list looks like this:</p><div class="table"><a name="table_03_04"></a><p class="title"><b>Table 3.4. Arithmetic operators</b></p><div class="table-contents"><table class="table" summary="Arithmetic operators" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Operator</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left">VAR++ and VAR--</td><td align="left">variable post-increment and post-decrement</td></tr><tr><td align="left">++VAR and --VAR</td><td align="left">variable pre-increment and pre-decrement</td></tr><tr><td align="left">- and +</td><td align="left">unary minus and plus</td></tr><tr><td align="left">! and ~</td><td align="left">logical and bitwise negation</td></tr><tr><td align="left">**</td><td align="left">exponentiation</td></tr><tr><td align="left">*, / and %</td><td align="left">multiplication, division, remainder</td></tr><tr><td align="left">+ and -</td><td align="left">addition, subtraction</td></tr><tr><td align="left">&lt;&lt; and &gt;&gt;</td><td align="left">left and right bitwise shifts</td></tr><tr><td align="left">&lt;=, &gt;=, &lt; and &gt;</td><td align="left">comparison operators</td></tr><tr><td align="left">== and !=</td><td align="left">equality and inequality</td></tr><tr><td align="left">&amp;</td><td align="left">bitwise AND</td></tr><tr><td align="left">^</td><td align="left">bitwise exclusive OR</td></tr><tr><td align="left">|</td><td align="left">bitwise OR</td></tr><tr><td align="left">&amp;&amp;</td><td align="left">logical AND</td></tr><tr><td align="left">||</td><td align="left">logical OR</td></tr><tr><td align="left">expr ? expr : expr</td><td align="left">conditional evaluation</td></tr><tr><td align="left">=, *=, /=, %=, +=, -=, &lt;&lt;=, &gt;&gt;=, &amp;=, ^= and |=</td><td align="left">assignments</td></tr><tr><td align="left">,</td><td align="left">separator between expressions</td></tr></tbody></table></div></div><br class="table-break"><p>Shell variables are allowed as operands; parameter expansion is performed before the expression is evaluated.  Within an expression, shell variables may also be referenced by name without using the parameter expansion syntax.  The value of a variable is evaluated as an arithmetic expression when it is referenced.  A shell variable need not have its integer attribute turned on to be used in an expression.</p><p>Constants with a leading 0 (zero) are interpreted as octal numbers.  A
leading <span class="quote">&#8220;<span class="quote">0x</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">0X</span>&#8221;</span> denotes hexadecimal.  Otherwise, numbers take the form <span class="quote">&#8220;<span class="quote">[BASE'#']N</span>&#8221;</span>, where <span class="quote">&#8220;<span class="quote">BASE</span>&#8221;</span> is a decimal number between 2 and 64 representing the arithmetic base, and N is a number in that base.  If <span class="quote">&#8220;<span class="quote">BASE'#'</span>&#8221;</span> is omitted, then base 10 is used.  The digits greater than 9 are represented by the lowercase letters, the uppercase letters, <span class="quote">&#8220;<span class="quote">@</span>&#8221;</span>, and <span class="quote">&#8220;<span class="quote">_</span>&#8221;</span>, in that order.  If <span class="quote">&#8220;<span class="quote">BASE</span>&#8221;</span> is less than or equal to 36, lowercase and uppercase letters may be used interchangably to represent numbers between 10 and 35.</p><p>Operators are evaluated in order of precedence.  Sub-expressions in parentheses are evaluated first and may override the precedence rules above.</p><p>Wherever possible, Bash users should try to use the syntax with square brackets:</p><div class="cmdsynopsis"><p><code class="command">$[ EXPRESSION ]</code> </p></div><p>However, this will only calculate the result of <span class="emphasis"><em>EXPRESSION</em></span>, and do no tests:</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>echo <em class="parameter"><code>$[365*24]</code></em></strong></span>
8760
</pre><p>See <a class="xref" href="#sect_07_01_02_02" title="1.2.2. Numeric comparisons">Section 1.2.2, &#8220;Numeric comparisons&#8221;</a>, among others, for practical examples in scripts.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_06"></a>4.7. Process substitution</h3></div></div></div><p>Process substitution<a class="indexterm" name="idm2848"></a> is supported on systems that support named pipes (FIFOs) or the <code class="filename">/dev/fd</code> method of naming open files.  It takes the form<a class="indexterm" name="idm2852"></a> of</p><div class="cmdsynopsis"><p><code class="command">&lt;(LIST)</code> </p></div><p>or</p><div class="cmdsynopsis"><p><code class="command">&gt;(LIST)</code> </p></div><p>The process <code class="varname">LIST</code> is run with its input or output connected to a FIFO or some file in <code class="filename">/dev/fd</code>.  The name of this file is passed as an argument to the current command as the result of the expansion.  If the <span class="quote">&#8220;<span class="quote">&gt;(LIST)</span>&#8221;</span> form is used, writing to the file will provide input for <code class="varname">LIST</code>.  If the <span class="quote">&#8220;<span class="quote">&lt;(LIST)</span>&#8221;</span> form is used, the file passed as an argument should be read to obtain the output of <code class="varname">LIST</code>.  Note that no space may appear between the &lt; or &gt; signs and the left parenthesis, otherwise the construct would be interpreted as a redirection.</p><p>When available, process substitution is performed simultaneously with parameter and variable expansion, command substitution, and arithmetic expansion.</p><p>More information in <a class="xref" href="#sect_08_02_03" title="2.3. Redirection and file descriptors">Section 2.3, &#8220;Redirection and file descriptors&#8221;</a>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_07"></a>4.8. Word splitting</h3></div></div></div><p>The shell<a class="indexterm" name="idm2873"></a> scans the results of parameter expansion, command substitution, and arithmetic expansion that did not occur within double quotes for word splitting.</p><p>The shell<a class="indexterm" name="idm2877"></a> treats each character of <code class="varname">$IFS<a class="indexterm" name="idm2881"></a></code> as a delimiter, and splits the results of the other expansions into words on these characters.  If <code class="varname">IFS<a class="indexterm" name="idm2885"></a></code> is unset, or its value is exactly <span class="quote">&#8220;<span class="quote">'&lt;space&gt;&lt;tab&gt;&lt;newline&gt;'</span>&#8221;</span>, the default, then any sequence of <code class="varname">IFS</code> characters serves to delimit words.  If <code class="varname">IFS</code> has a value other than the default, then sequences of the whitespace characters <span class="quote">&#8220;<span class="quote">space</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">Tab</span>&#8221;</span> are ignored at the beginning and end of the word, as long as the whitespace character is in the value of <code class="varname">IFS</code> (an <code class="varname">IFS</code> whitespace character).  Any character in <code class="varname">IFS</code> that is not <code class="varname">IFS</code> whitespace, along with any adjacent <code class="varname">IF</code> whitespace characters, delimits a field.  A sequence of <code class="varname">IFS</code> whitespace characters is also treated as a delimiter.  If the value of <code class="varname">IFS</code> is null, no word splitting occurs.</p><p>Explicit null arguments<a class="indexterm" name="idm2901"></a> (<span class="quote">&#8220;<span class="quote">""</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">''</span>&#8221;</span>) are retained.  Unquoted implicit null arguments, resulting from the expansion of parameters that have no values, are removed.  If a parameter with no value is expanded within double quotes, a null argument results and is retained.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Expansion and word splitting</h3><p>If no expansion occurs, no splitting is performed.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_04_08"></a>4.9. File name expansion</h3></div></div></div><p>After word splitting<a class="indexterm" name="idm2912"></a>, unless the <code class="option">-f</code> option has been set (see <a class="xref" href="#sect_02_03_02" title="3.2. Debugging on part(s) of the script">Section 3.2, &#8220;Debugging on part(s) of the script&#8221;</a>), Bash scans each word for the characters<a class="indexterm" name="idm2917"></a> <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">?</span>&#8221;</span>, and <span class="quote">&#8220;<span class="quote">[</span>&#8221;</span>.  If one of these characters appears, then the word is regarded as a <span class="emphasis"><em>PATTERN</em></span>, and replaced with an alphabetically sorted list of file names matching the pattern. If no matching file names are found, and the shell option <code class="option">nullglob<a class="indexterm" name="idm2925"></a></code> is disabled, the word is left unchanged.  If the <code class="option">nullglob</code> option is set, and no matches are found, the word is removed.  If the shell option<a class="indexterm" name="idm2929"></a> <code class="option">nocaseglob</code> is enabled, the match is performed without regard to the case of alphabetic characters.</p><p>When a pattern is used for file name generation, the character <span class="quote">&#8220;<span class="quote">.</span>&#8221;</span> at the start of a file name or immediately following a slash must be matched explicitly, unless the shell option <code class="option">dotglob</code> is set.  When matching a file name, the slash character must always be matched explicitly.  In other cases, the <span class="quote">&#8220;<span class="quote">.</span>&#8221;</span> character is not treated specially.</p><p>The <code class="varname">GLOBIGNORE<a class="indexterm" name="idm2939"></a></code> shell variable may be used to restrict the set of file names matching a pattern.  If <code class="varname">GLOBIGNORE</code> is set, each matching file name that also matches one of the patterns in <code class="varname">GLOBIGNORE</code> is removed from the list of matches.  The file names <code class="filename">.</code> and <code class="filename">..</code> are always ignored, even when <code class="varname">GLOBIGNORE</code> is set.  However, setting <code class="varname">GLOBIGNORE</code> has the effect of enabling the <code class="option">dotglob</code> shell option, so all other file names beginning with a <span class="quote">&#8220;<span class="quote">.</span>&#8221;</span> will match.  To get the old behavior of ignoring file names beginning with a <span class="quote">&#8220;<span class="quote">.</span>&#8221;</span>, make <span class="quote">&#8220;<span class="quote">.*</span>&#8221;</span> one of the patterns in <code class="varname">GLOBIGNORE</code>.  The <code class="option">dotglob</code> option is disabled when <code class="varname">GLOBIGNORE</code> is unset.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_03_05"></a>5. Aliases</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_05_01"></a>5.1. What are aliases?</h3></div></div></div><p>An alias allows a string to be substituted for a word when it is used as the first word of a simple command.  The shell maintains a list of aliases<a class="indexterm" name="idm2960"></a> that may be set and unset with the <span class="command"><strong>alias</strong></span> and <span class="command"><strong>unalias</strong></span> built-in<a class="indexterm" name="idm2965"></a> commands.  Issue the <span class="command"><strong>alias</strong></span> without options to display a list of aliases known to the current shell<a class="indexterm" name="idm2969"></a>.</p><pre class="screen">
<code class="prompt">franky: ~&gt;</code> <span class="command"><strong>alias</strong></span>
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias PAGER='less -r'
alias Txterm='export TERM=xterm'
alias XARGS='xargs -r'
alias cdrecord='cdrecord -dev 0,0,0 -speed=8'
alias e='vi'
alias egrep='grep -E'
alias ewformat='fdformat -n /dev/fd0u1743; ewfsck'
alias fgrep='grep -F'
alias ftp='ncftp -d15'
alias h='history 10'
alias fformat='fdformat /dev/fd0H1440'
alias j='jobs -l'
alias ksane='setterm -reset'
alias ls='ls -F --color=auto'
alias m='less'
alias md='mkdir'
alias od='od -Ax -ta -txC'
alias p='pstree -p'
alias ping='ping -vc1'
alias sb='ssh blubber'
alias sl='ls'
alias ss='ssh octarine'
alias tar='gtar'
alias tmp='cd /tmp'
alias unaliasall='unalias -a'
alias vi='eval `resize`;vi'
alias vt100='export TERM=vt100'
alias which='type'
alias xt='xterm -bg black -fg white &amp;'

<code class="prompt">franky ~&gt;</code>
</pre><p>Aliases are useful for specifying the default version of a command that exists in several versions on your system, or to specify default options to a command.  Another use for aliases<a class="indexterm" name="idm2977"></a> is for correcting incorrect spelling.</p><p>The first word of each simple command, if unquoted, is checked to see if it has an alias.  If so, that word is replaced by the text of the alias.  The alias name and the replacement text may contain any valid shell input, including shell metacharacters, with the exception that the alias name may not contain <span class="quote">&#8220;<span class="quote">=</span>&#8221;</span>.  The first word of the replacement text is tested for aliases, but a word that is identical to an alias being expanded is not expanded a second time.  This means that one may alias <span class="command"><strong>ls</strong></span> to <span class="command"><strong>ls <code class="option">-F</code></strong></span>, for instance, and Bash will not try to recursively expand the replacement text. If the last character of the alias value is a space or tab character, then the next command word following the alias is also checked for alias expansion.</p><p>Aliases are not expanded when the shell is not interactive, unless
the <code class="option">expand_aliases</code> option<a class="indexterm" name="idm2987"></a> is set using the <span class="command"><strong>shopt</strong></span> shell built-in.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_05_02"></a>5.2. Creating and removing aliases</h3></div></div></div><p>Aliases are created using the <span class="command"><strong>alias</strong></span> shell<a class="indexterm" name="idm2995"></a> built-in.  For permanent use, enter the <span class="command"><strong>alias</strong></span> in one of your shell initialization files; if you just enter the alias on the command line, it is only recognized within the current shell.</p><pre class="screen">
<code class="prompt">franky ~&gt;</code> <span class="command"><strong>alias <em class="parameter"><code>dh='df -h'</code></em></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>dh</strong></span>
Filesystem            Size  Used Avail Use% Mounted on
/dev/hda7             1.3G  272M 1018M  22% /
/dev/hda1             121M  9.4M  105M   9% /boot
/dev/hda2              13G  8.7G  3.7G  70% /home
/dev/hda3              13G  5.3G  7.1G  43% /opt
none                  243M     0  243M   0% /dev/shm
/dev/hda6             3.9G  3.2G  572M  85% /usr
/dev/hda5             5.2G  4.3G  725M  86% /var

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>unalias <em class="parameter"><code>dh</code></em></strong></span>

<code class="prompt">franky ~&gt;</code> <span class="command"><strong>dh</strong></span>
bash: dh: command not found

<code class="prompt">franky ~&gt;</code>
</pre><p>Bash always reads at least one complete line of input before executing any of the commands on that line.  Aliases are expanded when a command is read, not when it is executed.  Therefore, an alias definition appearing on the same line as another command does not take effect until the next line of input is read.  The commands following the alias definition on that line are not affected by the new alias.  This behavior is also an issue when functions are executed. Aliases are expanded when a function definition is read, not when the function is executed, because a function definition is itself a compound command.  As a consequence, aliases<a class="indexterm" name="idm3012"></a> defined in a function are not available until after that function is executed.  To be safe, always put alias definitions on a separate line, and do not use <span class="command"><strong>alias</strong></span> in compound commands.</p><p>Aliases are not inherited by child processes.  Bourne shell (<span class="command"><strong>sh</strong></span>) does not recognize aliases.</p><p>More about functions is in <a class="xref" href="#chap_11" title="Chapter 11. Functions">Chapter 11, <i>Functions</i></a>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Functions are faster</h3><p>Aliases are looked up after functions and thus resolving is slower.  While aliases are easier to understand, shell functions are preferred over aliases for almost every purpose.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_03_06"></a>6. More Bash options</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_06_01"></a>6.1. Displaying options</h3></div></div></div><p>We already discussed a couple of Bash options that are useful for debugging your scripts.  In this section, we will take a more in-depth view of the Bash options.</p><p>Use the <code class="option">-o</code> option to <span class="command"><strong>set</strong></span> to display all shell<a class="indexterm" name="idm3031"></a> options:</p><pre class="screen">
<code class="prompt">willy:~&gt;</code> <span class="command"><strong>set <code class="option">-o</code></strong></span>
allexport		off
braceexpand		on
emacs			on
errexit			off
hashall			on
histexpand		on
history			on
ignoreeof		off
interactive-comments	on
keyword			off
monitor			on
noclobber		off
noexec			off
noglob			off
nolog			off
notify			off
nounset			off
onecmd			off
physical		off
posix			off
privileged		off
verbose			off
vi			off
xtrace			off
</pre><p>See the Bash Info pages, section <span class="guimenu">Shell Built-in Commands</span> &#8594; <span class="guimenuitem">The Set Built-in</span> for a description of each option.  A lot of options have one-character shorthands: the <code class="option">xtrace</code> option, for instance, is equal to specifying <span class="command"><strong>set <code class="option">-x</code></strong></span>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_03_06_02"></a>6.2. Changing options</h3></div></div></div><p>Shell options can either be set different<a class="indexterm" name="idm3048"></a> from the default upon calling the shell, or be set during shell operation.  They may also be included in the shell resource configuration files.</p><p>The following command executes a script in POSIX-compatible mode:</p><pre class="screen">
<code class="prompt">willy:~/scripts&gt;</code> <span class="command"><strong>bash <code class="option">--posix</code> <code class="filename">script.sh</code></strong></span>
</pre><p>For changing the current environment temporarily, or for use in a script,
we would rather use <span class="command"><strong>set</strong></span>.  Use <span class="emphasis"><em>-</em></span> (dash) for enabling an option, <span class="emphasis"><em>+</em></span> for disabling:</p><pre class="screen">
<code class="prompt">willy:~/test&gt;</code> <span class="command"><strong>set <code class="option">-o</code> <em class="parameter"><code>noclobber</code></em></strong></span>

<code class="prompt">willy:~/test&gt;</code> <span class="command"><strong>touch <code class="filename">test</code></strong></span>

<code class="prompt">willy:~/test&gt;</code> <span class="command"><strong>date &gt; <code class="filename">test</code></strong></span>
bash: test: cannot overwrite existing file

<code class="prompt">willy:~/test&gt;</code> <span class="command"><strong>set <code class="option">+o</code> <em class="parameter"><code>noclobber</code></em></strong></span>

<code class="prompt">willy:~/test&gt;</code> <span class="command"><strong>date &gt; <code class="filename">test</code></strong></span>
</pre><p>The above example demonstrates the <code class="option">noclobber</code> option<a class="indexterm" name="idm3081"></a>, which prevents existing files from being overwritten by redirection operations.  The same goes for one-character options, for instance <code class="option">-u</code>, which will treat unset variables as an error when set, and exits a non-interactive shell upon
encountering such errors:</p><pre class="screen">
<code class="prompt">willy:~&gt;</code> <span class="command"><strong>echo <code class="varname">$VAR</code></strong></span>


<code class="prompt">willy:~&gt;</code> <span class="command"><strong>set <code class="option">-u</code></strong></span>

<code class="prompt">willy:~&gt;</code> <span class="command"><strong>echo <code class="varname">$VAR</code></strong></span>
bash: VAR: unbound variable
</pre><p>This option is also useful for detecting incorrect<a class="indexterm" name="idm3096"></a> content assignment to variables: the same error will also occur, for instance, when assigning a character string to a variable that was declared explicitly as one holding only integer values.</p><p>One last example follows, demonstrating the <code class="option">noglob</code> option, which prevents special characters from being expanded:</p><pre class="screen">
<code class="prompt">willy:~/testdir&gt;</code> <span class="command"><strong>set <code class="option">-o</code> <em class="parameter"><code>noglob</code></em></strong></span>

<code class="prompt">willy:~/testdir&gt;</code> <span class="command"><strong>touch <code class="filename">*</code></strong></span>

<code class="prompt">willy:~/testdir&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> <code class="filename">*</code></strong></span>
-rw-rw-r--    1 willy    willy		0 Feb 27 13:37 *
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_03_07"></a>7. Summary</h2></div></div></div><p>The Bash environment can be configured globally and on a per user basis.  Various configuration files are used to fine-tune the behavior of the shell.</p><p>These files contain shell options, settings for variables, function definitions and various other building blocks for creating ourselves a cosy environment.</p><p>Except for the reserved Bourne shell, Bash and special parameters, variable names can be chosen more or less freely.</p><p>Because a lot of characters have double or even triple meanings, depending on the environment, Bash uses a system of quoting to take away special meaning from one or multiple characters when special treatment is not wanted.</p><p>Bash uses various methods of expanding command line entries in order to determine which commands to execute.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_03_08"></a>8. Exercises</h2></div></div></div><p>For this exercise, you will need to read the <span class="command"><strong>useradd</strong></span> man pages, because we are going to use the <code class="filename">/etc/skel</code> directory to hold default shell configuration files, which are copied to the home directory of each newly added user.</p><p>First we will do some general exercises on setting and displaying variables.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create 3 variables, <code class="varname">VAR1</code>, <code class="varname">VAR2</code> and <code class="varname">VAR3</code>; initialize them to hold the values <span class="quote">&#8220;<span class="quote">thirteen</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">13</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">Happy Birthday</span>&#8221;</span> respectively.</p></li><li class="listitem"><p>Display the values of all three variables.</p></li><li class="listitem"><p>Are these local or global variables?</p></li><li class="listitem"><p>Remove <code class="varname">VAR3</code>.</p></li><li class="listitem"><p>Can you see the two remaining variables in a new terminal window?</p></li><li class="listitem"><p>Edit <code class="filename">/etc/profile</code> so that all users are greeted upon login (test this).</p></li><li class="listitem"><p>For the <span class="emphasis"><em>root</em></span> account, set the prompt to something like <span class="quote">&#8220;<span class="quote">Danger!! root is doing stuff in \w</span>&#8221;</span>, preferably in a bright color such as red or pink or in reverse video mode.</p></li><li class="listitem"><p>Make sure that newly created users also get a nice personalized prompt which informs them on which system in which directory they are working.  Test your changes by adding a new user and logging in as that user.</p></li><li class="listitem"><p>Write a script in which you assign two integer values to two variables.  The script should calculate the surface of a rectangle which has these proportions.  It should be aired with comments and generate elegant output.</p></li></ol></div><p>Don't forget to <span class="command"><strong>chmod</strong></span> your scripts!</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_04"></a>Chapter 4. Regular expressions</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_04_01">1. Regular expressions</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_04_01_01">1.1. What are regular expressions?</a></span></dt><dt><span class="sect2"><a href="#sect_04_01_02">1.2. Regular expression metacharacters</a></span></dt><dt><span class="sect2"><a href="#sect_04_01_03">1.3. Basic versus extended regular expressions</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_04_02">2. Examples using grep</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_04_02_01">2.1. What is grep?</a></span></dt><dt><span class="sect2"><a href="#sect_04_02_02">2.2. Grep and regular expressions</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_04_03">3. Pattern matching using Bash features</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_04_03_01">3.1. Character ranges</a></span></dt><dt><span class="sect2"><a href="#sect_04_03_02">3.2. Character classes</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_04_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_04_05">5. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this chapter we discuss:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Using regular expressions</p></li><li class="listitem"><p>Regular expression metacharacters</p></li><li class="listitem"><p>Finding patterns in files or output</p></li><li class="listitem"><p>Character ranges and classes in Bash</p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_04_01"></a>1. Regular expressions</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_04_01_01"></a>1.1. What are regular expressions?</h3></div></div></div><p>A <span class="emphasis"><em>regular expression<a class="indexterm" name="idm3177"></a></em></span> is a pattern that describes a set of strings.  Regular expressions are constructed analogously to arithmetic expressions by using various operators to combine smaller expressions.</p><p>The fundamental building blocks are the regular expressions that match a single character.  Most characters, including all letters and digits, are regular expressions that match themselves.  Any metacharacter with special meaning may be quoted by preceding it with a backslash.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_04_01_02"></a>1.2. Regular expression metacharacters</h3></div></div></div><p>A regular expression<a class="indexterm" name="idm3184"></a> may be followed by one of several repetition operators<a class="indexterm" name="idm3187"></a> (metacharacters):</p><div class="table"><a name="table_04_01"></a><p class="title"><b>Table 4.1. Regular expression operators</b></p><div class="table-contents"><table class="table" summary="Regular expression operators" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Operator</th><th align="left">Effect</th></tr></thead><tbody><tr><td align="left">.</td><td align="left">Matches any single character.</td></tr><tr><td align="left">?</td><td align="left">The preceding item is optional and will be matched, at most, once.</td></tr><tr><td align="left">*</td><td align="left">The preceding item will be matched zero or more times.</td></tr><tr><td align="left">+</td><td align="left">The preceding item will be matched one or more times.</td></tr><tr><td align="left">{N}</td><td align="left">The preceding item is matched exactly N times.</td></tr><tr><td align="left">{N,}</td><td align="left">The preceding item is matched N or more times.</td></tr><tr><td align="left">{N,M}</td><td align="left">The preceding item is matched at least N times, but not more than M times.</td></tr><tr><td align="left">-</td><td align="left">represents the range if it's not first or last in a list or the ending point of a range in a list.</td></tr><tr><td align="left">^</td><td align="left">Matches the empty string at the beginning of a line; also represents the characters not in the range of a list.</td></tr><tr><td align="left">$</td><td align="left">Matches the empty string at the end of a line.</td></tr><tr><td align="left">\b</td><td align="left">Matches the empty string at the edge of a word.</td></tr><tr><td align="left">\B</td><td align="left">Matches the empty string provided it's not at the edge of a word.</td></tr><tr><td align="left">\&lt;</td><td align="left">Match the empty string at the beginning of word.</td></tr><tr><td align="left">\&gt;</td><td align="left">Match the empty string at the end of word.</td></tr></tbody></table></div></div><br class="table-break"><p>Two regular expressions<a class="indexterm" name="idm3241"></a> may be concatenated; the resulting regular expression matches any string formed by concatenating two substrings that respectively match the concatenated subexpressions.</p><p>Two regular expressions<a class="indexterm" name="idm3245"></a> may be joined by the infix operator <span class="quote">&#8220;<span class="quote">|</span>&#8221;</span>; the resulting regular expression matches any string matching either subexpression.</p><p>Repetition<a class="indexterm" name="idm3250"></a> takes precedence over concatenation, which in turn takes precedence over alternation.  A whole subexpression may be enclosed in parentheses to override these precedence rules.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_04_01_03"></a>1.3. Basic versus extended regular expressions</h3></div></div></div><p>In basic<a class="indexterm" name="idm3256"></a> regular expressions the metacharacters <span class="quote">&#8220;<span class="quote">?</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">+</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">{</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">|</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">(</span>&#8221;</span>, and <span class="quote">&#8220;<span class="quote">)</span>&#8221;</span> lose their special meaning; instead use the backslashed versions <span class="quote">&#8220;<span class="quote">\?</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">\+</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">\{</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">\|</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">\(</span>&#8221;</span>, and <span class="quote">&#8220;<span class="quote">\)</span>&#8221;</span>.</p><p>Check in your system documentation whether commands using regular expressions support extended expressions.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_04_02"></a>2. Examples using grep</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_04_02_01"></a>2.1. What is grep?</h3></div></div></div><p><span class="command"><strong>grep</strong></span> searches<a class="indexterm" name="idm3278"></a> the input files for lines containing a match to a given pattern list.  When it finds a match in a line, it copies the line to standard output (by default), or whatever other sort of output you have requested with options.</p><p>Though <span class="command"><strong>grep<a class="indexterm" name="idm3283"></a></strong></span> expects to do the matching on text, it has no limits on input line length other than available memory, and it can match arbitrary characters within a line.  If the final byte of an input file is not a <span class="emphasis"><em>newline</em></span>, <span class="command"><strong>grep</strong></span> silently supplies one.  Since newline is also a separator for the list of patterns, there is no way to match newline characters in a text.</p><p>Some examples:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>root</code></em> <code class="filename">/etc/passwd</code></strong></span>
root:x:0:0:root:/root:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin

<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <code class="option">-n</code> <em class="parameter"><code>root</code></em> <code class="filename">/etc/passwd</code></strong></span>
1:root:x:0:0:root:/root:/bin/bash
12:operator:x:11:0:operator:/root:/sbin/nologin

<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <code class="option">-v</code> <em class="parameter"><code>bash</code></em> <code class="filename">/etc/passwd </code></strong></span>| <span class="command"><strong>grep <code class="option">-v</code> <em class="parameter"><code>nologin</code></em></strong></span>
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
news:x:9:13:news:/var/spool/news:
mailnull:x:47:47::/var/spool/mqueue:/dev/null
xfs:x:43:43:X Font Server:/etc/X11/fs:/bin/false
rpc:x:32:32:Portmapper RPC user:/:/bin/false
nscd:x:28:28:NSCD Daemon:/:/bin/false
named:x:25:25:Named:/var/named:/bin/false
squid:x:23:23::/var/spool/squid:/dev/null
ldap:x:55:55:LDAP User:/var/lib/ldap:/bin/false
apache:x:48:48:Apache:/var/www:/bin/false

<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <code class="option">-c</code> <em class="parameter"><code>false</code></em> <code class="filename">/etc/passwd</code></strong></span>
7

<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <code class="option">-i</code> <em class="parameter"><code>ps</code></em> <code class="filename">~/.bash*</code></strong></span> | <span class="command"><strong>grep <code class="option">-v</code> <em class="parameter"><code>history</code></em></strong></span>
/home/cathy/.bashrc:PS1="\[\033[1;44m\]$USER is in \w\[\033[0m\] "

</pre><p>With the first command, user <span class="emphasis"><em>cathy</em></span> displays the lines from <code class="filename">/etc/passwd</code> containing the string <span class="emphasis"><em>root</em></span>.</p><p>Then she displays the line numbers containing this search string.</p><p>With the third command she checks which users are not using <span class="command"><strong>bash</strong></span>, but accounts with the <span class="command"><strong>nologin</strong></span> shell are not displayed.</p><p>Then she counts the number of accounts that have <code class="filename">/bin/false</code> as the shell.</p><p>The last command displays the lines from all the files in her home directory starting with <code class="filename">~/.bash</code>, excluding matches containing the string <span class="emphasis"><em>history</em></span>, so as to exclude matches from <code class="filename">~/.bash_history</code> which might contain the same string, in upper or lower cases.  Note that the search is for the <span class="emphasis"><em>string</em></span> <span class="quote">&#8220;<span class="quote">ps</span>&#8221;</span>, and not for the <span class="emphasis"><em>command</em></span> <span class="command"><strong>ps</strong></span>.</p><p>Now let's see what else we can do with grep, using regular expressions.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_04_02_02"></a>2.2. Grep and regular expressions</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">If you are not on Linux</h3><p>We use GNU <span class="command"><strong>grep</strong></span> in these examples, which supports extended regular expressions.  GNU <span class="command"><strong>grep</strong></span> is the default on Linux systems.  If you are working on proprietary systems, check with the <code class="option">-V</code> option which version you are using.  GNU <span class="command"><strong>grep</strong></span> can be downloaded from <a class="ulink" href="http://gnu.org/directory/" target="_top">http://gnu.org/directory/</a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_04_02_02_01"></a>2.2.1. Line and word anchors</h4></div></div></div><p>From the previous example, we now exclusively want to display lines starting<a class="indexterm" name="idm3352"></a> with the string <span class="quote">&#8220;<span class="quote">root</span>&#8221;</span>:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>^root</code></em> <code class="filename">/etc/passwd</code></strong></span>
root:x:0:0:root:/root:/bin/bash
</pre><p>If we want to see which accounts have no shell assigned whatsoever, we search for lines ending in <span class="quote">&#8220;<span class="quote">:</span>&#8221;</span>:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>:$</code></em> <code class="filename">/etc/passwd</code></strong></span>
news:x:9:13:news:/var/spool/news:
</pre><p>To check that <code class="varname">PATH</code> is exported in <code class="filename">~/.bashrc</code>, first select <span class="quote">&#8220;<span class="quote">export</span>&#8221;</span> lines and then search for lines starting with the string <span class="quote">&#8220;<span class="quote">PATH</span>&#8221;</span>, so as not to display <code class="varname">MANPATH</code> and other possible<a class="indexterm" name="idm3374"></a> paths:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>export</code></em> <code class="filename">~/.bashrc</code></strong></span> | <span class="command"><strong>grep <em class="parameter"><code>'\&lt;PATH'</code></em></strong></span>
  export PATH="/bin:/usr/lib/mh:/lib:/usr/bin:/usr/local/bin:/usr/ucb:/usr/dbin:$PATH"
</pre><p>Similarly, <span class="emphasis"><em>\&gt;</em></span> matches the end of a word.</p><p>If you want to find a string that is a separate word (enclosed by spaces), it is better use the <code class="option">-w</code>, as in this example where we are displaying information for the root partition:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <code class="option">-w</code> <em class="parameter"><code>/</code></em> <code class="filename">/etc/fstab</code></strong></span>
LABEL=/                 /                       ext3    defaults        1 1
</pre><p>If this option is not used, all the lines from the file system table will be displayed.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_04_02_02_02"></a>2.2.2. Character classes</h4></div></div></div><p>A <span class="emphasis"><em>bracket expression<a class="indexterm" name="idm3399"></a></em></span> is a list of characters enclosed by <span class="quote">&#8220;<span class="quote">[</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">]</span>&#8221;</span>.  It matches any single character<a class="indexterm" name="idm3404"></a> in that list; if the first character of the list is the caret, <span class="quote">&#8220;<span class="quote">^</span>&#8221;</span>, then it matches any character NOT in the list.  For example, the regular expression <span class="quote">&#8220;<span class="quote">[0123456789]</span>&#8221;</span> matches any single digit.</p><p>Within a bracket expression, a <span class="emphasis"><em>range expression<a class="indexterm" name="idm3411"></a></em></span> consists of two characters separated by a hyphen.  It matches any single character that sorts between the two characters, inclusive, using the locale's collating sequence and character set.  For example, in the default C locale, <span class="quote">&#8220;<span class="quote">[a-d]</span>&#8221;</span> is equivalent to <span class="quote">&#8220;<span class="quote">[abcd]</span>&#8221;</span>.  Many locales sort characters in dictionary order, and in these locales <span class="quote">&#8220;<span class="quote">[a-d]</span>&#8221;</span> is typically not equivalent to <span class="quote">&#8220;<span class="quote">[abcd]</span>&#8221;</span>; it might be equivalent to <span class="quote">&#8220;<span class="quote">[aBbCcDd]</span>&#8221;</span>, for example.  To obtain the traditional interpretation of bracket expressions, you can use the C locale by setting the <code class="varname">LC_ALL</code> environment variable to the value <span class="quote">&#8220;<span class="quote">C</span>&#8221;</span>.</p><p>Finally, certain named classes of characters are predefined within bracket expressions.  See the <span class="command"><strong>grep</strong></span> man or info pages for more information about these predefined expressions.</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>[yf]</code></em> <code class="filename">/etc/group</code></strong></span>
sys:x:3:root,bin,adm
tty:x:5:
mail:x:12:mail,postfix
ftp:x:50:
nobody:x:99:
floppy:x:19:
xfs:x:43:
nfsnobody:x:65534:
postfix:x:89:
</pre><p>In the example, all the lines containing either a <span class="quote">&#8220;<span class="quote">y</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">f</span>&#8221;</span> character are displayed.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_04_02_02_04"></a>2.2.3. Wildcards</h4></div></div></div><p>Use the <span class="quote">&#8220;<span class="quote">.</span>&#8221;</span> for a single<a class="indexterm" name="idm3435"></a> character match.  If you want to get a list of all five-character English dictionary words starting with <span class="quote">&#8220;<span class="quote">c</span>&#8221;</span> and ending in <span class="quote">&#8220;<span class="quote">h</span>&#8221;</span> (handy for solving crosswords):</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>'\&lt;c...h\&gt;'</code></em> <code class="filename">/usr/share/dict/words</code></strong></span>
catch
clash
cloth
coach
couch
cough
crash
crush
</pre><p>If you want to display lines containing the literal dot character, use the <code class="option">-F</code> option to <span class="command"><strong>grep</strong></span>.</p><p>For matching multiple characters, use the asterisk.  This example selects all words starting with <span class="quote">&#8220;<span class="quote">c</span>&#8221;</span> and ending in <span class="quote">&#8220;<span class="quote">h</span>&#8221;</span> from the system's dictionary:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>'\&lt;c.*h\&gt;'</code></em> <code class="filename">/usr/share/dict/words</code></strong></span>
caliph
cash
catch
cheesecloth
cheetah
--output omitted--
</pre><p>If you want to find the literal asterisk character in a file or output, use single quotes.  Cathy in the example below first tries finding the asterisk character in <code class="filename">/etc/profile</code> without using quotes, which does not return any lines.  Using quotes, output is generated:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>*</code></em> <code class="filename">/etc/profile</code></strong></span>

<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>grep <em class="parameter"><code>'*'</code></em> <code class="filename">/etc/profile</code></strong></span>
for i in /etc/profile.d/*.sh ; do
</pre></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_04_03"></a>3. Pattern matching using Bash features</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_04_03_01"></a>3.1. Character ranges</h3></div></div></div><p>Apart from <span class="command"><strong>grep</strong></span> and regular expressions, there's a good deal of pattern matching<a class="indexterm" name="idm3473"></a> that you can do directly in the shell, without having to use an external program.</p><p>As you already know, the asterisk (*) and the question mark (?) match any string<a class="indexterm" name="idm3477"></a> or any single character, respectively.  Quote these special characters to match them literally:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>touch <code class="filename">"*"</code></strong></span>

<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>ls <code class="filename">"*"</code></strong></span>
*
</pre><p>But you can also use the square braces to match any enclosed character or range of characters, if pairs of characters are separated by a hyphen.  An example:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>ls <code class="option">-ld</code> <code class="filename">[a-cx-z]*</code></strong></span>
drwxr-xr-x    2 cathy	 cathy		4096 Jul 20  2002 app-defaults/
drwxrwxr-x    4 cathy    cathy          4096 May 25  2002 arabic/
drwxrwxr-x    2 cathy    cathy          4096 Mar  4 18:30 bin/
drwxr-xr-x    7 cathy    cathy          4096 Sep  2  2001 crossover/
drwxrwxr-x    3 cathy    cathy          4096 Mar 22  2002 xml/
</pre><p>This lists all files in <span class="emphasis"><em>cathy</em></span>'s home directory, starting with <span class="quote">&#8220;<span class="quote">a</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">b</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">c</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">x</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">y</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">z</span>&#8221;</span>.</p><p>If the first character within the braces is <span class="quote">&#8220;<span class="quote">!</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">^</span>&#8221;</span>, any character not enclosed will be matched.  To match the dash (<span class="quote">&#8220;<span class="quote">-</span>&#8221;</span>), include it as the first or last character in the set.  The sorting depends on the current locale and of the value of the <code class="varname">LC_COLLATE<a class="indexterm" name="idm3506"></a></code> variable, if it is set.  Mind that other locales might interpret <span class="quote">&#8220;<span class="quote">[a-cx-z]</span>&#8221;</span> as <span class="quote">&#8220;<span class="quote">[aBbCcXxYyZz]</span>&#8221;</span> if sorting is done in dictionary order.  If you want to be sure to have the traditional interpretation of ranges, force this behavior by setting <code class="varname">LC_COLLATE</code> or <code class="varname">LC_ALL<a class="indexterm" name="idm3513"></a></code> to <span class="quote">&#8220;<span class="quote">C</span>&#8221;</span>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_04_03_02"></a>3.2. Character classes</h3></div></div></div><p>Character classes<a class="indexterm" name="idm3520"></a> can be specified within the square braces, using the syntax <span class="command"><strong>[:CLASS:]</strong></span>, where CLASS<a class="indexterm" name="idm3524"></a> is defined in the POSIX standard and has one of the values</p><p><span class="quote">&#8220;<span class="quote">alnum</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">alpha</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">ascii</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">blank</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">cntrl</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">digit</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">graph</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">lower</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">print</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">punct</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">space</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">upper</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">word</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">xdigit</span>&#8221;</span>.</p><p>Some examples:</p><pre class="screen">
<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>ls <code class="option">-ld</code> <code class="filename">[[:digit:]]*</code></strong></span>
drwxrwxr-x    2 cathy	cathy		4096 Apr 20 13:45 2/

<code class="prompt">cathy ~&gt;</code> <span class="command"><strong>ls <code class="option">-ld</code> <code class="filename">[[:upper:]]*</code></strong></span>
drwxrwxr--    3 cathy   cathy           4096 Sep 30  2001 Nautilus/
drwxrwxr-x    4 cathy   cathy           4096 Jul 11  2002 OpenOffice.org1.0/
-rw-rw-r--    1 cathy   cathy         997376 Apr 18 15:39 Schedule.sdc
</pre><p>When the <code class="option">extglob<a class="indexterm" name="idm3554"></a></code> shell option is enabled (using the <span class="command"><strong>shopt</strong></span> built-in), several extended pattern matching operators are recognized.  Read more in the Bash info pages, section <span class="guimenu">Basic shell features</span> &#8594; <span class="guisubmenu">Shell Expansions</span> &#8594; <span class="guisubmenu">Filename Expansion</span> &#8594; <span class="guimenuitem">Pattern Matching</span>.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_04_04"></a>4. Summary</h2></div></div></div><p>Regular expressions are powerful tools for selecting particular lines from files or output.  A lot of UNIX commands use regular expressions: <span class="command"><strong>vim</strong></span>, <span class="command"><strong>perl</strong></span>, the <span class="application">PostgreSQL</span> database and so on.  They can be made available in any language or application using external libraries, and they even found their way to non-UNIX systems.  For instance, regular expressions are used in the Excell spreadsheet that comes with the MicroSoft Windows Office suite.  In this chapter we got the feel of the <span class="command"><strong>grep</strong></span> command, which is indispensable in any UNIX environment.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The <span class="command"><strong>grep</strong></span> command can do much more than the few tasks we discussed here; we only used it as an example for regular expressions.  The GNU <span class="command"><strong>grep</strong></span> version comes with plenty of documentation, which you are strongly advised to read!</p></div><p>Bash has built-in features for matching patterns and can recognize character classes and ranges.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_04_05"></a>5. Exercises</h2></div></div></div><p>These exercises will help you master regular expressions.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Display a list of all the users on your system who log in with the Bash shell as a default.</p></li><li class="listitem"><p>From the <code class="filename">/etc/group</code> directory, display all lines starting with the string <span class="quote">&#8220;<span class="quote">daemon</span>&#8221;</span>.</p></li><li class="listitem"><p>Print all the lines from the same file that don't contain the string.</p></li><li class="listitem"><p>Display localhost information from the <code class="filename">/etc/hosts</code> file, display the line number(s) matching the search string and count the number of occurrences of the string.</p></li><li class="listitem"><p>Display a list of <code class="filename">/usr/share/doc</code> subdirectories containing information about shells.</p></li><li class="listitem"><p>How many <code class="filename">README</code> files do these subdirectories contain?  Don't count anything in the form of <span class="quote">&#8220;<span class="quote">README.a_string</span>&#8221;</span>.</p></li><li class="listitem"><p>Make a list of files in your home directory that were changed less that 10 hours ago, using <span class="command"><strong>grep</strong></span>, but leave out directories.</p></li><li class="listitem"><p>Put these commands in a shell script that will generate comprehensible output.</p></li><li class="listitem"><p>Can you find an alternative for <span class="command"><strong>wc <code class="option">-l</code></strong></span>, using <span class="command"><strong>grep</strong></span>?</p></li><li class="listitem"><p>Using the file system table (<code class="filename">/etc/fstab</code> for instance), list local disk devices.</p></li><li class="listitem"><p>Make a script that checks whether a user exists in <code class="filename">/etc/passwd</code>.  For now, you can specify the user name in the script, you don't have to work with arguments and conditionals at this stage.</p></li><li class="listitem"><p>Display configuration files in <code class="filename">/etc</code> that contain numbers in their names.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_05"></a>Chapter 5. The GNU sed stream editor</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_05_01">1. Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_05_01_01">1.1. What is sed?</a></span></dt><dt><span class="sect2"><a href="#sect_05_01_02">1.2. sed commands</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_05_02">2. Interactive editing</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_05_02_01">2.1. Printing lines containing a pattern</a></span></dt><dt><span class="sect2"><a href="#sect_05_02_02">2.2. Deleting lines of input containing a pattern</a></span></dt><dt><span class="sect2"><a href="#sect_05_02_03">2.3. Ranges of lines</a></span></dt><dt><span class="sect2"><a href="#sect_05_02_04">2.4. Find and replace with sed</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_05_03">3. Non-interactive editing</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_05_03_01">3.1. Reading sed commands from a file</a></span></dt><dt><span class="sect2"><a href="#sect_05_03_02">3.2. Writing output files</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_05_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_05_05">5. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>At the end of this chapter you will know about the following topics:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>What is <span class="command"><strong>sed</strong></span>?</p></li><li class="listitem"><p>Interactive use of <span class="command"><strong>sed</strong></span></p></li><li class="listitem"><p>Regular expressions and stream editing</p></li><li class="listitem"><p>Using <span class="command"><strong>sed</strong></span> commands in scripts</p></li></ul></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">This is an introduction</h3><p>These explanations are far from complete and certainly not meant to be used as the definite user manual for <span class="command"><strong>sed</strong></span>.  This chapter is only included in order to show some more interesting topics in the next chapters, and because every power user should have a basic knowledge of things that can be done with this editor.</p><p>For detailed information, refer to the <span class="command"><strong>sed</strong></span> info and man pages.</p></div><p>
</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_05_01"></a>1. Introduction</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_05_01_01"></a>1.1. What is sed?</h3></div></div></div><p>A <span class="application">Stream EDitor<a class="indexterm" name="idm3646"></a></span> is used to perform basic transformations on text read from a file or a pipe.  The result is sent to standard output.  The syntax for the <span class="command"><strong>sed</strong></span> command has no output file specification, but results can be saved to a file using output redirection.  The editor does not modify the original input.</p><p>What distinguishes <span class="command"><strong>sed</strong></span> from other editors, such as <span class="command"><strong>vi</strong></span> and <span class="command"><strong>ed</strong></span>, is its ability to filter text that it gets from a pipeline feed.  You do not need to interact with the editor while it is running; that is why <span class="command"><strong>sed</strong></span> is sometimes called a <span class="emphasis"><em>batch editor</em></span>.  This feature allows use of editing commands in scripts, greatly easing repetitive editing tasks.  When facing replacement of text in a large number of files, <span class="command"><strong>sed</strong></span> is a great help.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_05_01_02"></a>1.2. sed commands</h3></div></div></div><p>The <span class="command"><strong>sed<a class="indexterm" name="idm3661"></a></strong></span> program can perform text pattern substitutions and deletions using regular expressions<a class="indexterm" name="idm3664"></a>, like the ones used with the <span class="command"><strong>grep</strong></span> command; see <a class="xref" href="#sect_04_02" title="2. Examples using grep">Section 2, &#8220;Examples using grep&#8221;</a>.</p><p>The editing commands are similar to the ones used in the <span class="command"><strong>vi</strong></span> editor:</p><div class="table"><a name="tab_05_01"></a><p class="title"><b>Table 5.1. Sed editing commands</b></p><div class="table-contents"><table class="table" summary="Sed editing commands" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Command</th><th align="left">Result</th></tr></thead><tbody><tr><td align="left">a\</td><td align="left">Append text below current line.</td></tr><tr><td align="left">c\</td><td align="left">Change text in the current line with new text.</td></tr><tr><td align="left">d</td><td align="left">Delete text.</td></tr><tr><td align="left">i\</td><td align="left">Insert text above current line.</td></tr><tr><td align="left">p</td><td align="left">Print text.</td></tr><tr><td align="left">r</td><td align="left">Read a file.</td></tr><tr><td align="left">s</td><td align="left">Search and replace text.</td></tr><tr><td align="left">w</td><td align="left">Write to a file.</td></tr></tbody></table></div></div><br class="table-break"><p>Apart from editing commands, you can give options to <span class="command"><strong>sed</strong></span>.  An overview<a class="indexterm" name="idm3705"></a> is in the table below:</p><div class="table"><a name="tab_05_02"></a><p class="title"><b>Table 5.2. Sed options</b></p><div class="table-contents"><table class="table" summary="Sed options" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Option</th><th align="left">Effect</th></tr></thead><tbody><tr><td align="left"><code class="option">-e SCRIPT</code></td><td align="left">Add the commands in SCRIPT to the set of commands to be run while processing the input.</td></tr><tr><td align="left"><code class="option">-f</code></td><td align="left">Add the commands contained in the file SCRIPT-FILE to the set of commands to be run while processing the input.</td></tr><tr><td align="left"><code class="option">-n</code></td><td align="left">Silent mode.</td></tr><tr><td align="left"><code class="option">-V</code></td><td align="left">Print version information and exit.</td></tr></tbody></table></div></div><br class="table-break"><p>The <span class="command"><strong>sed</strong></span> info pages contain more information; we only list the most frequently used commands and options here.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_05_02"></a>2. Interactive editing</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_05_02_01"></a>2.1. Printing lines containing a pattern</h3></div></div></div><p>This is something you can do with <span class="command"><strong>grep</strong></span>, of course, but you can't do a <span class="quote">&#8220;<span class="quote">find and replace</span>&#8221;</span> using that command.  This is just to get<a class="indexterm" name="idm3741"></a> you started.</p><p>This is our example text file:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>cat <code class="option">-n</code> <code class="filename">example</code></strong></span>
     1  This is the first line of an example text.
     2  It is a text with erors.
     3  Lots of erors.
     4  So much erors, all these erors are making me sick.
     5  This is a line not containing any errors.
     6  This is the last line.

<code class="prompt">sandy ~&gt;</code>
</pre><p>We want <span class="command"><strong>sed</strong></span> to find all the lines containing our search pattern, in this case <span class="quote">&#8220;<span class="quote">erors</span>&#8221;</span>.  We use the <span class="command"><strong>p</strong></span> to obtain the result:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed  <em class="parameter"><code>'/erors/p'</code></em> <code class="filename">example</code></strong></span>
This is the first line of an example text.
It is a text with erors.
It is a text with erors.
Lots of erors.
Lots of erors.
So much erors, all these erors are making me sick.
So much erors, all these erors are making me sick.
This is a line not containing any errors.
This is the last line.

<code class="prompt">sandy ~&gt;</code>
</pre><p>As you notice, <span class="command"><strong>sed</strong></span> prints the entire file, but the lines containing the search string are printed twice.  This is not what we want.  In order to only print those lines matching our pattern, use the <code class="option">-n</code> option:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <code class="option">-n</code> <em class="parameter"><code>'/erors/p'</code></em> <code class="filename">example</code></strong></span>
It is a text with erors.
Lots of erors.
So much erors, all these erors are making me sick.

<code class="prompt">sandy ~&gt;</code>
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_05_02_02"></a>2.2. Deleting lines of input containing a pattern</h3></div></div></div><p>We use the same example text file.  Now we only want to see the lines <span class="emphasis"><em>not</em></span> containing<a class="indexterm" name="idm3775"></a> the search string:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <em class="parameter"><code>'/erors/d'</code></em> <code class="filename">example</code></strong></span>
This is the first line of an example text.
This is a line not containing any errors.
This is the last line.

<code class="prompt">sandy ~&gt;</code>
</pre><p>The <span class="command"><strong>d</strong></span> command results in excluding lines from being displayed.</p><p>Matching lines starting with a given pattern and ending in a second pattern are showed like this:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <code class="option">-n</code> <em class="parameter"><code>'/^This.*errors.$/p'</code></em> <code class="filename">example</code></strong></span>
This is a line not containing any errors.

<code class="prompt">sandy ~&gt;</code>
</pre><p>Note that the last dot needs to be escaped in order to actually match.  In our example the expression just matches any character, including the last dot.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_05_02_03"></a>2.3. Ranges of lines</h3></div></div></div><p>This time we want to take out the lines containing the errors.  In the example these are lines 2 to 4.  Specify this range<a class="indexterm" name="idm3798"></a> to address, together with the <span class="command"><strong>d</strong></span> command:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <em class="parameter"><code>'2,4d'</code></em> <code class="filename">example</code></strong></span>
This is the first line of an example text.
This is a line not containing any errors.
This is the last line.

<code class="prompt">sandy ~&gt;</code>
</pre><p>To print the file starting from a certain line until the end of the file, use a command similar to this:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <em class="parameter"><code>'3,$d'</code></em> <code class="filename">example</code></strong></span>
This is the first line of an example text.
It is a text with erors.

<code class="prompt">sandy ~&gt;</code>
</pre><p>This only prints the first two lines of the example file.</p><p>The following command prints the first line containing the pattern <span class="quote">&#8220;<span class="quote">a text</span>&#8221;</span>, up to and including the next line containing the pattern <span class="quote">&#8220;<span class="quote">a line</span>&#8221;</span>:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <code class="option">-n</code> <em class="parameter"><code>'/a text/,/This/p'</code></em> <code class="filename">example</code></strong></span>
It is a text with erors.
Lots of erors.
So much erors, all these erors are making me sick.
This is a line not containing any errors.

<code class="prompt">sandy ~&gt;</code>
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_05_02_04"></a>2.4. Find and replace with sed</h3></div></div></div><p>In the example file, we will now search and replace<a class="indexterm" name="idm3829"></a> the errors instead of only (de)selecting the lines containing the search string.</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <em class="parameter"><code>'s/erors/errors/'</code></em> <code class="filename">example</code></strong></span>
This is the first line of an example text.
It is a text with errors.
Lots of errors.
So much errors, all these erors are making me sick.
This is a line not containing any errors.
This is the last line.

<code class="prompt">sandy ~&gt;</code>
</pre><p>As you can see, this is not exactly the desired effect: in line 4, only the first occurrence of the search string has been replaced, and there is still an 'eror' left.  Use the <span class="command"><strong>g</strong></span> command to indicate to <span class="command"><strong>sed</strong></span> that it should examine the entire line instead of stopping at the first occurrence of your string:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <em class="parameter"><code>'s/erors/errors/g'</code></em> <code class="filename">example</code></strong></span>
This is the first line of an example text.
It is a text with errors.
Lots of errors.
So much errors, all these errors are making me sick.
This is a line not containing any errors.
This is the last line.

<code class="prompt">sandy ~&gt;</code>
</pre><p>To insert a string at the beginning of each line of a file, for instance for quoting:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <em class="parameter"><code>'s/^/&gt; /'</code></em> <code class="filename">example</code></strong></span>
&gt; This is the first line of an example text.
&gt; It is a text with erors.
&gt; Lots of erors.
&gt; So much erors, all these erors are making me sick.
&gt; This is a line not containing any errors.
&gt; This is the last line.

<code class="prompt">sandy ~&gt;</code>
</pre><p>Insert some string at the end of each line:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <em class="parameter"><code>'s/$/EOL/'</code></em> <code class="filename">example</code></strong></span>
This is the first line of an example text.EOL
It is a text with erors.EOL
Lots of erors.EOL
So much erors, all these erors are making me sick.EOL
This is a line not containing any errors.EOL
This is the last line.EOL

<code class="prompt">sandy ~&gt;</code>
</pre><p>Multiple find and replace commands are separated with individual <code class="option">-e</code> options:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>sed <code class="option">-e</code> <em class="parameter"><code>'s/erors/errors/g'</code></em> <code class="option">-e</code> <em class="parameter"><code>'s/last/final/g'</code></em> <code class="filename">example</code></strong></span>
This is the first line of an example text.
It is a text with errors.
Lots of errors.
So much errors, all these errors are making me sick.
This is a line not containing any errors.
This is the final line.

<code class="prompt">sandy ~&gt;</code>
</pre><p>Keep in mind that by default <span class="command"><strong>sed</strong></span> prints its results to the standard output, most likely your terminal window.  If you want to save the output<a class="indexterm" name="idm3874"></a> to a file, redirect it:</p><div class="cmdsynopsis"><p><code class="command">sed <code class="option">option</code> <code class="function">'some/expression'</code> <code class="filename">file_to_process</code> &gt; <code class="filename">sed_output_in_a_file</code></code> </p></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">More examples</h3><p>Plenty of <span class="command"><strong>sed</strong></span> examples can be found in the startup scripts for your machine, which are usually in <code class="filename">/etc/init.d</code> or <code class="filename">/etc/rc.d/init.d</code>.  Change into the directory containing the initscripts on your system and issue the following command:</p><div class="cmdsynopsis"><p><code class="command">grep <em class="parameter"><code>sed</code></em> <code class="filename">*</code></code> </p></div></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_05_03"></a>3. Non-interactive editing</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_05_03_01"></a>3.1. Reading sed commands from a file</h3></div></div></div><p>Multiple <span class="command"><strong>sed</strong></span> commands can be put in a file and executed using<a class="indexterm" name="idm3899"></a> the <code class="option">-f</code> option.  When creating such a file, make sure that:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>No trailing white spaces exist at the end of lines.</p></li><li class="listitem"><p>No quotes are used.</p></li><li class="listitem"><p>When entering text to add or replace, all except the last line end in a backslash.</p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_05_03_02"></a>3.2. Writing output files</h3></div></div></div><p>Writing output is done using the output redirection<a class="indexterm" name="idm3913"></a> operator <span class="command"><strong>&gt;</strong></span>.  This is an example script<a class="indexterm" name="idm3917"></a> used to create very simple HTML files from plain text files.</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>cat <code class="filename">script.sed</code></strong></span>
1i\
&lt;html&gt;\
&lt;head&gt;&lt;title&gt;sed generated html&lt;/title&gt;&lt;/head&gt;\
&lt;body bgcolor="#ffffff"&gt;\
&lt;pre&gt;
$a\
&lt;/pre&gt;\
&lt;/body&gt;\
&lt;/html&gt;

<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>cat <code class="filename">txt2html.sh</code></strong></span>
#!/bin/bash

# This is a simple script that you can use for converting text into HTML.
# First we take out all newline characters, so that the appending only happens
# once, then we replace the newlines.

echo "converting $1..."

SCRIPT="/home/sandy/scripts/script.sed"
NAME="$1"
TEMPFILE="/var/tmp/sed.$PID.tmp"
sed "s/\n/^M/" $1 | sed -f $SCRIPT | sed "s/^M/\n/" &gt; $TEMPFILE
mv $TEMPFILE $NAME

echo "done."

<code class="prompt">sandy ~&gt;</code>
</pre><p><code class="varname">$1</code> holds the first argument to a given command, in this case the name of the file to convert:</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>cat <code class="filename">test</code></strong></span>
line1
line2
line3
</pre><p>More on positional parameters in <a class="xref" href="#chap_07" title="Chapter 7. Conditional statements">Chapter 7, <i>Conditional statements</i></a>.</p><pre class="screen">
<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>txt2html.sh <code class="filename">test</code></strong></span>
converting test...
done.

<code class="prompt">sandy ~&gt;</code> <span class="command"><strong>cat <code class="filename">test</code></strong></span>
&lt;html&gt;
&lt;head&gt;&lt;title&gt;sed generated html&lt;/title&gt;&lt;/head&gt;
&lt;body bgcolor="#ffffff"&gt;
&lt;pre&gt;
line1
line2
line3
&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;

<code class="prompt">sandy ~&gt;</code>
</pre><p>This is not really how it is done; this example just demonstrates <span class="command"><strong>sed</strong></span> capabilities.  See <a class="xref" href="#sect_06_03" title="3. Gawk variables">Section 3, &#8220;Gawk variables&#8221;</a> for a more decent solution to this problem, using <span class="command"><strong>awk</strong></span> <span class="emphasis"><em>BEGIN</em></span> and <span class="emphasis"><em>END</em></span> constructs.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Easy sed</h3><p>Advanced editors, supporting syntax highlighting, can recognize <span class="command"><strong>sed</strong></span> syntax.  This can be a great help if you tend to forget backslashes and such.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_05_04"></a>4. Summary</h2></div></div></div><p>The <span class="command"><strong>sed</strong></span> stream editor is a powerful command line tool, which can handle streams of data: it can take input lines from a pipe.  This makes it fit for non-interactive use.  The <span class="command"><strong>sed</strong></span> editor uses <span class="command"><strong>vi</strong></span>-like commands and accepts regular expressions.</p><p>The <span class="command"><strong>sed</strong></span> tool can read commands from the command line or from a script.  It is often used to perform find-and-replace actions on lines containing a pattern.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_05_05"></a>5. Exercises</h2></div></div></div><p>These exercises are meant to further demonstrate what <span class="command"><strong>sed</strong></span> can do.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Print a list of files in your <code class="filename">scripts</code> directory, ending in <span class="quote">&#8220;<span class="quote">.sh</span>&#8221;</span>.  Mind that you might have to unalias <span class="command"><strong>ls</strong></span>.  Put the result in a temporary file.</p></li><li class="listitem"><p>Make a list of files in <code class="filename">/usr/bin</code> that have the letter <span class="quote">&#8220;<span class="quote">a</span>&#8221;</span> as the second character.  Put the result in a temporary file.</p></li><li class="listitem"><p>Delete the first 3 lines of each temporary file.</p></li><li class="listitem"><p>Print to standard output only the lines containing the pattern <span class="quote">&#8220;<span class="quote">an</span>&#8221;</span>.</p></li><li class="listitem"><p>Create a file holding <span class="command"><strong>sed</strong></span> commands to perform the previous two tasks.  Add an extra command to this file that adds a string like <span class="quote">&#8220;<span class="quote">*** This might have something to do with man and man pages ***</span>&#8221;</span> in the line preceding every occurence of the string <span class="quote">&#8220;<span class="quote">man</span>&#8221;</span>.  Check the results.</p></li><li class="listitem"><p>A long listing of the root directory, <code class="filename">/</code>, is used for input.  Create a file holding <span class="command"><strong>sed</strong></span> commands that check for symbolic links and plain files.  If a file is a symbolic link, precede it with a line like <span class="quote">&#8220;<span class="quote">--This is a symlink--</span>&#8221;</span>.  If the file is a plain file, add a string on the same line, adding a comment like <span class="quote">&#8220;<span class="quote">&lt;--- this is a plain file</span>&#8221;</span>.</p></li><li class="listitem"><p>Create a script that shows lines containing trailing white spaces from a file.  This script should use a <span class="command"><strong>sed</strong></span> script and show sensible information to the user.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_06"></a>Chapter 6. The GNU awk programming language</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_06_01">1. Getting started with gawk</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_06_01_01">1.1. What is gawk?</a></span></dt><dt><span class="sect2"><a href="#sect_06_01_02">1.2. Gawk commands</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_06_02">2. The print program</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_06_02_01">2.1. Printing selected fields</a></span></dt><dt><span class="sect2"><a href="#sect_06_02_02">2.2. Formatting fields</a></span></dt><dt><span class="sect2"><a href="#sect_06_02_03">2.3. The print command and regular expressions</a></span></dt><dt><span class="sect2"><a href="#sect_06_02_04">2.4. Special patterns</a></span></dt><dt><span class="sect2"><a href="#sect_06_02_05">2.5. Gawk scripts</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_06_03">3. Gawk variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_06_03_01">3.1. The input field separator</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_02">3.2. The output separators</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_03">3.3. The number of records</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_04">3.4. User defined variables</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_05">3.5. More examples</a></span></dt><dt><span class="sect2"><a href="#sect_06_03_06">3.6. The printf program</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_06_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_06_05">5. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this chapter we will discuss:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>What is <span class="application">gawk</span>?</p></li><li class="listitem"><p>Using <span class="application">gawk</span> commands on the command line</p></li><li class="listitem"><p>How to format text with <span class="application">gawk</span></p></li><li class="listitem"><p>How <span class="application">gawk</span> uses regular expressions</p></li><li class="listitem"><p><span class="application">Gawk</span> in scripts</p></li><li class="listitem"><p><span class="application">Gawk</span> and variables</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">To make it more fun</h3><p>As with <span class="command"><strong>sed</strong></span>, entire books have been written about various versions of <span class="command"><strong>awk<a class="indexterm" name="idm4025"></a></strong></span>.  This introduction is far from complete and is only intended for understanding examples in the following chapters.  For more information, best start with the documentation that comes with <span class="application">GNU awk</span>: <span class="quote">&#8220;<span class="quote">GAWK: Effective AWK Programming: A User's Guide for GNU Awk</span>&#8221;</span>.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_06_01"></a>1. Getting started with gawk</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_01_01"></a>1.1. What is gawk?</h3></div></div></div><p><span class="application">Gawk<a class="indexterm" name="idm4036"></a></span> is the GNU version of the commonly available UNIX <span class="command"><strong>awk</strong></span> program<a class="indexterm" name="idm4040"></a>, another popular stream editor.  Since the <span class="command"><strong>awk</strong></span> program is often just a link to <span class="command"><strong>gawk</strong></span>, we will refer to it as <span class="command"><strong>awk</strong></span>.</p><p>The basic function of <span class="command"><strong>awk</strong></span> is to search files for lines or other text units containing one or more patterns.  When a line matches one of the patterns, special actions are performed on that line.</p><p>Programs in <span class="command"><strong>awk</strong></span> are different from programs in most other languages, because <span class="command"><strong>awk</strong></span> programs are <span class="quote">&#8220;<span class="quote">data-driven</span>&#8221;</span>: you describe the data you want to work with and then what to do when you
find it.  Most other languages are <span class="quote">&#8220;<span class="quote">procedural.</span>&#8221;</span>  You have to describe, in great detail, every step the program is to take.  When working with procedural languages, it is usually much harder to clearly describe the data your program will process.  For this reason, <span class="command"><strong>awk</strong></span> programs are often refreshingly easy to read and write.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">What does it really mean?</h3><p>Back in the 1970s, three programmers got together to create this language.  Their names were Aho, Kernighan and Weinberger.  They took the first character of each of their names and put them together.  So the name of the language might just as well have been <span class="quote">&#8220;<span class="quote">wak</span>&#8221;</span>.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_01_02"></a>1.2. Gawk commands</h3></div></div></div><p>When you run <span class="command"><strong>awk</strong></span>, you specify an <span class="command"><strong>awk</strong></span> <span class="emphasis"><em>program</em></span> that tells <span class="command"><strong>awk</strong></span> what to do.  The program consists of a series of <span class="emphasis"><em>rules</em></span>.  (It may also
contain function definitions, loops, conditions and other programming constructs, advanced features that we will ignore for now.)  Each rule specifies one pattern to search for and one action to perform upon finding the pattern.</p><p>There are several ways to run <span class="command"><strong>awk</strong></span>.  If the program is short, it is easiest to run it on the command line<a class="indexterm" name="idm4068"></a>:</p><div class="cmdsynopsis"><p><code class="command">awk PROGRAM <code class="filename">inputfile(s)</code></code> </p></div><p>If multiple changes have to be made, possibly regularly and on multiple files, it is easier to put the <span class="command"><strong>awk</strong></span> commands<a class="indexterm" name="idm4076"></a> in a script.  This is read like this:</p><div class="cmdsynopsis"><p><code class="command">awk <code class="option">-f</code> <code class="filename">PROGRAM-FILE</code> <code class="filename">inputfile(s)</code></code> </p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_06_02"></a>2. The print program</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_02_01"></a>2.1. Printing selected fields</h3></div></div></div><p>The <span class="command"><strong>print</strong></span> command in <span class="command"><strong>awk</strong></span> outputs selected data<a class="indexterm" name="idm4091"></a> from the input file.</p><p>When <span class="command"><strong>awk</strong></span> reads a line of a file, it divides the line in fields based on the specified <span class="emphasis"><em>input field separator</em></span>, <code class="varname">FS</code>, which is an <span class="command"><strong>awk</strong></span> variable (see <a class="xref" href="#sect_06_03_02" title="3.2. The output separators">Section 3.2, &#8220;The output separators&#8221;</a>).  This variable is predefined to be one or more spaces or tabs.</p><p>The variables <code class="varname">$1</code>, <code class="varname">$2</code>, <code class="varname">$3</code>, ..., <code class="varname">$N</code> hold the values of the first, second, third until the last field of an input line<a class="indexterm" name="idm4105"></a>.  The variable <code class="varname">$0</code> (zero) holds the value of the entire line.  This is depicted in the image below, where we see six colums in the output of the <span class="command"><strong>df</strong></span> command:</p><div class="figure"><a name="idm4110"></a><p class="title"><b>Figure 6.1. Fields in awk</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/awk.png" alt="Fields as interpreted by awk: first column is $1, second column is $2 and so on."></div></div></div><br class="figure-break"><p>In the output of <span class="command"><strong>ls <code class="option">-l</code></strong></span>, there are 9 columns.  The <span class="command"><strong>print</strong></span> statement uses these fields<a class="indexterm" name="idm4123"></a> as follows:</p><pre class="screen">
<code class="prompt">kelly@octarine ~/test&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> | awk <em class="parameter"><code>'{ print $5 $9 }'</code></em></strong></span>
160orig
121script.sed
120temp_file
126test
120twolines
441txt2html.sh

<code class="prompt">kelly@octarine ~/test&gt;</code>
</pre><p>This command printed the fifth column of a long file listing, which contains the file size, and the last column, the name of the file.  This output is not very readable unless you use the official way of referring to columns, which is to separate the ones that you want to print with a comma.  In that case, the default output separater character, usually a space, will be put in between each output field.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Local configuration</h3><p>Note that the configuration of the output of the <span class="command"><strong>ls <code class="option">-l</code></strong></span> command might be different on your system.  Display of time and date is dependent on your locale setting.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_02_02"></a>2.2. Formatting fields</h3></div></div></div><p>Without formatting, using only the output separator, the output looks rather poor.  Inserting a couple of tabs<a class="indexterm" name="idm4141"></a> and a string to indicate what output this is will make it look a lot better:</p><pre class="screen">
<code class="prompt">kelly@octarine ~/test&gt;</code> <span class="command"><strong>ls <code class="option">-ldh</code> <code class="filename">*</code> | grep <code class="option">-v</code> <em class="parameter"><code>total</code></em> | \ 
awk <em class="parameter"><code>'{ print "Size is " $5 " bytes for " $9 }'</code></em></strong></span>
Size is 160 bytes for orig
Size is 121 bytes for script.sed
Size is 120 bytes for temp_file
Size is 126 bytes for test
Size is 120 bytes for twolines
Size is 441 bytes for txt2html.sh

<code class="prompt">kelly@octarine ~/test&gt;</code>
</pre><p>Note the use of the backslash, which makes long input continue on the next line without the shell interpreting this as a separate command.  While your command line input can be of virtually unlimited length, your monitor is not, and printed paper certainly isn't.  Using the backslash also allows for copying and pasting of the above lines into a terminal window.</p><p>The <code class="option">-h</code> option to <span class="command"><strong>ls</strong></span> is used for supplying humanly readable size formats for bigger files.  The output of a long listing displaying the total amount of blocks in the directory is given when a directory is the argument.  This line is useless to us, so we add an asterisk.  We also add the <code class="option">-d</code> option for the same reason, in case asterisk expands to a directory.</p><p>The backslash in this example marks the continuation of a line. See <a class="xref" href="#sect_03_03_02" title="3.2. Escape characters">Section 3.2, &#8220;Escape characters&#8221;</a>.</p><p>You can take out any number of columns and even reverse the order.  In the example below this is demonstrated for showing the most critical partitions<a class="indexterm" name="idm4161"></a>:</p><pre class="screen">
<code class="prompt">kelly@octarine ~&gt;</code> <span class="command"><strong>df <code class="option">-h</code> | sort <code class="option">-rnk</code> <em class="parameter"><code>5</code></em> | head <em class="parameter"><code>-3</code></em> | \ 
awk <em class="parameter"><code>'{ print "Partition " $6 "\t: " $5 " full!" }'</code></em></strong></span>
Partition /var  : 86% full!
Partition /usr  : 85% full!
Partition /home : 70% full!

<code class="prompt">kelly@octarine ~&gt;</code>
</pre><p>The table below gives an overview of special formatting<a class="indexterm" name="idm4174"></a> characters:</p><div class="table"><a name="tab_06_01"></a><p class="title"><b>Table 6.1. Formatting characters for gawk</b></p><div class="table-contents"><table class="table" summary="Formatting characters for gawk" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Sequence</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left">\a</td><td align="left">Bell character</td></tr><tr><td align="left">\n</td><td align="left">Newline character</td></tr><tr><td align="left">\t</td><td align="left">Tab</td></tr></tbody></table></div></div><br class="table-break"><p>Quotes, dollar signs and other meta-characters should be escaped with a backslash.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_02_03"></a>2.3. The print command and regular expressions</h3></div></div></div><p>A regular expression can be used as a pattern by enclosing it in slashes.  The regular expression<a class="indexterm" name="idm4198"></a> is then tested against the entire text of each record.  The syntax is as follows:</p><div class="cmdsynopsis"><p><code class="command">awk 'EXPRESSION  { PROGRAM }' <code class="filename">file(s)</code></code> </p></div><p>The following example displays only local disk device information, networked file systems are not shown<a class="indexterm" name="idm4205"></a>:</p><pre class="screen">
<code class="prompt">kelly is in ~&gt;</code> <span class="command"><strong>df <code class="option">-h</code> | awk <em class="parameter"><code>'/dev\/hd/ { print $6 "\t: " $5 }'</code></em></strong></span>
/       : 46%
/boot   : 10%
/opt    : 84%
/usr    : 97%
/var    : 73%
/.vol1  : 8%

<code class="prompt">kelly is in ~&gt;</code>
</pre><p>Slashes need to be escaped, because they have a special meaning to the <span class="command"><strong>awk</strong></span> program.</p><p>Below another example where we search the <code class="filename">/etc</code> directory for files ending in <span class="quote">&#8220;<span class="quote">.conf</span>&#8221;</span> and starting with either <span class="quote">&#8220;<span class="quote">a</span>&#8221;</span> <span class="emphasis"><em>or</em></span> <span class="quote">&#8220;<span class="quote">x</span>&#8221;</span>, using extended regular expressions:</p><pre class="screen">
<code class="prompt">kelly is in /etc&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> | awk <em class="parameter"><code>'/\&lt;(a|x).*\.conf$/ { print $9 }'</code></em></strong></span>
amd.conf
antivir.conf
xcdroast.conf
xinetd.conf

<code class="prompt">kelly is in /etc&gt;</code>
</pre><p>This example illustrates the special meaning of the dot in regular expressions: the first one indicates that we want to search for any character after the first search string, the second is escaped because it is part of a string to find (the end of the file name).</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_02_04"></a>2.4. Special patterns</h3></div></div></div><p>In order to precede output with comments<a class="indexterm" name="idm4232"></a>, use the <span class="command"><strong>BEGIN</strong></span> statement:</p><pre class="screen">
<code class="prompt">kelly is in /etc&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> | \
awk <em class="parameter"><code>'BEGIN { print "Files found:\n" } /\&lt;[a|x].*\.conf$/ { print $9 }'</code></em></strong></span>
Files found:
amd.conf
antivir.conf
xcdroast.conf
xinetd.conf

<code class="prompt">kelly is in /etc&gt;</code>
</pre><p>The <span class="command"><strong>END</strong></span> statement can be added for inserting text after the entire input is processed:</p><pre class="screen">
<code class="prompt">kelly is in /etc&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> | \
awk <em class="parameter"><code>'/\&lt;[a|x].*\.conf$/ { print $9 } END { print \
"Can I do anything else for you, mistress?" }'</code></em></strong></span>
amd.conf
antivir.conf
xcdroast.conf
xinetd.conf
Can I do anything else for you, mistress?

<code class="prompt">kelly is in /etc&gt;</code>
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_02_05"></a>2.5. Gawk scripts</h3></div></div></div><p>As commands tend to get a little longer, you might want to put them in a script<a class="indexterm" name="idm4253"></a>, so they are reusable.  An <span class="command"><strong>awk</strong></span> script contains <span class="command"><strong>awk</strong></span> statements defining patterns and actions.</p><p>As an illustration, we will build a report that displays our most loaded partitions<a class="indexterm" name="idm4259"></a>.  See <a class="xref" href="#sect_06_02_02" title="2.2. Formatting fields">Section 2.2, &#8220;Formatting fields&#8221;</a>.</p><pre class="screen">
<code class="prompt">kelly is in ~&gt;</code> <span class="command"><strong>cat <code class="filename">diskrep.awk</code></strong></span>
BEGIN { print "*** WARNING WARNING WARNING ***" }
/\&lt;[8|9][0-9]%/ { print "Partition " $6 "\t: " $5 " full!" }
END { print "*** Give money for new disks URGENTLY! ***" }

kelly is in ~&gt; df -h | awk -f diskrep.awk
*** WARNING WARNING WARNING ***
Partition /usr  : 97% full!
*** Give money for new disks URGENTLY! ***

<code class="prompt">kelly is in ~&gt;</code>
</pre><p><span class="command"><strong>awk</strong></span> first prints a begin message, then formats all the lines that contain an eight or a nine at the beginning of a word, followed by one other number and a percentage sign.  An end message is added.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Syntax highlighting</h3><p>Awk is a programming language.  Its syntax is recognized by most editors that can do syntax highlighting for other languages, such as C, Bash, HTML, etc.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_06_03"></a>3. Gawk variables</h2></div></div></div><p>As <span class="command"><strong>awk</strong></span> is processing the input file, it uses several variables<a class="indexterm" name="idm4277"></a>.  Some are editable, some are read-only.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_03_01"></a>3.1. The input field separator</h3></div></div></div><p>The <span class="emphasis"><em>field separator<a class="indexterm" name="idm4284"></a></em></span>, which is either a single character or a regular expression, controls the way <span class="command"><strong>awk</strong></span> splits up an input record into fields.  The input record is scanned for character sequences that match the separator definition; the fields themselves are the text between the matches.</p><p>The field separator is represented by the built-in variable <code class="varname">FS</code>.  Note that this is something different from the <code class="varname">IFS</code> variable used by POSIX-compliant shells.</p><p>The value of the field separator variable can be changed in the <span class="command"><strong>awk</strong></span> program with the assignment operator <span class="command"><strong>=</strong></span>.  Often the right time to do this is at the beginning of execution before any input has been processed, so that the very first record is read with the proper separator.  To do this, use the special <span class="command"><strong>BEGIN</strong></span> pattern.</p><p>In the example below, we build a command that displays all the users on your system with a description:</p><pre class="screen">
<code class="prompt">kelly is in ~&gt;</code> <span class="command"><strong>awk <em class="parameter"><code>'BEGIN { FS=":" } { print $1 "\t" $5 }'</code></em> <code class="filename">/etc/passwd</code></strong></span>
--output omitted--
kelly	Kelly Smith
franky	Franky B.
eddy	Eddy White
willy	William Black
cathy	Catherine the Great
sandy	Sandy Li Wong

<code class="prompt">kelly is in ~&gt;</code>
</pre><p>In an <span class="command"><strong>awk</strong></span> script, it would look like this:</p><pre class="screen">
<code class="prompt">kelly is in ~&gt;</code> <span class="command"><strong>cat <code class="filename">printnames.awk</code></strong></span>
BEGIN { FS=":" }
{ print $1 "\t" $5 }

<code class="prompt">kelly is in ~&gt;</code> <span class="command"><strong>awk <code class="option">-f</code> <code class="filename">printnames.awk /etc/passwd</code></strong></span>
--output omitted--
</pre><p>Choose input field separators carefully to prevent problems.  An example to illustrate this: say you get input in the form of lines that look like this:</p><p><span class="quote">&#8220;<span class="quote">Sandy L. Wong, 64 Zoo St., Antwerp, 2000X</span>&#8221;</span></p><p>You write a command line or a script, which prints out the name of the person in that record:</p><div class="cmdsynopsis"><p><code class="command">awk 'BEGIN { FS="," } { print $1, $2, $3 }' <code class="filename">inputfile</code></code> </p></div><p>But a person might have a PhD, and it might be written like this:</p><p><span class="quote">&#8220;<span class="quote">Sandy L. Wong, PhD, 64 Zoo St., Antwerp, 2000X</span>&#8221;</span></p><p>Your <span class="command"><strong>awk</strong></span> will give the wrong output for this line.  If needed, use an extra <span class="command"><strong>awk</strong></span> or <span class="command"><strong>sed</strong></span> to uniform data input formats.</p><p>The default input field separator is one or more whitespaces or tabs.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_03_02"></a>3.2. The output separators</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_06_03_02_01"></a>3.2.1. The output field separator</h4></div></div></div><p>Fields are normally separated by spaces in the output<a class="indexterm" name="idm4332"></a>.  This becomes apparent when you use the correct syntax for the <span class="command"><strong>print</strong></span> command, where arguments are separated by commas:</p><pre class="screen">
<code class="prompt">kelly@octarine ~/test&gt;</code> <span class="command"><strong>cat <code class="filename">test</code></strong></span>
record1         data1
record2         data2

<code class="prompt">kelly@octarine ~/test&gt;</code> <span class="command"><strong>awk <em class="parameter"><code>'{ print $1 $2}'</code></em> <code class="filename">test</code></strong></span>
record1data1
record2data2

<code class="prompt">kelly@octarine ~/test&gt;</code> <span class="command"><strong>awk <em class="parameter"><code>'{ print $1, $2}'</code></em> <code class="filename">test</code></strong></span>
record1 data1
record2 data2

<code class="prompt">kelly@octarine ~/test&gt;</code>
</pre><p>If you don't put in the commas, <span class="command"><strong>print</strong></span> will treat the items to output as one argument, thus omitting the use of the default <span class="emphasis"><em>output separator</em></span>, <code class="varname">OFS</code>.</p><p>Any character string may be used as the output field separator by setting this built-in variable.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_06_03_02_02"></a>3.2.2. The output record separator</h4></div></div></div><p>The output from an entire <span class="command"><strong>print</strong></span> statement is called an <span class="emphasis"><em>output record<a class="indexterm" name="idm4359"></a></em></span>.  Each <span class="command"><strong>print</strong></span> command results in one output record, and then outputs a string called the <span class="emphasis"><em>output record separator</em></span>, <code class="varname">ORS</code>.  The default value for this variable is <span class="quote">&#8220;<span class="quote">\n</span>&#8221;</span>, a newline character.  Thus, each <span class="command"><strong>print</strong></span> statement generates a separate line.</p><p>To change the way output fields and records are separated, assign new values to <code class="varname">OFS</code> and <code class="varname">ORS</code>:</p><pre class="screen">
<code class="prompt">kelly@octarine ~/test&gt;</code> <span class="command"><strong>awk <em class="parameter"><code>'BEGIN { OFS=";" ; ORS="\n--&gt;\n" } \
{ print $1,$2}'</code></em> <code class="filename">test</code></strong></span>
record1;data1
--&gt;
record2;data2
--&gt;

<code class="prompt">kelly@octarine ~/test&gt;</code>
</pre><p>If the value of <code class="varname">ORS</code> does not contain a newline, the program's output is run together on a single line.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_03_03"></a>3.3. The number of records</h3></div></div></div><p>The built-in <code class="varname">NR</code> holds the number of records<a class="indexterm" name="idm4382"></a> that are processed.  It is incremented after reading a new input line.  You can use it at the end to count the total number of records, or in each output record:</p><pre class="screen">
<code class="prompt">kelly@octarine ~/test&gt;</code> <span class="command"><strong>cat <code class="filename">processed.awk</code></strong></span>
BEGIN { OFS="-" ; ORS="\n--&gt; done\n" }
{ print "Record number " NR ":\t" $1,$2 }
END { print "Number of records processed: " NR }

<code class="prompt">kelly@octarine ~/test&gt;</code> <span class="command"><strong>awk <code class="option">-f</code> <code class="filename">processed.awk test</code></strong></span>
Record number 1:        record1-data1
--&gt; done
Record number 2:        record2-data2
--&gt; done
Number of records processed: 2
--&gt; done

<code class="prompt">kelly@octarine ~/test&gt;</code>
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_03_04"></a>3.4. User defined variables</h3></div></div></div><p>Apart from the built-in variables, you can define your own.  When <span class="command"><strong>awk</strong></span> encounters a reference to a variable<a class="indexterm" name="idm4398"></a> which does not exist (which is not predefined), the variable is created and initialized to a null string.  For all subsequent references, the value of the variable is whatever value was assigned last.  Variables can be a string or a numeric value.  Content of input fields can also be assigned to variables.</p><p>Values can be assigned directly using the <span class="command"><strong>=</strong></span> operator, or you can use the current value of the variable in combination with other operators:</p><pre class="screen">
<code class="prompt">kelly@octarine ~&gt;</code> <span class="command"><strong>cat <code class="filename">revenues</code></strong></span>
20021009        20021013        consultancy     BigComp         2500
20021015        20021020        training        EduComp         2000
20021112        20021123        appdev          SmartComp       10000
20021204        20021215        training        EduComp         5000

<code class="prompt">kelly@octarine ~&gt;</code> <span class="command"><strong>cat <code class="filename">total.awk</code></strong></span>
{ total=total + $5 }
{ print "Send bill for " $5 " dollar to " $4 }
END { print "---------------------------------\nTotal revenue: " total }

<code class="prompt">kelly@octarine ~&gt;</code> <span class="command"><strong>awk <code class="option">-f</code> <code class="filename">total.awk test</code></strong></span>
Send bill for 2500 dollar to BigComp
Send bill for 2000 dollar to EduComp
Send bill for 10000 dollar to SmartComp
Send bill for 5000 dollar to EduComp
---------------------------------
Total revenue: 19500

<code class="prompt">kelly@octarine ~&gt;</code>
</pre><p>C-like shorthands like <span class="command"><strong><code class="varname">VAR</code>+= value</strong></span> are also accepted.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_03_05"></a>3.5. More examples</h3></div></div></div><p>The example from <a class="xref" href="#sect_05_03_02" title="3.2. Writing output files">Section 3.2, &#8220;Writing output files&#8221;</a> becomes much easier when we use an <span class="command"><strong>awk</strong></span> script<a class="indexterm" name="idm4423"></a>:</p><pre class="screen">
<code class="prompt">kelly@octarine ~/html&gt;</code> <span class="command"><strong>cat <code class="filename">make-html-from-text.awk</code></strong></span>
BEGIN { print "&lt;html&gt;\n&lt;head&gt;&lt;title&gt;Awk-generated HTML&lt;/title&gt;&lt;/head&gt;\n&lt;body bgcolor=\"#ffffff\"&gt;\n&lt;pre&gt;" }
{ print $0 }
END { print "&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;" }
</pre><p>And the command to execute is also much more straightforward when using <span class="command"><strong>awk</strong></span> instead of <span class="command"><strong>sed</strong></span>:</p><pre class="screen">
<code class="prompt">kelly@octarine ~/html&gt;</code> <span class="command"><strong>awk <code class="option">-f</code> <code class="filename">make-html-from-text.awk testfile</code> &gt; <code class="filename">file.html</code></strong></span>
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Awk examples on your system</h3><p>We refer again to the directory containing the initscripts on your system.  Enter a command similar to the following to see more practical examples of the widely spread usage of the <span class="command"><strong>awk</strong></span> command:</p><div class="cmdsynopsis"><p><code class="command">grep <em class="parameter"><code>awk</code></em> <code class="filename">/etc/init.d/*</code></code> </p></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_06_03_06"></a>3.6. The printf program</h3></div></div></div><p>For more precise control over the output format than what is normally provided by <span class="command"><strong>print</strong></span>, use <span class="command"><strong>printf<a class="indexterm" name="idm4452"></a></strong></span>.  The <span class="command"><strong>printf</strong></span> command can be used to specify the field width to use for each item, as well as various formatting choices for numbers (such as what output base to use, whether to print an exponent, whether to print a sign, and how many digits to print after the decimal point).  This is done by supplying a string, called the <span class="emphasis"><em>format string</em></span>, that controls how and where to print the other arguments.</p><p>The syntax is the same as for the C-language <span class="command"><strong>printf</strong></span> statement; see your C introduction guide.  The <span class="command"><strong>gawk</strong></span> info pages contain full explanations.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_06_04"></a>4. Summary</h2></div></div></div><p>The <span class="command"><strong>gawk</strong></span> utility interprets a special-purpose programming language, handling simple data-reformatting jobs with just a few lines of code.  It is the free version of the general UNIX <span class="command"><strong>awk</strong></span> command.</p><p>This tools reads lines of input data and can easily recognize columned output.  The <span class="command"><strong>print</strong></span> program is the most common for filtering and formatting defined fields.</p><p>On-the-fly variable declaration is straightforward and allows for simple calculation of sums, statistics and other operations on the processed input stream.  Variables and commands can be put in <span class="command"><strong>awk</strong></span> scripts for background processing.</p><p>Other things you should know about <span class="command"><strong>awk</strong></span>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The language remains well-known on UNIX and alikes, but for executing similar tasks, <span class="application">Perl</span> is now more commonly used.  However, <span class="command"><strong>awk</strong></span> has a much steeper learning curve (meaning that you learn a lot in a very short time).  In other words, <span class="application">Perl</span> is more difficult to learn.</p></li><li class="listitem"><p>Both <span class="application">Perl</span> and <span class="command"><strong>awk</strong></span> share the reputation of being incomprehensible, even to the actual authors of the programs that use these languages.  So document your code!</p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_06_05"></a>5. Exercises</h2></div></div></div><p>These are some practical examples where <span class="command"><strong>awk</strong></span> can be useful.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>For the first exercise, your input is lines in the following form:</p><pre class="screen">Username:Firstname:Lastname:Telephone number</pre><p>Make an <span class="command"><strong>awk</strong></span> script that will convert such a line to an LDAP record in this format:</p><pre class="screen">
dn: uid=Username, dc=example, dc=com
cn: Firstname Lastname
sn: Lastname
telephoneNumber: Telephone number
</pre><p>Create a file containing a couple of test records and check.</p></li><li class="listitem"><p>Create a Bash script using <span class="command"><strong>awk</strong></span> and standard UNIX commands that will show the top three users of disk space in the <code class="filename">/home</code> file system (if you don't have the directory holding the homes on a separate partition, make the script for the <code class="filename">/</code> partition; this is present on every UNIX system).  First, execute the commands from the command line.  Then put them in a script.  The script should create sensible output (sensible as in readable by the boss).  If everything proves to work, have the script email its results to you (use for instance <span class="command"><strong>mail <code class="option">-s</code> <em class="parameter"><code>Disk space usage</code></em> <code class="email">&lt;<a class="email" href="mailto:you@your_comp">you@your_comp</a>&gt;</code> &lt; <code class="filename">result</code></strong></span>).</p><p>If the quota daemon is running, use that information; if not, use <span class="command"><strong>find</strong></span>.</p></li><li class="listitem"><p>Create XML-style output from a <span class="keycap"><strong>Tab</strong></span>-separated list in the following form:</p><pre class="screen">
Meaning very long line with a lot of description
 
meaning another long line
 
othermeaning    more longline
 
testmeaning     looooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooong line, but i mean really looooooooooooooooooooooooooooooooooooooooooooooooooong.
 
</pre><p>The output should read:</p><pre class="screen">
&lt;row&gt;
&lt;entry&gt;Meaning&lt;/entry&gt;
&lt;entry&gt;
very long line
&lt;/entry&gt;
&lt;/row&gt;
&lt;row&gt;
&lt;entry&gt;meaning&lt;/entry&gt;
&lt;entry&gt;
long line
&lt;/entry&gt;
&lt;/row&gt;
&lt;row&gt;
&lt;entryothermeaning&lt;/entry&gt;
&lt;entry&gt;
more longline
&lt;/entry&gt;
&lt;/row&gt;
&lt;row&gt;
&lt;entrytestmeaning&lt;/entry&gt;
&lt;entry&gt;
looooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooong line, but i mean really looooooooooooooooooooooooooooooooooooooooooooooooooong.
&lt;/entry&gt;
&lt;/row&gt;
</pre><p>Additionally, if you know anything about XML, write a BEGIN and END script to complete the table.  Or do it in HTML.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_07"></a>Chapter 7. Conditional statements</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_07_01">1. Introduction to if</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_07_01_01">1.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_07_01_02">1.2. Simple applications of if</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_07_02">2. More advanced if usage</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_07_02_01">2.1. if/then/else constructs</a></span></dt><dt><span class="sect2"><a href="#sect_07_02_02">2.2. if/then/elif/else constructs</a></span></dt><dt><span class="sect2"><a href="#sect_07_02_03">2.3. Nested if statements</a></span></dt><dt><span class="sect2"><a href="#sect_07_02_04">2.4. Boolean operations</a></span></dt><dt><span class="sect2"><a href="#sect_07_02_05">2.5. Using the exit statement and if</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_07_03">3. Using case statements</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_07_03_01">3.1. Simplified conditions</a></span></dt><dt><span class="sect2"><a href="#sect_07_03_02">3.2. Initscript example</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_07_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_07_05">5. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this chapter we will discuss the use of conditionals in Bash scripts.  This includes the following topics:</p><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The <span class="command"><strong>if</strong></span> statement</p></li><li class="listitem"><p>Using the exit status of a command</p></li><li class="listitem"><p>Comparing and testing input and files</p></li><li class="listitem"><p><span class="command"><strong>if/then/else</strong></span> constructs</p></li><li class="listitem"><p><span class="command"><strong>if/then/elif/else</strong></span> constructs</p></li><li class="listitem"><p>Using and testing the positional parameters</p></li><li class="listitem"><p>Nested <span class="command"><strong>if</strong></span> statements</p></li><li class="listitem"><p>Boolean expressions</p></li><li class="listitem"><p>Using <span class="command"><strong>case</strong></span> statements</p></li></ul></div><p>
</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_07_01"></a>1. Introduction to if</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_01_01"></a>1.1. General</h3></div></div></div><p>At times you need to specify different courses of action to be taken in a shell script, depending on the success or failure of a command.  The <span class="command"><strong>if</strong></span> construction allows you to specify such conditions.</p><p>The most compact syntax of the <span class="command"><strong>if</strong></span> command is:</p><div class="cmdsynopsis"><p><code class="command">if TEST-COMMANDS; then CONSEQUENT-COMMANDS; fi</code> </p></div><p>The <span class="command"><strong>TEST-COMMAND</strong></span> list is executed, and if its return status is zero, the <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> list is executed.  The return status is the exit status of the last command executed, or zero if no condition tested true.</p><p>The <span class="command"><strong>TEST-COMMAND</strong></span> often involves numerical or string comparison tests, but it can also be any command that returns a status of zero when it succeeds and some other status when it fails.  Unary expressions are often used to examine the status of a file.  If the <code class="filename">FILE</code> argument to one of the primaries is of the form <code class="filename">/dev/fd/N</code>, then file descriptor <span class="quote">&#8220;<span class="quote">N</span>&#8221;</span> is checked.  <code class="filename">stdin</code>, <code class="filename">stdout</code> and <code class="filename">stderr</code> and their respective file descriptors may also be used for tests.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_01_01_01"></a>1.1.1. Expressions used with if</h4></div></div></div><p>The table below contains an overview of the so-called <span class="quote">&#8220;<span class="quote">primaries</span>&#8221;</span> that make up the <span class="command"><strong>TEST-COMMAND</strong></span> command or list of commands.  These primaries are put between square brackets to indicate the test of a conditional expression.</p><div class="table"><a name="tab_07_01"></a><p class="title"><b>Table 7.1. Primary expressions</b></p><div class="table-contents"><table class="table" summary="Primary expressions" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Primary</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left">[ <code class="option">-a</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists.</td></tr><tr><td align="left">[ <code class="option">-b</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is a block-special file.</td></tr><tr><td align="left">[ <code class="option">-c</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is a character-special file.</td></tr><tr><td align="left">[ <code class="option">-d</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is a directory.</td></tr><tr><td align="left">[ <code class="option">-e</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists.</td></tr><tr><td align="left">[ <code class="option">-f</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is a regular file.</td></tr><tr><td align="left">[ <code class="option">-g</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and its SGID bit is set.</td></tr><tr><td align="left">[ <code class="option">-h</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is a symbolic link.</td></tr><tr><td align="left">[ <code class="option">-k</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and its sticky bit is set.</td></tr><tr><td align="left">[ <code class="option">-p</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is a named pipe (FIFO).</td></tr><tr><td align="left">[ <code class="option">-r</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is readable.</td></tr><tr><td align="left">[ <code class="option">-s</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and has a size greater than zero.</td></tr><tr><td align="left">[ <code class="option">-t</code> <code class="filename">FD</code> ]</td><td align="left">True if file descriptor <code class="filename">FD</code> is open and refers to a terminal.</td></tr><tr><td align="left">[ <code class="option">-u</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and its SUID (set user ID) bit is set.</td></tr><tr><td align="left">[ <code class="option">-w</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is writable.</td></tr><tr><td align="left">[ <code class="option">-x</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is executable.</td></tr><tr><td align="left">[ <code class="option">-O</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is owned by the effective user ID.</td></tr><tr><td align="left">[ <code class="option">-G</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is owned by the effective group ID.</td></tr><tr><td align="left">[ <code class="option">-L</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is a symbolic link.</td></tr><tr><td align="left">[ <code class="option">-N</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and has been modified since it was last read.</td></tr><tr><td align="left">[ <code class="option">-S</code> <code class="filename">FILE</code> ]</td><td align="left">True if <code class="filename">FILE</code> exists and is a socket.</td></tr><tr><td align="left">[ <code class="filename">FILE1</code> <code class="option">-nt</code> <code class="filename">FILE2</code> ]</td><td align="left">True if <code class="filename">FILE1</code> has been changed more recently than <code class="filename">FILE2</code>, or if <code class="filename">FILE1</code> exists and <code class="filename">FILE2</code> does not.</td></tr><tr><td align="left">[ <code class="filename">FILE1</code> <code class="option">-ot</code> <code class="filename">FILE2</code> ]</td><td align="left">True if <code class="filename">FILE1</code> is older than <code class="filename">FILE2</code>, or is <code class="filename">FILE2</code> exists and <code class="filename">FILE1</code> does not.</td></tr><tr><td align="left">[ <code class="filename">FILE1</code> <code class="option">-ef</code> <code class="filename">FILE2</code> ]</td><td align="left">True if <code class="filename">FILE1</code> and <code class="filename">FILE2</code> refer to the same device and inode numbers.</td></tr><tr><td align="left">[ <code class="option">-o</code> OPTIONNAME ]</td><td align="left">True if shell option <span class="quote">&#8220;<span class="quote">OPTIONNAME</span>&#8221;</span> is enabled.</td></tr><tr><td align="left"><code class="option">[ -z</code> STRING ]</td><td align="left">True if the length of <span class="quote">&#8220;<span class="quote">STRING</span>&#8221;</span> is zero.</td></tr><tr><td align="left"><code class="option">[ -n</code> STRING ] or [ STRING ]</td><td align="left">True if the length of <span class="quote">&#8220;<span class="quote">STRING</span>&#8221;</span> is non-zero.</td></tr><tr><td align="left">[ STRING1 == STRING2 ] </td><td align="left">True if the strings are equal.  <span class="quote">&#8220;<span class="quote">=</span>&#8221;</span> may be used instead of <span class="quote">&#8220;<span class="quote">==</span>&#8221;</span> for strict POSIX compliance.</td></tr><tr><td align="left">[ STRING1 != STRING2 ] </td><td align="left">True if the strings are not equal.</td></tr><tr><td align="left">[ STRING1 &lt; STRING2 ] </td><td align="left">True if <span class="quote">&#8220;<span class="quote">STRING1</span>&#8221;</span> sorts before <span class="quote">&#8220;<span class="quote">STRING2</span>&#8221;</span> lexicographically in the current locale.</td></tr><tr><td align="left">[ STRING1 &gt; STRING2 ] </td><td align="left">True if <span class="quote">&#8220;<span class="quote">STRING1</span>&#8221;</span> sorts after <span class="quote">&#8220;<span class="quote">STRING2</span>&#8221;</span> lexicographically in the current locale.</td></tr><tr><td align="left">[ ARG1 OP ARG2 ]</td><td align="left"><span class="quote">&#8220;<span class="quote">OP</span>&#8221;</span> is one of <code class="option">-eq</code>, <code class="option">-ne</code>, <code class="option">-lt</code>, <code class="option">-le</code>, <code class="option">-gt</code> or <code class="option">-ge</code>.  These arithmetic<a class="indexterm" name="idm4772"></a> binary operators return true if <span class="quote">&#8220;<span class="quote">ARG1</span>&#8221;</span> is equal to, not equal to, less than, less than or equal to, greater than, or greater than or equal to <span class="quote">&#8220;<span class="quote">ARG2</span>&#8221;</span>, respectively.  <span class="quote">&#8220;<span class="quote">ARG1</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">ARG2</span>&#8221;</span> are integers.</td></tr></tbody></table></div></div><br class="table-break"><p>Expressions may be combined using the following operators, listed in decreasing order of precedence:</p><div class="table"><a name="tab_07_02"></a><p class="title"><b>Table 7.2. Combining expressions</b></p><div class="table-contents"><table class="table" summary="Combining expressions" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Operation</th><th align="left">Effect</th></tr></thead><tbody><tr><td align="left">[ ! EXPR ]</td><td align="left">True if <span class="command"><strong>EXPR</strong></span> is false.</td></tr><tr><td align="left">[ ( EXPR ) ]</td><td align="left">Returns the value of <span class="command"><strong>EXPR</strong></span>.  This may be used to override the normal precedence of operators.</td></tr><tr><td align="left">[ EXPR1 -a EXPR2 ]</td><td align="left">True if both <span class="command"><strong>EXPR1</strong></span> and <span class="command"><strong>EXPR2</strong></span> are true.</td></tr><tr><td align="left">[ EXPR1 -o EXPR2 ]</td><td align="left">True if either <span class="command"><strong>EXPR1</strong></span> or <span class="command"><strong>EXPR2</strong></span> is true.</td></tr></tbody></table></div></div><br class="table-break"><p>The <span class="command"><strong>[</strong></span> (or <span class="command"><strong>test</strong></span>) built-in evaluates conditional expressions using a set of rules based on the number of arguments.  More information about this subject can be found in the Bash documentation.  Just like the <span class="command"><strong>if</strong></span> is closed with <span class="command"><strong>fi</strong></span>, the opening square bracket should be closed after the conditions have been listed.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_01_01_02"></a>1.1.2. Commands following the then statement</h4></div></div></div><p>The <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> list that follows the <span class="command"><strong>then</strong></span> statement can be any valid UNIX command, any executable program, any executable shell script or any shell statement, with the exception of the closing <span class="command"><strong>fi</strong></span>.  It is important to remember that the <span class="command"><strong>then</strong></span> and <span class="command"><strong>fi</strong></span> are considered to be separated statements in the shell.  Therefore, when issued on the command line, they are separated by a semi-colon.</p><p>In a script, the different parts of the <span class="command"><strong>if</strong></span> statement are usually well-separated.  Below, a couple of simple examples.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_01_01_03"></a>1.1.3. Checking files</h4></div></div></div><p>The first example checks for the existence of a file:</p><pre class="screen">
<code class="prompt">anny ~&gt;</code> <span class="command"><strong>cat <code class="filename">msgcheck.sh</code></strong></span>
#!/bin/bash

echo "This scripts checks the existence of the messages file."
echo "Checking..."
if [ -f /var/log/messages ]
  then
    echo "/var/log/messages exists."
fi
echo
echo "...done."

<code class="prompt">anny ~&gt;</code> <span class="command"><strong>./msgcheck.sh</strong></span>
This scripts checks the existence of the messages file.
Checking...
/var/log/messages exists.

...done.
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_01_01_04"></a>1.1.4. Checking shell options</h4></div></div></div><p>To add in your Bash configuration files:</p><pre class="screen">
# These lines will print a message if the noclobber option is set:

if [ -o noclobber ]
  then
	echo "Your files are protected against accidental overwriting using redirection."
fi

</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">The environment</h3><p>The above example will work when entered on the command line:</p><pre class="screen">
<code class="prompt">anny ~&gt;</code> <span class="command"><strong>if <em class="parameter"><code>[ -o noclobber ]</code></em> ; then echo ; echo <em class="parameter"><code>"your files are protected
against overwriting."</code></em> ; echo ; fi</strong></span>

your files are protected against overwriting.

<code class="prompt">anny ~&gt;</code>
</pre><p>However, if you use testing of conditions that depend on the environment, you might get different results when you enter the same command in a script, because the script will open a new shell, in which expected variables and options might not be set automatically.</p></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_01_02"></a>1.2. Simple applications of if</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_01_02_01"></a>1.2.1. Testing exit status</h4></div></div></div><p>The <code class="varname">?</code> variable holds the exit status of the previously executed command (the most recently completed foreground process).</p><p>The following example shows a simple test:</p><pre class="screen">
<code class="prompt">anny ~&gt;</code> <span class="command"><strong>if <em class="parameter"><code>[ $? -eq 0 ]</code></em></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>then echo <em class="parameter"><code>'That was a good job!'</code></em></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>fi</strong></span>
That was a good job!

<code class="prompt">anny ~&gt;</code>
</pre><p>The following example demonstrates that <span class="command"><strong>TEST-COMMANDS</strong></span> might be any UNIX command that returns an exit status, and that <span class="command"><strong>if</strong></span> again returns an exit status of zero:</p><pre class="screen">
<code class="prompt">anny ~&gt;</code> <span class="command"><strong>if <em class="parameter"><code>! grep $USER</code></em> <code class="filename">/etc/passwd</code></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>then echo <em class="parameter"><code>"your user account is not managed locally"</code></em>; fi</strong></span>
your user account is not managed locally

<code class="prompt">anny &gt;</code> <span class="command"><strong>echo <code class="varname">$?</code></strong></span>
0

<code class="prompt">anny &gt;</code>
</pre><p>The same result can be obtained as follows:</p><pre class="screen">
<code class="prompt">anny &gt;</code> <span class="command"><strong>grep <code class="varname">$USER</code> <code class="filename">/etc/passwd</code></strong></span>

<code class="prompt">anny &gt;</code> <span class="command"><strong>if <em class="parameter"><code>[ $? -ne 0 ]</code></em> ; then echo <em class="parameter"><code>"not a local account"</code></em> ; fi</strong></span>
not a local account

<code class="prompt">anny &gt;</code>
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_01_02_02"></a>1.2.2. Numeric comparisons</h4></div></div></div><p>The examples below use numerical comparisons:</p><pre class="screen">
<code class="prompt">anny &gt;</code> <span class="command"><strong><code class="varname">num</code>=<em class="parameter"><code>`wc -l work.txt`</code></em></strong></span>

<code class="prompt">anny &gt;</code> <span class="command"><strong>echo <code class="varname">$num</code></strong></span>
201

<code class="prompt">anny &gt;</code> <span class="command"><strong>if <em class="parameter"><code>[ "$num" -gt "150" ]</code></em></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>then echo ; echo <em class="parameter"><code>"you've worked hard enough for today."</code></em></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>echo ; fi</strong></span>

you've worked hard enough for today.


<code class="prompt">anny &gt;</code>
</pre><p>This script is executed by cron every Sunday.  If the week number is even, it reminds you to put out the garbage cans:</p><pre class="screen">
#!/bin/bash

# Calculate the week number using the date command:

WEEKOFFSET=$[ $(date +"%V") % 2 ]

# Test if we have a remainder.  If not, this is an even week so send a message.
# Else, do nothing.

if [ $WEEKOFFSET -eq "0" ]; then
  echo "Sunday evening, put out the garbage cans." | mail -s "Garbage cans out" your@your_domain.org
fi
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_01_02_03"></a>1.2.3. String comparisons</h4></div></div></div><p>An example of comparing strings for testing the user ID:</p><pre class="screen">
if [ "$(whoami)" != 'root' ]; then
        echo "You have no permission to run $0 as non-root user."
        exit 1;
fi
</pre><p>With Bash, you can shorten this type of construct.  The compact equivalent of the above test is as follows:</p><pre class="screen">
[ "$(whoami)" != 'root' ] &amp;&amp; ( echo you are using a non-privileged account; exit 1 )
</pre><p>Similar to the <span class="quote">&#8220;<span class="quote">&amp;&amp;</span>&#8221;</span> expression which indicates what to do if the test proves true, <span class="quote">&#8220;<span class="quote">||</span>&#8221;</span> specifies what to do if the test is false.</p><p>Regular expressions may also be used in comparisons:</p><pre class="screen">
<code class="prompt">anny &gt;</code> <span class="command"><strong><code class="varname">gender</code>=<em class="parameter"><code>"female"</code></em></strong></span>

<code class="prompt">anny &gt;</code> <span class="command"><strong>if <em class="parameter"><code>[[ "$gender" == f* ]]</code></em></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>then echo <em class="parameter"><code>"Pleasure to meet you, Madame."</code></em>; fi</strong></span>
Pleasure to meet you, Madame.

<code class="prompt">anny &gt;</code>
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Real Programmers</h3><p>Most programmers will prefer to use the <span class="command"><strong>test</strong></span> built-in command, which is equivalent to using square brackets for comparison, like this:</p><pre class="screen">
test "$(whoami)" != 'root' &amp;&amp; (echo you are using a non-privileged account; exit 1)
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">No exit?</h3><p>If you invoke the <span class="command"><strong>exit</strong></span> in a subshell, it will not pass variables to the parent.  Use { and } instead of ( and ) if you do not want Bash to fork a subshell.</p></div><p>See the info pages for Bash for more information on pattern matching with the <span class="quote">&#8220;<span class="quote">(( EXPRESSION ))</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">[[ EXPRESSION ]]</span>&#8221;</span> constructs.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_07_02"></a>2. More advanced if usage</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_02_01"></a>2.1. if/then/else constructs</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_02_01_01"></a>2.1.1. Dummy example</h4></div></div></div><p>This is the construct to use to take one course of action if the <span class="command"><strong>if</strong></span> commands test true, and another if it tests false.  An example:</p><pre class="screen">
<code class="prompt">freddy scripts&gt;</code> <span class="command"><strong><code class="varname">gender</code>=<em class="parameter"><code>"male"</code></em></strong></span>

<code class="prompt">freddy scripts&gt;</code> <span class="command"><strong>if <em class="parameter"><code>[[ "$gender" == "f*" ]]</code></em></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>then echo <em class="parameter"><code>"Pleasure to meet you, Madame."</code></em></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>else echo <em class="parameter"><code>"How come the lady hasn't got a drink yet?"</code></em></strong></span>
<code class="prompt">More input&gt;</code> <span class="command"><strong>fi</strong></span>
How come the lady hasn't got a drink yet?

<code class="prompt">freddy scripts&gt;</code>
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">[] vs. [[]]</h3><p>Contrary to <em class="parameter"><code>[</code></em>, <em class="parameter"><code>[[</code></em> prevents word splitting of variable values.  So, if <code class="varname">VAR="var with spaces"</code>, you do not need to double quote <code class="varname">$VAR</code> in a test - eventhough using quotes remains a good habit.  Also, <em class="parameter"><code>[[</code></em> prevents pathname expansion, so literal strings with wildcards do not try to expand to filenames.  Using <em class="parameter"><code>[[</code></em>, <em class="parameter"><code>==</code></em> and <em class="parameter"><code>!=</code></em> interpret strings to the right as shell glob patterns to be matched against the value to the left, for instance: <em class="parameter"><code>[[ "value" == val* ]]</code></em>.</p></div><p>Like the <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> list following the <span class="command"><strong>then</strong></span> statement, the <span class="command"><strong>ALTERNATE-CONSEQUENT-COMMANDS</strong></span> list following the <span class="command"><strong>else</strong></span> statement can hold any UNIX-style command that returns an exit status.</p><p>Another example, extending the one from <a class="xref" href="#sect_07_01_02_01" title="1.2.1. Testing exit status">Section 1.2.1, &#8220;Testing exit status&#8221;</a>:</p><pre class="screen">
<code class="prompt">anny ~&gt;</code> <span class="command"><strong>su <em class="parameter"><code>-</code></em></strong></span>
Password:
<code class="prompt">[root@elegance root]#</code> <span class="command"><strong>if <em class="parameter"><code>! grep ^$USER</code></em> <code class="filename">/etc/passwd</code> 1&gt; <code class="filename">/dev/null</code></strong></span>
<code class="prompt">&gt;</code> <span class="command"><strong>then echo <em class="parameter"><code>"your user account is not managed locally"</code></em></strong></span>
<code class="prompt">&gt;</code> <span class="command"><strong>else echo <em class="parameter"><code>"your account is managed from the local /etc/passwd file"</code></em></strong></span>
<code class="prompt">&gt;</code> <span class="command"><strong>fi</strong></span>
your account is managed from the local /etc/passwd file
<code class="prompt">[root@elegance root]#</code>
</pre><p>We switch to the <span class="emphasis"><em>root</em></span> account to demonstrate the effect of the <span class="command"><strong>else</strong></span> statement - your <span class="emphasis"><em>root</em></span> is usually a local account while your own user account might be managed by a central system, such as an LDAP server.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_02_01_02"></a>2.1.2. Checking command line arguments</h4></div></div></div><p>Instead of setting a variable and then executing a script, it is frequently more elegant to put the values for the variables<a class="indexterm" name="idm5012"></a> on the command line.</p><p>We use the positional parameters<a class="indexterm" name="idm5016"></a> <code class="varname">$1</code>, <code class="varname">$2</code>, ..., <code class="varname">$N</code> for this purpose.  <code class="varname">$#</code> refers to the number of command line arguments<a class="indexterm" name="idm5023"></a>.  <code class="varname">$0</code> refers to the name of the script.</p><p>The following is a simple example:</p><div class="figure"><a name="idm5028"></a><p class="title"><b>Figure 7.1. Testing of a command line argument with if</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/penguin.sh.png" alt='Simple if/then/else/fi construct: if [ "$1" == fish ]; then echo "Tux likes this"; else echo "Tux wants fish!"; fi'></div></div></div><br class="figure-break"><p>Here's another example, using two<a class="indexterm" name="idm5038"></a> arguments:</p><pre class="screen">
<code class="prompt">anny ~&gt;</code> <span class="command"><strong>cat <code class="filename">weight.sh</code></strong></span>
#!/bin/bash

# This script prints a message about your weight if you give it your
# weight in kilos and height in centimeters.

weight="$1"
height="$2"
idealweight=$[$height - 110]

if [ $weight -le $idealweight ] ; then
  echo "You should eat a bit more fat."
else
  echo "You should eat a bit more fruit."
fi

<code class="prompt">anny ~&gt;</code> <span class="command"><strong>bash <code class="option">-x</code> <code class="filename">weight.sh</code> <em class="parameter"><code>55 169</code></em></strong></span>
+ weight=55
+ height=169
+ idealweight=59
+ '[' 55 -le 59 ']'
+ echo 'You should eat a bit more fat.'
You should eat a bit more fat.
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_02_01_03"></a>2.1.3. Testing the number of arguments</h4></div></div></div><p>The following example<a class="indexterm" name="idm5053"></a> shows how to change the previous script so that it prints a message if more or less than 2 arguments are given:</p><pre class="screen">
<code class="prompt">anny ~&gt;</code> <span class="command"><strong>cat <code class="filename">weight.sh</code></strong></span>
#!/bin/bash

# This script prints a message about your weight if you give it your
# weight in kilos and height in centimeters.

if [ ! $# == 2 ]; then
  echo "Usage: $0 weight_in_kilos length_in_centimeters"
  exit
fi

weight="$1"
height="$2"
idealweight=$[$height - 110]

if [ $weight -le $idealweight ] ; then
  echo "You should eat a bit more fat."
else
  echo "You should eat a bit more fruit."
fi

<code class="prompt">anny ~&gt;</code> <span class="command"><strong>weight.sh <em class="parameter"><code>70 150</code></em></strong></span>
You should eat a bit more fruit.

<code class="prompt">anny ~&gt;</code> <span class="command"><strong>weight.sh <em class="parameter"><code>70 150 33</code></em></strong></span>
Usage: ./weight.sh weight_in_kilos length_in_centimeters
</pre><p>The first argument is referred to as <code class="varname">$1</code>, the second as <code class="varname">$2</code> and so on.  The total number of arguments is stored in <code class="varname">$#</code>.</p><p>Check out <a class="xref" href="#sect_07_02_05" title="2.5. Using the exit statement and if">Section 2.5, &#8220;Using the exit statement and if&#8221;</a> for a more elegant way to print usage messages.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_02_01_04"></a>2.1.4. Testing that a file exists</h4></div></div></div><p>This test is done in a lot of scripts<a class="indexterm" name="idm5075"></a>, because there's no use in starting a lot of programs if you know they're not going to work:</p><pre class="screen">
#!/bin/bash

# This script gives information about a file.

FILENAME="$1"

echo "Properties for $FILENAME:"

if [ -f $FILENAME ]; then
  echo "Size is $(ls -lh $FILENAME | awk '{ print $5 }')"
  echo "Type is $(file $FILENAME | cut -d":" -f2 -)"
  echo "Inode number is $(ls -i $FILENAME | cut -d" " -f1 -)"
  echo "$(df -h $FILENAME | grep -v Mounted | awk '{ print "On",$1", \
which is mounted as the",$6,"partition."}')"
else
  echo "File does not exist."
fi
</pre><p>Note that the file is referred to using a variable; in this case it is the first argument to the script.  Alternatively, when no arguments are given, file locations are usually stored in variables at the beginning of a script, and their content is referred to using these variables.  Thus, when you want to change a file name in a script, you only need to do it once.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Filenames with spaces</h3><p>The above example will fail if the value of <code class="varname">$1</code> can be parsed as multiple words.  In that case, the <span class="command"><strong>if</strong></span> command can be fixed either using double quotes around the filename, or by using <em class="parameter"><code>[[</code></em> instead of <em class="parameter"><code>[</code></em>.</p></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_02_02"></a>2.2. if/then/elif/else constructs</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_02_02_01"></a>2.2.1. General</h4></div></div></div><p>This is the full form of the <span class="command"><strong>if</strong></span> statement:</p><div class="cmdsynopsis"><p><code class="command">if TEST-COMMANDS; then</code> </p></div><div class="cmdsynopsis"><p><code class="command">CONSEQUENT-COMMANDS;</code> </p></div><div class="cmdsynopsis"><p><code class="command">elif MORE-TEST-COMMANDS; then</code> </p></div><div class="cmdsynopsis"><p><code class="command">MORE-CONSEQUENT-COMMANDS;</code> </p></div><div class="cmdsynopsis"><p><code class="command">else ALTERNATE-CONSEQUENT-COMMANDS;</code> </p></div><div class="cmdsynopsis"><p><code class="command">fi</code> </p></div><p>The <span class="command"><strong>TEST-COMMANDS</strong></span> list is executed, and if its return status is zero, the <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> list is executed.  If
<span class="command"><strong>TEST-COMMANDS</strong></span> returns a non-zero status, each <span class="command"><strong>elif</strong></span> list is executed in turn, and if its exit status is zero, the corresponding <span class="command"><strong>MORE-CONSEQUENT-COMMANDS</strong></span> is executed and the command completes.  If <span class="command"><strong>else</strong></span> is followed by an <span class="command"><strong>ALTERNATE-CONSEQUENT-COMMANDS</strong></span> list, and the final command in the final <span class="command"><strong>if</strong></span> or <span class="command"><strong>elif</strong></span> clause has a non-zero exit status, then <span class="command"><strong>ALTERNATE-CONSEQUENT-COMMANDS</strong></span> is executed.  The return status is the exit status of the last command executed, or zero if no condition tested true.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_07_02_02_02"></a>2.2.2. Example</h4></div></div></div><p>This is an example that you can put in your crontab for daily execution:</p><pre class="screen">
<code class="prompt">anny /etc/cron.daily&gt;</code> <span class="command"><strong>cat <code class="filename">disktest.sh</code></strong></span>
#!/bin/bash

# This script does a very simple test for checking disk space.

space=`df -h | awk '{print $5}' | grep % | grep -v Use | sort -n | tail -1 | cut -d "%" -f1 -`
alertvalue="80"

if [ "$space" -ge "$alertvalue" ]; then
  echo "At least one of my disks is nearly full!" | mail -s "daily diskcheck" root
else
  echo "Disk space normal" | mail -s "daily diskcheck" root
fi
</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_02_03"></a>2.3. Nested if statements</h3></div></div></div><p>Inside the <span class="command"><strong>if</strong></span> statement, you can use another <span class="command"><strong>if</strong></span> statement.  You may use as many levels of nested <span class="command"><strong>if</strong></span>s as you can logically manage.</p><p>This is an example testing leap years:</p><pre class="screen">
<code class="prompt">anny ~/testdir&gt;</code> <span class="command"><strong>cat <code class="filename">testleap.sh</code></strong></span>
#!/bin/bash
# This script will test if we're in a leap year or not.

year=`date +%Y`

if [ $[$year % 400] -eq "0" ]; then
  echo "This is a leap year.  February has 29 days."
elif [ $[$year % 4] -eq 0 ]; then
        if [ $[$year % 100] -ne 0 ]; then
          echo "This is a leap year, February has 29 days."
        else
          echo "This is not a leap year.  February has 28 days."
        fi
else
  echo "This is not a leap year.  February has 28 days."
fi

<code class="prompt">anny ~/testdir&gt;</code> <span class="command"><strong>date</strong></span>
Tue Jan 14 20:37:55 CET 2003

<code class="prompt">anny ~/testdir&gt;</code> <span class="command"><strong>testleap.sh</strong></span>
This is not a leap year.
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_02_04"></a>2.4. Boolean operations</h3></div></div></div><p>The above script can be shortened using the Boolean operators <span class="quote">&#8220;<span class="quote">AND</span>&#8221;</span> (&amp;&amp;) and <span class="quote">&#8220;<span class="quote">OR</span>&#8221;</span> (||).</p><div class="figure"><a name="idm5143"></a><p class="title"><b>Figure 7.2. Example using Boolean operators</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/leaptest.sh.png" alt='year=`date +%Y`; if (( ("$year" % 400) == "0" )) || (( ("$year" % 4 == "0") &amp;&amp; ("$year" % 100 != "0") )); then echo "this is a leap year."; else echo "not a leap year"; fi'></div></div></div><br class="figure-break"><p>We use the double brackets for testing<a class="indexterm" name="idm5153"></a> an arithmetic expression, see <a class="xref" href="#sect_03_04_05" title="4.6. Arithmetic expansion">Section 4.6, &#8220;Arithmetic expansion&#8221;</a>.  This is equivalent to the <span class="command"><strong>let</strong></span> statement.  You will get stuck using square brackets here, if you try something like <span class="command"><strong>$[$year % 400]</strong></span>, because here, the square brackets don't represent an actual command by themselves.</p><p>Among other editors, <span class="command"><strong>gvim</strong></span> is one of those supporting colour schemes according to the file format; such editors are useful for detecting errors in your code.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_02_05"></a>2.5. Using the exit statement and if</h3></div></div></div><p>We already briefly met the <span class="command"><strong>exit</strong></span> statement in <a class="xref" href="#sect_07_02_01_03" title="2.1.3. Testing the number of arguments">Section 2.1.3, &#8220;Testing the number of arguments&#8221;</a>.  It terminates execution of the entire script.  It is most often used if the input requested from the user is incorrect, if a statement did not run successfully or if some other error occurred.</p><p>The <span class="command"><strong>exit</strong></span> statement takes an optional argument<a class="indexterm" name="idm5168"></a>.  This argument is the integer exit status code, which is passed back to the parent and stored in the <code class="varname">$?</code> variable.</p><p>A zero argument<a class="indexterm" name="idm5173"></a> means that the script ran successfully.  Any other value may be used by programmers to pass back different messages to the parent, so that different actions can be taken according to failure or success of the child process.  If no argument is given to the <span class="command"><strong>exit</strong></span> command, the parent shell uses the current value of the <code class="varname">$?</code> variable.</p><p>Below is an example with a slightly adapted <code class="filename">penguin.sh</code> script, which sends its exit status back to the parent, <code class="filename">feed.sh</code>:</p><pre class="screen">
<code class="prompt">anny ~/testdir&gt;</code> <span class="command"><strong>cat <code class="filename">penguin.sh</code></strong></span>
#!/bin/bash
                                                                                                 
# This script lets you present different menus to Tux.  He will only be happy
# when given a fish.  We've also added a dolphin and (presumably) a camel.
                                                                                                 
if [ "$menu" == "fish" ]; then
  if [ "$animal" == "penguin" ]; then
    echo "Hmmmmmm fish... Tux happy!"
  elif [ "$animal" == "dolphin" ]; then
    echo "Pweetpeettreetppeterdepweet!"
  else
    echo "*prrrrrrrt*"
  fi
else
  if [ "$animal" == "penguin" ]; then
    echo "Tux don't like that.  Tux wants fish!"
    exit 1
  elif [ "$animal" == "dolphin" ]; then
    echo "Pweepwishpeeterdepweet!"
    exit 2
  else
    echo "Will you read this sign?!"
    exit 3
  fi
fi
</pre><p>This script is called upon in the next one, which therefore exports its variables <code class="varname">menu</code> and <code class="varname">animal</code>:</p><pre class="screen">
<code class="prompt">anny ~/testdir&gt;</code> <span class="command"><strong>cat <code class="filename">feed.sh</code></strong></span>
#!/bin/bash
# This script acts upon the exit status given by penguin.sh
                                                                                                 
export menu="$1"
export animal="$2"
                                                                                                 
feed="/nethome/anny/testdir/penguin.sh"
                                                                                                 
$feed $menu $animal
                                                                                                 
case $? in
                                                                                                 
1)
  echo "Guard: You'd better give'm a fish, less they get violent..."
  ;;
2)
  echo "Guard: It's because of people like you that they are leaving earth all the time..."
  ;;
3)
  echo "Guard: Buy the food that the Zoo provides for the animals, you ***, how
do you think we survive?"
  ;;
*)
  echo "Guard: Don't forget the guide!"
  ;;
esac
                                                                                                 
<code class="prompt">anny ~/testdir&gt;</code> <span class="command"><strong>./feed.sh <em class="parameter"><code>apple penguin</code></em></strong></span>
Tux don't like that.  Tux wants fish!
Guard: You'd better give'm a fish, less they get violent...
</pre><p>As you can see, exit status codes can be chosen freely.  Existing commands usually have a series of defined codes; see the programmer's manual for each command for more information.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_07_03"></a>3. Using case statements</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_03_01"></a>3.1. Simplified conditions</h3></div></div></div><p>Nested <span class="command"><strong>if</strong></span> statements might be nice, but as soon as you are confronted with a couple of different possible actions to take, they tend to confuse.  For the more complex conditionals, use the <span class="command"><strong>case</strong></span> syntax:</p><div class="cmdsynopsis"><p><code class="command">case <code class="function">EXPRESSION</code> in <code class="function">CASE1</code>) COMMAND-LIST;; <code class="function">CASE2</code>) COMMAND-LIST;; ... <code class="function">CASEN</code>) COMMAND-LIST;; esac</code> </p></div><p>Each case is an expression matching a pattern.  The commands in the <span class="command"><strong>COMMAND-LIST</strong></span> for the first match are executed.  The <span class="quote">&#8220;<span class="quote">|</span>&#8221;</span> symbol is used for separating multiple patterns, and the <span class="quote">&#8220;<span class="quote">)</span>&#8221;</span> operator terminates a pattern list.  Each case plus its according commands are called a <span class="emphasis"><em>clause</em></span>.  Each clause must be terminated with <span class="quote">&#8220;<span class="quote">;;</span>&#8221;</span>.  Each <span class="command"><strong>case</strong></span> statement is ended with the <span class="command"><strong>esac</strong></span> statement.</p><p>In the example, we demonstrate use of cases for sending a more selective warning message with the <code class="filename">disktest.sh</code> script:</p><pre class="screen">
<code class="prompt">anny ~/testdir&gt;</code> <span class="command"><strong>cat <code class="filename">disktest.sh</code></strong></span>
#!/bin/bash

# This script does a very simple test for checking disk space.

space=`df -h | awk '{print $5}' | grep % | grep -v Use | sort -n | tail -1 | cut -d "%" -f1 -`

case $space in
[1-6]*)
  Message="All is quiet."
  ;;
[7-8]*)
  Message="Start thinking about cleaning out some stuff.  There's a partition that is $space % full."
  ;;
9[1-8])
  Message="Better hurry with that new disk...  One partition is $space % full."
  ;;
99)
  Message="I'm drowning here!  There's a partition at $space %!"
  ;;
*)
  Message="I seem to be running with an nonexistent amount of disk space..."
  ;;
esac

echo $Message | mail -s "disk report `date`" anny

<code class="prompt">anny ~/testdir&gt;</code>
You have new mail.

<code class="prompt">anny ~/testdir&gt;</code> <span class="command"><strong>tail <em class="parameter"><code>-16</code></em> <code class="filename">/var/spool/mail/anny</code></strong></span>
From anny@octarine Tue Jan 14 22:10:47 2003
Return-Path: &lt;anny@octarine&gt;
Received: from octarine (localhost [127.0.0.1])
        by octarine (8.12.5/8.12.5) with ESMTP id h0ELAlBG020414
        for &lt;anny@octarine&gt;; Tue, 14 Jan 2003 22:10:47 +0100
Received: (from anny@localhost)
        by octarine (8.12.5/8.12.5/Submit) id h0ELAltn020413
        for anny; Tue, 14 Jan 2003 22:10:47 +0100
Date: Tue, 14 Jan 2003 22:10:47 +0100
From: Anny &lt;anny@octarine&gt;
Message-Id: &lt;200301142110.h0ELAltn020413@octarine&gt;
To: anny@octarine
Subject: disk report Tue Jan 14 22:10:47 CET 2003

Start thinking about cleaning out some stuff.  There's a partition that is 87 % full.

<code class="prompt">anny ~/testdir&gt;</code>
</pre><p>Of course you could have opened your mail program to check the results; this is just to demonstrate that the script sends a decent mail with <span class="quote">&#8220;<span class="quote">To:</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">Subject:</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">From:</span>&#8221;</span> header lines.</p><p>Many more examples using <span class="command"><strong>case</strong></span> statements can be found in your system's init script directory.  The startup scripts use <span class="command"><strong>start</strong></span> and <span class="command"><strong>stop</strong></span> cases to run or stop system processes.  A theoretical example can be found in the next section.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_07_03_02"></a>3.2. Initscript example</h3></div></div></div><p>Initscripts often make use of <span class="command"><strong>case</strong></span> statements for starting, stopping and querying system services.  This is an excerpt of the script that starts <span class="application">Anacron</span>, a daemon that runs commands periodically with a frequency specified in days.</p><pre class="screen">
case "$1" in
        start)
            start
            ;;
         
        stop)
            stop
            ;;
         
        status)
            status anacron
            ;;
        restart)
            stop
            start
            ;;
        condrestart)
            if test "x`pidof anacron`" != x; then
                stop
                start
            fi
            ;;
         
        *)
            echo $"Usage: $0 {start|stop|restart|condrestart|status}"
            exit 1
 
esac
</pre><p>The tasks to execute in each case, such as stopping and starting the daemon, are defined in functions, which are partially sourced from the <code class="filename">/etc/rc.d/init.d/functions</code> file.  See <a class="xref" href="#chap_11" title="Chapter 11. Functions">Chapter 11, <i>Functions</i></a> for more explanation.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_07_04"></a>4. Summary</h2></div></div></div><p>In this chapter we learned how to build conditions into our scripts so that different actions can be undertaken upon success or failure of a command.  The actions can be determined using the <span class="command"><strong>if</strong></span> statement.  This allows you to perform arithmetic and string comparisons, and testing of exit code, input and files needed by the script.</p><p>A simple <span class="command"><strong>if/then/fi</strong></span> test often preceeds commands in a shell script in order to prevent output generation, so that the script can easily be run in the background or through the <span class="application">cron</span> facility.  More complex definitions of conditions are usually put in a <span class="command"><strong>case</strong></span> statement.</p><p>Upon successful condition testing, the script can explicitly inform the parent using the <span class="command"><strong>exit 0</strong></span> status.  Upon failure, any other number may be returned.  Based on the return code, the parent program can take appropriate action.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_07_05"></a>5. Exercises</h2></div></div></div><p>Here are some ideas to get you started using <span class="command"><strong>if</strong></span> in scripts:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Use an <span class="command"><strong>if/then/elif/else</strong></span> construct that prints information about the current month.  The script should print the number of days in this month, and give information about leap years if the current month is February.</p></li><li class="listitem"><p>Do the same, using a <span class="command"><strong>case</strong></span> statement and an alternative use of the <span class="command"><strong>date</strong></span> command.</p></li><li class="listitem"><p>Modify <code class="filename">/etc/profile</code> so that you get a special greeting message when you connect to your system as <span class="emphasis"><em>root</em></span>.</p></li><li class="listitem"><p>Edit the <code class="filename">leaptest.sh</code> script from <a class="xref" href="#sect_07_02_04" title="2.4. Boolean operations">Section 2.4, &#8220;Boolean operations&#8221;</a> so that it requires one argument, the year.  Test that exactly one argument is supplied.</p></li><li class="listitem"><p>Write a script called <code class="filename">whichdaemon.sh</code> that checks if the <span class="command"><strong>httpd</strong></span> and <span class="command"><strong>init</strong></span> daemons are running on your system.  If an <span class="command"><strong>httpd</strong></span> is running, the script should print a message like, <span class="quote">&#8220;<span class="quote">This machine is running a web server.</span>&#8221;</span>  Use <span class="command"><strong>ps</strong></span> to check on processes.</p></li><li class="listitem"><p>Write a script that makes a backup of your home directory on a remote machine using <span class="command"><strong>scp</strong></span>.  The script should report in a log file, for instance <code class="filename">~/log/homebackup.log</code>.  If you don't have a second machine to copy the backup to, use <span class="command"><strong>scp</strong></span> to test copying it to the localhost.  This requires SSH keys between the two hosts, or else you have to supply a password.  The creation of SSH keys is explained in <span class="command"><strong>man <em class="parameter"><code>ssh-keygen</code></em></strong></span>.</p></li><li class="listitem"><p>Adapt the script from the first example in <a class="xref" href="#sect_07_03_01" title="3.1. Simplified conditions">Section 3.1, &#8220;Simplified conditions&#8221;</a> to include the case of exactly 90% disk space usage, and lower than 10% disk space usage.</p><p>The script should use <span class="command"><strong>tar <code class="option">cf</code></strong></span> for the creation of the backup and <span class="command"><strong>gzip</strong></span> or <span class="command"><strong>bzip2</strong></span> for compressing the <code class="filename">.tar</code> file.  Put all filenames in variables.  Put the name of the remote server and the remote directory in a variable.  This will make it easier to re-use the script or to make changes to it in the future.</p><p>The script should check for the existence of a compressed archive.  If this exists, remove it first in order to prevent output generation.</p><p>The script should also check for available diskspace.  Keep in mind that at any given moment you could have the data in your home directory, the data in the <code class="filename">.tar</code> file and the data in the compressed archive all together on your disk.  If there is not enough diskspace, exit with an error message in the log file.</p><p>The script should clean up the compressed archive before it exits.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_08"></a>Chapter 8. Writing interactive scripts</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_08_01">1. Displaying user messages</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_08_01_01">1.1. Interactive or not?</a></span></dt><dt><span class="sect2"><a href="#sect_08_01_02">1.2. Using the echo built-in command</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_08_02">2. Catching user input</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_08_02_01">2.1. Using the read built-in command</a></span></dt><dt><span class="sect2"><a href="#sect_08_02_02">2.2. Prompting for user input</a></span></dt><dt><span class="sect2"><a href="#sect_08_02_03">2.3. Redirection and file descriptors</a></span></dt><dt><span class="sect2"><a href="#sect_08_02_04">2.4. File input and output</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_08_03">3. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_08_04">4. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this chapter we will discuss how to interact with the users of our scripts:</p><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Printing user friendly messages and explanations</p></li><li class="listitem"><p>Catching user input</p></li><li class="listitem"><p>Prompting for user input</p></li><li class="listitem"><p>Using the file descriptors to read from and write to multiple files</p></li></ul></div><p>
</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_08_01"></a>1. Displaying user messages</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_08_01_01"></a>1.1. Interactive or not?</h3></div></div></div><p>Some scripts run without any interaction from the user at all.  Advantages of non-interactive scripts include:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The script runs in a predictable way every time.</p></li><li class="listitem"><p>The script can run in the background.</p></li></ul></div><p>Many scripts, however, require input from the user, or give output to the user as the script is running.  The advantages of interactive scripts are, among others:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>More flexible scripts can be built.</p></li><li class="listitem"><p>Users can customize the script as it runs or make it behave in different ways.</p></li><li class="listitem"><p>The script can report its progress as it runs.</p></li></ul></div><p>When writing interactive scripts, never hold back on comments.  A script that prints appropriate messages is much more user-friendly and can be more easily debugged.  A script might do a perfect job, but you will get a whole lot of support calls if it does not inform the user about what it is doing.  So include messages that tell the user to wait for output because a calculation is being done.  If possible, try to give an indication of how long the user will have to wait.  If the waiting should regularly take a long time when executing a certain task, you might want to consider integrating some processing indication in the output of your script.</p><p>When prompting the user for input, it is also better to give too much than too little information about the kind of data to be entered.  This applies to the checking of arguments and the accompanying usage message as well.</p><p>Bash has the <span class="command"><strong>echo</strong></span> and <span class="command"><strong>printf</strong></span> commands to provide comments for users, and although you should be familiar with at least the use of <span class="command"><strong>echo</strong></span> by now, we will discuss some more examples in the next sections.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_08_01_02"></a>1.2. Using the echo built-in command</h3></div></div></div><p>The <span class="command"><strong>echo</strong></span> built-in command outputs its arguments, separated by spaces and terminated with a newline character.  The return status is always zero.  <span class="command"><strong>echo</strong></span> takes a couple of options:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="option">-e</code>: interprets backslash-escaped characters.</p></li><li class="listitem"><p><code class="option">-n</code>: suppresses the trailing newline.</p></li></ul></div><p>As an example of adding comments, we will make the <code class="filename">feed.sh</code> and <code class="filename">penguin.sh</code> from <a class="xref" href="#sect_07_02_01_02" title="2.1.2. Checking command line arguments">Section 2.1.2, &#8220;Checking command line arguments&#8221;</a> a bit better:</p><pre class="screen">
<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>cat <code class="filename">penguin.sh</code></strong></span>
#!/bin/bash

# This script lets you present different menus to Tux.  He will only be happy
# when given a fish.  To make it more fun, we added a couple more animals.

if [ "$menu" == "fish" ]; then
  if [ "$animal" == "penguin" ]; then
    echo -e "Hmmmmmm fish... Tux happy!\n"
  elif [ "$animal" == "dolphin" ]; then
    echo -e "\a\a\aPweetpeettreetppeterdepweet!\a\a\a\n"
  else
    echo -e "*prrrrrrrt*\n"
  fi
else
  if [ "$animal" == "penguin" ]; then
    echo -e "Tux don't like that.  Tux wants fish!\n"
    exit 1
  elif [ "$animal" == "dolphin" ]; then
    echo -e "\a\a\a\a\a\aPweepwishpeeterdepweet!\a\a\a"
    exit 2
  else
    echo -e "Will you read this sign?!  Don't feed the "$animal"s!\n"
    exit 3
  fi
fi

<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>cat <code class="filename">feed.sh</code></strong></span>
#!/bin/bash
# This script acts upon the exit status given by penguin.sh

if [ "$#" != "2" ]; then
  echo -e "Usage of the feed script:\t$0 food-on-menu animal-name\n"
  exit 1
else

  export menu="$1"
  export animal="$2"

  echo -e "Feeding $menu to $animal...\n"

  feed="/nethome/anny/testdir/penguin.sh"

  $feed $menu $animal

result="$?"

  echo -e "Done feeding.\n"

case "$result" in

  1)
    echo -e "Guard: \"You'd better give'm a fish, less they get violent...\"\n"
    ;;
  2)
    echo -e "Guard: \"No wonder they flee our planet...\"\n"
    ;;
  3)
    echo -e "Guard: \"Buy the food that the Zoo provides at the entry, you ***\"\n"
    echo -e "Guard: \"You want to poison them, do you?\"\n"
    ;;
  *)
    echo -e "Guard: \"Don't forget the guide!\"\n"
    ;;
  esac

fi

echo "Leaving..."
echo -e "\a\a\aThanks for visiting the Zoo, hope to see you again soon!\n"

<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>feed.sh <em class="parameter"><code>apple camel</code></em></strong></span>
Feeding apple to camel...

Will you read this sign?!  Don't feed the camels!

Done feeding.

Guard: "Buy the food that the Zoo provides at the entry, you ***"

Guard: "You want to poison them, do you?"

Leaving...
Thanks for visiting the Zoo, hope to see you again soon!

<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>feed.sh <em class="parameter"><code>apple</code></em></strong></span>
Usage of the feed script:       ./feed.sh food-on-menu animal-name

</pre><p>More about escape characters can be found in <a class="xref" href="#sect_03_03_02" title="3.2. Escape characters">Section 3.2, &#8220;Escape characters&#8221;</a>.  The following table gives an overview of sequences recognized by the <span class="command"><strong>echo</strong></span> command:</p><div class="table"><a name="tab_08_01"></a><p class="title"><b>Table 8.1. Escape sequences used by the echo command</b></p><div class="table-contents"><table class="table" summary="Escape sequences used by the echo command" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Sequence</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left">\a</td><td align="left">Alert (bell).</td></tr><tr><td align="left">\b</td><td align="left">Backspace.</td></tr><tr><td align="left">\c</td><td align="left">Suppress trailing newline.</td></tr><tr><td align="left">\e</td><td align="left">Escape.</td></tr><tr><td align="left">\f</td><td align="left">Form feed.</td></tr><tr><td align="left">\n</td><td align="left">Newline.</td></tr><tr><td align="left">\r</td><td align="left">Carriage return.</td></tr><tr><td align="left">\t</td><td align="left">Horizontal tab.</td></tr><tr><td align="left">\v</td><td align="left">Vertical tab.</td></tr><tr><td align="left">\\</td><td align="left">Backslash.</td></tr><tr><td align="left">\0NNN</td><td align="left">The eight-bit character whose value is the octal value NNN (zero to three octal digits).</td></tr><tr><td align="left">\NNN</td><td align="left">The eight-bit character whose value is the octal value NNN (one to three octal digits).</td></tr><tr><td align="left">\xHH</td><td align="left">The eight-bit character whose value is the hexadecimal value (one or two hexadecimal digits).</td></tr></tbody></table></div></div><br class="table-break"><p>For more information about the <span class="command"><strong>printf</strong></span> command and the way it allows you to format output, see the Bash info pages.  Keep in mind that there might be differences between different versions of Bash.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_08_02"></a>2. Catching user input</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_08_02_01"></a>2.1. Using the read built-in command</h3></div></div></div><p>The <span class="command"><strong>read</strong></span> built-in command is the counterpart of the <span class="command"><strong>echo</strong></span> and <span class="command"><strong>printf</strong></span> commands.  The syntax of the <span class="command"><strong>read</strong></span> command is as follows:</p><div class="cmdsynopsis"><p><code class="command">read <code class="option">[options]</code> <code class="varname">NAME1 NAME2 ... NAMEN</code></code> </p></div><p>One line is read from the standard input, or from the file descriptor supplied as an argument to the <code class="option">-u</code> option.  The first word of the line is assigned to the first name, <code class="varname">NAME1</code>, the second word to the second name, and so on, with leftover words and their intervening separators assigned to the last name, <code class="varname">NAMEN</code>.  If there are fewer words read from the input stream than there are names, the remaining names are assigned empty values.</p><p>The characters in the value of the <code class="varname">IFS</code> variable are used to split the input line into words or tokens; see <a class="xref" href="#sect_03_04_07" title="4.8. Word splitting">Section 4.8, &#8220;Word splitting&#8221;</a>.  The backslash character may be used to remove any special meaning for the next character read and for line continuation.</p><p>If no names are supplied, the line read is assigned to the variable <code class="varname">REPLY</code>.</p><p>The return code of the <span class="command"><strong>read</strong></span> command is zero, unless an end-of-file character is encountered, if <span class="command"><strong>read</strong></span> times out or if an invalid file descriptor is supplied as the argument to the <code class="option">-u</code> option.</p><p>The following options are supported by the Bash <span class="command"><strong>read</strong></span> built-in:</p><div class="table"><a name="tab_08_02"></a><p class="title"><b>Table 8.2. Options to the read built-in</b></p><div class="table-contents"><table class="table" summary="Options to the read built-in" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Option</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left">-a <code class="varname">ANAME</code></td><td align="left">The words are assigned to sequential indexes of the array variable <code class="varname">ANAME</code>, starting at 0.  All elements are removed from <code class="varname">ANAME</code> before the assignment.  Other <code class="varname">NAME</code> arguments are ignored.</td></tr><tr><td align="left">-d <code class="varname">DELIM</code></td><td align="left">The first character of <code class="varname">DELIM</code> is used to terminate the input line, rather than newline.</td></tr><tr><td align="left">-e</td><td align="left"><span class="command"><strong>readline</strong></span> is used to obtain the line.</td></tr><tr><td align="left">-n <code class="varname">NCHARS</code></td><td align="left"><span class="command"><strong>read</strong></span> returns after reading <code class="varname">NCHARS</code> characters rather than waiting for a complete line of input.</td></tr><tr><td align="left">-p <code class="varname">PROMPT</code></td><td align="left">Display <code class="varname">PROMPT</code>, without a trailing newline, before attempting to read any input.  The prompt is displayed only if input is coming from a terminal.</td></tr><tr><td align="left">-r</td><td align="left">If this option is given, backslash does not act as an escape character.  The backslash is considered to be part of the line.  In particular, a backslash-newline pair may not be used as a line continuation.</td></tr><tr><td align="left">-s</td><td align="left">Silent mode.  If input is coming from a terminal, characters are not echoed.</td></tr><tr><td align="left">-t <code class="varname">TIMEOUT</code></td><td align="left">Cause <span class="command"><strong>read</strong></span> to time out and return failure if a complete line of input is not read within <code class="varname">TIMEOUT</code> seconds.  This option has no effect if <span class="command"><strong>read</strong></span> is not reading input from the terminal or from a pipe.</td></tr><tr><td align="left">-u <code class="varname">FD</code></td><td align="left">Read input from file descriptor <code class="varname">FD</code>.</td></tr></tbody></table></div></div><br class="table-break"><p>This is a straightforward example, improving on the <code class="filename">leaptest.sh</code> script from the previous chapter:</p><pre class="screen">
<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>cat <code class="filename">leaptest.sh</code></strong></span>
#!/bin/bash
# This script will test if you have given a leap year or not.

echo "Type the year that you want to check (4 digits), followed by [ENTER]:"

read year

if (( ("$year" % 400) == "0" )) || (( ("$year" % 4 == "0") &amp;&amp; ("$year" % 100 !=
"0") )); then
  echo "$year is a leap year."
else
  echo "This is not a leap year."
fi

<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>leaptest.sh</strong></span>
Type the year that you want to check (4 digits), followed by [ENTER]:
2000
2000 is a leap year.
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_08_02_02"></a>2.2. Prompting for user input</h3></div></div></div><p>The following example shows how you can use prompts to explain what the user should enter.</p><pre class="screen">
<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>cat <code class="filename">books.sh</code></strong></span>
#!/bin/bash

# This is a program that creates a favorite book library.

books="books.txt"

echo "Hello, "$USER". This script will add your favorite book to the database."

echo -n "Enter the title and press [ENTER]: "
read title
echo -n "Enter the name of the author and press [ENTER]: "
read author
echo

grep -i "$title" "$books"

if [ $? == 0 ]; then
  echo "You have already suggested a book, quitting."
  exit 1
elif [ "$author" == "shakespeare" ]; then
  echo "What's in a name? That which we call a rose by any other name would smell as sweet."
  exit 1
else
  echo -n "Enter the cost and press [ENTER]: "
  read cost
  if [ $cost -lt 25 ]; then
    echo "$title | $author | $cost" &gt;&gt; "$books"
    echo "Your book is added to the database. Thank you so much!"
  else
    echo "Let me look for $title by $author at the library."
    exit 1
  fi
fi

<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>cp <code class="filename">books.sh /var/tmp</code>; cd <code class="filename">/var/tmp</code></strong></span>

<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>touch <code class="filename">books</code>; chmod <code class="option">a+w</code> <code class="filename">books</code></strong></span>

<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>books.sh</strong></span>
Hello, michel. This script will add your favorite book to the database.
Enter the title and press [ENTER]: 1984
Enter the name of the author and press [ENTER]: Orwell
Enter the cost and press [ENTER]: 30
Let me look for 1984 by Orwell at the library.

<code class="prompt">michel ~/test&gt;</code> <span class="command"><strong>cat <code class="filename">books</code></strong></span>

</pre><p>Note that no output is omitted here.  The script only stores information about the books that Michel is interested in. It will always thank you for your suggestion, unless you already provided it.</p><p>Other people can now start executing the script:</p><pre class="screen">
<code class="prompt">[anny@octarine tmp]$</code> <span class="command"><strong>books.sh</strong></span>
Hello, anny. This script will add your favorite book to the database.
Enter the title and press [ENTER]: Sense and Sensibility
Enter the name of the author and press [ENTER]: Austen
Enter the cost and press [ENTER]: 10
Your book is added to the database. Thank you so much!
</pre><p>After a while, the <code class="filename">books</code> list begins to look like this:</p><pre class="screen">
Sense and Sensibility | Austen | 10
Harry Potter and the Sorcerer's Stone | Rowling | 20
The Lord of the Rings | Tolkien | 22
To Kill a Mockingbird | Lee | 12

--output omitted--
</pre><p>Of course, this situation is not ideal, since everybody can edit (but not delete) Michel's files.  You can solve this problem using special access modes on the script file, see <a class="ulink" href="http://www.tldp.org/LDP/intro-linux/html/sect_04_01.html#sect_04_01_06" target="_top">SUID and SGID</a> in the Introduction to Linux guide.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_08_02_03"></a>2.3. Redirection and file descriptors</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_08_02_03_01"></a>2.3.1. General</h4></div></div></div><p>As you know from basic shell usage, input and output of a command may be redirected before it is executed, using a special notation - the redirection operators - interpreted by the shell.  Redirection may also be used to open and close files for the current shell execution environment.</p><p>Redirection can also occur in a script, so that it can receive input from a file, for instance, or send output to a file.  Later, the user can review the output file, or it may be used by another script as input.</p><p>File input and output are accomplished by integer handles that track all open files for a given process.  These numeric values are known as file descriptors.  The best known file descriptors are <span class="emphasis"><em>stdin</em></span>, <span class="emphasis"><em>stdout</em></span> and <span class="emphasis"><em>stderr</em></span>, with file descriptor numbers 0, 1 and 2, respectively.  These numbers and respective devices are reserved.  Bash can take TCP or UDP ports on networked hosts as file descriptors as well.</p><p>The output below shows how the reserved file descriptors point to actual devices:</p><pre class="screen">
<code class="prompt">michel ~&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> <code class="filename">/dev/std*</code></strong></span>
lrwxrwxrwx  1 root    root     17 Oct  2 07:46 /dev/stderr -&gt; ../proc/self/fd/2
lrwxrwxrwx  1 root    root     17 Oct  2 07:46 /dev/stdin -&gt; ../proc/self/fd/0
lrwxrwxrwx  1 root    root     17 Oct  2 07:46 /dev/stdout -&gt; ../proc/self/fd/1

<code class="prompt">michel ~&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> <code class="filename">/proc/self/fd/[0-2]</code></strong></span>
lrwx------  1 michel  michel   64 Jan 23 12:11 /proc/self/fd/0 -&gt; /dev/pts/6
lrwx------  1 michel  michel   64 Jan 23 12:11 /proc/self/fd/1 -&gt; /dev/pts/6
lrwx------  1 michel  michel   64 Jan 23 12:11 /proc/self/fd/2 -&gt; /dev/pts/6
</pre><p>Note that each process has its own view of the files under <code class="filename">/proc/self</code>, as it is actually a symbolic link to <code class="filename">/proc/&lt;process_ID&gt;</code>.</p><p>You might want to check <span class="command"><strong>info MAKEDEV</strong></span> and <span class="command"><strong>info proc</strong></span> for more information about <code class="filename">/proc</code> subdirectories and the way your system handles standard file descriptors for each running process.</p><p>When excuting a given command, the following steps are excuted, in order:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If the standard output of a previous command is being piped to the standard input of the current command, then <code class="filename">/proc/&lt;current_process_ID&gt;/fd/0</code> is updated to target the same anonymous pipe as <code class="filename">/proc/&lt;previous_process_ID/fd/1</code>.</p></li><li class="listitem"><p>If the standard output of the current command is being piped to the standard input of the next command, then <code class="filename">/proc/&lt;current_process_ID&gt;/fd/1</code> is updated to target another anonymous pipe.</p></li><li class="listitem"><p>Redirection for the current command is processed from left to right.</p></li><li class="listitem"><p>Redirection <span class="quote">&#8220;<span class="quote">N&gt;&amp;M</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">N&lt;&amp;M</span>&#8221;</span> after a command has the effect of creating or updating the symbolic link <code class="filename">/proc/self/fd/N</code> with the same target as the symbolic link <code class="filename">/proc/self/fd/M</code>.</p></li><li class="listitem"><p>The redirections <span class="quote">&#8220;<span class="quote">N&gt; file</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">N&lt; file</span>&#8221;</span> have the effect of creating or updating the symbolic link <code class="filename">/proc/self/fd/N</code> with the target file.</p></li><li class="listitem"><p>File descriptor closure <span class="quote">&#8220;<span class="quote">N&gt;&amp;-</span>&#8221;</span> has the effect of deleting the symbolic link <code class="filename">/proc/self/fd/N</code>.</p></li><li class="listitem"><p>Only now is the current command executed.</p></li></ul></div><p>When you run a script from the command line, nothing much changes because the child shell process will use the same file descriptors as the parent.  When no such parent is available, for instance when you run a script using the <span class="emphasis"><em>cron</em></span> facility, the standard file descriptors are pipes or other (temporary) files, unless some form of redirection is used.  This is demonstrated in the example below, which shows output from a simple <span class="command"><strong>at</strong></span> script:</p><pre class="screen">
<code class="prompt">michel ~&gt;</code> <span class="command"><strong>date</strong></span>
Fri Jan 24 11:05:50 CET 2003

<code class="prompt">michel ~&gt;</code> <span class="command"><strong>at <em class="parameter"><code>1107</code></em></strong></span>
warning: commands will be executed using (in order) 
a) $SHELL b) login shell c)/bin/sh
<code class="prompt">at&gt;</code> <span class="command"><strong>ls <code class="option">-l</code> <code class="filename">/proc/self/fd/</code> &gt; <code class="filename">/var/tmp/fdtest.at</code></strong></span>
<code class="prompt">at&gt;</code> <span class="command"><strong>&lt;EOT&gt;</strong></span>
job 10 at 2003-01-24 11:07

<code class="prompt">michel ~&gt;</code> <span class="command"><strong>cat <code class="filename">/var/tmp/fdtest.at</code></strong></span>
total 0
lr-x------    1 michel michel  64 Jan 24 11:07 0 -&gt; /var/spool/at/!0000c010959eb (deleted)
l-wx------    1 michel michel  64 Jan 24 11:07 1 -&gt; /var/tmp/fdtest.at
l-wx------    1 michel michel  64 Jan 24 11:07 2 -&gt; /var/spool/at/spool/a0000c010959eb
lr-x------    1 michel michel  64 Jan 24 11:07 3 -&gt; /proc/21949/fd
</pre><p>And one with <span class="command"><strong>cron</strong></span>:</p><pre class="screen">
<code class="prompt">michel ~&gt;</code> <span class="command"><strong>crontab <code class="option">-l</code></strong></span>
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (/tmp/crontab.21968 installed on Fri Jan 24 11:30:41 2003)
# (Cron version -- $Id$)
32 11 * * * ls -l /proc/self/fd/ &gt; /var/tmp/fdtest.cron

<code class="prompt">michel ~&gt;</code> <span class="command"><strong>cat <code class="filename">/var/tmp/fdtest.cron</code></strong></span>
total 0
lr-x------    1 michel michel  64 Jan 24 11:32 0 -&gt; pipe:[124440]
l-wx------    1 michel michel  64 Jan 24 11:32 1 -&gt; /var/tmp/fdtest.cron
l-wx------    1 michel michel  64 Jan 24 11:32 2 -&gt; pipe:[124441]
lr-x------    1 michel michel  64 Jan 24 11:32 3 -&gt; /proc/21974/fd
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_08_02_03_02"></a>2.3.2. Redirection of errors</h4></div></div></div><p>From the previous examples, it is clear that you can provide input and output files for a script (see <a class="xref" href="#sect_08_02_04" title="2.4. File input and output">Section 2.4, &#8220;File input and output&#8221;</a> for more), but some tend to forget about redirecting errors - output which might be depended upon later on.  Also, if you are lucky, errors will be mailed to you and eventual causes of failure might get revealed.  If you are not as lucky, errors will cause your script to fail and won't be caught or sent anywhere, so that you can't start to do any worthwhile debugging.</p><p>When redirecting errors, note that the order of precedence is significant.  For example, this command, issued in <code class="filename">/var/spool</code></p><pre class="screen">
<span class="command"><strong>ls <code class="option">-l</code> <code class="filename">*</code> <em class="parameter"><code>2</code></em>&gt; <code class="filename">/var/tmp/unaccessible-in-spool</code></strong></span>
</pre><p>will redirect standard output of the <span class="command"><strong>ls</strong></span> command to the file <code class="filename">unaccessible-in-spool</code> in <code class="filename">/var/tmp</code>.  The command</p><pre class="screen">
<span class="command"><strong>ls <code class="option">-l</code> <code class="filename">*</code> &gt; <code class="filename">/var/tmp/spoollist</code> <em class="parameter"><code>2</code></em>&gt;&amp;<em class="parameter"><code>1</code></em></strong></span>
</pre><p>will direct both standard input and standard error to the file <code class="filename">spoollist</code>.  The command</p><pre class="screen">
<span class="command"><strong>ls <code class="option">-l</code> <code class="filename">*</code> <em class="parameter"><code>2</code></em> &gt;&amp; <em class="parameter"><code>1</code></em> &gt; <code class="filename">/var/tmp/spoollist</code></strong></span>
</pre><p>directs only the standard output to the destination file, because the standard error is copied to standard output before the standard output is redirected.</p><p>For convenience, errors are often redirected to <code class="filename">/dev/null</code>, if it is sure they will not be needed.  Hundreds of examples can be found in the startup scripts for your system.</p><p>Bash allows for both standard output and standard error to be redirected to the file whose name is the result of the expansion of <code class="filename">FILE</code> with this construct:</p><div class="cmdsynopsis"><p><code class="command">&amp;&gt; <code class="filename">FILE</code></code> </p></div><p>This is the equivalent of <span class="command"><strong>&gt; <code class="filename">FILE</code> 2&gt;&amp;1</strong></span>, the construct used in the previous set of examples.  It is also often combined with redirection to <code class="filename">/dev/null</code>, for instance when you just want a command to execute, no matter what output or errors it gives.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_08_02_04"></a>2.4. File input and output</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_08_02_04_01"></a>2.4.1. Using /dev/fd</h4></div></div></div><p>The <code class="filename">/dev/fd</code> directory contains entries named <code class="filename">0</code>, <code class="filename">1</code>, <code class="filename">2</code>, and so on.  Opening the file <code class="filename">/dev/fd/N</code> is equivalent to duplicating file descriptor <span class="emphasis"><em>N</em></span>.  If your system provides <code class="filename">/dev/stdin</code>, <code class="filename">/dev/stdout</code> and <code class="filename">/dev/stderr</code>, you will see that these are equivalent to <code class="filename">/dev/fd/0</code>, <code class="filename">/dev/fd/1</code> and <code class="filename">/dev/fd/2</code>, respectively.</p><p>The main use of the <code class="filename">/dev/fd</code> files is from the shell.  This mechanism allows for programs that use pathname arguments to handle standard input and standard output in the same way as other pathnames.  If <code class="filename">/dev/fd</code> is not available on a system, you'll have to find a way to bypass the problem.  This can be done for instance using a hyphen (<span class="emphasis"><em>-</em></span>) to indicate that a program should read from a pipe.  An example:</p><pre class="screen">
<code class="prompt">michel ~&gt;</code> <span class="command"><strong>filter <code class="filename">body.txt.gz</code> | cat <code class="filename">header.txt</code> - <code class="filename">footer.txt</code></strong></span>
This text is printed at the beginning of each print job and thanks the sysadmin
for setting us up such a great printing infrastructure.

Text to be filtered.

This text is printed at the end of each print job.
</pre><p>The <span class="command"><strong>cat</strong></span> command first reads the file <code class="filename">header.txt</code>, next its standard input which is the output of the <span class="command"><strong>filter</strong></span> command, and last the <code class="filename">footer.txt</code> file.  The special meaning of the hyphen as a command-line argument to refer to the standard input or standard output is a misconception that has crept into many programs.  There might also be problems when specifying hyphen as the first argument, since it might be interpreted as an option to the preceding command.  Using <code class="filename">/dev/fd</code> allows for uniformity and prevents confusion:</p><pre class="screen">
<code class="prompt">michel ~&gt;</code> <span class="command"><strong>filter <code class="filename">body.txt</code> | cat <code class="filename">header.txt /dev/fd/0 footer.txt</code> | lp</strong></span>
</pre><p>In this clean example, all output is additionally piped through <span class="command"><strong>lp</strong></span> to send it to the default printer.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_08_02_04_02"></a>2.4.2. Read and exec</h4></div></div></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_08_02_04_02_01"></a>2.4.2.1. Assigning file descriptors to files</h5></div></div></div><p>Another way of looking at file descriptors is thinking of them as a way to assign a numeric value to a file.  Instead of using the file name, you can use the file descriptor number.  The <span class="command"><strong>exec</strong></span> built-in command can be used to replace the shell of the current process or to alter the file descriptors of the current shell.  For example, it can be used to assign a file descriptor to a file.  Use</p><div class="cmdsynopsis"><p><code class="command">exec fdN&gt; <code class="filename">file</code></code> </p></div><p>for assigning file descriptor N to <code class="filename">file</code> for output, and</p><div class="cmdsynopsis"><p><code class="command">exec fdN&lt; <code class="filename">file</code></code> </p></div><p>for assigning file descriptor N to <code class="filename">file</code> for input.  After a file descriptor has been assigned to a file, it can be used with the shell redirection operators, as is demonstrated in the following example:</p><pre class="screen">
<code class="prompt">michel ~&gt;</code> <span class="command"><strong>exec <code class="filename">4</code>&gt; <code class="filename">result.txt</code></strong></span>

<code class="prompt">michel ~&gt;</code> <span class="command"><strong>filter <code class="filename">body.txt</code> | cat <code class="filename">header.txt /dev/fd/0 footer.txt</code> &gt;&amp; <code class="filename">4</code></strong></span>

<code class="prompt">michel ~&gt;</code> <span class="command"><strong>cat <code class="filename">result.txt</code></strong></span>
This text is printed at the beginning of each print job and thanks the sysadmin
for setting us up such a great printing infrastructure.

Text to be filtered.

This text is printed at the end of each print job.
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">File descriptor 5</h3><p>Using this file descriptor might cause problems, see <a class="ulink" href="http://www.tldp.org/LDP/abs/html/io-redirection.html" target="_top">the Advanced Bash-Scripting Guide</a>, chapter 16.  You are strongly advised not to use it.</p></div></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="sect_08_02_04_02_02"></a>2.4.2.2. Read in scripts</h5></div></div></div><p>The following is an example that shows how you can alternate between file input and command line input:</p><pre class="screen">
<code class="prompt">michel ~/testdir&gt;</code> <span class="command"><strong>cat <code class="filename">sysnotes.sh</code></strong></span>
#!/bin/bash

# This script makes an index of important config files, puts them together in
# a backup file and allows for adding comment for each file.

CONFIG=/var/tmp/sysconfig.out
rm "$CONFIG" 2&gt;/dev/null

echo "Output will be saved in $CONFIG."

# create fd 7 with same target as fd 0 (save stdin "value")
exec 7&lt;&amp;0

# update fd 0 to target file /etc/passwd
exec &lt; /etc/passwd

# Read the first line of /etc/passwd
read rootpasswd

echo "Saving root account info..."
echo "Your root account info:" &gt;&gt; "$CONFIG"
echo $rootpasswd &gt;&gt; "$CONFIG"

# update fd 0 to target fd 7 target (old fd 0 target); delete fd 7
exec 0&lt;&amp;7 7&lt;&amp;-

echo -n "Enter comment or [ENTER] for no comment: "
read comment; echo $comment &gt;&gt; "$CONFIG"

echo "Saving hosts information..."

# first prepare a hosts file not containing any comments
TEMP="/var/tmp/hosts.tmp"
cat /etc/hosts | grep -v "^#" &gt; "$TEMP"

exec 7&lt;&amp;0
exec &lt; "$TEMP"

read ip1 name1 alias1
read ip2 name2 alias2

echo "Your local host configuration:" &gt;&gt; "$CONFIG"

echo "$ip1 $name1 $alias1" &gt;&gt; "$CONFIG"
echo "$ip2 $name2 $alias2" &gt;&gt; "$CONFIG"

exec 0&lt;&amp;7 7&lt;&amp;-

echo -n "Enter comment or [ENTER] for no comment: "
read comment; echo $comment &gt;&gt; "$CONFIG"
rm "$TEMP"

<code class="prompt">michel ~/testdir&gt;</code> <span class="command"><strong>sysnotes.sh</strong></span>
Output will be saved in /var/tmp/sysconfig.out.
Saving root account info...
Enter comment or [ENTER] for no comment: hint for password: blue lagoon
Saving hosts information...
Enter comment or [ENTER] for no comment: in central DNS

<code class="prompt">michel ~/testdir&gt;</code> <span class="command"><strong>cat <code class="filename">/var/tmp/sysconfig.out</code></strong></span>
Your root account info:
root:x:0:0:root:/root:/bin/bash
hint for password: blue lagoon
Your local host configuration:
127.0.0.1 localhost.localdomain localhost
192.168.42.1 tintagel.kingarthur.com tintagel
in central DNS
</pre></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_08_02_04_03"></a>2.4.3. Closing file descriptors</h4></div></div></div><p>Since child processes inherit open file descriptors, it is good practice to close a file descriptor when it is no longer needed.  This is done using the</p><div class="cmdsynopsis"><p><code class="command">exec fd&lt;&amp;-</code> </p></div><p>syntax.  In the above example, file descriptor 7, which has been assigned to standard input, is closed each time the user needs to have access to the actual standard input device, usually the keyboard.</p><p>The following is a simple example redirecting only standard error to a pipe:</p><pre class="screen">
<code class="prompt">michel ~&gt;</code> <span class="command"><strong>cat <code class="filename">listdirs.sh</code></strong></span>
#!/bin/bash

# This script prints standard output unchanged, while standard error is 
# redirected for processing by awk.

INPUTDIR="$1"

# fd 6 targets fd 1 target (console out) in current shell
exec 6&gt;&amp;1

# fd 1 targets pipe, fd 2 targets fd 1 target (pipe),
# fd 1 targets fd 6 target (console out), fd 6 closed, execute ls
ls "$INPUTDIR"/* 2&gt;&amp;1 &gt;&amp;6 6&gt;&amp;- \
				# Closes fd 6 for awk, but not for ls.

| awk 'BEGIN { FS=":" } { print "YOU HAVE NO ACCESS TO" $2 }' 6&gt;&amp;-

# fd 6 closed for current shell
exec 6&gt;&amp;-
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_08_02_04_04"></a>2.4.4. <span class="emphasis"><em>Here</em></span> documents</h4></div></div></div><p>Frequently, your script might call on another program or script that requires input.  The <span class="emphasis"><em>here</em></span> document provides a way of instructing the shell to read input from the current source until a line containing only the search string is found (no trailing blanks).  All of the lines read up to that point are then used as the standard input for a command.</p><p>The result is that you don't need to call on separate files; you can use shell-special characters, and it looks nicer than a bunch of <span class="command"><strong>echo</strong></span>'s:</p><pre class="screen">
<code class="prompt">michel ~&gt;</code> <span class="command"><strong>cat <code class="filename">startsurf.sh</code></strong></span>
#!/bin/bash

# This script provides an easy way for users to choose between browsers.

echo "These are the web browsers on this system:"
 
# Start here document
cat &lt;&lt; BROWSERS
mozilla
links
lynx
konqueror
opera
netscape
BROWSERS
# End here document

echo -n "Which is your favorite? "
read browser

echo "Starting $browser, please wait..."
$browser &amp;

<code class="prompt">michel ~&gt;</code> <span class="command"><strong>startsurf.sh</strong></span>
These are the web browsers on this system:
mozilla
links
lynx
konqueror
opera
netscape
<code class="prompt">Which is your favorite?</code> <span class="command"><strong>opera</strong></span>
Starting opera, please wait...
</pre><p>Although we talk about a <span class="emphasis"><em>here document</em></span>, it is supposed to be a construct within the same script.  This is an example that installs a package automatically, eventhough you should normally confirm:</p><pre class="screen">
#!/bin/bash
 
# This script installs packages automatically, using yum.
 
if [ $# -lt 1 ]; then
        echo "Usage: $0 package."
        exit 1
fi
 
yum install $1 &lt;&lt; CONFIRM
y
CONFIRM
</pre><p>And this is how the script runs.  When prompted with the <span class="quote">&#8220;<span class="quote">Is this ok [y/N]</span>&#8221;</span> string, the script answers <span class="quote">&#8220;<span class="quote">y</span>&#8221;</span> automatically:</p><pre class="screen">
<code class="prompt">[root@picon bin]#</code> <span class="command"><strong>./install.sh <em class="parameter"><code>tuxracer</code></em></strong></span>
Gathering header information file(s) from server(s)
Server: Fedora Linux 2 - i386 - core
Server: Fedora Linux 2 - i386 - freshrpms
Server: JPackage 1.5 for Fedora Core 2
Server: JPackage 1.5, generic
Server: Fedora Linux 2 - i386 - updates
Finding updated packages
Downloading needed headers
Resolving dependencies
Dependencies resolved
I will do the following:
[install: tuxracer 0.61-26.i386]
<code class="prompt">Is this ok [y/N]:</code> <span class="command"><strong><span class="keycap"><strong>Enter</strong></span></strong></span>Downloading Packages
Running test transaction:
Test transaction complete, Success!
tuxracer 100 % done 1/1
Installed:  tuxracer 0.61-26.i386
Transaction(s) Complete
</pre></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_08_03"></a>3. Summary</h2></div></div></div><p>In this chapter, we learned how to provide user comments and how to prompt for user input.  This is usually done using the <span class="command"><strong>echo</strong></span>/<span class="command"><strong>read</strong></span> combination.  We also discussed how files can be used as input and output using file descriptors and redirection, and how this can be combined with getting input from the user.</p><p>We stressed the importance of providing ample message for the users of our scripts.  As always when others use your scripts, it is better to give too much information than not enough.  <span class="emphasis"><em>Here</em></span> documents is a type of shell construct that allows creation of lists, holding choices for the users.  This construct can also be used to execute otherwise interactive tasks in the background, without intervention.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_08_04"></a>4. Exercises</h2></div></div></div><p>These exercises are practical applications of the constructs discussed in this chapter.  When writing the scripts, you may test by using a test directory that does not contain too much data.  Write each step, then test that portion of code, rather than writing everything at once.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Write a script that asks for the user's age.  If it is equal to or higher than 16, print a message saying that this user is allowed to drink alcohol.  If the user's age is below 16, print a message telling the user how many years he or she has to wait before legally being allowed to drink.</p><p>As an extra, calculate how much beer an 18+ user has drunk statistically (100 liters/year) and print this information for the user.</p></li><li class="listitem"><p>Write a script that takes one file as an argument.  Use a <span class="emphasis"><em>here</em></span> document that presents the user with a couple of choices for compressing the file.  Possible choices could be <span class="command"><strong>gzip</strong></span>, <span class="command"><strong>bzip2</strong></span>, <span class="command"><strong>compress</strong></span> and <span class="command"><strong>zip</strong></span>. </p></li><li class="listitem"><p>Write a script called <code class="filename">homebackup</code> that automates <span class="command"><strong>tar</strong></span> so the person executing the script always uses the desired options (<code class="option">cvp</code>) and backup destination directory (<code class="filename">/var/backups</code>) to make a backup of his or her home directory.  Implement the following features:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Test for the number of arguments.  The script should run without arguments.  If any arguments are present, exit after printing a usage message.</p></li><li class="listitem"><p>Determine whether the <code class="filename">backups</code> directory has enough free space to hold the backup.</p></li><li class="listitem"><p>Ask the user whether a full or an incremental backup is wanted.  If the user does not have a full backup file yet, print a message that a full backup will be taken.  In case of an incremental backup, only do this if the full backup is not older than a week.</p></li><li class="listitem"><p>Compress the backup using any compression tool.  Inform the user that the script is doing this, because it might take some time, during which the user might start worrying if no output appears on the screen.</p></li><li class="listitem"><p>Print a message informing the user about the size of the compressed backup.</p></li></ul></div><p>See <span class="command"><strong>info tar</strong></span> or <a class="ulink" href="http://tille.garrels.be/training/tldp/c4540.html#sect_09_01_01" target="_top">Introduction to Linux</a>, chapter 9: <span class="quote">&#8220;<span class="quote">Preparing your data</span>&#8221;</span> for background information.</p></li><li class="listitem"><p>Write a script called <code class="filename">simple-useradd.sh</code> that adds a local user to the system.  This script should:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Take only one argument, or else exit after printing a usage message.</p></li><li class="listitem"><p>Check <code class="filename">/etc/passwd</code> and decide on the first free user ID.  Print a message containing this ID.</p></li><li class="listitem"><p>Create a private group for this user, checking the <code class="filename">/etc/group</code> file.  Print a message containing the group ID.</p></li><li class="listitem"><p>Gather information from the operator user: a comment describing this user, choice from a list of shells (test for acceptability, else exit printing a message), expiration date for this account, extra groups of which the new user should be a member.</p></li><li class="listitem"><p>With the obtained information, add a line to <code class="filename">/etc/passwd</code>, <code class="filename">/etc/group</code> and <code class="filename">/etc/shadow</code>; create the user's home directory (with correct permissions!); add the user to the desired secondary groups.</p></li><li class="listitem"><p>Set the password for this user to a default known string.</p></li></ul></div></li><li class="listitem"><p>Rewrite the script from <a class="xref" href="#sect_07_02_01_04" title="2.1.4. Testing that a file exists">Section 2.1.4, &#8220;Testing that a file exists&#8221;</a> so that it reads input from the user instead of taking it from the first argument.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_09"></a>Chapter 9. Repetitive tasks</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_09_01">1. The for loop</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_01_01">1.1. How does it work?</a></span></dt><dt><span class="sect2"><a href="#sect_09_01_02">1.2. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_02">2. The while loop</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_02_01">2.1. What is it?</a></span></dt><dt><span class="sect2"><a href="#sect_09_02_02">2.2. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_03">3. The until loop</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_03_01">3.1. What is it?</a></span></dt><dt><span class="sect2"><a href="#sect_09_03_02">3.2. Example</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_04">4. I/O redirection and loops</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_04_01">4.1. Input redirection</a></span></dt><dt><span class="sect2"><a href="#sect_09_04_02">4.2. Output redirection</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_05">5. Break and continue</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_05_01">5.1. The break built-in</a></span></dt><dt><span class="sect2"><a href="#sect_09_05_02">5.2. The continue built-in</a></span></dt><dt><span class="sect2"><a href="#sect_09_05_03">5.3. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_06">6. Making menus with the select built-in</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_06_01">6.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_09_06_02">6.2. Submenus</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_07">7. The shift built-in</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_09_07_01">7.1. What does it do?</a></span></dt><dt><span class="sect2"><a href="#sect_09_07_02">7.2. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_09_08">8. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_09_09">9. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>Upon completion of this chapter, you will be able to</p><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Use <span class="command"><strong>for</strong></span>, <span class="command"><strong>while</strong></span> and <span class="command"><strong>until</strong></span> loops, and decide which loop fits which occasion.</p></li><li class="listitem"><p>Use the <span class="command"><strong>break</strong></span> and <span class="command"><strong>continue</strong></span> Bash built-ins.</p></li><li class="listitem"><p>Write scripts using the <span class="command"><strong>select</strong></span> statement.</p></li><li class="listitem"><p>Write scripts that take a variable number of arguments.</p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_01"></a>1. The for loop</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_01_01"></a>1.1. How does it work?</h3></div></div></div><p>The <span class="command"><strong>for</strong></span> loop is the first of the three shell looping constructs.  This loop allows for specification of a list of values.  A list of commands is executed for each value in the list.</p><p>The syntax for this loop is:</p><div class="cmdsynopsis"><p><code class="command">for <code class="varname">NAME</code> [in LIST ]; do COMMANDS; done</code> </p></div><p>If <span class="command"><strong>[in LIST]</strong></span> is not present, it is replaced with <span class="command"><strong>in <code class="varname">$@</code></strong></span> and <span class="command"><strong>for</strong></span> executes the <span class="command"><strong>COMMANDS</strong></span> once for each positional parameter that is set (see <a class="xref" href="#sect_03_02_05" title="2.5. Special parameters">Section 2.5, &#8220;Special parameters&#8221;</a> and <a class="xref" href="#sect_07_02_01_02" title="2.1.2. Checking command line arguments">Section 2.1.2, &#8220;Checking command line arguments&#8221;</a>).</p><p>The return status is the exit status of the last command that executes.  If no commands are executed because <code class="varname">LIST</code> does not expand to any items, the return status is zero.</p><p><code class="varname">NAME</code> can be any variable name, although <code class="varname">i</code> is used very often.  <code class="varname">LIST</code> can be any list of words, strings or numbers, which can be literal or generated by any command.  The <span class="command"><strong>COMMANDS</strong></span> to execute can also be any operating system commands, script, program or shell statement.  The first time through the loop, <code class="varname">NAME</code> is set to the first item in <code class="varname">LIST</code>.  The second time, its value is set to the second item in the list, and so on.  The loop terminates when <code class="varname">NAME</code> has taken on each of the values from <code class="varname">LIST</code> and no items are left in <code class="varname">LIST</code>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_01_02"></a>1.2. Examples</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_01_02_03"></a>1.2.1. Using command substitution for specifying LIST items</h4></div></div></div><p>The first is a command line example, demonstrating the use of a <span class="command"><strong>for</strong></span> loop that makes a backup copy of each <code class="filename">.xml</code> file.  After issuing the command, it is safe to start working on your sources:</p><pre class="screen">
<code class="prompt">[carol@octarine ~/articles]</code> <span class="command"><strong>ls <code class="filename">*.xml</code></strong></span>
file1.xml  file2.xml  file3.xml

<code class="prompt">[carol@octarine ~/articles]</code> <span class="command"><strong>ls <code class="filename">*.xml</code> &gt; <code class="filename">list</code></strong></span>

<code class="prompt">[carol@octarine ~/articles]</code> <span class="command"><strong>for <code class="varname">i</code> in <em class="parameter"><code>`cat list`</code></em>; do cp <code class="filename">"$i" "$i".bak</code> ; done</strong></span>

<code class="prompt">[carol@octarine ~/articles]</code> <span class="command"><strong>ls <code class="filename">*.xml*</code></strong></span>
file1.xml  file1.xml.bak  file2.xml  file2.xml.bak  file3.xml  file3.xml.bak
</pre><p>This one lists the files in <code class="filename">/sbin</code> that are just plain text files, and possibly scripts:</p><pre class="screen">
<span class="command"><strong>for <code class="varname">i</code> in <em class="parameter"><code>`ls /sbin`</code></em>; do file <code class="filename">/sbin/$i</code> | grep <em class="parameter"><code>ASCII</code></em>; done</strong></span>
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_01_02_02"></a>1.2.2. Using the content of a variable to specify LIST items</h4></div></div></div><p>The following is a specific application script for converting HTML files, compliant with a certain scheme, to PHP files.  The conversion is done by taking out the first 25 and the last 21 lines, replacing these with two PHP tags that provide header and footer lines:</p><pre class="screen">
<code class="prompt">[carol@octarine ~/html]</code> <span class="command"><strong>cat <code class="filename">html2php.sh</code></strong></span>
#!/bin/bash
# specific conversion script for my html files to php
LIST="$(ls *.html)"
for i in "$LIST"; do
     NEWNAME=$(ls "$i" | sed -e 's/html/php/')
     cat beginfile &gt; "$NEWNAME"
     cat "$i" | sed -e '1,25d' | tac | sed -e '1,21d'| tac &gt;&gt; "$NEWNAME"
     cat endfile &gt;&gt; "$NEWNAME"
done
</pre><p>Since we don't do a line count here, there is no way of knowing the line number from which to start deleting lines until reaching the end.  The problem is solved using <span class="command"><strong>tac</strong></span>, which reverses the lines in a file.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">The basename command</h3><p>Instead of using <span class="command"><strong>sed</strong></span> to replace the <code class="filename">html</code> suffix with <code class="filename">php</code>, it would be cleaner to use the <span class="command"><strong>basename</strong></span> command.  Read the man page for more info.</p></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Odd characters</h3><p>You will run into problems if the list expands to file names containing spaces and other irregular characters.  A more ideal construct to obtain the list would be to use the shell's globbing feature, like this:</p><pre class="screen">
for i in $PATHNAME/*; do
	commands
done
</pre></div></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_02"></a>2. The while loop</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_02_01"></a>2.1. What is it?</h3></div></div></div><p>The <span class="command"><strong>while</strong></span> construct allows for repetitive execution of a list of commands, as long as the command controlling the <span class="command"><strong>while</strong></span> loop executes successfully (exit status of zero).  The syntax is:</p><div class="cmdsynopsis"><p><code class="command">while CONTROL-COMMAND; do CONSEQUENT-COMMANDS; done</code> </p></div><p><span class="command"><strong>CONTROL-COMMAND</strong></span> can be any command(s) that can exit with a success or failure status.  The <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> can be any program, script or shell construct.</p><p>As soon as the <span class="command"><strong>CONTROL-COMMAND</strong></span> fails, the loop exits.  In a script, the command following the <span class="command"><strong>done</strong></span> statement is executed.</p><p>The return status is the exit status of the last <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> command, or zero if none was executed.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_02_02"></a>2.2. Examples</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_02_02_01"></a>2.2.1. Simple example using while</h4></div></div></div><p>Here is an example for the impatient:</p><pre class="screen">
#!/bin/bash

# This script opens 4 terminal windows.

i="0"

while [ $i -lt 4 ]
do
xterm &amp;
i=$[$i+1]
done
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_02_02_02"></a>2.2.2. Nested while loops</h4></div></div></div><p>The example below was written to copy pictures that are made with a webcam to a web directory.  Every five minutes a picture is taken.  Every hour, a new directory is created, holding the images for that hour.  Every day, a new directory is created containing 24 subdirectories.  The script runs in the background.</p><pre class="screen">
#!/bin/bash

# This script copies files from my homedirectory into the webserver directory.
# (use scp and SSH keys for a remote directory)
# A new directory is created every hour.

PICSDIR=/home/carol/pics
WEBDIR=/var/www/carol/webcam

while true; do 
	DATE=`date +%Y%m%d`
	HOUR=`date +%H`
	mkdir $WEBDIR/"$DATE"
	
	while [ $HOUR -ne "00" ]; do 
		DESTDIR=$WEBDIR/"$DATE"/"$HOUR"
		mkdir "$DESTDIR"
		mv $PICDIR/*.jpg "$DESTDIR"/
		sleep 3600
		HOUR=`date +%H`
	done
done
</pre><p>Note the use of the <span class="command"><strong>true</strong></span> statement.  This means: continue execution until we are forcibly interrupted (with <span class="command"><strong>kill</strong></span> or <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span>).</p><p>This small script can be used for simulation testing; it generates files:</p><pre class="screen">
#!/bin/bash

# This generates a file every 5 minutes

while true; do
touch pic-`date +%s`.jpg
sleep 300
done
</pre><p>Note the use of the <span class="command"><strong>date</strong></span> command to generate all kinds of file and directory names.  See the man page for more.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Use the system</h3><p>The previous example is for the sake of demonstration.  Regular checks can easily be achieved using the system's <span class="emphasis"><em>cron</em></span> facility.  Do not forget to redirect output and errors when using scripts that are executed from your crontab!</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_02_02_03"></a>2.2.3. Using keyboard input to control the while loop</h4></div></div></div><p>This script can be interrupted by the user when a <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span> sequence is entered:</p><pre class="screen">
#!/bin/bash

# This script provides wisdom

FORTUNE=/usr/games/fortune

while true; do
echo "On which topic do you want advice?"
cat &lt;&lt; topics
politics
startrek
kernelnewbies
sports
bofh-excuses
magic
love
literature
drugs
education
topics

echo
echo -n "Make your choice: "
read topic
echo
echo "Free advice on the topic of $topic: "
echo
$FORTUNE $topic
echo

done
</pre><p>A <span class="emphasis"><em>here</em></span> document is used to present the user with possible choices.  And again, the <span class="command"><strong>true</strong></span> test repeats the commands from the <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> list over and over again.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_02_02_04"></a>2.2.4. Calculating an average</h4></div></div></div><p>This script calculates the average of user input, which is tested before it is processed: if input is not within range, a message is printed.  If <span class="keycap"><strong>q</strong></span> is pressed, the loop exits:</p><pre class="screen">
#!/bin/bash

# Calculate the average of a series of numbers.

SCORE="0"
AVERAGE="0"
SUM="0"
NUM="0"

while true; do

  echo -n "Enter your score [0-100%] ('q' for quit): "; read SCORE;

  if (("$SCORE" &lt; "0"))  || (("$SCORE" &gt; "100")); then
    echo "Be serious.  Common, try again: "
  elif [ "$SCORE" == "q" ]; then
    echo "Average rating: $AVERAGE%."
    break
  else
    SUM=$[$SUM + $SCORE]
    NUM=$[$NUM + 1]
    AVERAGE=$[$SUM / $NUM]
  fi

done

echo "Exiting."
</pre><p>Note how the variables in the last lines are left unquoted in order to do arithmetic.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_03"></a>3. The until loop</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_03_01"></a>3.1. What is it?</h3></div></div></div><p>The <span class="command"><strong>until</strong></span> loop is very similar to the <span class="command"><strong>while</strong></span> loop, except that the loop executes until the <span class="command"><strong>TEST-COMMAND</strong></span> executes successfully.  As long as this command fails, the loop continues.  The syntax is the same as for the <span class="command"><strong>while</strong></span> loop:</p><div class="cmdsynopsis"><p><code class="command">until TEST-COMMAND; do CONSEQUENT-COMMANDS; done</code> </p></div><p>The return status is the exit status of the last command executed in the <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> list, or zero if none was executed.  <span class="command"><strong>TEST-COMMAND</strong></span> can, again, be any command that can exit with a success or failure status, and <span class="command"><strong>CONSEQUENT-COMMANDS</strong></span> can be any UNIX command, script or shell construct.</p><p>As we already explained previously, the <span class="quote">&#8220;<span class="quote">;</span>&#8221;</span> may be replaced with one or more newlines wherever it appears.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_03_02"></a>3.2. Example</h3></div></div></div><p>An improved <code class="filename">picturesort.sh</code> script (see <a class="xref" href="#sect_09_02_02_02" title="2.2.2. Nested while loops">Section 2.2.2, &#8220;Nested while loops&#8221;</a>), which tests for available disk space.  If not enough disk space is available, remove pictures from the previous months:</p><pre class="screen">
#!/bin/bash

# This script copies files from my homedirectory into the webserver directory.
# A new directory is created every hour.
# If the pics are taking up too much space, the oldest are removed.

while true; do 
	DISKFUL=$(df -h $WEBDIR | grep -v File | awk '{print $5 }' | cut -d "%" -f1 -)

	until [ $DISKFUL -ge "90" ]; do 

        	DATE=`date +%Y%m%d`
        	HOUR=`date +%H`
        	mkdir $WEBDIR/"$DATE"
                                                                                
        	while [ $HOUR -ne "00" ]; do
                	DESTDIR=$WEBDIR/"$DATE"/"$HOUR"
                	mkdir "$DESTDIR"
                	mv $PICDIR/*.jpg "$DESTDIR"/
                	sleep 3600
                	HOUR=`date +%H`
        	done

	DISKFULL=$(df -h $WEBDIR | grep -v File | awk '{ print $5 }' | cut -d "%" -f1 -)
	done

	TOREMOVE=$(find $WEBDIR -type d -a -mtime +30)
	for i in $TOREMOVE; do
		rm -rf "$i";
	done

done
</pre><p>Note the initialization of the <code class="varname">HOUR</code> and <code class="varname">DISKFULL</code> variables and the use of options with <span class="command"><strong>ls</strong></span> and <span class="command"><strong>date</strong></span> in order to obtain a correct listing for <code class="varname">TOREMOVE</code>.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_04"></a>4. I/O redirection and loops</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_04_01"></a>4.1. Input redirection</h3></div></div></div><p>Instead of controlling a loop by testing the result of a command or by user input, you can specify a file from which to read input that controls the loop.  In such cases, <span class="command"><strong>read</strong></span> is often the controlling command.  As long as input lines are fed into the loop, execution of the loop commands continues.  As soon as all the input lines are read the loop exits.</p><p>Since the loop construct is considered to be one command structure (such as <span class="command"><strong>while TEST-COMMAND; do CONSEQUENT-COMMANDS; done</strong></span>), the redirection should occur after the <span class="command"><strong>done</strong></span> statement, so that it complies with the form</p><div class="cmdsynopsis"><p><code class="command">command &lt; <code class="filename">file</code></code> </p></div><p>This kind of redirection also works with other kinds of loops.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_04_02"></a>4.2. Output redirection</h3></div></div></div><p>In the example below, output of the <span class="command"><strong>find</strong></span> command is used as input for the <span class="command"><strong>read</strong></span> command controlling a <span class="command"><strong>while</strong></span> loop:</p><pre class="screen">
<code class="prompt">[carol@octarine ~/testdir]</code> <span class="command"><strong>cat <code class="filename">archiveoldstuff.sh</code></strong></span>
#!/bin/bash

# This script creates a subdirectory in the current directory, to which old
# files are moved.
# Might be something for cron (if slightly adapted) to execute weekly or 
# monthly.

ARCHIVENR=`date +%Y%m%d`
DESTDIR="$PWD/archive-$ARCHIVENR"

mkdir "$DESTDIR"

# using quotes to catch file names containing spaces, using read -d for more 
# fool-proof usage:
find "$PWD" -type f -a -mtime +5 | while read -d $'\000' file

do
gzip "$file"; mv "$file".gz "$DESTDIR"
echo "$file archived"
done
</pre><p>Files are compressed before they are moved into the archive directory.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_05"></a>5. Break and continue</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_05_01"></a>5.1. The break built-in</h3></div></div></div><p>The <span class="command"><strong>break</strong></span> statement is used to exit the current loop before its normal ending.  This is done when you don't know in advance how many times the loop will have to execute, for instance because it is dependent on user input.</p><p>The example below demonstrates a <span class="command"><strong>while</strong></span> loop that can be interrupted.  This is a slightly improved version of the <code class="filename">wisdom.sh</code> script from <a class="xref" href="#sect_09_02_02_03" title="2.2.3. Using keyboard input to control the while loop">Section 2.2.3, &#8220;Using keyboard input to control the while loop&#8221;</a>.</p><pre class="screen">
#!/bin/bash

# This script provides wisdom
# You can now exit in a decent way.

FORTUNE=/usr/games/fortune

while true; do
echo "On which topic do you want advice?"
echo "1.  politics"
echo "2.  startrek"
echo "3.  kernelnewbies"
echo "4.  sports"
echo "5.  bofh-excuses"
echo "6.  magic"
echo "7.  love"
echo "8.  literature"
echo "9.  drugs"
echo "10. education"
echo

echo -n "Enter your choice, or 0 for exit: "
read choice
echo

case $choice in
     1)
     $FORTUNE politics
     ;;
     2)
     $FORTUNE startrek
     ;;
     3)
     $FORTUNE kernelnewbies
     ;;
     4)
     echo "Sports are a waste of time, energy and money."
     echo "Go back to your keyboard."
     echo -e "\t\t\t\t -- \"Unhealthy is my middle name\" Soggie."
     ;;
     5)
     $FORTUNE bofh-excuses
     ;;
     6)
     $FORTUNE magic
     ;;
     7)
     $FORTUNE love
     ;;
     8)
     $FORTUNE literature
     ;;
     9)
     $FORTUNE drugs
     ;;
     10)
     $FORTUNE education
     ;;
     0)
     echo "OK, see you!"
     break
     ;;
     *)
     echo "That is not a valid choice, try a number from 0 to 10."
     ;;
esac  
done
</pre><p>Mind that <span class="command"><strong>break</strong></span> exits the loop, not the script.  This can be demonstrated by adding an <span class="command"><strong>echo</strong></span> command at the end of the script.  This <span class="command"><strong>echo</strong></span> will also be executed upon input that causes <span class="command"><strong>break</strong></span> to be executed (when the user types <span class="quote">&#8220;<span class="quote">0</span>&#8221;</span>).</p><p>In nested loops, <span class="command"><strong>break</strong></span> allows for specification of which loop to exit.  See the Bash <span class="command"><strong>info</strong></span> pages for more.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_05_02"></a>5.2. The continue built-in</h3></div></div></div><p>The <span class="command"><strong>continue</strong></span> statement resumes iteration of an enclosing <span class="command"><strong>for</strong></span>, <span class="command"><strong>while</strong></span>, <span class="command"><strong>until</strong></span> or <span class="command"><strong>select</strong></span> loop.</p><p>When used in a <span class="command"><strong>for</strong></span> loop, the controlling variable takes on the value of the next element in the list.  When used in a <span class="command"><strong>while</strong></span> or <span class="command"><strong>until</strong></span> construct, on the other hand, execution resumes with <span class="command"><strong>TEST-COMMAND</strong></span> at the top of the loop.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_05_03"></a>5.3. Examples</h3></div></div></div><p>In the following example, file names are converted to lower case.  If no conversion needs to be done, a <span class="command"><strong>continue</strong></span> statement restarts execution of the loop.  These commands don't eat much system resources, and most likely, similar problems can be solved using <span class="command"><strong>sed</strong></span> and <span class="command"><strong>awk</strong></span>.  However, it is useful to know about this kind of construction when executing heavy jobs, that might not even be necessary when tests are inserted at the correct locations in a script, sparing system resources.</p><pre class="screen">
<code class="prompt">[carol@octarine ~/test]</code> <span class="command"><strong>cat <code class="filename">tolower.sh</code></strong></span>
#!/bin/bash

# This script converts all file names containing upper case characters into file# names containing only lower cases.

LIST="$(ls)"

for name in "$LIST"; do

if [[ "$name" != *[[:upper:]]* ]]; then
continue
fi

ORIG="$name"
NEW=`echo $name | tr 'A-Z' 'a-z'`

mv "$ORIG" "$NEW"
echo "new name for $ORIG is $NEW"
done
</pre><p>This script has at least one disadvantage: it overwrites existing files.  The <code class="option">noclobber</code> option to Bash is only useful when redirection occurs.  The <code class="option">-b</code> option to the <span class="command"><strong>mv</strong></span> command provides more security, but is only safe in case of one accidental overwrite, as is demonstrated in this test:</p><pre class="screen">
<code class="prompt">[carol@octarine ~/test]</code> <span class="command"><strong>rm <code class="filename">*</code></strong></span>

<code class="prompt">[carol@octarine ~/test]</code> <span class="command"><strong>touch <code class="filename">test Test TEST</code></strong></span>

<code class="prompt">[carol@octarine ~/test]</code> <span class="command"><strong>bash <code class="option">-x</code> <code class="filename">tolower.sh</code></strong></span>
++ ls
+ LIST=test
Test
TEST
+ [[ test != *[[:upper:]]* ]]
+ continue
+ [[ Test != *[[:upper:]]* ]]
+ ORIG=Test
++ echo Test
++ tr A-Z a-z
+ NEW=test
+ mv -b Test test
+ echo 'new name for Test is test'
new name for Test is test
+ [[ TEST != *[[:upper:]]* ]]
+ ORIG=TEST
++ echo TEST
++ tr A-Z a-z
+ NEW=test
+ mv -b TEST test
+ echo 'new name for TEST is test'
new name for TEST is test

<code class="prompt">[carol@octarine ~/test]</code> <span class="command"><strong>ls <code class="option">-a</code></strong></span>
./  ../  test  test~
</pre><p>The <span class="command"><strong>tr</strong></span> is part of the <span class="emphasis"><em>textutils</em></span> package; it can perform all kinds of character transformations.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_06"></a>6. Making menus with the select built-in</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_06_01"></a>6.1. General</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_06_01_01"></a>6.1.1. Use of select</h4></div></div></div><p>The <span class="command"><strong>select</strong></span> construct allows easy menu generation.  The syntax is quite similar to that of the <span class="command"><strong>for</strong></span> loop:</p><div class="cmdsynopsis"><p><code class="command">select <code class="varname">WORD</code> [in <code class="varname">LIST</code>]; do RESPECTIVE-COMMANDS; done</code> </p></div><p><code class="varname">LIST</code> is expanded, generating a list of items.  The expansion is printed to standard error; each item is preceded by a number.  If <span class="command"><strong>in <code class="varname">LIST</code></strong></span> is not present, the positional parameters are printed, as if <span class="command"><strong>in <code class="varname">$@</code></strong></span> would have been specified.  <code class="varname">LIST</code> is only printed once.</p><p>Upon printing all the items, the <code class="varname">PS3</code> prompt is printed and one line from standard input is read.  If this line consists of a number corresponding to one of the items, the value of <code class="varname">WORD</code> is set to the name of that item.  If the line is empty, the items and the <code class="varname">PS3</code> prompt are displayed again.  If an <span class="emphasis"><em>EOF</em></span> (End Of File) character is read, the loop exits.  Since most users don't have a clue which key combination is used for the EOF sequence, it is more user-friendly to have a <span class="command"><strong>break</strong></span> command as one of the items.  Any other value of the read line will set <code class="varname">WORD</code> to be a null string.</p><p>The read line is saved in the <code class="varname">REPLY</code> variable.</p><p>The <span class="command"><strong>RESPECTIVE-COMMANDS</strong></span> are executed after each selection until the number representing the <span class="command"><strong>break</strong></span> is read.  This exits the loop.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_09_06_01_02"></a>6.1.2. Examples</h4></div></div></div><p>This is a very simple example, but as you can see, it is not very user-friendly:</p><pre class="screen">
<code class="prompt">[carol@octarine testdir]</code> <span class="command"><strong>cat <code class="filename">private.sh</code></strong></span>
#!/bin/bash

echo "This script can make any of the files in this directory private."
echo "Enter the number of the file you want to protect:"

select FILENAME in *;
do
     echo "You picked $FILENAME ($REPLY), it is now only accessible to you."
     chmod go-rwx "$FILENAME"
done

<code class="prompt">[carol@octarine testdir]</code> <span class="command"><strong>./private.sh</strong></span>
This script can make any of the files in this directory private.
Enter the number of the file you want to protect:
1) archive-20030129
2) bash
3) private.sh
#? 1
You picked archive-20030129 (1)
#?
</pre><p>Setting the <code class="varname">PS3</code> prompt and adding a possibility to quit makes it better:</p><pre class="screen">
#!/bin/bash

echo "This script can make any of the files in this directory private."
echo "Enter the number of the file you want to protect:"

PS3="Your choice: "
QUIT="QUIT THIS PROGRAM - I feel safe now."
touch "$QUIT"

select FILENAME in *;
do
  case $FILENAME in
        "$QUIT")
          echo "Exiting."
          break
          ;;
        *)
          echo "You picked $FILENAME ($REPLY)"
          chmod go-rwx "$FILENAME"
          ;;
  esac
done
rm "$QUIT"
</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_06_02"></a>6.2. Submenus</h3></div></div></div><p>Any statement within a <span class="command"><strong>select</strong></span> construct can be another <span class="command"><strong>select</strong></span> loop, enabling (a) submenu(s) within a menu.</p><p>By default, the <code class="varname">PS3</code> variable is not changed when entering a nested <span class="command"><strong>select</strong></span> loop.  If you want a different prompt in the submenu, be sure to set it at the appropriate time(s).</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_07"></a>7. The shift built-in</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_07_01"></a>7.1. What does it do?</h3></div></div></div><p>The <span class="command"><strong>shift</strong></span> command is one of the Bourne shell built-ins that comes with Bash.  This command takes one argument, a number.  The positional parameters are shifted to the left by this number, <span class="emphasis"><em>N</em></span>.  The positional parameters from <code class="varname">N+1</code> to <code class="varname">$#</code> are renamed to variable names from <code class="varname">$1</code> to <code class="varname">$# - N+1</code>.</p><p>Say you have a command that takes 10 arguments, and N is 4, then <code class="varname">$4</code> becomes <code class="varname">$1</code>, <code class="varname">$5</code> becomes <code class="varname">$2</code> and so on.  <code class="varname">$10</code> becomes <code class="varname">$7</code> and the original <code class="varname">$1</code>, <code class="varname">$2</code> and <code class="varname">$3</code> are thrown away.</p><p>If N is zero or greater than <code class="varname">$#</code>, the positional parameters are not changed (the total number of arguments, see <a class="xref" href="#sect_07_02_01_02" title="2.1.2. Checking command line arguments">Section 2.1.2, &#8220;Checking command line arguments&#8221;</a>) and the command has no effect.  If N is not present, it is assumed to be 1.  The return status is zero unless N is greater than <code class="varname">$#</code> or less than zero; otherwise it is non-zero.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_09_07_02"></a>7.2. Examples</h3></div></div></div><p>A shift statement is typically used when the number of arguments to a command is not known in advance, for instance when users can give as many arguments as they like.  In such cases, the arguments are usually processed in a <span class="command"><strong>while</strong></span> loop with a test condition of <span class="command"><strong>(( $# ))</strong></span>.  This condition is true as long as the number of arguments is greater than zero.  The <code class="varname">$1</code> variable and the <span class="command"><strong>shift</strong></span> statement process each argument.  The number of arguments is reduced each time <span class="command"><strong>shift</strong></span> is executed and eventually becomes zero, upon which the <span class="command"><strong>while</strong></span> loop exits.</p><p>The example below, <code class="filename">cleanup.sh</code>, uses <span class="command"><strong>shift</strong></span> statements to process each file in the list generated by <span class="command"><strong>find</strong></span>:</p><pre class="screen">
#!/bin/bash

# This script can clean up files that were last accessed over 365 days ago.

USAGE="Usage: $0 dir1 dir2 dir3 ... dirN"

if [ "$#" == "0" ]; then
	echo "$USAGE"
	exit 1
fi

while (( "$#" )); do

if [[ $(ls "$1") == "" ]]; then 
	echo "Empty directory, nothing to be done."
  else 
	find "$1" -type f -a -atime +365 -exec rm -i {} \;
fi

shift

done
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">-exec vs. xargs</h3><p>The above <span class="command"><strong>find</strong></span> command can be replaced with the following:</p><div class="cmdsynopsis"><p><code class="command">find <code class="option">options</code> | xargs [commands_to_execute_on_found_files]</code> </p></div><p>The <span class="command"><strong>xargs</strong></span> command builds and executes command lines from standard input.  This has the advantage that the command line is filled until the system limit is reached.  Only then will the command to execute be called, in the above example this would be <span class="command"><strong>rm</strong></span>.  If there are more arguments, a new command line will be used, until that one is full or until there are no more arguments.  The same thing using <span class="command"><strong>find <code class="option">-exec</code></strong></span> calls on the command to execute on the found files every time a file is found.  Thus, using <span class="command"><strong>xargs</strong></span> greatly speeds up your scripts and the performance of your machine.</p></div><p>In the next example, we modified the script from <a class="xref" href="#sect_08_02_04_04" title="2.4.4. Here documents">Section 2.4.4, &#8220;<span class="emphasis"><em>Here</em></span> documents&#8221;</a> so that it accepts multiple packages to install at once:</p><pre class="screen">
#!/bin/bash
if [ $# -lt 1 ]; then
        echo "Usage: $0 package(s)"
        exit 1
fi
while (($#)); do
	yum install "$1" &lt;&lt; CONFIRM
y
CONFIRM
	shift
done
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_08"></a>8. Summary</h2></div></div></div><p>In this chapter, we discussed how repetitive commands can be incorporated in loop constructs.  Most common loops are built using the <span class="command"><strong>for</strong></span>, <span class="command"><strong>while</strong></span> or <span class="command"><strong>until</strong></span> statements, or a combination of these commands.  The <span class="command"><strong>for</strong></span> loop executes a task a defined number of times.  If you don't know how many times a command should execute, use either <span class="command"><strong>until</strong></span> or <span class="command"><strong>while</strong></span> to specify when the loop should end.</p><p>Loops can be interrupted or reiterated using the <span class="command"><strong>break</strong></span> and <span class="command"><strong>continue</strong></span> statements.</p><p>A file can be used as input for a loop using the input redirection operator, loops can also read output from commands that is fed into the loop using a pipe.</p><p>The <span class="command"><strong>select</strong></span> construct is used for printing menus in interactive scripts.  Looping through the command line arguments to a script can be done using the <span class="command"><strong>shift</strong></span> statement.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_09_09"></a>9. Exercises</h2></div></div></div><p>Remember: when building scripts, work in steps and test each step before incorporating it in your script.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a script that will take a (recursive) copy of files in <code class="filename">/etc</code> so that a beginning system administrator can edit files without fear.</p></li><li class="listitem"><p>Write a script that takes exactly one argument, a directory name.  If the number of arguments is more or less than one, print a usage message.  If the argument is not a directory, print another message.  For the given directory, print the five biggest files and the five files that were most recently modified.</p></li><li class="listitem"><p>Can you explain why it is so important to put the variables in between double quotes in the example from <a class="xref" href="#sect_09_04_02" title="4.2. Output redirection">Section 4.2, &#8220;Output redirection&#8221;</a>?</p></li><li class="listitem"><p>Write a script similar to the one in <a class="xref" href="#sect_09_05_01" title="5.1. The break built-in">Section 5.1, &#8220;The break built-in&#8221;</a>, but think of a way of quitting after the user has executed 3 loops.</p></li><li class="listitem"><p>Think of a better solution than <span class="command"><strong>move <code class="option">-b</code></strong></span> for the script from <a class="xref" href="#sect_09_05_03" title="5.3. Examples">Section 5.3, &#8220;Examples&#8221;</a> to prevent overwriting of existing files.  For instance, test whether or not a file exists.  Don't do unnecessary work!</p></li><li class="listitem"><p>Rewrite the <code class="filename">whichdaemon.sh</code> script from <a class="xref" href="#sect_07_02_04" title="2.4. Boolean operations">Section 2.4, &#8220;Boolean operations&#8221;</a>, so that it:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Prints a list of servers to check, such as Apache, the SSH server, the NTP daemon, a name daemon, a power management daemon, and so on.</p></li><li class="listitem"><p>For each choice the user can make, print some sensible information, like the name of the web server, NTP trace information, and so on.</p></li><li class="listitem"><p>Optionally, build in a possibility for users to check other servers than the ones listed.  For such cases, check that at least the given process is running.</p></li><li class="listitem"><p>Review the script from <a class="xref" href="#sect_09_02_02_04" title="2.2.4. Calculating an average">Section 2.2.4, &#8220;Calculating an average&#8221;</a>.  Note how character input other than <span class="keycap"><strong>q</strong></span> is processed.  Rebuild this script so that it prints a message if characters are given as input.</p></li></ul></div></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_10"></a>Chapter 10. More on variables</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_10_01">1. Types of variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_10_01_01">1.1. General assignment of values</a></span></dt><dt><span class="sect2"><a href="#sect_10_01_02">1.2. Using the declare built-in</a></span></dt><dt><span class="sect2"><a href="#sect_10_01_03">1.3. Constants</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_10_02">2. Array variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_10_02_01">2.1. Creating arrays</a></span></dt><dt><span class="sect2"><a href="#sect_10_02_02">2.2. Dereferencing the variables in an array</a></span></dt><dt><span class="sect2"><a href="#sect_10_02_03">2.3. Deleting array variables</a></span></dt><dt><span class="sect2"><a href="#sect_10_02_04">2.4. Examples of arrays</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_10_03">3. Operations on variables</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_10_03_01">3.1. Arithmetic on variables</a></span></dt><dt><span class="sect2"><a href="#sect_10_03_02">3.2. Length of a variable</a></span></dt><dt><span class="sect2"><a href="#sect_10_03_03">3.3. Transformations of variables</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_10_04">4. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_10_05">5. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this chapter, we will discuss the advanced use of variables and arguments.  Upon completion, you will be able to:</p><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Declare and use an array of variables</p></li><li class="listitem"><p>Specify the sort of variable you want to use</p></li><li class="listitem"><p>Make variables read-only</p></li><li class="listitem"><p>Use <span class="command"><strong>set</strong></span> to assign a value to a variable</p></li></ul></div><p>
</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_10_01"></a>1. Types of variables</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_01_01"></a>1.1. General assignment of values</h3></div></div></div><p>As we already saw, Bash understands many different kinds of variables or parameters.  Thus far, we haven't bothered much with what kind of variables we assigned, so our variables could hold any value that we assigned to them.  A simple command line example demonstrates this:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong><code class="varname">VARIABLE</code>=<em class="parameter"><code>12</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$VARIABLE</code></strong></span>
12

<code class="prompt">[bob in ~]</code> <span class="command"><strong><code class="varname">VARIABLE</code>=<em class="parameter"><code>string</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$VARIABLE</code></strong></span>
string
</pre><p>There are cases when you want to avoid this kind of behavior, for instance when handling telephone and other numbers.  Apart from integers and variables, you may also want to specify a variable that is a constant.  This is often done at the beginning of a script, when the value of the constant is declared.  After that, there are only references to the constant variable name, so that when the constant needs to be changed, it only has to be done once.  A variable may also be a series of variables of any type, a so-called <span class="emphasis"><em>array</em></span> of variables<a class="indexterm" name="idm6330"></a> (<code class="varname">VAR0</code><code class="varname">VAR1</code>, <code class="varname">VAR2</code>, ... <code class="varname">VARN</code>).</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_01_02"></a>1.2. Using the declare built-in</h3></div></div></div><p>Using a <span class="command"><strong>declare</strong></span> statement, we can limit the value assignment to variables.</p><p>The syntax for <span class="command"><strong>declare</strong></span> is the following:</p><div class="cmdsynopsis"><p><code class="command">declare <code class="option">OPTION(s)</code> <code class="varname">VARIABLE</code>=value</code> </p></div><p>The following options are used to determine the type of data the variable can hold and to assign it attributes:</p><div class="table"><a name="tab_10_01"></a><p class="title"><b>Table 10.1. Options to the declare built-in</b></p><div class="table-contents"><table class="table" summary="Options to the declare built-in" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Option</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="option">-a</code></td><td align="left">Variable is an array<a class="indexterm" name="idm6360"></a>.</td></tr><tr><td align="left"><code class="option">-f</code></td><td align="left">Use function names only.</td></tr><tr><td align="left"><code class="option">-i</code></td><td align="left">The variable is to be treated as an integer; arithmetic<a class="indexterm" name="idm6371"></a> evaluation is performed when the variable is assigned a value (see <a class="xref" href="#sect_03_04_05" title="4.6. Arithmetic expansion">Section 4.6, &#8220;Arithmetic expansion&#8221;</a>).</td></tr><tr><td align="left"><code class="option">-p</code></td><td align="left">Display the attributes and values of each variable.  When <code class="option">-p</code> is used, additional options are ignored.</td></tr><tr><td align="left"><code class="option">-r</code></td><td align="left">Make variables read-only.  These variables cannot then be assigned values by subsequent assignment statements, nor can they be unset.</td></tr><tr><td align="left"><code class="option">-t</code></td><td align="left">Give each variable the <span class="emphasis"><em>trace</em></span> attribute.</td></tr><tr><td align="left"><code class="option">-x</code></td><td align="left">Mark each variable for export to subsequent commands via the environment.</td></tr></tbody></table></div></div><br class="table-break"><p>Using <code class="option">+</code> instead of <code class="option">-</code> turns off the attribute instead.  When used in a function, <span class="command"><strong>declare</strong></span> creates local variables.</p><p>The following example shows how assignment of a type to a variable influences the value.</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>declare <code class="option">-i</code> <code class="varname">VARIABLE</code>=<em class="parameter"><code>12</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong><code class="varname">VARIABLE</code>=<em class="parameter"><code>string</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$VARIABLE</code></strong></span>
0

<code class="prompt">[bob in ~]</code> <span class="command"><strong>declare <code class="option">-p</code> <code class="varname">VARIABLE</code></strong></span>
declare -i VARIABLE="0"
</pre><p>Note that Bash has an option to declare a numeric value, but none for declaring string values.  This is because, by default, if no specifications are given, a variable can hold any type of data:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong><code class="varname">OTHERVAR</code>=<em class="parameter"><code>blah</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>declare <code class="option">-p</code> <code class="varname">OTHERVAR</code></strong></span>
declare -- OTHERVAR="blah"
</pre><p>As soon as you restrict assignment of values to a variable, it can only hold that type of data.  Possible restrictions are either integer, constant or array.</p><p>See the Bash info pages for information on return status.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_01_03"></a>1.3. Constants</h3></div></div></div><p>In Bash, constants are created by making a variable read-only.  The <span class="command"><strong>readonly</strong></span> built-in marks each specified variable as unchangeable.  The syntax is:</p><div class="cmdsynopsis"><p><code class="command">readonly <code class="option">OPTION</code> <code class="varname">VARIABLE(s)</code></code> </p></div><p>The values of these variables can then no longer be changed by subsequent assignment.  If the <code class="option">-f</code> option is given, each variable refers to a shell function; see <a class="xref" href="#chap_11" title="Chapter 11. Functions">Chapter 11, <i>Functions</i></a>.  If <code class="option">-a</code> is specified, each variable refers to an array of variables.  If no arguments are given, or if <code class="option">-p</code> is supplied, a list of all read-only variables is displayed.  Using the <code class="option">-p</code> option, the output can be reused as input.</p><p>The return status is zero, unless an invalid option was specified, one of the variables or functions does not exist, or <code class="option">-f</code> was supplied for a variable name instead of for a function name.</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>readonly <code class="varname">TUX</code>=<em class="parameter"><code>penguinpower</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong><code class="varname">TUX</code>=<em class="parameter"><code>Mickeysoft</code></em></strong></span>
bash: TUX: readonly variable
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_10_02"></a>2. Array variables</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_02_01"></a>2.1. Creating arrays</h3></div></div></div><p>An array is a variable containing multiple values.  Any variable may be used as an array<a class="indexterm" name="idm6457"></a>.  There is no maximum limit to the size of an array, nor any requirement that member variables be indexed or assigned contiguously.  Arrays are zero-based: the first element is indexed with the number 0.</p><p>Indirect declaration is done using the following syntax to declare a variable:</p><div class="cmdsynopsis"><p><code class="command"><code class="varname">ARRAY[INDEXNR]</code>=value</code> </p></div><p>The <span class="emphasis"><em>INDEXNR</em></span> is treated as an arithmetic expression that must evaluate to a positive number.</p><p>Explicit declaration of an array is done using the <span class="command"><strong>declare</strong></span> built-in:</p><div class="cmdsynopsis"><p><code class="command">declare <code class="option">-a</code> <code class="varname">ARRAYNAME</code></code> </p></div><p>A declaration with an index number will also be accepted, but the index number will be ignored.  Attributes<a class="indexterm" name="idm6473"></a> to the array may be specified using the <span class="command"><strong>declare</strong></span> and <span class="command"><strong>readonly</strong></span> built-ins.  Attributes apply to all variables in the array; you can't have mixed arrays.</p><p>Array variables may also be created using compound assignments in this format:</p><div class="cmdsynopsis"><p><code class="command"><code class="varname">ARRAY</code>=(value1 value2 ... valueN)</code> </p></div><p>Each value is then in the form of <span class="emphasis"><em>[indexnumber=]string</em></span>.  The index number is optional.  If it is supplied, that index is assigned to it; otherwise the index of the element assigned is the number of the last index that was assigned, plus one.  This format is accepted by <span class="command"><strong>declare</strong></span> as well.  If no index numbers are supplied, indexing starts at zero.</p><p>Adding missing or extra members in an array<a class="indexterm" name="idm6486"></a> is done using the syntax:</p><div class="cmdsynopsis"><p><code class="command"><code class="varname">ARRAYNAME[indexnumber]</code>=value</code> </p></div><p>Remember that the <span class="command"><strong>read</strong></span> built-in provides the <code class="option">-a</code> option, which allows for reading and assigning values for member variables of an array.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_02_02"></a>2.2. Dereferencing the variables in an array</h3></div></div></div><p>In order to refer to the content of an item in an array<a class="indexterm" name="idm6498"></a>, use curly braces.  This is necessary, as you can see from the following example, to bypass the shell interpretation of expansion operators.  If the index number is <span class="emphasis"><em>@</em></span> or <span class="emphasis"><em>*</em></span>, all members of an array are referenced.</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong><code class="varname">ARRAY</code>=<em class="parameter"><code>(one two three)</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]}</code></strong></span>
one two three

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$ARRAY[*]</code></strong></span>
one[*]

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[2]}</code></strong></span>
three

<code class="prompt">[bob in ~]</code> <span class="command"><strong><code class="varname">ARRAY[3]</code>=<em class="parameter"><code>four</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]}</code></strong></span>
one two three four
</pre><p>Referring to the content of a member variable of an array without providing an index number is the same as referring to the content of the first element, the one referenced with index number zero.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_02_03"></a>2.3. Deleting array variables</h3></div></div></div><p>The <span class="command"><strong>unset</strong></span> built-in is used to destroy arrays<a class="indexterm" name="idm6529"></a> or member variables of an array:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>unset <code class="varname">ARRAY[1]</code></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]}</code></strong></span>
one three four

<code class="prompt">[bob in ~]</code> <span class="command"><strong>unset <code class="varname">ARRAY</code></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]}</code></strong></span>
&lt;--no output--&gt;
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_02_04"></a>2.4. Examples of arrays</h3></div></div></div><p>Practical examples of the usage of arrays<a class="indexterm" name="idm6548"></a> are hard to find.  You will find plenty of scripts that don't really do anything on your system but that do use arrays to calculate mathematical series, for instance.  And that would be one of the more interesting examples...most scripts just show what you can do with an array in an oversimplified and theoretical way.</p><p>The reason for this dullness is that arrays are rather complex structures.  You will find that most practical examples for which arrays could be used are already implemented on your system using arrays, however on a lower level, in the C programming language in which most UNIX commands are written.  A good example is the Bash <span class="command"><strong>history</strong></span> built-in command.  Those readers who are interested might check the <code class="filename">built-ins</code> directory in the Bash source tree and take a look at <code class="filename">fc.def</code>, which is processed when compiling the built-ins.</p><p>Another reason good examples are hard to find is that not all shells support arrays, so they break compatibility.</p><p>After long days of searching, I finally found this example operating at an Internet provider.  It distributes Apache web server configuration files onto hosts in a web farm:</p><pre class="screen">
#!/bin/bash

if [ $(whoami) != 'root' ]; then
        echo "Must be root to run $0"
        exit 1;
fi
if [ -z $1 ]; then
        echo "Usage: $0 &lt;/path/to/httpd.conf&gt;"
        exit 1
fi

httpd_conf_new=$1
httpd_conf_path="/usr/local/apache/conf"
login=htuser

farm_hosts=(web03 web04 web05 web06 web07)

for i in ${farm_hosts[@]}; do
        su $login -c "scp $httpd_conf_new ${i}:${httpd_conf_path}"
        su $login -c "ssh $i sudo /usr/local/apache/bin/apachectl graceful"

done
exit 0
</pre><p>First two tests are performed to check whether the correct user is running the script with the correct arguments<a class="indexterm" name="idm6559"></a>.  The names of the hosts that need to be configured are listed in the array <code class="varname">farm_hosts</code>.  Then all these hosts are provided with the Apache configuration file, after which the daemon is restarted.  Note the use of commands from the Secure Shell suite, encrypting the connections to remote hosts.</p><p>Thanks, Eugene and colleague, for this contribution.</p><p>Dan Richter contributed the following example.  This is the problem he was confronted with:</p><p><span class="quote">&#8220;<span class="quote">...In my company, we have demos on our web site, and every week someone has to test all of them.  So I have a cron job that fills an array with the possible candidates, uses <span class="command"><strong>date <code class="option">+%W</code></strong></span> to find the week of the year, and does a modulo operation to find the correct index. The lucky person gets notified by e-mail.</span>&#8221;</span></p><p>And this was his way of solving it:</p><pre class="screen">
#!/bin/bash
# This is get-tester-address.sh 
#
# First, we test whether bash supports arrays.
# (Support for arrays was only added recently.)
#
whotest[0]='test' || (echo 'Failure: arrays not supported in this version of
bash.' &amp;&amp; exit 2)
                                                                                
#
# Our list of candidates. (Feel free to add or
# remove candidates.)
#
wholist=(
     'Bob Smith &lt;bob@example.com&gt;'
     'Jane L. Williams &lt;jane@example.com&gt;'
     'Eric S. Raymond &lt;esr@example.com&gt;'
     'Larry Wall &lt;wall@example.com&gt;'
     'Linus Torvalds &lt;linus@example.com&gt;'
   )
#
# Count the number of possible testers.
# (Loop until we find an empty string.)
#
count=0
while [ "x${wholist[count]}" != "x" ]
do
   count=$(( $count + 1 ))
done
                                                                                
#
# Now we calculate whose turn it is.
#
week=`date '+%W'`    	# The week of the year (0..53).
week=${week#0}       	# Remove possible leading zero.
                                                                                
let "index = $week % $count"   # week modulo count = the lucky person

email=${wholist[index]}     # Get the lucky person's e-mail address.
                                                                                
echo $email     	# Output the person's e-mail address.
</pre><p>This script is then used in other scripts, such as this one, which uses a <span class="emphasis"><em>here</em></span> document:</p><pre class="screen">
email=`get-tester-address.sh`   # Find who to e-mail.
hostname=`hostname`    		# This machine's name.
                                                                                
#
# Send e-mail to the right person.
#
mail $email -s '[Demo Testing]' &lt;&lt;EOF
The lucky tester this week is: $email
                                                                                
Reminder: the list of demos is here:
    http://web.example.com:8080/DemoSites
                                                                                
(This e-mail was generated by $0 on ${hostname}.)
EOF
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_10_03"></a>3. Operations on variables</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_03_01"></a>3.1. Arithmetic on variables</h3></div></div></div><p>We discussed this already in <a class="xref" href="#sect_03_04_05" title="4.6. Arithmetic expansion">Section 4.6, &#8220;Arithmetic expansion&#8221;</a>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_03_02"></a>3.2. Length of a variable</h3></div></div></div><p>Using the <span class="command"><strong>${#<code class="varname">VAR</code>}</strong></span> syntax will calculate the number of characters in a variable.  If <code class="varname">VAR</code> is <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">@</span>&#8221;</span>, this value is substituted with the number of positional parameters or number of elements in an array<a class="indexterm" name="idm6588"></a> in general.  This is demonstrated in the example below:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$SHELL</code></strong></span>
/bin/bash

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${#SHELL}</code></strong></span>
9

<code class="prompt">[bob in ~]</code> <span class="command"><strong><code class="varname">ARRAY</code>=<em class="parameter"><code>(one two three)</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${#ARRAY}</code></strong></span>
3
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_03_03"></a>3.3. Transformations of variables</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_03_03_01"></a>3.3.1. Substitution</h4></div></div></div><div class="cmdsynopsis"><p><code class="command">${<code class="varname">VAR</code>:-<em class="parameter"><code>WORD</code></em>}</code> </p></div><p>If <code class="varname">VAR</code> is not defined or null, the expansion of <em class="parameter"><code>WORD</code></em> is substituted; otherwise the value of <code class="varname">VAR</code> is substituted:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${TEST:-test}</code></strong></span>
test

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$TEST</code></strong></span>
 

<code class="prompt">[bob in ~]</code> <span class="command"><strong>export <code class="varname">TEST</code>=<em class="parameter"><code>a_string</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${TEST:-test}</code></strong></span>
a_string

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${TEST2:-$TEST}</code></strong></span>
a_string
</pre><p>This form is often used in conditional tests, for instance in this one:</p><pre class="screen">
<span class="command"><strong><em class="parameter"><code>[ -z "${COLUMNS:-}" ]</code></em> &amp;&amp; <code class="varname">COLUMNS</code>=<em class="parameter"><code>80</code></em></strong></span>
</pre><p>It is a shorter notation for</p><pre class="screen">
<span class="command"><strong>if <em class="parameter"><code>[ -z "${COLUMNS:-}" ]</code></em>; then
	<code class="varname">COLUMNS</code>=<em class="parameter"><code>80</code></em>
fi</strong></span>
</pre><p>See <a class="xref" href="#sect_07_01_02_03" title="1.2.3. String comparisons">Section 1.2.3, &#8220;String comparisons&#8221;</a> for more information about this type of condition testing.</p><p>If the hyphen (-) is replaced with the equal sign (=), the value is assigned to the parameter if it does not exist:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$TEST2</code></strong></span>


<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${TEST2:=$TEST}</code></strong></span>
a_string

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$TEST2</code></strong></span>
a_string
</pre><p>The following syntax tests the existence of a variable.  If it is not set, the expansion of <em class="parameter"><code>WORD</code></em> is printed to standard out and non-interactive shells quit.  A demonstration:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>cat <code class="filename">vartest.sh</code></strong></span>
#!/bin/bash
 
# This script tests whether a variable is set.  If not,
# it exits printing a message.
 
echo ${TESTVAR:?"There's so much I still wanted to do..."}
echo "TESTVAR is set, we can proceed."

<code class="prompt">[bob in testdir]</code> <span class="command"><strong>./vartest.sh</strong></span>
./vartest.sh: line 6: TESTVAR: There's so much I still wanted to do...

<code class="prompt">[bob in testdir]</code> <span class="command"><strong>export <code class="varname">TESTVAR</code>=<em class="parameter"><code>present</code></em></strong></span>

<code class="prompt">[bob in testdir]</code> <span class="command"><strong>./vartest.sh</strong></span>
present
TESTVAR is set, we can proceed.
</pre><p>Using <span class="quote">&#8220;<span class="quote">+</span>&#8221;</span> instead of the exclamation mark sets the variable to the expansion of <em class="parameter"><code>WORD</code></em>; if it does not exist, nothing happens.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_03_03_02"></a>3.3.2. Removing substrings</h4></div></div></div><p>To strip a number of characters, equal to <em class="parameter"><code>OFFSET</code></em>, from a variable, use this syntax:</p><div class="cmdsynopsis"><p><code class="command">${<code class="varname">VAR</code>:<em class="parameter"><code>OFFSET</code></em>:<em class="parameter"><code>LENGTH</code></em>}</code> </p></div><p>The <em class="parameter"><code>LENGTH</code></em> parameter defines how many characters to keep, starting from the first character after the offset point.  If <em class="parameter"><code>LENGTH</code></em> is omitted, the remainder of the variable content is taken:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>export <code class="varname">STRING</code>=<em class="parameter"><code>"thisisaverylongname"</code></em></strong></span>

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${STRING:4}</code></strong></span>
isaverylongname

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${STRING:6:5}</code></strong></span>
avery
</pre><div class="cmdsynopsis"><p><code class="command">${<code class="varname">VAR</code>#<em class="parameter"><code>WORD</code></em>}</code> </p></div><p>and</p><div class="cmdsynopsis"><p><code class="command">${<code class="varname">VAR</code>##<em class="parameter"><code>WORD</code></em>}</code> </p></div><p>These constructs are used for deleting the pattern matching the expansion of <em class="parameter"><code>WORD</code></em> in <code class="varname">VAR</code>.  <em class="parameter"><code>WORD</code></em> is expanded to produce a pattern just as in file name expansion.  If the pattern matches the beginning of the expanded value of <code class="varname">VAR</code>, then the result of the expansion is the expanded value of <code class="varname">VAR</code> with the shortest matching pattern (<span class="quote">&#8220;<span class="quote">#</span>&#8221;</span>) or the longest matching pattern (indicated with <span class="quote">&#8220;<span class="quote">##</span>&#8221;</span>).</p><p>If <code class="varname">VAR</code> is <code class="varname">*</code> or <code class="varname">@</code>, the pattern removal operation is applied to each positional parameter in turn, and the expansion is the resultant list.</p><p>If <code class="varname">VAR</code> is an array variable subscribed with <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span> or <span class="quote">&#8220;<span class="quote">@</span>&#8221;</span>, the pattern removal operation is applied to each member of the array<a class="indexterm" name="idm6724"></a> in turn, and the expansion is the resultant list.  This is shown in the examples below:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]}</code></strong></span>
one two one three one four

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]#one}</code></strong></span>
two three four

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]#t}</code></strong></span>
one wo one hree one four

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]#t*}</code></strong></span>
one wo one hree one four

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${ARRAY[*]##t*}</code></strong></span>
one one one four
</pre><p>The opposite effect is obtained using <span class="quote">&#8220;<span class="quote">%</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">%%</span>&#8221;</span>, as in this example below.  <em class="parameter"><code>WORD</code></em> should match a trailing portion of string:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">$STRING</code></strong></span>
thisisaverylongname

<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${STRING%name}</code></strong></span>
thisisaverylong
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_03_03_03"></a>3.3.3. Replacing parts of variable names</h4></div></div></div><p>This is done using the</p><div class="cmdsynopsis"><p><code class="command">${<code class="varname">VAR</code>/<em class="parameter"><code>PATTERN</code></em>/<em class="parameter"><code>STRING</code></em>}</code> </p></div><p>or</p><div class="cmdsynopsis"><p><code class="command">${<code class="varname">VAR</code>//<em class="parameter"><code>PATTERN</code></em>/<em class="parameter"><code>STRING</code></em>}</code> </p></div><p>syntax.  The first form replaces only the first match, the second replaces all matches of <em class="parameter"><code>PATTERN</code></em> with <em class="parameter"><code>STRING</code></em>:</p><pre class="screen">
<code class="prompt">[bob in ~]</code> <span class="command"><strong>echo <code class="varname">${STRING/name/string}</code></strong></span>
thisisaverylongstring
</pre><p>More information can be found in the Bash info pages.</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_10_04"></a>4. Summary</h2></div></div></div><p>Normally, a variable can hold any type of data, unless variables are declared explicitly.  Constant variables are set using the <span class="command"><strong>readonly</strong></span> built-in command.</p><p>An array holds a set of variables.  If a type of data is declared, then all elements in the array will be set to hold only this type of data.</p><p>Bash features allow for substitution and transformation of variables <span class="quote">&#8220;<span class="quote">on the fly</span>&#8221;</span>.  Standard operations include calculating the length of a variable, arithmetic on variables, substituting variable content and substituting part of the content.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_10_05"></a>5. Exercises</h2></div></div></div><p>Here are some brain crackers:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Write a script that does the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Display the name of the script being executed.</p></li><li class="listitem"><p>Display the first, third and tenth argument given to the script.</p></li><li class="listitem"><p>Display the total number of arguments passed to the script.</p></li><li class="listitem"><p>If there were more than three positional parameters, use <span class="command"><strong>shift</strong></span> to move all the values 3 places to the left.</p></li><li class="listitem"><p>Print all the values of the remaining arguments.</p></li><li class="listitem"><p>Print the number of arguments.</p></li></ul></div><p>Test with zero, one, three and over ten arguments.</p></li><li class="listitem"><p>Write a script that implements a simple web browser (in text mode), using <span class="command"><strong>wget</strong></span> and <span class="command"><strong>links <code class="option">-dump</code></strong></span> to display HTML pages to the user.  The user has 3 choices: enter a URL, enter <span class="keycap"><strong>b</strong></span> for back and <span class="keycap"><strong>q</strong></span> to quit.  The last 10 URLs entered by the user are stored in an array, from which the user can restore the URL by using the <span class="emphasis"><em>back</em></span> functionality.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_11"></a>Chapter 11. Functions</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_11_01">1. Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_11_01_01">1.1. What are functions?</a></span></dt><dt><span class="sect2"><a href="#sect_11_01_02">1.2. Function syntax</a></span></dt><dt><span class="sect2"><a href="#sect_11_01_03">1.3. Positional parameters in functions</a></span></dt><dt><span class="sect2"><a href="#sect_11_01_04">1.4. Displaying functions</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_11_02">2. Examples of functions in scripts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_11_02_01">2.1. Recycling</a></span></dt><dt><span class="sect2"><a href="#sect_11_02_02">2.2. Setting the path</a></span></dt><dt><span class="sect2"><a href="#sect_11_02_03">2.3. Remote backups</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_11_03">3. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_11_04">4. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this chapter, we will discuss</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>What functions are</p></li><li class="listitem"><p>Creation and displaying of functions from the command line</p></li><li class="listitem"><p>Functions in scripts</p></li><li class="listitem"><p>Passing arguments to functions</p></li><li class="listitem"><p>When to use functions</p></li></ul></div><p>
</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_11_01"></a>1. Introduction</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_11_01_01"></a>1.1. What are functions?</h3></div></div></div><p>Shell functions are a way to group commands for later execution, using a single name for this group, or <span class="emphasis"><em>routine</em></span>.  The name of the routine must be unique within the shell or script.  All the commands that make up a function are executed like regular commands.  When calling on a function as a simple command name, the list of commands associated with that function name is executed.  A function is executed within the shell in which it has been declared: no new process is created to interpret the commands.</p><p>Special built-in commands are found before shell functions during command lookup.  The special built-ins are: <span class="command"><strong>break</strong></span>, <span class="command"><strong>:</strong></span>, <span class="command"><strong>.</strong></span>, <span class="command"><strong>continue</strong></span>, <span class="command"><strong>eval</strong></span>, <span class="command"><strong>exec</strong></span>, <span class="command"><strong>exit</strong></span>, <span class="command"><strong>export</strong></span>, <span class="command"><strong>readonly</strong></span>, <span class="command"><strong>return</strong></span>, <span class="command"><strong>set</strong></span>, <span class="command"><strong>shift</strong></span>, <span class="command"><strong>trap</strong></span> and <span class="command"><strong>unset</strong></span>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_11_01_02"></a>1.2. Function syntax</h3></div></div></div><p>Functions either use the syntax</p><div class="cmdsynopsis"><p><code class="command">function FUNCTION { COMMANDS; }</code> </p></div><p>or</p><div class="cmdsynopsis"><p><code class="command">FUNCTION () { COMMANDS; }</code> </p></div><p>Both define a shell function <span class="command"><strong>FUNCTION</strong></span>.  The use of the built-in command <span class="command"><strong>function</strong></span> is optional; however, if it is not used, parentheses are needed.</p><p>The commands listed between curly braces make up the body of the function.  These commands are executed whenever <span class="command"><strong>FUNCTION</strong></span> is specified as the name of a command.  The exit status is the exit status of the last command executed in the body.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Common mistakes</h3><p>The curly braces must be separated from the body by spaces, otherwise they are interpreted in the wrong way.</p><p>The body of a function should end in a semicolon or a newline.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_11_01_03"></a>1.3. Positional parameters in functions</h3></div></div></div><p>Functions are like mini-scripts: they can accept parameters, they can use variables only known within the function (using the <span class="command"><strong>local</strong></span> shell built-in) and they can return values to the calling shell.</p><p>A function also has a system for interpreting positional parameters.  However, the positional parameters passed to a function are not the same as the ones passed to a command or script.</p><p>When a function is executed, the arguments<a class="indexterm" name="idm6872"></a> to the function<a class="indexterm" name="idm6875"></a> become the positional parameters during its execution.  The special parameter <code class="varname">#</code> that expands to the number of positional parameters is updated to reflect the change. Positional parameter <code class="varname">0</code> is unchanged.  The Bash variable <code class="varname">FUNCNAME</code> is set to the name of the function, while it is executing.</p><p>If the <span class="command"><strong>return</strong></span> built-in is executed in a function, the function completes and execution resumes with the next command after the function call.  When a function completes, the values of the positional parameters and the special parameter <code class="varname">#</code> are restored to the values they had prior to the function's execution.  If a numeric argument is given to <span class="command"><strong>return</strong></span>, that status is returned.  A simple<a class="indexterm" name="idm6885"></a> example<a class="indexterm" name="idm6888"></a>:</p><pre class="screen">
<code class="prompt">[lydia@cointreau ~/test]</code> <span class="command"><strong>cat <code class="filename">showparams.sh</code></strong></span>
#!/bin/bash
                                                                                
echo "This script demonstrates function arguments."
echo
                                                                                
echo "Positional parameter 1 for the script is $1."
echo
                                                                                
test ()
{
echo "Positional parameter 1 in the function is $1."
RETURN_VALUE=$?
echo "The exit code of this function is $RETURN_VALUE."
}
                                                                                
test other_param

<code class="prompt">[lydia@cointreau ~/test]</code> <span class="command"><strong>./showparams.sh <em class="parameter"><code>parameter1</code></em></strong></span>
This script demonstrates function arguments.
 
Positional parameter 1 for the script is parameter1.
 
Positional parameter 1 in the function is other_param.
The exit code of this function is 0.

<code class="prompt">[lydia@cointreau ~/test]</code>
</pre><p>Note that the return value or exit code of the function is often storen in a variable, so that it can be probed at a later point.  The init scripts on your system often use the technique of probing the <code class="varname">RETVAL</code> variable in a conditional test, like this one:</p><pre class="screen">
<span class="command"><strong>if <em class="parameter"><code>[ $RETVAL -eq 0 ]</code></em>; then
	&lt;start the daemon&gt;</strong></span>
</pre><p>Or like this example from the <code class="filename">/etc/init.d/amd</code> script, where Bash's optimization features are used:</p><pre class="screen">
<span class="command"><strong><em class="parameter"><code>[ $RETVAL = 0 ]</code></em> &amp;&amp; touch <code class="filename">/var/lock/subsys/amd</code></strong></span>
</pre><p>The commands after <span class="command"><strong>&amp;&amp;</strong></span> are only executed when the test proves to be true; this is a shorter way to represent an <span class="command"><strong>if/then/fi</strong></span> structure.</p><p>The return code of the function is often used as exit code of the entire script.  You'll see a lot of initscripts ending in something like <span class="command"><strong>exit <code class="varname">$RETVAL</code></strong></span>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_11_01_04"></a>1.4. Displaying functions</h3></div></div></div><p>All functions known by the current shell can be displayed using the <span class="command"><strong>set</strong></span> built-in without options.  Functions are retained after they are used, unless they are <span class="command"><strong>unset</strong></span> after use.  The <span class="command"><strong>which</strong></span> command also displays functions:</p><pre class="screen">
<code class="prompt">[lydia@cointreau ~]</code> <span class="command"><strong>which <code class="filename">zless</code></strong></span>
zless is a function
zless ()
{
    zcat "$@" | "$PAGER"
}

<code class="prompt">[lydia@cointreau ~]</code> <span class="command"><strong>echo <code class="varname">$PAGER</code></strong></span>
less
</pre><p>This is the sort of function that is typically configured in the user's shell resource configuration files.  Functions are more flexible than aliases and provide a simple and easy way of adapting the user environment.</p><p>Here's one for DOS users:</p><pre class="screen">
dir ()
{
    ls -F --color=auto -lF --color=always "$@" | less -r
}
</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_11_02"></a>2. Examples of functions in scripts</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_11_02_01"></a>2.1. Recycling</h3></div></div></div><p>There are plenty of scripts on your system that use functions as a structured way of handling series of commands.  On some Linux systems, for instance, you will find the <code class="filename">/etc/rc.d/init.d/functions</code> definition file, which is sourced in all init scripts.  Using this method, common tasks such as checking if a process runs, starting or stopping a daemon and so on, only have to be written once, in a general way.  If the same task is needed again, the code is recycled.</p><p>You could make your own <code class="filename">/etc/functions</code> file that contains all functions that you use regularly on your system, in different scripts.  Just put the line </p><div class="cmdsynopsis"><p><code class="command">. <code class="filename">/etc/functions</code></code> </p></div><p>somewhere at the start of the script and you can recycle functions.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_11_02_02"></a>2.2. Setting the path</h3></div></div></div><p>This section might be found in your <code class="filename">/etc/profile</code> file.  The function <span class="command"><strong>pathmunge</strong></span> is defined and then used to set the path for the <span class="emphasis"><em>root</em></span> and other users:</p><pre class="screen">
pathmunge () {
        if ! echo $PATH | /bin/egrep -q "(^|:)$1($|:)" ; then
           if [ "$2" = "after" ] ; then
              PATH=$PATH:$1
           else
              PATH=$1:$PATH
           fi
        fi
}

# Path manipulation
if [ `id -u` = 0 ]; then
        pathmunge /sbin
        pathmunge /usr/sbin
        pathmunge /usr/local/sbin
fi

pathmunge /usr/X11R6/bin after

unset pathmunge
</pre><p>The function takes its first argument to be a path name.  If this path name is not yet in the current path, it is added.  The second argument to the function defines if the path will be added in front or after the current <code class="varname">PATH</code> definition.</p><p>Normal users only get <code class="filename">/usr/X11R6/bin</code> added to their paths, while <span class="emphasis"><em>root</em></span> gets a couple of extra directories containing system commands.  After being used, the function is unset so that it is not retained.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_11_02_03"></a>2.3. Remote backups</h3></div></div></div><p>The following example is one that I use for making backups of the files for my books.  It uses SSH keys for enabling the remote connection.  Two functions are defined, <span class="command"><strong>buplinux</strong></span> and <span class="command"><strong>bupbash</strong></span>, that each make a <code class="filename">.tar</code> file, which is then compressed and sent to a remote server.  After that, the local copy is cleaned up.</p><p>On Sunday, only <span class="command"><strong>bupbash</strong></span> is executed.</p><pre class="screen">
#/bin/bash

LOGFILE="/nethome/tille/log/backupscript.log"
echo "Starting backups for `date`" &gt;&gt; "$LOGFILE"

buplinux()
{
DIR="/nethome/tille/xml/db/linux-basics/"
TAR="Linux.tar"
BZIP="$TAR.bz2"
SERVER="rincewind"
RDIR="/var/www/intra/tille/html/training/"

cd "$DIR"
tar cf "$TAR" src/*.xml src/images/*.png src/images/*.eps
echo "Compressing $TAR..." &gt;&gt; "$LOGFILE"
bzip2 "$TAR"
echo "...done." &gt;&gt; "$LOGFILE"
echo "Copying to $SERVER..." &gt;&gt; "$LOGFILE"
scp "$BZIP" "$SERVER:$RDIR" &gt; /dev/null 2&gt;&amp;1
echo "...done." &gt;&gt; "$LOGFILE"
echo -e "Done backing up Linux course:\nSource files, PNG and EPS images.\nRubbish removed." &gt;&gt; "$LOGFILE"
rm "$BZIP"
}

bupbash()
{
DIR="/nethome/tille/xml/db/"
TAR="Bash.tar"
BZIP="$TAR.bz2"
FILES="bash-programming/"
SERVER="rincewind"
RDIR="/var/www/intra/tille/html/training/"

cd "$DIR"
tar cf "$TAR" "$FILES"
echo "Compressing $TAR..." &gt;&gt; "$LOGFILE"
bzip2 "$TAR"
echo "...done." &gt;&gt; "$LOGFILE"
echo "Copying to $SERVER..." &gt;&gt; "$LOGFILE"
scp "$BZIP" "$SERVER:$RDIR" &gt; /dev/null 2&gt;&amp;1
echo "...done." &gt;&gt; "$LOGFILE"

echo -e "Done backing up Bash course:\n$FILES\nRubbish removed." &gt;&gt; "$LOGFILE"
rm "$BZIP"
}

DAY=`date +%w`

if [ "$DAY" -lt "2" ]; then
  echo "It is `date +%A`, only backing up Bash course." &gt;&gt; "$LOGFILE"
  bupbash
else
  buplinux
  bupbash
fi


echo -e "Remote backup `date` SUCCESS\n----------" &gt;&gt; "$LOGFILE"
</pre><p>This script runs from cron, meaning without user interaction, so we redirect standard error from the <span class="command"><strong>scp</strong></span> command to <code class="filename">/dev/null</code>.</p><p>It might be argued that all the separate steps can be combined in a command such as</p><div class="cmdsynopsis"><p><code class="command">tar <code class="option">c</code> <code class="filename">dir_to_backup/</code> | bzip2 | ssh <code class="option">server</code> "cat &gt; <code class="filename">backup.tar.bz2</code>"</code> </p></div><p>However, if you are interested in intermediate results, which might be recovered upon failure of the script, this is not what you want.</p><p>The expression</p><div class="cmdsynopsis"><p><code class="command">command &amp;&gt; <code class="filename">file</code></code> </p></div><p>is equivalent to</p><div class="cmdsynopsis"><p><code class="command">command &gt; <code class="filename">file</code> 2&gt;&amp;1</code> </p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_11_03"></a>3. Summary</h2></div></div></div><p>Functions provide an easy way of grouping commands that you need to execute repetitively.  When a function is running, the positional parameters are changed to those of the function.  When it stops, they are reset to those of the calling program.  Functions are like mini-scripts, and just like a script, they generate exit or return codes.</p><p>While this was a short chapter, it contains important knowledge needed for achieving the ultimate state of laziness that is the typical goal of any system administrator.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_11_04"></a>4. Exercises</h2></div></div></div><p>Here are some useful things you can do using functions:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Add a function to your <code class="filename">~/.bashrc</code> config file that automates the printing of man pages.  The result should be that you type something like <span class="command"><strong>printman &lt;command&gt;</strong></span>, upon which the first appropriate man page rolls out of your printer.  Check using a pseudo printer device for testing purposes.</p><p>As an extra, build in a possibility for the user to supply the section number of the man page he or she wants to print.</p></li><li class="listitem"><p>Create a subdirectory in your home directory in which you can store function definitions.  Put a couple of functions in that directory.  Useful functions might be, amongs others, that you have the same commands as on DOS or a commercial UNIX when working with Linux, or vice versa.  These functions should then be imported in your shell environment when <code class="filename">~/.bashrc</code> is read.</p></li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap_12"></a>Chapter 12. Catching signals</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#sect_12_01">1. Signals</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_12_01_01">1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#sect_12_01_02">1.2. Usage of signals with kill</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_12_02">2. Traps</a></span></dt><dd><dl><dt><span class="sect2"><a href="#sect_12_02_01">2.1. General</a></span></dt><dt><span class="sect2"><a href="#sect_12_02_02">2.2. How Bash interprets traps</a></span></dt><dt><span class="sect2"><a href="#sect_12_02_03">2.3. More examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sect_12_03">3. Summary</a></span></dt><dt><span class="sect1"><a href="#sect_12_04">4. Exercises</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>In this chapter, we will discuss the following subjects:</p><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Available signals</p></li><li class="listitem"><p>Use of the signals</p></li><li class="listitem"><p>Use of the <span class="command"><strong>trap</strong></span> statement</p></li><li class="listitem"><p>How to prevent users from interrupting your programs</p></li></ul></div><p>
</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_12_01"></a>1. Signals</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_12_01_01"></a>1.1. Introduction</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_12_01_01_01"></a>1.1.1. Finding the signal man page</h4></div></div></div><p>Your system contains a man page listing all the available signals, but depending on your operating system, it might be opened in a different way.  On most Linux systems, this will be <span class="command"><strong>man <code class="option">7</code> signal</strong></span>.  When in doubt, locate the exact man page and section using commands like</p><div class="cmdsynopsis"><p><code class="command">man <code class="option">-k</code> signal | grep <code class="option">list</code></code> </p></div><p>or</p><div class="cmdsynopsis"><p><code class="command">apropos signal | grep <code class="option">list</code></code> </p></div><p>Signal names can be found using <span class="command"><strong>kill -l</strong></span>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_12_01_01_02"></a>1.1.2. Signals to your Bash shell</h4></div></div></div><p>In the absence of any traps, an interactive Bash shell ignores <span class="emphasis"><em>SIGTERM</em></span> and <span class="emphasis"><em>SIGQUIT</em></span>.  <span class="emphasis"><em>SIGINT</em></span> is caught and handled, and if job control is active, <span class="emphasis"><em>SIGTTIN</em></span>, <span class="emphasis"><em>SIGTTOU</em></span> and <span class="emphasis"><em>SIGTSTP</em></span> are also ignored.  Commands that are run as the result of a command substitution also ignore these signals, when keyboard generated.</p><p><span class="emphasis"><em>SIGHUP</em></span> by default exits a shell.  An interactive shell will send a <span class="emphasis"><em>SIGHUP</em></span> to all jobs, running or stopped; see the documentation on the <span class="command"><strong>disown</strong></span> built-in if you want to disable this default behavior for a particular process.  Use the <code class="option">huponexit</code> option for killing all jobs upon receiving a <span class="emphasis"><em>SIGHUP</em></span> signal, using the <span class="command"><strong>shopt</strong></span> built-in.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_12_01_01_03"></a>1.1.3. Sending signals using the shell</h4></div></div></div><p>The following signals can be sent using the Bash shell:</p><div class="table"><a name="tab_12_01"></a><p class="title"><b>Table 12.1. Control signals in Bash</b></p><div class="table-contents"><table class="table" summary="Control signals in Bash" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Standard key combination</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span></td><td align="left">The interrupt signal, sends SIGINT to the job running in the foreground.</td></tr><tr><td align="left"><span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Y</strong></span></td><td align="left">The <span class="emphasis"><em>delayed suspend</em></span> character.  Causes a running process to be stopped when it attempts to read input from the terminal.  Control is returned to the shell, the user can foreground, background or kill the process.  Delayed suspend is only available on operating systems supporting this feature.</td></tr><tr><td align="left"><span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Z</strong></span></td><td align="left">The <span class="emphasis"><em>suspend</em></span> signal, sends a <span class="emphasis"><em>SIGTSTP</em></span> to a running program, thus stopping it and returning control to the shell.</td></tr></tbody></table></div></div><br class="table-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Terminal settings</h3><p>Check your <span class="command"><strong>stty</strong></span> settings.  Suspend and resume of output is usually disabled if you are using <span class="quote">&#8220;<span class="quote">modern</span>&#8221;</span> terminal emulations.  The standard <span class="command"><strong>xterm</strong></span> supports <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>S</strong></span> and <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Q</strong></span> by default.</p></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_12_01_02"></a>1.2. Usage of signals with kill</h3></div></div></div><p>Most modern shells, Bash included, have a built-in <span class="command"><strong>kill</strong></span> function.  In Bash, both signal names and numbers are accepted as options, and arguments may be job or process IDs.  An exit status can be reported using the <code class="option">-l</code> option: zero when at least one signal was successfully sent, non-zero if an error occurred.</p><p>Using the <span class="command"><strong>kill</strong></span> command from <code class="filename">/usr/bin</code>, your system might enable extra options, such as the ability to kill processes from other than your own user ID and specifying processes by name, like with <span class="command"><strong>pgrep</strong></span> and <span class="command"><strong>pkill</strong></span>.</p><p>Both <span class="command"><strong>kill</strong></span> commands send the <span class="emphasis"><em>TERM</em></span> signal if none is given.</p><p>This is a list of the most common signals:</p><div class="table"><a name="tab_12_02"></a><p class="title"><b>Table 12.2. Common kill signals</b></p><div class="table-contents"><table class="table" summary="Common kill signals" border="1"><colgroup><col><col><col></colgroup><thead><tr><th align="left">Signal name</th><th align="left">Signal value</th><th align="left">Effect</th></tr></thead><tbody><tr><td align="left">SIGHUP</td><td align="left">1</td><td align="left">Hangup</td></tr><tr><td align="left">SIGINT</td><td align="left">2</td><td align="left">Interrupt from keyboard</td></tr><tr><td align="left">SIGKILL</td><td align="left">9</td><td align="left">Kill signal</td></tr><tr><td align="left">SIGTERM</td><td align="left">15</td><td align="left">Termination signal</td></tr><tr><td align="left">SIGSTOP</td><td align="left">17,19,23</td><td align="left">Stop the process</td></tr></tbody></table></div></div><br class="table-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">SIGKILL and SIGSTOP</h3><p><span class="emphasis"><em>SIGKILL</em></span> and <span class="emphasis"><em>SIGSTOP</em></span> can not be caught, blocked or ignored.</p></div><p>When killing a process or series of processes, it is common sense to start trying with the least dangerous signal, <span class="emphasis"><em>SIGTERM</em></span>.  That way, programs that care about an orderly shutdown get the chance to follow the procedures that they have been designed to execute when getting the <span class="emphasis"><em>SIGTERM</em></span> signal, such as cleaning up and closing open files.  If you send a <span class="emphasis"><em>SIGKILL</em></span> to a process, you remove any chance for the process to do a tidy cleanup and shutdown, which might have unfortunate consequences.</p><p>But if a clean termination does not work, the <span class="emphasis"><em>INT</em></span> or<span class="emphasis"><em>KILL</em></span> signals might be the only way.  For instance, when a process does not die using <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span>, it is best to use the <span class="command"><strong>kill <code class="option">-9</code></strong></span> on that process ID:</p><pre class="screen">
<code class="prompt">maud: ~&gt;</code> <span class="command"><strong>ps <code class="option">-ef</code> | grep <em class="parameter"><code>stuck_process</code></em></strong></span>
maud    5607   2214  0 20:05 pts/5    00:00:02 stuck_process

<code class="prompt">maud: ~&gt;</code> <span class="command"><strong>kill <code class="option">-9</code> <em class="parameter"><code>5607</code></em></strong></span>

<code class="prompt">maud: ~&gt;</code> <span class="command"><strong>ps <code class="option">-ef</code> | grep <em class="parameter"><code>stuck_process</code></em></strong></span>
maud    5614    2214 0 20:15 pts/5    00:00:00 grep stuck_process
[1]+ Killed		stuck_process
</pre><p>When a process starts up several instances, <span class="command"><strong>killall</strong></span> might be easier.  It takes the same option as the <span class="command"><strong>kill</strong></span> command, but applies on all instances of a given process.  Test this command before using it in a production environment, since it might not work as expected on some of the commercial Unices.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_12_02"></a>2. Traps</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_12_02_01"></a>2.1. General</h3></div></div></div><p>There might be situations when you don't want users of your scripts to exit untimely using keyboard abort sequences, for example because input has to be provided or cleanup has to be done.  The <span class="command"><strong>trap</strong></span> statement catches these sequences and can be programmed to execute a list of commands upon catching those signals.</p><p>The syntax for the <span class="command"><strong>trap</strong></span> statement is straightforward:</p><div class="cmdsynopsis"><p><code class="command">trap [COMMANDS] [SIGNALS]</code> </p></div><p>This instructs the <span class="command"><strong>trap</strong></span> command to catch the listed <span class="emphasis"><em>SIGNALS</em></span>, which may be signal names with or without the <span class="emphasis"><em>SIG</em></span> prefix, or signal numbers.  If a signal is <span class="emphasis"><em>0</em></span> or <span class="emphasis"><em>EXIT</em></span>, the <span class="command"><strong>COMMANDS</strong></span> are executed when the shell exits.  If one of the signals is <span class="emphasis"><em>DEBUG</em></span>, the list of <span class="command"><strong>COMMANDS</strong></span> is executed after every simple command.  A signal may also be specified as <span class="emphasis"><em>ERR</em></span>; in that case <span class="command"><strong>COMMANDS</strong></span> are executed each time a simple command exits with a non-zero status.  Note that these commands will not be executed when the non-zero exit status comes from part of an <span class="command"><strong>if</strong></span> statement, or from a <span class="command"><strong>while</strong></span> or <span class="command"><strong>until</strong></span> loop.  Neither will they be executed if a logical <span class="emphasis"><em>AND</em></span> (&amp;&amp;) or <span class="emphasis"><em>OR</em></span> (||) result in a non-zero exit code, or when a command's return status is inverted using the <span class="emphasis"><em>!</em></span> operator.</p><p>The return status of the <span class="command"><strong>trap</strong></span> command itself is zero unless an invalid signal specification is encountered.  The <span class="command"><strong>trap</strong></span> command takes a couple of options, which are documented in the Bash info pages.</p><p>Here is a very simple example, catching <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span> from the user, upon which a message is printed.  When you try to kill this program without specifying the <span class="emphasis"><em>KILL</em></span> signal, nothing will happen:</p><pre class="screen">
#!/bin/bash
# traptest.sh

trap "echo Booh!" SIGINT SIGTERM
echo "pid is $$"

while :			# This is the same as "while true".
do
        sleep 60	# This script is not really doing anything.
done
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_12_02_02"></a>2.2. How Bash interprets traps</h3></div></div></div><p>When Bash receives a signal for which a trap has been set while waiting for a command to complete, the trap will not be executed until the command completes.  When Bash is waiting for an asynchronous command via the <span class="command"><strong>wait</strong></span> built-in, the reception of a signal for which a trap has been set will cause the <span class="command"><strong>wait</strong></span> built-in to return immediately with an exit status greater than 128, immediately after which the trap is executed.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_12_02_03"></a>2.3. More examples</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_12_02_03_01"></a>2.3.1. Detecting when a variable is used</h4></div></div></div><p>When debugging longer scripts, you might want to give a variable the <span class="emphasis"><em>trace</em></span> attribute and trap <span class="emphasis"><em>DEBUG</em></span> messages for that variable.  Normally you would just declare a variable using an assignment like <span class="command"><strong><code class="varname">VARIABLE</code>=value</strong></span>.  Replacing the declaration of the variable with the following lines might provide valuable information about what your script is doing:</p><pre class="screen">
declare -t VARIABLE=value

trap "echo VARIABLE is being used here." DEBUG

# rest of the script
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_12_02_03_02"></a>2.3.2. Removing rubbish upon exit</h4></div></div></div><p>The <span class="command"><strong>whatis</strong></span> command relies on a database which is regularly built using the <code class="filename">makewhatis.cron</code> script with cron:</p><pre class="screen">
#!/bin/bash

LOCKFILE=/var/lock/makewhatis.lock

# Previous makewhatis should execute successfully:

[ -f $LOCKFILE ] &amp;&amp; exit 0

# Upon exit, remove lockfile.

trap "{ rm -f $LOCKFILE ; exit 255; }" EXIT

touch $LOCKFILE
makewhatis -u -w
exit 0
</pre></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_12_03"></a>3. Summary</h2></div></div></div><p>Signals can be sent to your programs using the <span class="command"><strong>kill</strong></span> command or keyboard shortcuts.  These signals can be caught, upon which action can be performed, using the <span class="command"><strong>trap</strong></span> statement.</p><p>Some programs ignore signals.  The only signal that no program can ignore is the <span class="emphasis"><em>KILL</em></span> signal.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_12_04"></a>4. Exercises</h2></div></div></div><p>A couple of practical examples:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a script that writes a boot image to a diskette using the <span class="command"><strong>dd</strong></span> utility.  If the user tries to interrupt the script using <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span>, display a message that this action will make the diskette unusable.</p></li><li class="listitem"><p>Write a script that automates the installation of a third-party package of your choice.  The package must be downloaded from the Internet.  It must be decompressed, unarchived and compiled if these actions are appropriate.  Only the actual installation of the package should be uninterruptable.</p></li></ol></div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="app3"></a>Appendix A. Shell Features</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#idm7242">1. Common features</a></span></dt><dt><span class="sect1"><a href="#idm7368">2. Differing features</a></span></dt></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>This document gives an overview of common shell features (the same in every shell flavour) and differing shell features (shell specific features).</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm7242"></a>1. Common features</h2></div></div></div><p>
The following features are standard in every shell.  Note that the stop, suspend, jobs, bg and fg commands are only available on systems that support job control.
</p><div class="table"><a name="idm7245"></a><p class="title"><b>Table A.1. Common Shell Features</b></p><div class="table-contents"><table class="table" summary="Common Shell Features" border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Command</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left">&gt;</td><td align="left">Redirect output</td></tr><tr><td align="left">&gt;&gt;</td><td align="left">Append to file</td></tr><tr><td align="left">&lt;</td><td align="left">Redirect input</td></tr><tr><td align="left">&lt;&lt;</td><td align="left">"Here" document (redirect input)</td></tr><tr><td align="left">|</td><td align="left">Pipe output</td></tr><tr><td align="left">&amp;</td><td align="left">Run process in background.</td></tr><tr><td align="left">;</td><td align="left">Separate commands on same line</td></tr><tr><td align="left">*</td><td align="left">Match any character(s) in filename</td></tr><tr><td align="left">?</td><td align="left">Match single character in filename</td></tr><tr><td align="left">[ ]</td><td align="left">Match any characters enclosed</td></tr><tr><td align="left">( )</td><td align="left">Execute in subshell</td></tr><tr><td align="left">` `</td><td align="left">Substitute output of enclosed command</td></tr><tr><td align="left">" "</td><td align="left">Partial quote (allows variable and command expansion)</td></tr><tr><td align="left">' '</td><td align="left">Full quote (no expansion)</td></tr><tr><td align="left">\</td><td align="left">Quote following character</td></tr><tr><td align="left">$var</td><td align="left">Use value for variable</td></tr><tr><td align="left">$$</td><td align="left">Process id</td></tr><tr><td align="left">$0</td><td align="left">Command name</td></tr><tr><td align="left">$n</td><td align="left">nth argument (n from 0 to 9)</td></tr><tr><td align="left"><code class="literal">#</code></td><td align="left">Begin comment</td></tr><tr><td align="left">bg</td><td align="left">Background execution</td></tr><tr><td align="left">break</td><td align="left">Break from loop statements</td></tr><tr><td align="left">cd</td><td align="left">Change directories</td></tr><tr><td align="left">continue</td><td align="left">Resume a program loop</td></tr><tr><td align="left">echo</td><td align="left">Display output</td></tr><tr><td align="left">eval</td><td align="left">Evaluate arguments</td></tr><tr><td align="left">exec</td><td align="left">Execute a new shell</td></tr><tr><td align="left">fg</td><td align="left">Foreground execution</td></tr><tr><td align="left">jobs</td><td align="left">Show active jobs</td></tr><tr><td align="left">kill</td><td align="left">Terminate running jobs</td></tr><tr><td align="left">newgrp</td><td align="left">Change to a new group</td></tr><tr><td align="left">shift</td><td align="left">Shift positional parameters</td></tr><tr><td align="left">stop</td><td align="left">Suspend a background job</td></tr><tr><td align="left">suspend</td><td align="left">Suspend a foreground job</td></tr><tr><td align="left">time</td><td align="left">Time a command</td></tr><tr><td align="left">umask</td><td align="left">Set or list file permissions</td></tr><tr><td align="left">unset</td><td align="left">Erase variable or function definitions</td></tr><tr><td align="left">wait</td><td align="left">Wait for a background job to finish</td></tr></tbody></table></div></div><br class="table-break"></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm7368"></a>2. Differing features</h2></div></div></div><p>The table below shows major differences between the standard shell (<span class="command"><strong>sh</strong></span>), Bourne Again SHell (<span class="command"><strong>bash</strong></span>), Korn shell (<span class="command"><strong>ksh</strong></span>) and the C shell (<span class="command"><strong>csh</strong></span>).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Shell compatibility</h3><p>Since the Bourne Again SHell is a superset of <span class="command"><strong>sh</strong></span>, all <span class="command"><strong>sh</strong></span> commands will also work in <span class="command"><strong>bash</strong></span> - but not vice versa.  <span class="command"><strong>bash</strong></span> has many more features of its own, and, as the table below demonstrates, many features incorporated from other shells.</p><p>Since the Turbo C shell is a superset of <span class="command"><strong>csh</strong></span>, all <span class="command"><strong>csh</strong></span> commands will work in <span class="command"><strong>tcsh</strong></span>, but not the other way round.</p></div><div class="table"><a name="idm7386"></a><p class="title"><b>Table A.2. Differing Shell Features</b></p><div class="table-contents"><table class="table" summary="Differing Shell Features" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th align="left"><span class="command"><strong>sh</strong></span></th><th align="left"><span class="command"><strong>bash</strong></span></th><th align="left"><span class="command"><strong>ksh</strong></span></th><th align="left"><span class="command"><strong>csh</strong></span></th><th align="left">Meaning/Action</th></tr></thead><tbody><tr><td align="left">$</td><td align="left">$</td><td align="left">$</td><td align="left">%</td><td align="left">Default user prompt</td></tr><tr><td align="left"> </td><td align="left"><span class="command"><strong>&gt;|</strong></span></td><td align="left"><span class="command"><strong>&gt;|</strong></span></td><td align="left"><span class="command"><strong>&gt;!</strong></span></td><td align="left">Force redirection</td></tr><tr><td align="left"><span class="command"><strong>&gt; <code class="filename">file</code> 2&gt;&amp;1</strong></span></td><td align="left"><span class="command"><strong>&amp;&gt; <code class="filename">file</code></strong></span> or <span class="command"><strong>&gt; <code class="filename">file</code> 2&gt;&amp;1</strong></span></td><td align="left"><span class="command"><strong>&gt; <code class="filename">file</code> 2&gt;&amp;1</strong></span></td><td align="left"><span class="command"><strong>&gt;&amp; <code class="filename">file</code></strong></span></td><td align="left">Redirect stdout and stderr to <code class="filename">file</code></td></tr><tr><td align="left"> </td><td align="left"><span class="command"><strong>{ }</strong></span></td><td align="left"> </td><td align="left"><span class="command"><strong>{ }</strong></span></td><td align="left">Expand elements in list</td></tr><tr><td align="left"><span class="command"><strong>`command`</strong></span></td><td align="left"><span class="command"><strong>`command`</strong></span> or <span class="command"><strong>$(command)</strong></span></td><td align="left"><span class="command"><strong>$(command)</strong></span></td><td align="left"><span class="command"><strong>`command`</strong></span></td><td align="left">Substitute output of enclosed <span class="command"><strong>command</strong></span></td></tr><tr><td align="left"><code class="varname">$HOME</code></td><td align="left"><code class="varname">$HOME</code></td><td align="left"><code class="varname">$HOME</code></td><td align="left"><code class="varname">$home</code></td><td align="left">Home directory</td></tr><tr><td align="left"> </td><td align="left">~</td><td align="left">~</td><td align="left">~</td><td align="left">Home directory symbol</td></tr><tr><td align="left"> </td><td align="left"><code class="filename">~+</code>, <code class="filename">~-</code>, <span class="command"><strong>dirs</strong></span></td><td align="left"><code class="filename">~+</code>, <code class="filename">~-</code></td><td align="left"><code class="filename">=-</code>, <code class="filename">=N</code></td><td align="left">Access directory stack</td></tr><tr><td align="left"><span class="command"><strong><code class="varname">var</code>=value</strong></span></td><td align="left"><span class="command"><strong><code class="varname">VAR</code>=value</strong></span></td><td align="left"><span class="command"><strong><code class="varname">var</code>=value</strong></span></td><td align="left"><span class="command"><strong>set <code class="varname">var</code>=value</strong></span></td><td align="left">Variable assignment</td></tr><tr><td align="left"><span class="command"><strong>export <code class="varname">var</code></strong></span></td><td align="left"><span class="command"><strong>export <code class="varname">VAR</code>=value</strong></span></td><td align="left"><span class="command"><strong>export <code class="varname">var</code>=val</strong></span></td><td align="left"><span class="command"><strong>setenv <code class="varname">var</code> <em class="parameter"><code>val</code></em></strong></span></td><td align="left">Set environment variable</td></tr><tr><td align="left"> </td><td align="left"><code class="varname">${nnnn}</code></td><td align="left"><code class="varname">${nn}</code></td><td align="left"> </td><td align="left">More than 9 arguments can be referenced</td></tr><tr><td align="left">"<code class="varname">$@</code>"</td><td align="left">"<code class="varname">$@</code>"</td><td align="left">"<code class="varname">$@</code>"</td><td align="left"> </td><td align="left">All arguments as separate words</td></tr><tr><td align="left"><code class="varname">$#</code></td><td align="left"><code class="varname">$#</code></td><td align="left"><code class="varname">$#</code></td><td align="left"><code class="varname">$#argv</code></td><td align="left">Number of arguments</td></tr><tr><td align="left"><code class="varname">$?</code></td><td align="left"><code class="varname">$?</code></td><td align="left"><code class="varname">$?</code></td><td align="left"><code class="varname">$status</code></td><td align="left">Exit status of the most recently executed command</td></tr><tr><td align="left"><code class="varname">$!</code></td><td align="left"><code class="varname">$!</code></td><td align="left"><code class="varname">$!</code></td><td align="left"> </td><td align="left">PID of most recently backgrounded process</td></tr><tr><td align="left"><code class="varname">$-</code></td><td align="left"><code class="varname">$-</code></td><td align="left"><code class="varname">$-</code></td><td align="left"> </td><td align="left">Current options</td></tr><tr><td align="left"><span class="command"><strong>. <code class="filename">file</code></strong></span></td><td align="left"><span class="command"><strong>source <code class="filename">file</code></strong></span> or <span class="command"><strong>. <code class="filename">file</code></strong></span></td><td align="left"><span class="command"><strong>. <code class="filename">file</code></strong></span></td><td align="left"><span class="command"><strong>source <code class="filename">file</code></strong></span></td><td align="left">Read commands in file</td></tr><tr><td align="left"> </td><td align="left"><span class="command"><strong>alias x='y'</strong></span></td><td align="left"><span class="command"><strong>alias x=y</strong></span></td><td align="left"><span class="command"><strong>alias x y</strong></span></td><td align="left">Name <span class="command"><strong>x</strong></span> stands for command <span class="command"><strong>y</strong></span></td></tr><tr><td align="left"><span class="command"><strong>case</strong></span></td><td align="left"><span class="command"><strong>case</strong></span></td><td align="left"><span class="command"><strong>case</strong></span></td><td align="left"><span class="command"><strong>switch</strong></span> or <span class="command"><strong>case</strong></span></td><td align="left">Choose alternatives</td></tr><tr><td align="left"><span class="command"><strong>done</strong></span></td><td align="left"><span class="command"><strong>done</strong></span></td><td align="left"><span class="command"><strong>done</strong></span></td><td align="left"><span class="command"><strong>end</strong></span></td><td align="left">End a loop statement</td></tr><tr><td align="left"><span class="command"><strong>esac</strong></span></td><td align="left"><span class="command"><strong>esac</strong></span></td><td align="left"><span class="command"><strong>esac</strong></span></td><td align="left"><span class="command"><strong>endsw</strong></span></td><td align="left">End <span class="command"><strong>case</strong></span> or <span class="command"><strong>switch</strong></span></td></tr><tr><td align="left"><span class="command"><strong>exit <em class="parameter"><code>n</code></em></strong></span></td><td align="left"><span class="command"><strong>exit <em class="parameter"><code>n</code></em></strong></span></td><td align="left"><span class="command"><strong>exit <em class="parameter"><code>n</code></em></strong></span></td><td align="left"><span class="command"><strong>exit <em class="parameter"><code>(expr)</code></em></strong></span></td><td align="left">Exit with a status</td></tr><tr><td align="left"><span class="command"><strong>for</strong></span>/<span class="command"><strong>do</strong></span></td><td align="left"><span class="command"><strong>for</strong></span>/<span class="command"><strong>do</strong></span></td><td align="left"><span class="command"><strong>for</strong></span>/<span class="command"><strong>do</strong></span></td><td align="left"><span class="command"><strong>foreach</strong></span></td><td align="left">Loop through variables</td></tr><tr><td align="left"> </td><td align="left"><span class="command"><strong>set <code class="option">-f</code></strong></span>, <span class="command"><strong>set <code class="option">-o nullglob|dotglob|nocaseglob|noglob</code></strong></span></td><td align="left"> </td><td align="left"><span class="command"><strong>noglob</strong></span></td><td align="left">Ignore substitution characters for filename generation</td></tr><tr><td align="left"><span class="command"><strong>hash</strong></span></td><td align="left"><span class="command"><strong>hash</strong></span></td><td align="left"><span class="command"><strong>alias <code class="option">-t</code></strong></span></td><td align="left"><span class="command"><strong>hashstat</strong></span></td><td align="left">Display hashed commands (tracked aliases)</td></tr><tr><td align="left"><span class="command"><strong>hash <em class="parameter"><code>cmds</code></em></strong></span></td><td align="left"><span class="command"><strong>hash <em class="parameter"><code>cmds</code></em></strong></span></td><td align="left"><span class="command"><strong>alias <code class="option">-t</code> <em class="parameter"><code>cmds</code></em></strong></span></td><td align="left"><span class="command"><strong>rehash</strong></span></td><td align="left">Remember command locations</td></tr><tr><td align="left"><span class="command"><strong>hash <code class="option">-r</code></strong></span></td><td align="left"><span class="command"><strong>hash <code class="option">-r</code></strong></span></td><td align="left"> </td><td align="left"><span class="command"><strong>unhash</strong></span></td><td align="left">Forget command locations</td></tr><tr><td align="left"> </td><td align="left"><span class="command"><strong>history</strong></span></td><td align="left"><span class="command"><strong>history</strong></span></td><td align="left"><span class="command"><strong>history</strong></span></td><td align="left">List previous commands</td></tr><tr><td align="left"> </td><td align="left"><span class="keycap"><strong>ArrowUp</strong></span>+<span class="keycap"><strong>Enter</strong></span> or <span class="command"><strong>!!</strong></span></td><td align="left"><span class="command"><strong>r</strong></span></td><td align="left"><span class="command"><strong>!!</strong></span></td><td align="left">Redo previous command</td></tr><tr><td align="left"> </td><td align="left"><span class="command"><strong>!<em class="parameter"><code>str</code></em></strong></span></td><td align="left"><span class="command"><strong>r <em class="parameter"><code>str</code></em></strong></span></td><td align="left"><span class="command"><strong>!<em class="parameter"><code>str</code></em></strong></span></td><td align="left">Redo last command that starts with <span class="quote">&#8220;<span class="quote">str</span>&#8221;</span></td></tr><tr><td align="left"> </td><td align="left"><span class="command"><strong>!<em class="parameter"><code>cmd</code></em>:s/<em class="parameter"><code>x</code></em>/<em class="parameter"><code>y</code></em>/</strong></span></td><td align="left"><span class="command"><strong>r <em class="parameter"><code>x</code></em>=<em class="parameter"><code>y</code></em> <em class="parameter"><code>cmd</code></em></strong></span></td><td align="left"><span class="command"><strong>!<em class="parameter"><code>cmd</code></em>:s/<em class="parameter"><code>x</code></em>/<em class="parameter"><code>y</code></em>/</strong></span></td><td align="left">Replace <span class="quote">&#8220;<span class="quote">x</span>&#8221;</span> with <span class="quote">&#8220;<span class="quote">y</span>&#8221;</span> in most recent command starting with <span class="quote">&#8220;<span class="quote">cmd</span>&#8221;</span>, then execute.</td></tr><tr><td align="left"><span class="command"><strong>if [ <code class="varname">$i</code> -eq <em class="parameter"><code>5</code></em> ]</strong></span></td><td align="left"><span class="command"><strong>if [ <code class="varname">$i</code> -eq <em class="parameter"><code>5</code></em> ]</strong></span></td><td align="left"><span class="command"><strong>if ((<code class="varname">i</code>==<em class="parameter"><code>5</code></em>))</strong></span></td><td align="left"><span class="command"><strong>if (<code class="varname">$i</code>==<em class="parameter"><code>5</code></em>)</strong></span></td><td align="left">Sample condition test</td></tr><tr><td align="left"><span class="command"><strong>fi</strong></span></td><td align="left"><span class="command"><strong>fi</strong></span></td><td align="left"><span class="command"><strong>fi</strong></span></td><td align="left"><span class="command"><strong>endif</strong></span></td><td align="left">End <span class="command"><strong>if</strong></span> statement</td></tr><tr><td align="left"><span class="command"><strong>ulimit</strong></span></td><td align="left"><span class="command"><strong>ulimit</strong></span></td><td align="left"><span class="command"><strong>ulimit</strong></span></td><td align="left"><span class="command"><strong>limit</strong></span></td><td align="left">Set resource limits</td></tr><tr><td align="left"><span class="command"><strong>pwd</strong></span></td><td align="left"><span class="command"><strong>pwd</strong></span></td><td align="left"><span class="command"><strong>pwd</strong></span></td><td align="left"><span class="command"><strong>dirs</strong></span></td><td align="left">Print working directory</td></tr><tr><td align="left"><span class="command"><strong>read</strong></span></td><td align="left"><span class="command"><strong>read</strong></span></td><td align="left"><span class="command"><strong>read</strong></span></td><td align="left"><span class="command"><strong>$&lt;</strong></span></td><td align="left">Read from terminal</td></tr><tr><td align="left"><span class="command"><strong>trap <em class="parameter"><code>2</code></em></strong></span></td><td align="left"><span class="command"><strong>trap <em class="parameter"><code>2</code></em></strong></span></td><td align="left"><span class="command"><strong>trap <em class="parameter"><code>2</code></em></strong></span></td><td align="left"><span class="command"><strong>onintr</strong></span></td><td align="left">Ignore interrupts</td></tr><tr><td align="left"> </td><td align="left"><span class="command"><strong>unalias</strong></span></td><td align="left"><span class="command"><strong>unalias</strong></span></td><td align="left"><span class="command"><strong>unalias</strong></span></td><td align="left">Remove aliases</td></tr><tr><td align="left"><span class="command"><strong>until</strong></span></td><td align="left"><span class="command"><strong>until</strong></span></td><td align="left"><span class="command"><strong>until</strong></span></td><td align="left"> </td><td align="left">Begin <span class="command"><strong>until</strong></span> loop</td></tr><tr><td align="left"><span class="command"><strong>while</strong></span>/<span class="command"><strong>do</strong></span></td><td align="left"><span class="command"><strong>while</strong></span>/<span class="command"><strong>do</strong></span></td><td align="left"><span class="command"><strong>while</strong></span>/<span class="command"><strong>do</strong></span></td><td align="left"><span class="command"><strong>while</strong></span></td><td align="left">Begin <span class="command"><strong>while</strong></span> loop</td></tr></tbody></table></div></div><br class="table-break"><p>The Bourne Again SHell has many more features not listed here.  This table is just to give you an idea of how this shell incorporates all useful ideas from other shells: there are no blanks in the column for <span class="command"><strong>bash</strong></span>.  More information on features found only in Bash can be retrieved from the Bash info pages, in the <span class="quote">&#8220;<span class="quote">Bash Features</span>&#8221;</span> section.</p><p>More information:</p><p>You should at least read one manual, being the manual of your shell.  The preferred choice would be <span class="command"><strong>info bash</strong></span>, <span class="command"><strong>bash</strong></span> being the GNU shell and easiest for beginners.  Print it out and take it home, study it whenever you have 5 minutes.</p></div></div><div class="glossary"><div class="titlepage"><div><div><h1 class="title"><a name="glossary"></a>Glossary</h1></div></div></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>This section contains an alphabetical overview of common UNIX commands.  More information about the usage can be found in the man or info pages.</p></div><div class="glossdiv"><h3 class="title">A</h3><dl><dt><a name="a2ps"></a><span class="glossterm">a2ps</span></dt><dd class="glossdef"><p>Format files for printing on a PostScript printer.</p></dd><dt><a name="acroread"></a><span class="glossterm">acroread</span></dt><dd class="glossdef"><p>PDF viewer.</p></dd><dt><a name="adduser"></a><span class="glossterm">adduser</span></dt><dd class="glossdef"><p>Create a new user or update default new user information.</p></dd><dt><a name="alias"></a><span class="glossterm">alias</span></dt><dd class="glossdef"><p>Create a shell alias for a command.</p></dd><dt><a name="anacron"></a><span class="glossterm">anacron</span></dt><dd class="glossdef"><p>Execute commands periodically, does not assume continuously running machine.</p></dd><dt><a name="apropos"></a><span class="glossterm">apropos</span></dt><dd class="glossdef"><p>Search the whatis database for strings.</p></dd><dt><a name="apt-get"></a><span class="glossterm">apt-get</span></dt><dd class="glossdef"><p>APT package handling utility.</p></dd><dt><a name="aspell"></a><span class="glossterm">aspell</span></dt><dd class="glossdef"><p>Spell checker.</p></dd><dt><a name="at"></a><span class="glossterm">at, atq, atrm</span></dt><dd class="glossdef"><p>Queue, examine or delete jobs for later execution.</p></dd><dt><a name="aumix"></a><span class="glossterm">aumix</span></dt><dd class="glossdef"><p>Adjust audio mixer.</p></dd><dt><a name="awk"></a><span class="glossterm">(g)awk</span></dt><dd class="glossdef"><p>Pattern scanning and processing language.</p></dd></dl></div><div class="glossdiv"><h3 class="title">B</h3><dl><dt><a name="bash"></a><span class="glossterm">bash</span></dt><dd class="glossdef"><p>Bourne Again SHell.</p></dd><dt><a name="batch"></a><span class="glossterm">batch</span></dt><dd class="glossdef"><p>Queue, examine or delete jobs for later execution.</p></dd><dt><a name="bg"></a><span class="glossterm">bg</span></dt><dd class="glossdef"><p>Run a job in the background.</p></dd><dt><a name="bitmap"></a><span class="glossterm">bitmap</span></dt><dd class="glossdef"><p>Bitmap editor and converter utilities for the X window System.</p></dd><dt><a name="bzip2"></a><span class="glossterm">bzip2</span></dt><dd class="glossdef"><p>A block-sorting file compressor.</p></dd></dl></div><div class="glossdiv"><h3 class="title">C</h3><dl><dt><a name="cat"></a><span class="glossterm">cat</span></dt><dd class="glossdef"><p>Concatenate files and print to standard output.</p></dd><dt><a name="cd"></a><span class="glossterm">cd</span></dt><dd class="glossdef"><p>Change directory.</p></dd><dt><a name="cdp"></a><span class="glossterm">cdp/cdplay</span></dt><dd class="glossdef"><p>An interactive text-mode program for controlling and playing
       audio CD Roms under Linux.</p></dd><dt><a name="cdparanoia"></a><span class="glossterm">cdparanoia</span></dt><dd class="glossdef"><p>An audio CD reading utility which
       includes extra data verification features.</p></dd><dt><a name="cdrecord"></a><span class="glossterm">cdrecord</span></dt><dd class="glossdef"><p>Record a CD-R.</p></dd><dt><a name="chattr"></a><span class="glossterm">chattr</span></dt><dd class="glossdef"><p>Change file attributes.</p></dd><dt><a name="chgrp"></a><span class="glossterm">chgrp</span></dt><dd class="glossdef"><p>Change group ownership.</p></dd><dt><a name="chkconfig"></a><span class="glossterm">chkconfig</span></dt><dd class="glossdef"><p>Update or query run level information for system services.</p></dd><dt><a name="chmod"></a><span class="glossterm">chmod</span></dt><dd class="glossdef"><p>Change file access permissions.</p></dd><dt><a name="chown"></a><span class="glossterm">chown</span></dt><dd class="glossdef"><p>Change file owner and group.</p></dd><dt><a name="compress"></a><span class="glossterm">compress</span></dt><dd class="glossdef"><p>Compress files.</p></dd><dt><a name="cp"></a><span class="glossterm">cp</span></dt><dd class="glossdef"><p>Copy files and directories.</p></dd><dt><a name="crontab"></a><span class="glossterm">crontab</span></dt><dd class="glossdef"><p>Maintain crontab files.</p></dd><dt><a name="csh"></a><span class="glossterm">csh</span></dt><dd class="glossdef"><p>Open a C shell.</p></dd><dt><a name="cut"></a><span class="glossterm">cut</span></dt><dd class="glossdef"><p>Remove sections from each line of file(s).</p></dd></dl></div><div class="glossdiv"><h3 class="title">D</h3><dl><dt><a name="date"></a><span class="glossterm">date</span></dt><dd class="glossdef"><p>Print or set system date and time.</p></dd><dt><a name="dd"></a><span class="glossterm">dd</span></dt><dd class="glossdef"><p>Convert and copy a file (disk dump).</p></dd><dt><a name="df"></a><span class="glossterm">df</span></dt><dd class="glossdef"><p>Report file system disk usage.</p></dd><dt><a name="dhcpcd"></a><span class="glossterm">dhcpcd</span></dt><dd class="glossdef"><p>DHCP client daemon.</p></dd><dt><a name="diff"></a><span class="glossterm">diff</span></dt><dd class="glossdef"><p>Find differences between two files.</p></dd><dt><a name="dig"></a><span class="glossterm">dig</span></dt><dd class="glossdef"><p>Send domain name query packets to name servers.</p></dd><dt><a name="dmesg"></a><span class="glossterm">dmesg</span></dt><dd class="glossdef"><p>Print or control the kernel ring buffer.</p></dd><dt><a name="du"></a><span class="glossterm">du</span></dt><dd class="glossdef"><p>Estimate file space usage.</p></dd></dl></div><div class="glossdiv"><h3 class="title">E</h3><dl><dt><a name="echo"></a><span class="glossterm">echo</span></dt><dd class="glossdef"><p>Display a line of text.</p></dd><dt><a name="ediff"></a><span class="glossterm">ediff</span></dt><dd class="glossdef"><p>Diff to English translator.</p></dd><dt><a name="egrep"></a><span class="glossterm">egrep</span></dt><dd class="glossdef"><p>Extended grep.</p></dd><dt><a name="eject"></a><span class="glossterm">eject</span></dt><dd class="glossdef"><p>Unmount and eject removable media.</p></dd><dt><a name="emacs"></a><span class="glossterm">emacs</span></dt><dd class="glossdef"><p>Start the Emacs editor.</p></dd><dt><a name="exec"></a><span class="glossterm">exec</span></dt><dd class="glossdef"><p>Invoke subprocess(es).</p></dd><dt><a name="exit"></a><span class="glossterm">exit</span></dt><dd class="glossdef"><p>Exit current shell.</p></dd><dt><a name="export"></a><span class="glossterm">export</span></dt><dd class="glossdef"><p>Add function(s) to the shell environment.</p></dd></dl></div><div class="glossdiv"><h3 class="title">F</h3><dl><dt><a name="fax2ps"></a><span class="glossterm">fax2ps</span></dt><dd class="glossdef"><p>Convert a TIFF facsimile to PostScript.</p></dd><dt><a name="fdformat"></a><span class="glossterm">fdformat</span></dt><dd class="glossdef"><p>Format floppy disk.</p></dd><dt><a name="fdisk"></a><span class="glossterm">fdisk</span></dt><dd class="glossdef"><p>Partition table manipulator for Linux.</p></dd><dt><a name="fetchmail"></a><span class="glossterm">fetchmail</span></dt><dd class="glossdef"><p>Fetch mail from a POP, IMAP, ETRN or ODMR-capable server.</p></dd><dt><a name="fg"></a><span class="glossterm">fg</span></dt><dd class="glossdef"><p>Bring a job in the foreground.</p></dd><dt><a name="file"></a><span class="glossterm">file</span></dt><dd class="glossdef"><p>Determine file type.</p></dd><dt><a name="find"></a><span class="glossterm">find</span></dt><dd class="glossdef"><p>Find files.</p></dd><dt><a name="formail"></a><span class="glossterm">formail</span></dt><dd class="glossdef"><p>Mail (re)formatter.</p></dd><dt><a name="fortune"></a><span class="glossterm">fortune</span></dt><dd class="glossdef"><p>Print a random, hopefully interesting adage.</p></dd><dt><a name="ftp"></a><span class="glossterm">ftp</span></dt><dd class="glossdef"><p>Transfer files (unsafe unless anonymous account is used!)services.</p></dd></dl></div><div class="glossdiv"><h3 class="title">G</h3><dl><dt><a name="galeon"></a><span class="glossterm">galeon</span></dt><dd class="glossdef"><p>Graphical web browser.</p></dd><dt><a name="gdm"></a><span class="glossterm">gdm</span></dt><dd class="glossdef"><p>Gnome Display Manager.</p></dd><dt><a name="getty"></a><span class="glossterm">(min/a)getty</span></dt><dd class="glossdef"><p>Control console devices.</p></dd><dt><a name="gimp"></a><span class="glossterm">gimp</span></dt><dd class="glossdef"><p>Image manipulation program.</p></dd><dt><a name="grep"></a><span class="glossterm">grep</span></dt><dd class="glossdef"><p>Print lines matching a pattern.</p></dd><dt><a name="grub"></a><span class="glossterm">grub</span></dt><dd class="glossdef"><p>The grub shell.</p></dd><dt><a name="gv"></a><span class="glossterm">gv</span></dt><dd class="glossdef"><p>A PostScript and PDF viewer.</p></dd><dt><a name="gzip"></a><span class="glossterm">gzip</span></dt><dd class="glossdef"><p>Compress or expand files.</p></dd></dl></div><div class="glossdiv"><h3 class="title">H</h3><dl><dt><a name="halt"></a><span class="glossterm">halt</span></dt><dd class="glossdef"><p>Stop the system.</p></dd><dt><a name="head"></a><span class="glossterm">head</span></dt><dd class="glossdef"><p>Output the first part of files.</p></dd><dt><a name="help"></a><span class="glossterm">help</span></dt><dd class="glossdef"><p>Display help on a shell built-in command.</p></dd><dt><a name="host"></a><span class="glossterm">host</span></dt><dd class="glossdef"><p>DNS lookup utility.</p></dd><dt><a name="httpd"></a><span class="glossterm">httpd</span></dt><dd class="glossdef"><p>Apache hypertext transfer protocol server.</p></dd></dl></div><div class="glossdiv"><h3 class="title">I</h3><dl><dt><a name="id"></a><span class="glossterm">id</span></dt><dd class="glossdef"><p>Print real and effective UIDs and GIDs.</p></dd><dt><a name="ifconfig"></a><span class="glossterm">ifconfig</span></dt><dd class="glossdef"><p>Configure network interface or show configuration.</p></dd><dt><a name="info"></a><span class="glossterm">info</span></dt><dd class="glossdef"><p>Read Info documents.</p></dd><dt><a name="init"></a><span class="glossterm">init</span></dt><dd class="glossdef"><p>Process control initialization.</p></dd><dt><a name="iostat"></a><span class="glossterm">iostat</span></dt><dd class="glossdef"><p>Display I/O statistics.</p></dd><dt><a name="ip"></a><span class="glossterm">ip</span></dt><dd class="glossdef"><p>Display/change network interface status.</p></dd><dt><a name="ipchains"></a><span class="glossterm">ipchains</span></dt><dd class="glossdef"><p>IP firewall administration.</p></dd><dt><a name="iptables"></a><span class="glossterm">iptables</span></dt><dd class="glossdef"><p>IP packet filter administration.</p></dd></dl></div><div class="glossdiv"><h3 class="title">J</h3><dl><dt><a name="jar"></a><span class="glossterm">jar</span></dt><dd class="glossdef"><p>Java archive tool.</p></dd><dt><a name="jobs"></a><span class="glossterm">jobs</span></dt><dd class="glossdef"><p>List backgrounded tasks.</p></dd></dl></div><div class="glossdiv"><h3 class="title">K</h3><dl><dt><a name="kdm"></a><span class="glossterm">kdm</span></dt><dd class="glossdef"><p>Desktop manager for KDE.</p></dd><dt><a name="kill"></a><span class="glossterm">kill(all)</span></dt><dd class="glossdef"><p>Terminate process(es).</p></dd><dt><a name="ksh"></a><span class="glossterm">ksh</span></dt><dd class="glossdef"><p>Open a Korn shell.</p></dd></dl></div><div class="glossdiv"><h3 class="title">L</h3><dl><dt><a name="ldapmodify"></a><span class="glossterm">ldapmodify</span></dt><dd class="glossdef"><p>Modify an LDAP entry.</p></dd><dt><a name="ldapsearch"></a><span class="glossterm">ldapsearch</span></dt><dd class="glossdef"><p>LDAP search tool.</p></dd><dt><a name="less"></a><span class="glossterm">less</span></dt><dd class="glossdef"><p><span class="command"><strong>more</strong></span> with features.</p></dd><dt><a name="lilo"></a><span class="glossterm">lilo</span></dt><dd class="glossdef"><p>Linux boot loader.</p></dd><dt><a name="links"></a><span class="glossterm">links</span></dt><dd class="glossdef"><p>Text mode WWW browser.</p></dd><dt><a name="ln"></a><span class="glossterm">ln</span></dt><dd class="glossdef"><p>Make links between files.</p></dd><dt><a name="loadkeys"></a><span class="glossterm">loadkeys</span></dt><dd class="glossdef"><p>Load keyboard translation tables.</p></dd><dt><a name="locate"></a><span class="glossterm">locate</span></dt><dd class="glossdef"><p>Find files.</p></dd><dt><a name="logout"></a><span class="glossterm">logout</span></dt><dd class="glossdef"><p>Close current shell.</p></dd><dt><a name="lp"></a><span class="glossterm">lp</span></dt><dd class="glossdef"><p>Send requests to the LP print service.</p></dd><dt><a name="lpc"></a><span class="glossterm">lpc</span></dt><dd class="glossdef"><p>Line printer control program.</p></dd><dt><a name="lpq"></a><span class="glossterm">lpq</span></dt><dd class="glossdef"><p>Print spool queue examination program.</p></dd><dt><a name="lpr"></a><span class="glossterm">lpr</span></dt><dd class="glossdef"><p>Offline print.</p></dd><dt><a name="lprm"></a><span class="glossterm">lprm</span></dt><dd class="glossdef"><p>Remove print requests.</p></dd><dt><a name="ls"></a><span class="glossterm">ls</span></dt><dd class="glossdef"><p>List directory content.</p></dd><dt><a name="lynx"></a><span class="glossterm">lynx</span></dt><dd class="glossdef"><p>Text mode WWW browser.</p></dd></dl></div><div class="glossdiv"><h3 class="title">M</h3><dl><dt><a name="mail"></a><span class="glossterm">mail</span></dt><dd class="glossdef"><p>Send and receive mail.</p></dd><dt><a name="man"></a><span class="glossterm">man</span></dt><dd class="glossdef"><p>Read man pages.</p></dd><dt><a name="mcopy"></a><span class="glossterm">mcopy</span></dt><dd class="glossdef"><p>Copy MSDOS files to/from Unix.</p></dd><dt><a name="mdir"></a><span class="glossterm">mdir</span></dt><dd class="glossdef"><p>Display an MSDOS directory.</p></dd><dt><a name="memusage"></a><span class="glossterm">memusage</span></dt><dd class="glossdef"><p>Display memory usage.</p></dd><dt><a name="memusagestat"></a><span class="glossterm">memusagestat</span></dt><dd class="glossdef"><p>Display memory usage statistics.</p></dd><dt><a name="mesg"></a><span class="glossterm">mesg</span></dt><dd class="glossdef"><p>Control write access to your terminal.</p></dd><dt><a name="mformat"></a><span class="glossterm">mformat</span></dt><dd class="glossdef"><p>Add an MSDOS file system to a low-level formatted floppy disk.</p></dd><dt><a name="mkbootdisk"></a><span class="glossterm">mkbootdisk</span></dt><dd class="glossdef"><p>Creates a stand-alone boot floppy for the running system.</p></dd><dt><a name="mkdir"></a><span class="glossterm">mkdir</span></dt><dd class="glossdef"><p>Create directory.</p></dd><dt><a name="mkisofs"></a><span class="glossterm">mkisofs</span></dt><dd class="glossdef"><p>Create a hybrid ISO9660 filesystem.</p></dd><dt><a name="more"></a><span class="glossterm">more</span></dt><dd class="glossdef"><p>Filter for displaying text one screen at the time.</p></dd><dt><a name="mount"></a><span class="glossterm">mount</span></dt><dd class="glossdef"><p>Mount a file system or display information about mounted file systems.</p></dd><dt><a name="mozilla"></a><span class="glossterm">mozilla</span></dt><dd class="glossdef"><p>Web browser.</p></dd><dt><a name="mt"></a><span class="glossterm">mt</span></dt><dd class="glossdef"><p>Control magnetic tape drive operation.</p></dd><dt><a name="mtr"></a><span class="glossterm">mtr</span></dt><dd class="glossdef"><p>Network diagnostic tool.</p></dd><dt><a name="mv"></a><span class="glossterm">mv</span></dt><dd class="glossdef"><p>Rename files.</p></dd></dl></div><div class="glossdiv"><h3 class="title">N</h3><dl><dt><a name="named"></a><span class="glossterm">named</span></dt><dd class="glossdef"><p>Internet domain name server.</p></dd><dt><a name="ncftp"></a><span class="glossterm">ncftp</span></dt><dd class="glossdef"><p>Browser program for ftp services (insecure!).</p></dd><dt><a name="netstat"></a><span class="glossterm">netstat</span></dt><dd class="glossdef"><p>Print network connections, routing tables, interface statistics, masquerade connections, and multi-cast memberships.</p></dd><dt><a name="nfsstat"></a><span class="glossterm">nfsstat</span></dt><dd class="glossdef"><p>Print statistics about networked file systems.</p></dd><dt><a name="nice"></a><span class="glossterm">nice</span></dt><dd class="glossdef"><p>Run a program with modified scheduling priority.</p></dd><dt><a name="nmap"></a><span class="glossterm">nmap</span></dt><dd class="glossdef"><p>Network exploration tool and security scanner.</p></dd><dt><a name="ntsysv"></a><span class="glossterm">ntsysv</span></dt><dd class="glossdef"><p>Simple interface for configuring run levels.</p></dd></dl></div><div class="glossdiv"><h3 class="title">P</h3><dl><dt><a name="passwd"></a><span class="glossterm">passwd</span></dt><dd class="glossdef"><p>Change password.</p></dd><dt><a name="pdf2ps"></a><span class="glossterm">pdf2ps</span></dt><dd class="glossdef"><p>Ghostscript PDF to PostScript translator.</p></dd><dt><a name="perl"></a><span class="glossterm">perl</span></dt><dd class="glossdef"><p>Practical Extraction and Report Language.</p></dd><dt><a name="pg"></a><span class="glossterm">pg</span></dt><dd class="glossdef"><p>Page through text output.</p></dd><dt><a name="ping"></a><span class="glossterm">ping</span></dt><dd class="glossdef"><p>Send echo request to a host.</p></dd><dt><a name="pr"></a><span class="glossterm">pr</span></dt><dd class="glossdef"><p>Convert text files for printing.</p></dd><dt><a name="printenv"></a><span class="glossterm">printenv</span></dt><dd class="glossdef"><p>Print all or part of environment.</p></dd><dt><a name="procmail"></a><span class="glossterm">procmail</span></dt><dd class="glossdef"><p>Autonomous mail processor.</p></dd><dt><a name="ps"></a><span class="glossterm">ps</span></dt><dd class="glossdef"><p>Report process status.</p></dd><dt><a name="pstree"></a><span class="glossterm">pstree</span></dt><dd class="glossdef"><p>Display a tree of processes.</p></dd><dt><a name="pwd"></a><span class="glossterm">pwd</span></dt><dd class="glossdef"><p>Print present working directory.</p></dd></dl></div><div class="glossdiv"><h3 class="title">Q</h3><dl><dt><a name="quota"></a><span class="glossterm">quota</span></dt><dd class="glossdef"><p>Display disk usage and limits.</p></dd></dl></div><div class="glossdiv"><h3 class="title">R</h3><dl><dt><a name="rcp"></a><span class="glossterm">rcp</span></dt><dd class="glossdef"><p>Remote copy (unsafe!)</p></dd><dt><a name="rdesktop"></a><span class="glossterm">rdesktop</span></dt><dd class="glossdef"><p>Remote Desktop Protocol client.</p></dd><dt><a name="reboot"></a><span class="glossterm">reboot</span></dt><dd class="glossdef"><p>Stop and restart the system.</p></dd><dt><a name="renice"></a><span class="glossterm">renice</span></dt><dd class="glossdef"><p>Alter priority of a running process.</p></dd><dt><a name="rlogin"></a><span class="glossterm">rlogin</span></dt><dd class="glossdef"><p>Remote login (telnet, insecure!).</p></dd><dt><a name="rm"></a><span class="glossterm">rm</span></dt><dd class="glossdef"><p>Remove a file.</p></dd><dt><a name="rmdir"></a><span class="glossterm">rmdir</span></dt><dd class="glossdef"><p>Remove a directory.</p></dd><dt><a name="rpm"></a><span class="glossterm">rpm</span></dt><dd class="glossdef"><p>RPM Package Manager.</p></dd><dt><a name="rsh"></a><span class="glossterm">rsh</span></dt><dd class="glossdef"><p>Remote shell (insecure!).</p></dd></dl></div><div class="glossdiv"><h3 class="title">S</h3><dl><dt><a name="scp"></a><span class="glossterm">scp</span></dt><dd class="glossdef"><p>Secure remote copy.</p></dd><dt><a name="screen"></a><span class="glossterm">screen</span></dt><dd class="glossdef"><p>Screen manager with VT100 emulation.</p></dd><dt><a name="set"></a><span class="glossterm">set</span></dt><dd class="glossdef"><p>Display, set or change variable.</p></dd><dt><a name="setterm"></a><span class="glossterm">setterm</span></dt><dd class="glossdef"><p>Set terminal attributes.</p></dd><dt><a name="sftp"></a><span class="glossterm">sftp</span></dt><dd class="glossdef"><p>Secure (encrypted) ftp.</p></dd><dt><a name="sh"></a><span class="glossterm">sh</span></dt><dd class="glossdef"><p>Open a standard shell.</p></dd><dt><a name="shutdown"></a><span class="glossterm">shutdown</span></dt><dd class="glossdef"><p>Bring the system down.</p></dd><dt><a name="sleep"></a><span class="glossterm">sleep</span></dt><dd class="glossdef"><p>Wait for a given period.</p></dd><dt><a name="slocate"></a><span class="glossterm">slocate</span></dt><dd class="glossdef"><p>Security Enhanced version of the GNU Locate.</p></dd><dt><a name="slrnn"></a><span class="glossterm">slrnn</span></dt><dd class="glossdef"><p>text mode Usenet client.</p></dd><dt><a name="snort"></a><span class="glossterm">snort</span></dt><dd class="glossdef"><p>Network intrusion detection tool.</p></dd><dt><a name="sort"></a><span class="glossterm">sort</span></dt><dd class="glossdef"><p>Sort lines of text files.</p></dd><dt><a name="ssh"></a><span class="glossterm">ssh</span></dt><dd class="glossdef"><p>Secure shell.</p></dd><dt><a name="ssh-keygen"></a><span class="glossterm">ssh-keygen</span></dt><dd class="glossdef"><p>Authentication key generation.</p></dd><dt><a name="stty"></a><span class="glossterm">stty</span></dt><dd class="glossdef"><p>Change and print terminal line settings.</p></dd><dt><a name="su"></a><span class="glossterm">su</span></dt><dd class="glossdef"><p>Switch user.</p></dd></dl></div><div class="glossdiv"><h3 class="title">T</h3><dl><dt><a name="tac"></a><span class="glossterm">tac</span></dt><dd class="glossdef"><p>Concatenate and print files in reverse.</p></dd><dt><a name="tail"></a><span class="glossterm">tail</span></dt><dd class="glossdef"><p>Output the last part of files.</p></dd><dt><a name="talk"></a><span class="glossterm">talk</span></dt><dd class="glossdef"><p>Talk to a user.</p></dd><dt><a name="tar"></a><span class="glossterm">tar</span></dt><dd class="glossdef"><p>Archiving utility.</p></dd><dt><a name="tcsh"></a><span class="glossterm">tcsh</span></dt><dd class="glossdef"><p>Open a Turbo C shell.</p></dd><dt><a name="telnet"></a><span class="glossterm">telnet</span></dt><dd class="glossdef"><p>User interface to the TELNET protocol (insecure!).</p></dd><dt><a name="tex"></a><span class="glossterm">tex</span></dt><dd class="glossdef"><p>Text formatting and typesetting.</p></dd><dt><a name="time"></a><span class="glossterm">time</span></dt><dd class="glossdef"><p>Time a simple command or give resource usage.</p></dd><dt><a name="tin"></a><span class="glossterm">tin</span></dt><dd class="glossdef"><p>News reading program.</p></dd><dt><a name="top"></a><span class="glossterm">top</span></dt><dd class="glossdef"><p>Display top CPU processes.</p></dd><dt><a name="touch"></a><span class="glossterm">touch</span></dt><dd class="glossdef"><p>Change file timestamps.</p></dd><dt><a name="traceroute"></a><span class="glossterm">traceroute</span></dt><dd class="glossdef"><p>Print the route packets take to network host.</p></dd><dt><a name="tripwire"></a><span class="glossterm">tripwire</span></dt><dd class="glossdef"><p>A file integrity checker for UNIX systems.</p></dd><dt><a name="twm"></a><span class="glossterm">twm</span></dt><dd class="glossdef"><p>Tab Window Manager for the X Window System.</p></dd></dl></div><div class="glossdiv"><h3 class="title">U</h3><dl><dt><a name="ulimit"></a><span class="glossterm">ulimit</span></dt><dd class="glossdef"><p>Controll resources.</p></dd><dt><a name="umask"></a><span class="glossterm">umask</span></dt><dd class="glossdef"><p>Set user file creation mask.</p></dd><dt><a name="umount"></a><span class="glossterm">umount</span></dt><dd class="glossdef"><p>Unmount a file system.</p></dd><dt><a name="uncompress"></a><span class="glossterm">uncompress</span></dt><dd class="glossdef"><p>Decompress compressed files.</p></dd><dt><a name="uniq"></a><span class="glossterm">uniq</span></dt><dd class="glossdef"><p>Remove duplicate lines from a sorted file.</p></dd><dt><a name="update"></a><span class="glossterm">update</span></dt><dd class="glossdef"><p>Kernel daemon to flush dirty buffers back to disk.</p></dd><dt><a name="uptime"></a><span class="glossterm">uptime</span></dt><dd class="glossdef"><p>Display system uptime and average load.</p></dd><dt><a name="userdel"></a><span class="glossterm">userdel</span></dt><dd class="glossdef"><p>Delete a user account and related files.</p></dd></dl></div><div class="glossdiv"><h3 class="title">V</h3><dl><dt><a name="vi"></a><span class="glossterm">vi(m)</span></dt><dd class="glossdef"><p>Start the vi (improved) editor.</p></dd><dt><a name="vimtutor"></a><span class="glossterm">vimtutor</span></dt><dd class="glossdef"><p>The Vim tutor.</p></dd><dt><a name="vmstat"></a><span class="glossterm">vmstat</span></dt><dd class="glossdef"><p>Report virtual memory statistics.</p></dd></dl></div><div class="glossdiv"><h3 class="title">W</h3><dl><dt><a name="w"></a><span class="glossterm">w</span></dt><dd class="glossdef"><p>Show who is logged on and what they are doing.</p></dd><dt><a name="wall"></a><span class="glossterm">wall</span></dt><dd class="glossdef"><p>Send a message to everybody's terminal.</p></dd><dt><a name="wc"></a><span class="glossterm">wc</span></dt><dd class="glossdef"><p>Print the number of bytes, words and lines in files.</p></dd><dt><a name="which"></a><span class="glossterm">which</span></dt><dd class="glossdef"><p>Shows the full path of (shell) commands.</p></dd><dt><a name="who"></a><span class="glossterm">who</span></dt><dd class="glossdef"><p>Show who is logged on.</p></dd><dt><a name="whoami"></a><span class="glossterm">who am i</span></dt><dd class="glossdef"><p>Print effective user ID.</p></dd><dt><a name="whois"></a><span class="glossterm">whois</span></dt><dd class="glossdef"><p>Query a whois or nicname database.</p></dd><dt><a name="write"></a><span class="glossterm">write</span></dt><dd class="glossdef"><p>Send a message to another user.</p></dd></dl></div><div class="glossdiv"><h3 class="title">X</h3><dl><dt><a name="xauth"></a><span class="glossterm">xauth</span></dt><dd class="glossdef"><p>X authority file utility.</p></dd><dt><a name="xcdroast"></a><span class="glossterm">xcdroast</span></dt><dd class="glossdef"><p>Graphical front end to cdrecord.</p></dd><dt><a name="xclock"></a><span class="glossterm">xclock</span></dt><dd class="glossdef"><p>Analog/digital clock for X.</p></dd><dt><a name="xconsole"></a><span class="glossterm">xconsole</span></dt><dd class="glossdef"><p>Monitor system console messages with X.</p></dd><dt><a name="xdm"></a><span class="glossterm">xdm</span></dt><dd class="glossdef"><p>X Display Manager with support for XDMCP, host chooser.</p></dd><dt><a name="xdvi"></a><span class="glossterm">xdvi</span></dt><dd class="glossdef"><p>DVI viewer.</p></dd><dt><a name="xfs"></a><span class="glossterm">xfs</span></dt><dd class="glossdef"><p>X font server.</p></dd><dt><a name="xhost"></a><span class="glossterm">xhost</span></dt><dd class="glossdef"><p>Server access control program for X</p></dd><dt><a name="xinetd"></a><span class="glossterm">xinetd</span></dt><dd class="glossdef"><p>The extended Internet services daemon.</p></dd><dt><a name="xload"></a><span class="glossterm">xload</span></dt><dd class="glossdef"><p>System load average display for X.</p></dd><dt><a name="xlsfonts"></a><span class="glossterm">xlsfonts</span></dt><dd class="glossdef"><p>Server font list displayer for X.</p></dd><dt><a name="xmms"></a><span class="glossterm">xmms</span></dt><dd class="glossdef"><p>Audio player for X.</p></dd><dt><a name="xpdf"></a><span class="glossterm">xpdf</span></dt><dd class="glossdef"><p>PDF viewer.</p></dd><dt><a name="xterm"></a><span class="glossterm">xterm</span></dt><dd class="glossdef"><p>Terminal emulator for X.</p></dd></dl></div><div class="glossdiv"><h3 class="title">Z</h3><dl><dt><a name="zcat"></a><span class="glossterm">zcat</span></dt><dd class="glossdef"><p>Compress or expand files.</p></dd><dt><a name="zgrep"></a><span class="glossterm">zgrep</span></dt><dd class="glossdef"><p>Search possibly compressed files for a regular expression.</p></dd><dt><a name="zmore"></a><span class="glossterm">zmore</span></dt><dd class="glossdef"><p>Filter for viewing compressed text.</p></dd></dl></div></div><div class="glossary"><div class="titlepage"><div><div><h1 class="title"><a name="index-gloss-glossary"></a>Index</h1></div></div></div><div class="glossdiv"><h3 class="title">A</h3><dl><dt><a name="index-gloss-aliases"></a><span class="glossterm">aliases</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_05_01" title="5.1. What are aliases?">Section 5.1, &#8220;What are aliases?&#8221;</a></p></dd><dt><a name="index-gloss-ansiquoting"></a><span class="glossterm">ANSI-C quoting</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_03_05" title="3.5. ANSI-C quoting">Section 3.5, &#8220;ANSI-C quoting&#8221;</a></p></dd><dt><a name="index-gloss-arguments"></a><span class="glossterm">arguments</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_02_01_02" title="2.1.2. Checking command line arguments">Section 2.1.2, &#8220;Checking command line arguments&#8221;</a></p></dd><dt><a name="index-gloss-arithmexpand"></a><span class="glossterm">arithmetic expansion</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_06" title="4.7. Process substitution">Section 4.7, &#8220;Process substitution&#8221;</a></p></dd><dt><a name="index-gloss-arithmops"></a><span class="glossterm">arithmetic operators</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_06" title="4.7. Process substitution">Section 4.7, &#8220;Process substitution&#8221;</a></p></dd><dt><a name="index-gloss-array"></a><span class="glossterm">array</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_10_02_01" title="2.1. Creating arrays">Section 2.1, &#8220;Creating arrays&#8221;</a></p></dd><dt><a name="index-gloss-awk"></a><span class="glossterm">awk</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_01" title="1. Getting started with gawk">Section 1, &#8220;Getting started with gawk&#8221;</a></p></dd><dt><a name="index-gloss-awkprogram"></a><span class="glossterm">awkprogram</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_01_02" title="1.2. Gawk commands">Section 1.2, &#8220;Gawk commands&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">B</h3><dl><dt><a name="index-gloss-bash"></a><span class="glossterm">bash</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02" title="2. Advantages of the Bourne Again SHell">Section 2, &#8220;Advantages of the Bourne Again SHell&#8221;</a></p></dd><dt><a name="index-gloss-bashlogin"></a><span class="glossterm">.bash_login</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01_02_02" title="1.2.2. ~/.bash_login">Section 1.2.2, &#8220;~/.bash_login&#8221;</a></p></dd><dt><a name="index-gloss-bash_logout"></a><span class="glossterm">.bash_logout</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01_02_05" title="1.2.5. ~/.bash_logout">Section 1.2.5, &#8220;~/.bash_logout&#8221;</a></p></dd><dt><a name="index-gloss-bashprofile"></a><span class="glossterm">.bash_profile</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01_02_01" title="1.2.1. ~/.bash_profile">Section 1.2.1, &#8220;~/.bash_profile&#8221;</a></p></dd><dt><a name="index-gloss-bashrc"></a><span class="glossterm">.bashrc</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01_02_04" title="1.2.4. ~/.bashrc">Section 1.2.4, &#8220;~/.bashrc&#8221;</a></p></dd><dt><a name="index-gloss-batchedit"></a><span class="glossterm">batch editor</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_05_01_01" title="1.1. What is sed?">Section 1.1, &#8220;What is sed?&#8221;</a></p></dd><dt><a name="index-gloss-break"></a><span class="glossterm">break</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_05_01" title="5.1. The break built-in">Section 5.1, &#8220;The break built-in&#8221;</a></p></dd><dt><a name="index-gloss-booleanops"></a><span class="glossterm">boolean operators</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_02_04" title="2.4. Boolean operations">Section 2.4, &#8220;Boolean operations&#8221;</a></p></dd><dt><a name="index-gloss-bourne"></a><span class="glossterm">Bourne shell</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_01_02" title="1.2. Shell types">Section 1.2, &#8220;Shell types&#8221;</a></p></dd><dt><a name="index-gloss-brace-expand"></a><span class="glossterm">brace expansion</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_02" title="4.3. Tilde expansion">Section 4.3, &#8220;Tilde expansion&#8221;</a></p></dd><dt><a name="index-gloss-built-in"></a><span class="glossterm">built-in commands</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_03_02" title="3.2. Shell built-in commands">Section 3.2, &#8220;Shell built-in commands&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">C</h3><dl><dt><a name="index-gloss-case"></a><span class="glossterm">case statements</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_02_05" title="2.5. Using the exit statement and if">Section 2.5, &#8220;Using the exit statement and if&#8221;</a></p></dd><dt><a name="index-gloss-charclass"></a><span class="glossterm">character classes</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_02_02_02" title="2.2.2. Character classes">Section 2.2.2, &#8220;Character classes&#8221;</a>, <a class="xref" href="#sect_04_03_02" title="3.2. Character classes">Section 3.2, &#8220;Character classes&#8221;</a></p></dd><dt><a name="index-gloss-child"></a><span class="glossterm">child process</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_03_01" title="3.1. General">Section 3.1, &#8220;General&#8221;</a></p></dd><dt><a name="index-gloss-combexrs"></a><span class="glossterm">combined expressions</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_01_01_01" title="1.1.1. Expressions used with if">Section 1.1.1, &#8220;Expressions used with if&#8221;</a></p></dd><dt><a name="index-gloss-commandsubst"></a><span class="glossterm">command substitution</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_05" title="4.6. Arithmetic expansion">Section 4.6, &#8220;Arithmetic expansion&#8221;</a></p></dd><dt><a name="index-gloss-comments"></a><span class="glossterm">comments</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_02_02" title="2.2. Adding comments">Section 2.2, &#8220;Adding comments&#8221;</a></p></dd><dt><a name="index-gloss-conditionals"></a><span class="glossterm">conditionals</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_01" title="1. Introduction to if">Section 1, &#8220;Introduction to if&#8221;</a></p></dd><dt><a name="index-gloss-configfiles"></a><span class="glossterm">configuration files</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01" title="1. Shell initialization files">Section 1, &#8220;Shell initialization files&#8221;</a></p></dd><dt><a name="index-gloss-constants"></a><span class="glossterm">constants</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_10_01_03" title="1.3. Constants">Section 1.3, &#8220;Constants&#8221;</a></p></dd><dt><a name="index-gloss-continue"></a><span class="glossterm">continue</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_05_02" title="5.2. The continue built-in">Section 5.2, &#8220;The continue built-in&#8221;</a></p></dd><dt><a name="index-gloss-controlsigs"></a><span class="glossterm">control signals</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_12_01_01_03" title="1.1.3. Sending signals using the shell">Section 1.1.3, &#8220;Sending signals using the shell&#8221;</a></p></dd><dt><a name="index-gloss-createvars"></a><span class="glossterm">creating variables</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_02" title="2.2. Creating variables">Section 2.2, &#8220;Creating variables&#8221;</a></p></dd><dt><a name="index-gloss-csh"></a><span class="glossterm">csh</span></dt><dd class="glossdef"><p>The C shell, <a class="xref" href="#sect_01_01_02" title="1.2. Shell types">Section 1.2, &#8220;Shell types&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">D</h3><dl><dt><a name="index-gloss-debugging"></a><span class="glossterm">debugging scripts</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_03" title="3. Debugging Bash scripts">Section 3, &#8220;Debugging Bash scripts&#8221;</a></p></dd><dt><a name="index-gloss-declare"></a><span class="glossterm">declare</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_10_01_02" title="1.2. Using the declare built-in">Section 1.2, &#8220;Using the declare built-in&#8221;</a>, <a class="xref" href="#sect_10_02_01" title="2.1. Creating arrays">Section 2.1, &#8220;Creating arrays&#8221;</a></p></dd><dt><a name="index-gloss-doublequotes"></a><span class="glossterm">double quotes</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_03_04" title="3.4. Double quotes">Section 3.4, &#8220;Double quotes&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">E</h3><dl><dt><a name="index-gloss-echo"></a><span class="glossterm">echo</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_05_05" title="5.5. An example Bash script: mysystem.sh">Section 5.5, &#8220;An example Bash script: mysystem.sh&#8221;</a>, <a class="xref" href="#sect_02_01_02" title="1.2. script1.sh">Section 1.2, &#8220;script1.sh&#8221;</a>, <a class="xref" href="#sect_02_03_02" title="3.2. Debugging on part(s) of the script">Section 3.2, &#8220;Debugging on part(s) of the script&#8221;</a>, <a class="xref" href="#sect_08_01_02" title="1.2. Using the echo built-in command">Section 1.2, &#8220;Using the echo built-in command&#8221;</a></p></dd><dt><a name="index-gloss-editors"></a><span class="glossterm">editors</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_01" title="1.1. Writing and naming">Section 1.1, &#8220;Writing and naming&#8221;</a></p></dd><dt><a name="index-gloss-else"></a><span class="glossterm">else</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_02_01" title="2.1. if/then/else constructs">Section 2.1, &#8220;if/then/else constructs&#8221;</a></p></dd><dt><a name="index-gloss-emacs"></a><span class="glossterm">emacs</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_01" title="1.1. Writing and naming">Section 1.1, &#8220;Writing and naming&#8221;</a></p></dd><dt><a name="index-gloss-env"></a><span class="glossterm">env</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_01_01" title="2.1.1. Global variables">Section 2.1.1, &#8220;Global variables&#8221;</a></p></dd><dt><a name="index-gloss-esac"></a><span class="glossterm">esac</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_02_05" title="2.5. Using the exit statement and if">Section 2.5, &#8220;Using the exit statement and if&#8221;</a></p></dd><dt><a name="index-gloss-escapechars"></a><span class="glossterm">escape characters</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_03_02" title="3.2. Escape characters">Section 3.2, &#8220;Escape characters&#8221;</a></p></dd><dt><a name="index-gloss-escapeseqs"></a><span class="glossterm">escape sequences</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_01_02" title="1.2. Using the echo built-in command">Section 1.2, &#8220;Using the echo built-in command&#8221;</a></p></dd><dt><a name="index-gloss-etcbashrc"></a><span class="glossterm">/etc/bashrc</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01_01_02" title="1.1.2. /etc/bashrc">Section 1.1.2, &#8220;/etc/bashrc&#8221;</a></p></dd><dt><a name="index-gloss-passwd"></a><span class="glossterm">/etc/passwd</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_01_02" title="1.2. Shell types">Section 1.2, &#8220;Shell types&#8221;</a></p></dd><dt><a name="index-gloss-etcprofile"></a><span class="glossterm">/etc/profile</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01_01" title="1.1. System-wide configuration files">Section 1.1, &#8220;System-wide configuration files&#8221;</a></p></dd><dt><a name="index-gloss-shells"></a><span class="glossterm">/etc/shells</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_01_02" title="1.2. Shell types">Section 1.2, &#8220;Shell types&#8221;</a></p></dd><dt><a name="index-gloss-exec"></a><span class="glossterm">exec</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_03_01" title="3.1. General">Section 3.1, &#8220;General&#8221;</a>, <a class="xref" href="#sect_08_02_04_02" title="2.4.2. Read and exec">Section 2.4.2, &#8220;Read and exec&#8221;</a></p></dd><dt><a name="index-gloss-execute"></a><span class="glossterm">execute permissions</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_03" title="1.3. Executing the script">Section 1.3, &#8220;Executing the script&#8221;</a></p></dd><dt><a name="index-gloss-execution"></a><span class="glossterm">execution</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_03" title="1.3. Executing the script">Section 1.3, &#8220;Executing the script&#8221;</a></p></dd><dt><a name="index-gloss-exit"></a><span class="glossterm">exit</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_02_05" title="2.5. Using the exit statement and if">Section 2.5, &#8220;Using the exit statement and if&#8221;</a></p></dd><dt><a name="index-gloss-exitstatus"></a><span class="glossterm">exit status</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_01_02_01" title="1.2.1. Testing exit status">Section 1.2.1, &#8220;Testing exit status&#8221;</a></p></dd><dt><a name="index-gloss-expansion"></a><span class="glossterm">expansion</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_04_01_05" title="4.1.5. Shell expansions">Section 4.1.5, &#8220;Shell expansions&#8221;</a>, <a class="xref" href="#sect_03_04" title="4. Shell expansion">Section 4, &#8220;Shell expansion&#8221;</a></p></dd><dt><a name="index-gloss-export"></a><span class="glossterm">export</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_03" title="2.3. Exporting variables">Section 2.3, &#8220;Exporting variables&#8221;</a></p></dd><dt><a name="index-gloss-extendedregexps"></a><span class="glossterm">extended regular expressions</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_01_03" title="1.3. Basic versus extended regular expressions">Section 1.3, &#8220;Basic versus extended regular expressions&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">F</h3><dl><dt><a name="index-gloss-fd"></a><span class="glossterm">file descriptors</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_02_03" title="2.3. Redirection and file descriptors">Section 2.3, &#8220;Redirection and file descriptors&#8221;</a>, <a class="xref" href="#sect_08_02_04_01" title="2.4.1. Using /dev/fd">Section 2.4.1, &#8220;Using /dev/fd&#8221;</a></p></dd><dt><a name="index-gloss-fileexpand"></a><span class="glossterm">file name expansion</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_08" title="4.9. File name expansion">Section 4.9, &#8220;File name expansion&#8221;</a></p></dd><dt><a name="index-gloss-findreplace"></a><span class="glossterm">find and replace</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_05_02_04" title="2.4. Find and replace with sed">Section 2.4, &#8220;Find and replace with sed&#8221;</a></p></dd><dt><a name="index-gloss-for"></a><span class="glossterm">for</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_01" title="1. The for loop">Section 1, &#8220;The for loop&#8221;</a></p></dd><dt><a name="index-gloss-fork"></a><span class="glossterm">fork</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_03_01" title="3.1. General">Section 3.1, &#8220;General&#8221;</a></p></dd><dt><a name="index-gloss-functions"></a><span class="glossterm">functions</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_11_01_01" title="1.1. What are functions?">Section 1.1, &#8220;What are functions?&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">G</h3><dl><dt><a name="index-gloss-gawk"></a><span class="glossterm">gawk</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_01_01" title="1.1. What is gawk?">Section 1.1, &#8220;What is gawk?&#8221;</a></p></dd><dt><a name="index-gloss-gawkcommands"></a><span class="glossterm">gawk commands</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_01_02" title="1.2. Gawk commands">Section 1.2, &#8220;Gawk commands&#8221;</a></p></dd><dt><a name="index-gloss-gawkfields"></a><span class="glossterm">gawk fields</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_02_01" title="2.1. Printing selected fields">Section 2.1, &#8220;Printing selected fields&#8221;</a></p></dd><dt><a name="index-gloss-gawkformatting"></a><span class="glossterm">gawk formatting</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_02_02" title="2.2. Formatting fields">Section 2.2, &#8220;Formatting fields&#8221;</a></p></dd><dt><a name="index-gloss-gawkscripts"></a><span class="glossterm">gawk scripts</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_02_05" title="2.5. Gawk scripts">Section 2.5, &#8220;Gawk scripts&#8221;</a></p></dd><dt><a name="index-gloss-gawkvars"></a><span class="glossterm">gawk variables</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_03" title="3. Gawk variables">Section 3, &#8220;Gawk variables&#8221;</a></p></dd><dt><a name="index-gloss-gedit"></a><span class="glossterm">gedit</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_01" title="1.1. Writing and naming">Section 1.1, &#8220;Writing and naming&#8221;</a></p></dd><dt><a name="index-gloss-globalvars"></a><span class="glossterm">global variables</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_01_01" title="2.1.1. Global variables">Section 2.1.1, &#8220;Global variables&#8221;</a></p></dd><dt><a name="index-gloss-globbing"></a><span class="glossterm">globbing</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_03_02" title="3.2. Debugging on part(s) of the script">Section 3.2, &#8220;Debugging on part(s) of the script&#8221;</a></p></dd><dt><a name="index-gloss-grep"></a><span class="glossterm">grep</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_02_01" title="2.1. What is grep?">Section 2.1, &#8220;What is grep?&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">H</h3><dl><dt><a name="index-gloss-heredoc"></a><span class="glossterm">here document</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_02_04_04" title="2.4.4. Here documents">Section 2.4.4, &#8220;<span class="emphasis"><em>Here</em></span> documents&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">I</h3><dl><dt><a name="index-gloss-if"></a><span class="glossterm">if</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_01_01" title="1.1. General">Section 1.1, &#8220;General&#8221;</a></p></dd><dt><a name="index-gloss-init"></a><span class="glossterm">init</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_03_01" title="3.1. General">Section 3.1, &#8220;General&#8221;</a>, <a class="xref" href="#sect_01_05_06" title="5.6. Example init script">Section 5.6, &#8220;Example init script&#8221;</a></p></dd><dt><a name="index-gloss-initfiles"></a><span class="glossterm">initialization files</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01" title="1. Shell initialization files">Section 1, &#8220;Shell initialization files&#8221;</a></p></dd><dt><a name="index-gloss-awkfieldsep"></a><span class="glossterm">input field separator</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_04_01" title="2.4.1. Bourne shell reserved variables">Section 2.4.1, &#8220;Bourne shell reserved variables&#8221;</a>, <a class="xref" href="#sect_03_02_05" title="2.5. Special parameters">Section 2.5, &#8220;Special parameters&#8221;</a>, <a class="xref" href="#sect_06_03" title="3. Gawk variables">Section 3, &#8220;Gawk variables&#8221;</a></p></dd><dt><a name="index-gloss-interactiveedit"></a><span class="glossterm">interactive editing</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_05_02" title="2. Interactive editing">Section 2, &#8220;Interactive editing&#8221;</a></p></dd><dt><a name="index-gloss-interactivescripts"></a><span class="glossterm">interactive scripts</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_01" title="1. Displaying user messages">Section 1, &#8220;Displaying user messages&#8221;</a></p></dd><dt><a name="index-gloss-interactive"></a><span class="glossterm">interactive shell</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_02_02_01" title="2.2.2.1. Invoked as an interactive login shell, or with `--login'">Section 2.2.2.1, &#8220;Invoked as an interactive login shell, or with `--login'&#8221;</a>, <a class="xref" href="#sect_01_02_02_02_02" title="2.2.2.2. Invoked as an interactive non-login shell">Section 2.2.2.2, &#8220;Invoked as an interactive non-login shell&#8221;</a>, <a class="xref" href="#sect_01_02_02_03_03" title="2.2.3.3. Interactive shell behavior">Section 2.2.3.3, &#8220;Interactive shell behavior&#8221;</a></p></dd><dt><a name="index-gloss-invocation"></a><span class="glossterm">invocation</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_02_01" title="2.2.1. Invocation">Section 2.2.1, &#8220;Invocation&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">J</h3><dl><dt><a name="index-gloss-"></a><span class="glossterm"></span></dt><dd class="glossdef"><p></p></dd></dl></div><div class="glossdiv"><h3 class="title">K</h3><dl><dt><a name="index-gloss-kill"></a><span class="glossterm">kill</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_12_01_02" title="1.2. Usage of signals with kill">Section 1.2, &#8220;Usage of signals with kill&#8221;</a></p></dd><dt><a name="index-gloss-killall"></a><span class="glossterm">killall</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_12_01_02" title="1.2. Usage of signals with kill">Section 1.2, &#8220;Usage of signals with kill&#8221;</a></p></dd><dt><a name="index-gloss-ksh"></a><span class="glossterm">ksh</span></dt><dd class="glossdef"><p>Korn shell, <a class="xref" href="#sect_01_01_02" title="1.2. Shell types">Section 1.2, &#8220;Shell types&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">L</h3><dl><dt><a name="index-gloss-length"></a><span class="glossterm">length of a variable</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_10_03_02" title="3.2. Length of a variable">Section 3.2, &#8220;Length of a variable&#8221;</a></p></dd><dt><a name="index-gloss-lineanchor"></a><span class="glossterm">line anchors</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_02_02_01" title="2.2.1. Line and word anchors">Section 2.2.1, &#8220;Line and word anchors&#8221;</a></p></dd><dt><a name="index-gloss-locale"></a><span class="glossterm">locale</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_03_06" title="3.6. Locales">Section 3.6, &#8220;Locales&#8221;</a></p></dd><dt><a name="index-gloss-locate"></a><span class="glossterm">locate</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_01" title="1.1. Writing and naming">Section 1.1, &#8220;Writing and naming&#8221;</a></p></dd><dt><a name="index-gloss-logic"></a><span class="glossterm">logic flow</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_05_04" title="5.4. A word on order and logic">Section 5.4, &#8220;A word on order and logic&#8221;</a></p></dd><dt><a name="index-gloss-loginshell"></a><span class="glossterm">login shell</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_02_02_01" title="2.2.2.1. Invoked as an interactive login shell, or with `--login'">Section 2.2.2.1, &#8220;Invoked as an interactive login shell, or with `--login'&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">M</h3><dl><dt><a name="index-gloss-menu"></a><span class="glossterm">menu</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_06" title="6. Making menus with the select built-in">Section 6, &#8220;Making menus with the select built-in&#8221;</a></p></dd><dt><a name="index-gloss-metachars"></a><span class="glossterm">metacharacters</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_01_02" title="1.2. Regular expression metacharacters">Section 1.2, &#8220;Regular expression metacharacters&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">N</h3><dl><dt><a name="index-gloss-nestedifs"></a><span class="glossterm">nested if statements</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_02_03" title="2.3. Nested if statements">Section 2.3, &#8220;Nested if statements&#8221;</a></p></dd><dt><a name="index-gloss-noglob"></a><span class="glossterm">noglob</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_03_02" title="3.2. Debugging on part(s) of the script">Section 3.2, &#8220;Debugging on part(s) of the script&#8221;</a></p></dd><dt><a name="index-gloss-non-interactive-edit"></a><span class="glossterm">non-interactive editing</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_05_03" title="3. Non-interactive editing">Section 3, &#8220;Non-interactive editing&#8221;</a></p></dd><dt><a name="index-gloss-non-interactive"></a><span class="glossterm">non-interactive shell</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_02_02_03" title="2.2.2.3. Invoked non-interactively">Section 2.2.2.3, &#8220;Invoked non-interactively&#8221;</a></p></dd><dt><a name="index-gloss-non-login"></a><span class="glossterm">non-login shell</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_02_02_02" title="2.2.2.2. Invoked as an interactive non-login shell">Section 2.2.2.2, &#8220;Invoked as an interactive non-login shell&#8221;</a></p></dd><dt><a name="index-gloss-numcomp"></a><span class="glossterm">numeric comparisons</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_01_02_02" title="1.2.2. Numeric comparisons">Section 1.2.2, &#8220;Numeric comparisons&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">O</h3><dl><dt><a name="index-gloss-options"></a><span class="glossterm">options</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_06_01" title="6.1. Displaying options">Section 6.1, &#8220;Displaying options&#8221;</a></p></dd><dt><a name="index-gloss-outsep"></a><span class="glossterm">output field separator</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_03_02_01" title="3.2.1. The output field separator">Section 3.2.1, &#8220;The output field separator&#8221;</a></p></dd><dt><a name="index-gloss-outrecsep"></a><span class="glossterm">output record separator</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_06_03_02_02" title="3.2.2. The output record separator">Section 3.2.2, &#8220;The output record separator&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">P</h3><dl><dt><a name="index-gloss-paramexpand"></a><span class="glossterm">parameter expansion</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_04" title="4.5. Command substitution">Section 4.5, &#8220;Command substitution&#8221;</a></p></dd><dt><a name="index-gloss-path"></a><span class="glossterm">PATH</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_02" title="1.2. script1.sh">Section 1.2, &#8220;script1.sh&#8221;</a></p></dd><dt><a name="index-gloss-patmatch"></a><span class="glossterm">pattern matching</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_03" title="3. Pattern matching using Bash features">Section 3, &#8220;Pattern matching using Bash features&#8221;</a></p></dd><dt><a name="index-gloss-positionalparams"></a><span class="glossterm">positionalparams</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_05" title="2.5. Special parameters">Section 2.5, &#8220;Special parameters&#8221;</a>, <a class="xref" href="#sect_11_01_03" title="1.3. Positional parameters in functions">Section 1.3, &#8220;Positional parameters in functions&#8221;</a></p></dd><dt><a name="index-gloss-posix"></a><span class="glossterm">POSIX</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_01" title="2.1. Bash is the GNU shell">Section 2.1, &#8220;Bash is the GNU shell&#8221;</a></p></dd><dt><a name="index-gloss-posixmode"></a><span class="glossterm">POSIX mode</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_02_02_05" title="2.2.2.5. POSIX mode">Section 2.2.2.5, &#8220;POSIX mode&#8221;</a></p></dd><dt><a name="index-gloss-primexps"></a><span class="glossterm">primary expressions</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_01_01_01" title="1.1.1. Expressions used with if">Section 1.1.1, &#8220;Expressions used with if&#8221;</a></p></dd><dt><a name="index-gloss-printenv"></a><span class="glossterm">printenv</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_01_01" title="2.1.1. Global variables">Section 2.1.1, &#8220;Global variables&#8221;</a></p></dd><dt><a name="index-gloss-printf"></a><span class="glossterm">printf</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_05_05" title="5.5. An example Bash script: mysystem.sh">Section 5.5, &#8220;An example Bash script: mysystem.sh&#8221;</a>, <a class="xref" href="#sect_06_03_06" title="3.6. The printf program">Section 3.6, &#8220;The printf program&#8221;</a></p></dd><dt><a name="index-gloss-processsubst"></a><span class="glossterm">process substitution</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_07" title="4.8. Word splitting">Section 4.8, &#8220;Word splitting&#8221;</a></p></dd><dt><a name="index-gloss-profile"></a><span class="glossterm">.profile</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01_02_03" title="1.2.3. ~/.profile">Section 1.2.3, &#8220;~/.profile&#8221;</a></p></dd><dt><a name="index-gloss-prompt"></a><span class="glossterm">prompt</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_01_03" title="1.3. Changing shell configuration files">Section 1.3, &#8220;Changing shell configuration files&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">Q</h3><dl><dt><a name="index-gloss-quoting"></a><span class="glossterm">quoting characters</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_03" title="3. Quoting characters">Section 3, &#8220;Quoting characters&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">R</h3><dl><dt><a name="index-gloss-redirection"></a><span class="glossterm">redirection</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_04_01_07" title="4.1.7. Executing commands">Section 4.1.7, &#8220;Executing commands&#8221;</a>, <a class="xref" href="#sect_03_06_02" title="6.2. Changing options">Section 6.2, &#8220;Changing options&#8221;</a>, <a class="xref" href="#sect_08_02_03" title="2.3. Redirection and file descriptors">Section 2.3, &#8220;Redirection and file descriptors&#8221;</a>, <a class="xref" href="#sect_09_04" title="4. I/O redirection and loops">Section 4, &#8220;I/O redirection and loops&#8221;</a></p></dd><dt><a name="index-gloss-restricted"></a><span class="glossterm">rbash</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_02_10" title="2.2.10. The restricted shell">Section 2.2.10, &#8220;The restricted shell&#8221;</a></p></dd><dt><a name="index-gloss-read"></a><span class="glossterm">read</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_02_01" title="2.1. Using the read built-in command">Section 2.1, &#8220;Using the read built-in command&#8221;</a></p></dd><dt><a name="index-gloss-readonly"></a><span class="glossterm">readonly</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_10_01_03" title="1.3. Constants">Section 1.3, &#8220;Constants&#8221;</a></p></dd><dt><a name="index-gloss-regexpops"></a><span class="glossterm">regular expression operators</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_01_02" title="1.2. Regular expression metacharacters">Section 1.2, &#8220;Regular expression metacharacters&#8221;</a>, <a class="xref" href="#sect_05_02" title="2. Interactive editing">Section 2, &#8220;Interactive editing&#8221;</a>, <a class="xref" href="#sect_06_02_04" title="2.4. Special patterns">Section 2.4, &#8220;Special patterns&#8221;</a></p></dd><dt><a name="index-gloss-regexps"></a><span class="glossterm">regular expressions</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_01" title="1. Regular expressions">Section 1, &#8220;Regular expressions&#8221;</a></p></dd><dt><a name="index-gloss-remoteinvocation"></a><span class="glossterm">remote invocation</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_02_02_02_06" title="2.2.2.6. Invoked remotely">Section 2.2.2.6, &#8220;Invoked remotely&#8221;</a></p></dd><dt><a name="index-gloss-rmalias"></a><span class="glossterm">removing aliases</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_05_02" title="5.2. Creating and removing aliases">Section 5.2, &#8220;Creating and removing aliases&#8221;</a></p></dd><dt><a name="index-gloss-reservedvars"></a><span class="glossterm">reserved variables</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_04" title="2.4. Reserved variables">Section 2.4, &#8220;Reserved variables&#8221;</a></p></dd><dt><a name="index-gloss-return"></a><span class="glossterm">return</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_11_01_03" title="1.3. Positional parameters in functions">Section 1.3, &#8220;Positional parameters in functions&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">S</h3><dl><dt><a name="index-gloss-sed"></a><span class="glossterm">sed</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_05_01" title="1. Introduction">Section 1, &#8220;Introduction&#8221;</a></p></dd><dt><a name="index-gloss-sedcmds"></a><span class="glossterm">sed editing commands</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_05_01_02" title="1.2. sed commands">Section 1.2, &#8220;sed commands&#8221;</a></p></dd><dt><a name="index-gloss-sedopts"></a><span class="glossterm">sed options</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_05_01_02" title="1.2. sed commands">Section 1.2, &#8220;sed commands&#8221;</a></p></dd><dt><a name="index-gloss-sedscript"></a><span class="glossterm">sed script</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_05_03_02" title="3.2. Writing output files">Section 3.2, &#8220;Writing output files&#8221;</a></p></dd><dt><a name="index-gloss-select"></a><span class="glossterm">select</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_06" title="6. Making menus with the select built-in">Section 6, &#8220;Making menus with the select built-in&#8221;</a></p></dd><dt><a name="index-gloss-set"></a><span class="glossterm">set</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_01_02" title="2.1.2. Local variables">Section 2.1.2, &#8220;Local variables&#8221;</a>, <a class="xref" href="#sect_03_06_01" title="6.1. Displaying options">Section 6.1, &#8220;Displaying options&#8221;</a>, <a class="xref" href="#sect_11_01_04" title="1.4. Displaying functions">Section 1.4, &#8220;Displaying functions&#8221;</a></p></dd><dt><a name="index-gloss-shift"></a><span class="glossterm">shift</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_07" title="7. The shift built-in">Section 7, &#8220;The shift built-in&#8221;</a></p></dd><dt><a name="index-gloss-signals"></a><span class="glossterm">signals</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_12_01_01" title="1.1. Introduction">Section 1.1, &#8220;Introduction&#8221;</a></p></dd><dt><a name="index-gloss-singlequotes"></a><span class="glossterm">single quotes</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_03_03" title="3.3. Single quotes">Section 3.3, &#8220;Single quotes&#8221;</a></p></dd><dt><a name="index-gloss-source"></a><span class="glossterm">source</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_03" title="1.3. Executing the script">Section 1.3, &#8220;Executing the script&#8221;</a></p></dd><dt><a name="index-gloss-specialparams"></a><span class="glossterm">special parameters</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_05" title="2.5. Special parameters">Section 2.5, &#8220;Special parameters&#8221;</a></p></dd><dt><a name="index-gloss-specialvars"></a><span class="glossterm">special variables</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_05" title="2.5. Special parameters">Section 2.5, &#8220;Special parameters&#8221;</a></p></dd><dt><a name="index-gloss-stderr"></a><span class="glossterm">standard error</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_02_03_01" title="2.3.1. General">Section 2.3.1, &#8220;General&#8221;</a></p></dd><dt><a name="index-gloss-stdin"></a><span class="glossterm">standard input</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_02_03_01" title="2.3.1. General">Section 2.3.1, &#8220;General&#8221;</a></p></dd><dt><a name="index-gloss-stdout"></a><span class="glossterm">standard output</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_02_03_01" title="2.3.1. General">Section 2.3.1, &#8220;General&#8221;</a></p></dd><dt><a name="index-gloss-stringcomp"></a><span class="glossterm">string comparisons</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_01_02_03" title="1.2.3. String comparisons">Section 1.2.3, &#8220;String comparisons&#8221;</a></p></dd><dt><a name="index-gloss-stty"></a><span class="glossterm">stty</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_12_01_01" title="1.1. Introduction">Section 1.1, &#8220;Introduction&#8221;</a></p></dd><dt><a name="index-gloss-submenu"></a><span class="glossterm">submenu</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_06_02" title="6.2. Submenus">Section 6.2, &#8220;Submenus&#8221;</a></p></dd><dt><a name="index-gloss-subshell"></a><span class="glossterm">subshell</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_02_01" title="2.1. Which shell will run the script?">Section 2.1, &#8220;Which shell will run the script?&#8221;</a></p></dd><dt><a name="index-gloss-substitution"></a><span class="glossterm">substitution</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_10_03_03_01" title="3.3.1. Substitution">Section 3.3.1, &#8220;Substitution&#8221;</a>, <a class="xref" href="#sect_10_03_03_03" title="3.3.3. Replacing parts of variable names">Section 3.3.3, &#8220;Replacing parts of variable names&#8221;</a></p></dd><dt><a name="index-gloss-substring"></a><span class="glossterm">substring</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_10_03_03_02" title="3.3.2. Removing substrings">Section 3.3.2, &#8220;Removing substrings&#8221;</a></p></dd><dt><a name="index-gloss-syntax"></a><span class="glossterm">syntax</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_04_01_01" title="4.1.1. Shell syntax">Section 4.1.1, &#8220;Shell syntax&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">T</h3><dl><dt><a name="index-gloss-tcsh"></a><span class="glossterm">tcsh</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_01_02" title="1.2. Shell types">Section 1.2, &#8220;Shell types&#8221;</a></p></dd><dt><a name="index-gloss-terminology"></a><span class="glossterm">terminology</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_01_05_03" title="5.3. Terminology">Section 5.3, &#8220;Terminology&#8221;</a></p></dd><dt><a name="index-gloss-then"></a><span class="glossterm">then</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_07_01_01_02" title="1.1.2. Commands following the then statement">Section 1.1.2, &#8220;Commands following the then statement&#8221;</a></p></dd><dt><a name="index-gloss-tilde-expand"></a><span class="glossterm">tilde expansion</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_03" title="4.4. Shell parameter and variable expansion">Section 4.4, &#8220;Shell parameter and variable expansion&#8221;</a></p></dd><dt><a name="index-gloss-transformations"></a><span class="glossterm">transformation of variables</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_10_03_03" title="3.3. Transformations of variables">Section 3.3, &#8220;Transformations of variables&#8221;</a></p></dd><dt><a name="index-gloss-traps"></a><span class="glossterm">traps</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_12_02_01" title="2.1. General">Section 2.1, &#8220;General&#8221;</a></p></dd><dt><a name="index-gloss-true"></a><span class="glossterm">true</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_02_02_02" title="2.2.2. Nested while loops">Section 2.2.2, &#8220;Nested while loops&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">U</h3><dl><dt><a name="index-gloss-unalias"></a><span class="glossterm">unalias</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_05_01" title="5.1. What are aliases?">Section 5.1, &#8220;What are aliases?&#8221;</a>, <a class="xref" href="#sect_03_05_02" title="5.2. Creating and removing aliases">Section 5.2, &#8220;Creating and removing aliases&#8221;</a></p></dd><dt><a name="index-gloss-unset"></a><span class="glossterm">unset</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02_02" title="2.2. Creating variables">Section 2.2, &#8220;Creating variables&#8221;</a>, <a class="xref" href="#sect_10_02_03" title="2.3. Deleting array variables">Section 2.3, &#8220;Deleting array variables&#8221;</a>, <a class="xref" href="#sect_11_01_04" title="1.4. Displaying functions">Section 1.4, &#8220;Displaying functions&#8221;</a></p></dd><dt><a name="index-gloss-until"></a><span class="glossterm">until</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_03" title="3. The until loop">Section 3, &#8220;The until loop&#8221;</a></p></dd><dt><a name="index-gloss-userinput"></a><span class="glossterm">user input</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_02_01" title="2.1. Using the read built-in command">Section 2.1, &#8220;Using the read built-in command&#8221;</a>, <a class="xref" href="#sect_08_02_02" title="2.2. Prompting for user input">Section 2.2, &#8220;Prompting for user input&#8221;</a></p></dd><dt><a name="index-gloss-usermsgs"></a><span class="glossterm">user messages</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_08_01_01" title="1.1. Interactive or not?">Section 1.1, &#8220;Interactive or not?&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">V</h3><dl><dt><a name="index-gloss-variables"></a><span class="glossterm">variables</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_02" title="2. Variables">Section 2, &#8220;Variables&#8221;</a>, <a class="xref" href="#sect_10_01" title="1. Types of variables">Section 1, &#8220;Types of variables&#8221;</a></p></dd><dt><a name="index-gloss-varexpand"></a><span class="glossterm">variable expansion</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_04" title="4.5. Command substitution">Section 4.5, &#8220;Command substitution&#8221;</a></p></dd><dt><a name="index-gloss-verbose"></a><span class="glossterm">verbose</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_03_02" title="3.2. Debugging on part(s) of the script">Section 3.2, &#8220;Debugging on part(s) of the script&#8221;</a></p></dd><dt><a name="index-gloss-vim"></a><span class="glossterm">vi(m)</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_01" title="1.1. Writing and naming">Section 1.1, &#8220;Writing and naming&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">W</h3><dl><dt><a name="index-gloss-wait"></a><span class="glossterm">wait</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_12_02_02" title="2.2. How Bash interprets traps">Section 2.2, &#8220;How Bash interprets traps&#8221;</a></p></dd><dt><a name="index-gloss-whereis"></a><span class="glossterm">whereis</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_01" title="1.1. Writing and naming">Section 1.1, &#8220;Writing and naming&#8221;</a></p></dd><dt><a name="index-gloss-which"></a><span class="glossterm">which</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_01_01" title="1.1. Writing and naming">Section 1.1, &#8220;Writing and naming&#8221;</a></p></dd><dt><a name="index-gloss-while"></a><span class="glossterm">while</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_09_02" title="2. The while loop">Section 2, &#8220;The while loop&#8221;</a></p></dd><dt><a name="index-gloss-wildcards"></a><span class="glossterm">wildcards</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_02_02_04" title="2.2.3. Wildcards">Section 2.2.3, &#8220;Wildcards&#8221;</a></p></dd><dt><a name="index-gloss-wordanchor"></a><span class="glossterm">word anchors</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_04_02_02_01" title="2.2.1. Line and word anchors">Section 2.2.1, &#8220;Line and word anchors&#8221;</a></p></dd><dt><a name="index-gloss-wordsplit"></a><span class="glossterm">word splitting</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_03_04_08" title="4.9. File name expansion">Section 4.9, &#8220;File name expansion&#8221;</a></p></dd></dl></div><div class="glossdiv"><h3 class="title">X</h3><dl><dt><a name="index-gloss-xtrace"></a><span class="glossterm">xtrace</span></dt><dd class="glossdef"><p><a class="xref" href="#sect_02_03_01" title="3.1. Debugging on the entire script">Section 3.1, &#8220;Debugging on the entire script&#8221;</a>, <a class="xref" href="#sect_02_03_02" title="3.2. Debugging on part(s) of the script">Section 3.2, &#8220;Debugging on part(s) of the script&#8221;</a></p></dd></dl></div></div></div></body></html>
