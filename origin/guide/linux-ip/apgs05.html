<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>5. tcpdump</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="linux, ip, iproute2, ifconfig, firewall, ARP, NAT, route, routing, route selection, routing selection, network administration"><link rel="home" href="index.html" title="Guide to IP Layer Network Administration with Linux"><link rel="up" href="apg.html" title="Appendix G. Diagnostic Tools"><link rel="prev" href="apgs04.html" title="4. netstat"><link rel="next" href="apgs06.html" title="6. tcpflow"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5. <span class="command"><strong>tcpdump</strong></span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="apgs04.html">Prev</a> </td><th width="60%" align="center">Appendix G. Diagnostic Tools</th><td width="20%" align="right"> <a accesskey="n" href="apgs06.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tools-tcpdump"></a>5. <span class="command"><strong>tcpdump</strong></span></h2></div></div></div><p>
        The <span class="command"><strong>tcpdump</strong></span> utility is a not as friendly as some
        other network diagnostic tools.  Some of the output is 
      </p><p>
      </p><p>
        This is a good time to mention that tcpdump can capture and store
        packet flows for consumption at a later date.  Frequently, you may
        find yourself without a top-notch packet analysis utility such as
        <a class="ulink" href="http://www.ethereal.com/" target="_top"><span class="command"><strong>ethereal</strong></span></a>.
        Fortunately, you can
        <a class="link" href="apgs05.html#ex-tools-tcpdump-file-write" title="Example G.25. Writing tcpdump data to a file">create tcpdump data
        files</a> and view them with a tool such as
        <span class="command"><strong>ethereal</strong></span>.  Even if a stream analysis tool is not
        available, the
        <a class="ulink" href="http://www.ethereal.com/docs/user-guide/" target="_top">documentation
        for <span class="command"><strong>ethereal</strong></span></a> is tremendously helpful in
        packet analysis.
      </p><p>
        
      </p><p>
      </p><p>
      </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tools-tcpdump-arp"></a>5.1. Using <span class="command"><strong>tcpdump</strong></span> to view ARP messages</h3></div></div></div><p>
        </p><p>
        </p><p>
        </p><div class="example"><a name="ex-tools-tcpdump-arp-broadcast"></a><p class="title"><b>Example G.16. Viewing an ARP broadcast request and reply with 
            <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p><div class="example"><a name="ex-tools-tcpdump-arp-gratuitous"></a><p class="title"><b>Example G.17. Viewing a gratuitous ARP packet with 
            <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p><div class="example"><a name="ex-tools-tcpdump-arp-unicast"></a><p class="title"><b>Example G.18. Viewing unicast ARP packets with 
            <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p><p>
        </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tools-tcpdump-unreach"></a>5.2. Using <span class="command"><strong>tcpdump</strong></span> to see ICMP unreachable
          messages</h3></div></div></div><p>
        </p><div class="example"><a name="ex-tools-tcpdump-unreach-port"></a><p class="title"><b>Example G.19. <span class="command">tcpdump</span> reporting port unreachable</b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p><div class="example"><a name="ex-tools-tcpdump-unreach-host"></a><p class="title"><b>Example G.20. <span class="command">tcpdump</span> reporting host unreachable</b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p><p>
        </p><div class="example"><a name="ex-tools-tcpdump-unreach-net"></a><p class="title"><b>Example G.21. <span class="command">tcpdump</span> reporting net unreachable</b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p><p>
        </p><p>
        </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tools-tcpdump-tcp"></a>5.3. Using <span class="command"><strong>tcpdump</strong></span> to watch TCP sessions</h3></div></div></div><p>
        </p><p>
        </p><p>
        </p><div class="example"><a name="ex-tools-tcpdump-tcp-windows"></a><p class="title"><b>Example G.22. Monitoring TCP window sizes with
            <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p><p>
        </p><div class="example"><a name="ex-tools-tcpdump-tcp-flags"></a><p class="title"><b>Example G.23. Examining TCP flags with <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p><div class="example"><a name="ex-tools-tcpdump-tcp-ack"></a><p class="title"><b>Example G.24. Examining TCP acknowledgement numbers with
            <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><p>
        </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tools-tcpdump-file"></a>5.4. Reading and writing <span class="command"><strong>tcpdump</strong></span> data</h3></div></div></div><p>
        </p><div class="example"><a name="ex-tools-tcpdump-file-write"></a><p class="title"><b>Example G.25. Writing <span class="command">tcpdump</span> data to a file</b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><div class="example"><a name="ex-tools-tcpdump-file-read"></a><p class="title"><b>Example G.26. Reading <span class="command">tcpdump</span> data from a file</b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><div class="example"><a name="ex-tools-tcpdump-file-line-buffer"></a><p class="title"><b>Example G.27. Causing <span class="command">tcpdump</span> to use a line buffer</b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tools-tcpdump-frag"></a>5.5. Understanding fragmentation as reported by
          <span class="command"><strong>tcpdump</strong></span></h3></div></div></div><p>
        </p><div class="example"><a name="ex-tools-tcpdump-frag"></a><p class="title"><b>Example G.28. Understanding fragmentation as reported by
            <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tools-tcpdump-other"></a>5.6. Other options to the <span class="command"><strong>tcpdump</strong></span> command</h3></div></div></div><p>
        </p><div class="example"><a name="ex-tools-tcpdump-interface"></a><p class="title"><b>Example G.29. Specifying interface with <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p><div class="example"><a name="ex-tools-tcpdump-timestamp"></a><p class="title"><b>Example G.30. Timestamp related options to <span class="command">tcpdump</span></b></p><div class="example-contents"><pre class="programlisting">
<code class="prompt">[root@masq-gw]# </code><strong class="userinput"><code></code></strong>
<code class="computeroutput">
</code>
          </pre></div></div><br class="example-break"><p>
        </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="apgs04.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="apg.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="apgs06.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">4. <span class="command"><strong>netstat</strong></span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 6. <span class="command"><strong>tcpflow</strong></span></td></tr></table></div></body></html>
