<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>8. Failover and Failback of a private container on Linux-HA</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="EVMS User Guide"><link rel="up" href="ch14.html" title="Chapter 14. Clustering operations"><link rel="prev" href="ch14s07.html" title="7. Deleting a cluster container"><link rel="next" href="ch14s09.html" title="9. Remote configuration management"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">8. Failover and Failback of a private container on Linux-HA</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch14s07.html">Prev</a> </td><th width="60%" align="center">Chapter 14. Clustering operations</th><td width="20%" align="right"> <a accesskey="n" href="ch14s09.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm2853"></a>8. Failover and Failback of a private container on Linux-HA</h2></div></div></div><p>EVMS supports the Linux-HA cluster manager in EVMS V2.0 and later.  Support for 
the RSCT cluster
manager is also available as of EVMS V2.1, but is not as widely tested.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">NOTE</h3><p>Ensure that <span class="command"><strong>evms_activate</strong></span> is called in one of the startup scripts
before the <span class="command"><strong>heartbeat</strong></span> startup script is called. If <span class="command"><strong>evms_activate</strong></span> is not called, failover
might not work correctly. </p></div><p>Follow these steps to set up failover and failback of a private container:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Add an entry in <code class="filename">/etc/ha.d/haresources</code> for each 
private container to be failed over.  For example, if <code class="filename">container1</code> and 
<code class="filename">container2</code> are to
be failed over together to the same node with <code class="filename">node1</code> as the owning node, add the
following entry to <code class="filename">/etc/ha.d/haresources</code>:</p><pre class="programlisting">node1 evms_failover::container1 evms_failover::container2</pre><p><code class="filename">node1</code> is the cluster node that owns this resource.  The resource is failed over
to the other node when <code class="filename">node1</code> dies.</p><p>Similarly, if <code class="filename">container3</code> and <code class="filename">container4</code> are to be failed over together to the same
node with <code class="filename">node2</code> as the owning node, then add the following entry to 
<code class="filename">/etc/ha.d/haresources</code>:</p><pre class="programlisting">node2 evms_failover::container3 evms_failover::container4</pre><p>Refer to 
<a class="ulink" href="http://www.linux-ha.org/download/GettingStarted.html" target="_top">http://www.linux-ha.org/download/GettingStarted.html</a> for more details on the
semantics of resource groups.</p></li><li class="listitem"><p>Validate that the <code class="filename">/etc/ha.d</code>, <code class="filename">/etc/ha.cf</code> and <code class="filename">/etc/ha.d/haresources</code> files are the same
on all the nodes of the cluster.</p></li><li class="listitem"><p>The heartbeat cluster manager must be restarted, as follows, after the
<code class="filename">/etc/ha.d/haresources</code> file has been changed:</p><pre class="programlisting">/etc/init.d/heartbeat restart</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">NOTE</h3><p>
Do not add shared containers to the list of failover resources; doing so causes
EVMS to respond unpredictably.</p></div></li></ol></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch14s07.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch14.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch14s09.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">7. Deleting a cluster container </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 9. Remote configuration management</td></tr></table></div></body></html>
