<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>4. Remote execution of applications</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="Linux, Beginners, linux, start, Getting started, guide, Guide, Exercises, exercises"><link rel="home" href="index.html" title="Introduction to Linux"><link rel="up" href="ch10.html" title="Chapter 10. Networking"><link rel="prev" href="ch10s03.html" title="3. Internet/Intranet applications"><link rel="next" href="ch10s05.html" title="5. Security"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. Remote execution of applications</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10s03.html">Prev</a> </td><th width="60%" align="center">Chapter 10. Networking</th><td width="20%" align="right"> <a accesskey="n" href="ch10s05.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sect_10_05"></a>4. Remote execution of applications</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_05_01"></a>4.1. Introduction</h3></div></div></div><p>There are a couple of different ways to execute commands or run programs on a remote<a class="indexterm" name="idm10685"></a> machine and have the output, be it text or graphics, sent to your workstation.  The connections<a class="indexterm" name="idm10688"></a> can be secure or insecure.  While it is of course advised to use secure connections instead of transporting your password over the network unencrypted, we will discuss some practical applications of the older (unsafe) mechanisms, as they are still useful in a modern networked environment, such as for troubleshooting or running exotic programs.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_05_02"></a>4.2. Rsh, rlogin and telnet</h3></div></div></div><p>The <span class="command"><strong>rlogin<a class="indexterm" name="idm10695"></a></strong></span> and <span class="command"><strong>rsh<a class="indexterm" name="idm10698"></a></strong></span> commands for remote login and remote execution of commands are inherited from UNIX.  While seldom used because they are blatantly<a class="indexterm" name="idm10700"></a> insecure, they still come with almost every Linux distribution for backward compatibility with UNIX programs.</p><p>Telnet, on the other hand, is still commonly used, often by system and network administrators.  Telnet is one of the most powerful tools for remote access to files and remote administration, allowing connections from anywhere on the Internet.  Combined with an X server, remote graphical applications can be displayed locally.  There is no difference between working on the local machine and using the remote machine.</p><p>Because the entire connection<a class="indexterm" name="idm10705"></a> is unencrypted, allowing <span class="command"><strong>telnet<a class="indexterm" name="idm10709"></a></strong></span> connections involves taking high security risks.  For normal remote execution of programs, <span class="application">Secure SHell</span> or <span class="command"><strong>ssh<a class="indexterm" name="idm10713"></a></strong></span> is advised.  We will discuss the secure method later in this section.</p><p>However, <span class="command"><strong>telnet</strong></span> is still used in many cases.  Below are some examples in which a mail server and a web server are tested<a class="indexterm" name="idm10717"></a> for replies:</p><p>Checking that a mail server works:</p><pre class="screen">
<code class="prompt">[jimmy@blob ~]</code> <span class="command"><strong>telnet mailserver 25</strong></span>
Trying 192.168.42.1...
Connected to mailserver.
Escape character is '^]'.
220 m1.some.net ESMTP Sendmail 8.11.6/8.11.6; 200302281626
<span class="command"><strong>ehlo some.net</strong></span>
250-m1.some.net Hello blob.some.net [10.0.0.1], pleased to meet you
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-SIZE
250-DSN
250-ONEX
250-ETRN
250-XUSR
250 HELP
<span class="command"><strong>mail from: jimmy@some.net</strong></span>
250 2.1.0 jimmy@some.net... Sender ok
<span class="command"><strong>rcpt to: davy@some.net</strong></span>
250 2.1.5 davy@some.net... Recipient ok
<span class="command"><strong>data</strong></span>
354 Enter mail, end with "." on a line by itself
<span class="command"><strong>test</strong></span>
<span class="command"><strong>.</strong></span>
250 2.0.0 g2MA1R619237 Message accepted for delivery
<span class="command"><strong>quit</strong></span>
221 2.0.0 m1.some.net closing connection
Connection closed by foreign host.
</pre><p>Checking that a web server answers to basic requests:</p><pre class="screen">
<code class="prompt">[jimmy@blob ~]</code> <span class="command"><strong>telnet www.some.net 80</strong></span>
Trying 64.39.151.23...
Connected to www.some.net.
Escape character is '^]'.
<span class="command"><strong>HEAD / ;HTTP/1.1</strong></span>

HTTP/1.1 200 OK
Date: Fri, 22 Mar 2002 10:05:14 GMT
Server: Apache/1.3.22 (UNIX) (Red-Hat/Linux) 
 mod_ssl/2.8.5 OpenSSL/0.9.6
 DAV/1.0.2 PHP/4.0.6 mod_perl/1.24_01
Last-Modified: Fri, 04 Jan 2002 08:21:00 GMT
ETag: "70061-68-3c3565ec"
Accept-Ranges: bytes
Content-Length: 104
Connection: close
Content-Type: text/html

Connection closed by foreign host.

<code class="prompt">[jimmy@blob ~]</code>
</pre><p>This is perfectly safe, because you never have to give a username and/or password for getting the data you want, so nobody can snoop that important information off the cable.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_05_03"></a>4.3. The X Window System</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_05_03_01"></a>4.3.1. X features</h4></div></div></div><p>As we already explained in Chapter 7 (see <a class="xref" href="ch07s03.html#sect_07_03_03" title="3.3. X server configuration">Section 3.3, &#8220;X server configuration&#8221;</a>), the <span class="application">X Window<a class="indexterm" name="idm10745"></a></span> system comes with an X server which serves graphics to clients that need a display.</p><p>It is important to realize the distinction between the X server and the X client application(s).  The X server controls the display directly and is responsible for all input and output via keyboard, mouse and display.  The X client, on the other hand, does not access the input and output devices directly.  It communicates with the X server which handles input and output.  It is the X client which does the real work, like computing values, running applications and so forth.  The X server only opens windows to handle input and output for the specified client.</p><p>In normal operation (graphical mode), every Linux workstation is an X server to itself, even if it only runs client applications.  All the applications you are running (for example, <span class="application">Gimp</span>, a terminal window, your browser, your office application, your CD playing tool, and so on) are clients to your X server.  Server and client are running on the same machine in this case.</p><p>This client/server nature of the X system makes it an ideal environment for remote execution of applications and programs.  Because the process is actually being executed on the remote machine, very little CPU power is needed on the local host.  Such machines, purely acting as servers for X, are called X terminals and were once very popular.  More information may be found in the <a class="ulink" href="http://www.tldp.org/HOWTO/Remote-X-Apps.html" target="_top">Remote X applications mini-HOWTO</a>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_05_03_02"></a>4.3.2. Telnet and X</h4></div></div></div><p>If you would want to use <span class="command"><strong>telnet</strong></span> to display<a class="indexterm" name="idm10757"></a> graphical applications running on a remote machine, you first need to give the remote machine access to your display (to your X server!) using the <span class="command"><strong>xhost<a class="indexterm" name="idm10761"></a></strong></span> command, by typing a command similar to the one below in a terminal window on your local machine:</p><pre class="screen">
<code class="prompt">davy:~&gt;</code> <span class="command"><strong>xhost +remote.machine.com</strong></span>
</pre><p>After that, connect to the remote host and tell it to display graphics on the local machine by setting the environment variable <code class="varname">DISPLAY<a class="indexterm" name="idm10768"></a></code>:</p><pre class="screen">
<code class="prompt">[davy@remote ~]</code> <span class="command"><strong>export DISPLAY="local.host.com:0.0"</strong></span>
</pre><p>After completing this step, any application started in this terminal window will be displayed on your local desktop, using remote resources for computing, but your local graphical resources (your X server) for displaying the application.</p><p>This procedure assumes that you have some sort of X server (<span class="application">XFree86</span>, <span class="application">X.org</span>, <span class="application">Exceed</span>, <span class="application">Cygwin</span>) already set up on the machine where you want to display images.  The architecture and operating system of the client machine are not important as long as they allow you to run an X server on it.</p><p>Mind that displaying a terminal window from the remote machine is also considered to be a display of an image.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_05_04"></a>4.4. The SSH suite</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_05_04_01"></a>4.4.1. Introduction</h4></div></div></div><p>Most UNIX and Linux systems now run <span class="application">Secure SHell<a class="indexterm" name="idm10786"></a></span> in order to leave out the security<a class="indexterm" name="idm10789"></a> risks that came with <span class="command"><strong>telnet</strong></span>.  Most Linux systems will run a version of <span class="application">OpenSSH</span>, an Open Source implementation of the SSH protocol, providing secure encrypted communications between untrusted hosts over an untrusted network.  In the standard setup X connections are automatically forwarded, but arbitrary TCP/IP ports may also be forwarded using a secure channel.</p><p>The <span class="command"><strong>ssh<a class="indexterm" name="idm10796"></a></strong></span> client connects and logs into the specified host name.  The user must provide his identity to the remote machine as specified in the <code class="filename">sshd_config<a class="indexterm" name="idm10799"></a></code> file, which can usually be found in <code class="filename">/etc/ssh</code>.  The configuration file is rather self-explanatory and by defaults enables most common features.  Should you need help, you can find it in the <span class="command"><strong>sshd</strong></span> man pages.</p><p>When the user's identity has been accepted by the server, the server either executes the given command, or logs into the machine and gives the user a normal shell on the remote machine.  All communication with the remote command or shell will be automatically encrypted.</p><p>The session terminates when the command or shell on the remote machine exits and all X11 and TCP/IP connections have been closed.</p><p>When connecting to a host for the first time, using any of the programs that are included in the SSH collection, you need to establish the authenticity of that host and acknowledge<a class="indexterm" name="idm10806"></a> that you want to connect:</p><pre class="screen">
<code class="prompt">lenny ~&gt;</code> <span class="command"><strong>ssh blob</strong></span>
The authenticity of host 'blob (10.0.0.1)' can't be established.
RSA fingerprint is 18:30:50:46:ac:98:3c:93:1a:56:35:09:8d:97:e3:1d.
Are you sure you want to continue connecting (yes/no)? <span class="command"><strong>yes</strong></span>
Warning: Permanently added 'blob,192.168.30.2' (RSA) to the list of 
known hosts.
Last login: Sat Dec 28 13:29:19 2002 from octarine
This space for rent.

<code class="prompt">lenny is in ~</code>
</pre><p>It is important that you type <span class="quote">&#8220;<span class="quote">yes</span>&#8221;</span>, in three characters, not just <span class="quote">&#8220;<span class="quote">y</span>&#8221;</span>.  This edits your <code class="filename">~/.ssh/known_hosts</code> file, see <a class="xref" href="ch10s04.html#sect_10_03_04_03" title="4.4.3. Server authentication">Section 4.4.3, &#8220;Server authentication&#8221;</a>.</p><p>If you just want to check something on a remote machine and then get your prompt back on the local host, you can give the commands that you want to execute remotely as arguments to <span class="command"><strong>ssh</strong></span>:</p><pre class="screen">
<code class="prompt">lenny ~&gt;</code> <span class="command"><strong>ssh blob who</strong></span>
jenny@blob's password:
root     tty2         Jul 24 07:19
lena	 tty3         Jul 23 22:24
lena     0:	      Jul 25 22:03

<code class="prompt">lenny ~&gt;</code> <span class="command"><strong>uname -n</strong></span>
magrat.example.com
</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_05_04_02"></a>4.4.2. X11 and TCP forwarding</h4></div></div></div><p>If the <code class="varname">X11Forwarding<a class="indexterm" name="idm10830"></a></code> entry is set to <span class="emphasis"><em>yes</em></span> on the target machine and the user is using X applications, the <code class="varname">DISPLAY<a class="indexterm" name="idm10835"></a></code> environment variable is set, the connection to the X11 display is automatically forwarded to the remote side in such a way that any X11 programs started from the shell will go through the encrypted channel, and the connection to the real X server will be made from the local machine.  The user should not manually set <code class="varname">DISPLAY</code>.  Forwarding of X11 connections can be configured on the command line or in the <span class="command"><strong>sshd</strong></span> configuration file.</p><p>The value for <code class="varname">DISPLAY</code> set by <span class="command"><strong>ssh</strong></span> will point to the server machine, but with a display number greater than zero.  This is normal, and happens because <span class="command"><strong>ssh</strong></span> creates a <span class="emphasis"><em>proxy</em></span> X server on the server machine (that runs the X client application) for forwarding the connections over the encrypted channel.</p><p>This is all done automatically, so when you type in the name of a graphical application, it is displayed on your local machine and not on the remote host.  We use <span class="command"><strong>xclock</strong></span> in the example, since it is a small program which is generally installed and ideal for testing:</p><div class="figure"><a name="idm10846"></a><p class="title"><b>Figure 10.3. SSH X11 forwarding</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/ssh_X11.png" alt="SSH X11 forwarding"></div></div></div><br class="figure-break"><p>SSH will also automatically set up Xauthority data on the server machine.  For this purpose, it will generate a random authorization cookie, store it in <code class="filename">Xauthority<a class="indexterm" name="idm10855"></a></code> on the server, and verify that any forwarded connections carry this cookie and replace it by the real cookie when the connection is opened.  The real authentication cookie is never sent to the server machine (and no cookies are sent in the plain).</p><p>Forwarding of arbitrary TCP/IP connections over the secure channel can be specified either on the command line or in a configuration file.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">The X server</h3><p>This procedure assumes that you have a running X server on the client where you want to display the application from the remote host.  The client may be of different architecture and operating system than the remote host, as long as it can run an X server, such as <span class="application">Cygwin</span> (which implements an <span class="application">X.org</span> server for MS Windows clients and others) or <span class="application">Exceed</span>, it should be possible to set up a remote connection with any Linux or UNIX machine.</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_03_04_03"></a>4.4.3. Server authentication</h4></div></div></div><p>The <span class="command"><strong>ssh</strong></span> client/server system automatically maintains and checks a database containing identifications<a class="indexterm" name="idm10868"></a> for all hosts it has ever been used with.  Host keys are stored in <code class="filename">$HOME/.ssh/known_hosts</code> in the user's home directory.  Additionally, the file <code class="filename">/etc/ssh/ssh_known_hosts</code> is automatically checked for known hosts.  Any new hosts are automatically added to the user's file.  If a host's identification ever changes, <span class="command"><strong>ssh</strong></span> warns about this and disables password authentication to prevent a Trojan horse from getting the user's password.  Another purpose of this mechanism is to prevent man-in-the-middle attacks which could otherwise be used to circumvent the encryption.  In environments where high security is needed, <span class="command"><strong>sshd</strong></span> can even be configured to prevent logins to machines whose host keys have changed or are unknown.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_05_04_04"></a>4.4.4. Secure remote copying</h4></div></div></div><p>The SSH suite provides <span class="command"><strong>scp<a class="indexterm" name="idm10879"></a></strong></span> as a secure alternative to the <span class="command"><strong>rcp</strong></span> command that used to be popular when only <span class="command"><strong>rsh</strong></span> existed.  <span class="command"><strong>scp<a class="indexterm" name="idm10885"></a></strong></span> uses <span class="command"><strong>ssh</strong></span> for data transfer, uses the same authentication and provides the same security as <span class="command"><strong>ssh</strong></span>.  Unlike <span class="command"><strong>rcp</strong></span>, <span class="command"><strong>scp</strong></span> will ask for passwords or passphrases if they are needed for authentication<a class="indexterm" name="idm10891"></a>:</p><pre class="screen">
<code class="prompt">lenny /var/tmp&gt;</code> <span class="command"><strong>scp Schedule.sdc.gz blob:/var/tmp/</strong></span>
lenny@blob's password:
Schedule.sdc.gz  100% |*****************************| 100 KB 00:00

<code class="prompt">lenny /var/tmp&gt;</code>
</pre><p>Any file name may contain a host and user specification to indicate that the file is to be copied to/from that host.  Copies between two remote hosts are permitted.  See the Info pages for more information.</p><p>If you would rather use an FTP-like interface, use <span class="command"><strong>sftp</strong></span><a class="indexterm" name="idm10901"></a>:</p><pre class="screen">
<code class="prompt">lenny /var/tmp&gt;</code> <span class="command"><strong>sftp blob</strong></span>
Connecting to blob...
lenny@blob's password:

<code class="prompt">sftp&gt;</code> <span class="command"><strong>cd /var/tmp</strong></span>

<code class="prompt">sftp&gt;</code> <span class="command"><strong>get Sch*</strong></span>
Fetching /var/tmp/Schedule.sdc.gz to Schedule.sdc.gz

<code class="prompt">sftp&gt;</code> <span class="command"><strong>bye</strong></span>

<code class="prompt">lenny /var/tmp&gt;</code>
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Secure copy or FTP GUIs</h3><p>Don't feel comfortable with the command line yet?  Try <span class="application">Konqueror</span>'s capabilities for secure remote copy, or install <span class="application">Putty</span>.</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="sect_10_05_04_05"></a>4.4.5. Authentication keys</h4></div></div></div><p>The <span class="command"><strong>ssh-keygen<a class="indexterm" name="idm10923"></a></strong></span> command generates, manages and converts authentication<a class="indexterm" name="idm10925"></a> keys for <span class="command"><strong>ssh</strong></span>.  It can create RSA keys for use by SSH protocol version 1 and RSA or DSA keys for use by SSH protocol version 2.</p><p>Normally each user wishing to use SSH with RSA or DSA authentication runs this once to create the authentication key in <code class="filename">$HOME/.ssh/identity</code>, <code class="filename">id_dsa</code> or <code class="filename">id_rsa</code>.  Additionally, the system administrator may use this to generate host keys for the system.</p><p>Normally this program generates the key and asks for a file in which to store the private key.  The public key is stored in a file with the same name but <span class="emphasis"><em>.pub</em></span> appended.  The program also asks for a passphrase.  The passphrase may be empty to indicate no passphrase (host keys must have an empty passphrase), or it may be a string of arbitrary length.</p><p>There is no way to recover a lost passphrase.  If the passphrase is lost or forgotten, a new key must be generated and copied to the corresponding public keys.</p><p>We will study SSH keys in the exercises.  All information can be found in the man or <span class="application">Info</span> pages.</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_05_05"></a>4.5. VNC</h3></div></div></div><p>VNC or <span class="application">Virtual Network Computing</span> is in fact a remote display<a class="indexterm" name="idm10942"></a> system<a class="indexterm" name="idm10944"></a> which allows viewing a desktop environment not only on the local machine on which it is running, but from anywhere on the Internet and from a wide variety of machines and architectures, including MS Windows and several UNIX distributions.  You could, for example, run MS Word on a Windows NT machine and display the output on your Linux desktop.  VNC provides servers as well as clients, so the opposite also works and it may thus be used to display Linux programs on Windows clients.  VNC is probably the easiest way to have X connections on a PC.  The following features make VNC different from a normal X server or commercial implementations:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>No state is stored at the viewer side:  you can leave your desk and resume from another machine, continuing where you left.  When you are running a PC X server, and the PC crashes or is restarted, all remote applications that you were running will die.  With VNC, they keep on running.</p></li><li class="listitem"><p>It is small and simple, no installation needed, can be run from a floppy if needed.</p></li><li class="listitem"><p>Platform independent with the Java client, runs on virtually everything that supports X.</p></li><li class="listitem"><p>Sharable:  one desktop may be displayed on multiple viewers.</p></li><li class="listitem"><p>Free.</p></li></ul></div><p>More information can be found in the VNC client man pages (<span class="command"><strong>man <em class="parameter"><code>vncviewer</code></em></strong></span>) or on the <a class="ulink" href="http://www.realvnc.com/" target="_top">VNC website</a>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_05_06"></a>4.6. The rdesktop protocol</h3></div></div></div><p>In order to ease management of MS Windows hosts, recent Linux distributions support the Remote Desktop Protocol (RDP<a class="indexterm" name="idm10965"></a>), which is implemented in the <span class="command"><strong>rdesktop<a class="indexterm" name="idm10969"></a></strong></span> client.  The protocol<a class="indexterm" name="idm10971"></a> is used in a number of Microsoft products, including Windows NT Terminal Server, Windows 2000 Server, Windows XP and Windows 2003 Server.</p><p>Surprise your friends (or management) with the fullscreen mode, multiple types of keyboard layouts and single application mode, just like the real thing.  The <span class="command"><strong>man <em class="parameter"><code>rdesktop</code></em></strong></span> manual provides more information.  The project's homepage is at <a class="ulink" href="http://www.rdesktop.org/" target="_top">http://www.rdesktop.org/</a>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="sect_10_05_07"></a>4.7. Cygwin</h3></div></div></div><p><a class="ulink" href="http://www.cygwin.com" target="_top">Cygwin</a> provides<a class="indexterm" name="idm10982"></a> substantial UNIX functionality on MS Windows systems.  Apart from providing UNIX command line tools and graphical applications, it can also be used to display a Linux desktop on an MS Windows machine, using remote X.  From a <span class="application">Cygwin Bash<a class="indexterm" name="idm10986"></a></span> shell, type the command</p><div class="cmdsynopsis"><p><code class="command">/usr/X11R6/bin/XWin.exe <code class="option">-query</code> <em class="parameter"><code>your_linux_machine_name_or_IP</code></em></code> </p></div><p>The connection is by default denied.  You need to change the <span class="application">X Display Manager</span> (XDM) configuration and possibly the <span class="application">X Font Server</span> (XFS) configuration to enable this type of connection, where you get a login screen on the remote machine.  Depending on your desktop manager (<span class="application">Gnome</span>, <span class="application">KDE</span>, other), you might have to change some configurations there, too.</p><p>If you do not need to display the entire desktop, you can use SSH in <span class="application">Cygwin</span>, just like explained in <a class="xref" href="ch10s04.html#sect_10_05_04" title="4.4. The SSH suite">Section 4.4, &#8220;The SSH suite&#8221;</a>. without all the fuss of editing configuration files.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10s03.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch10.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch10s05.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">3. Internet/Intranet applications </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 5. Security</td></tr></table></div></body></html>
