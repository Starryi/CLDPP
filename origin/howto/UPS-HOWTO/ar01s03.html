<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>3. UPS Basics</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="UPS HOWTO"><link rel="up" href="index.html" title="UPS HOWTO"><link rel="prev" href="ar01s02.html" title="2. An Overview of Power Protection"><link rel="next" href="ar01s04.html" title="4. Testing Your UPS"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3. UPS Basics</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s02.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s04.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm142"></a>3. UPS Basics</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm144"></a>3.1. How To Select A UPS</h3></div></div></div><p>UPSes are nowadays very inexpensive.  In the U.S. in 2006, quite
capable ones are available for less than $100, and prices are heading
down.  In fact prices are so low now that we're not going to walk you through
the elaborate optimization step that would have been important
even two or three years ago, of estiming the watt dissipation of your
computer and matching it to a UPS rating.  Instead we'll explain
why this would be a waste of effort and how to buy in a simpler
and more effective way.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Bear in mind that the UPS systems that you're likely to buy in a
store or computer catalog are <span class="emphasis"><em>not</em></span> intended for safety
or life-critical equipment. These devices should be considered to be pieces
of consumer electronics. As such, the number-one basis on which most of these
devices compete with each other is on price, not quality.</p><p>Cost-effectiveness is more important to UPS vendors (because it
appears to be more important to their customers) than ultimate
reliability. If your life depends on computer uptime, you need a special
purpose, online, big, redundant, expensive system. These systems are beyond
the scope of this document. When you buy a UPS at your local computer
store, you are <span class="emphasis"><em>not</em></span> buying this sort of system.</p></div><p>UPSes are rated by the watts a full battery can put out before
it drains.  However, they are marketed using a VA (voltage-amps)
figure; often, consumer-grade UPSes don't even specify a wattage on
the box where you can see it.  This is because the VA figure is larger
and looks sexier.  As a rule of thumb. assume the wattage is half of
the VA rating; for an explanation of the complexities involved (if you
care) see the white paper <a class="ulink" href="http://sturgeon.apcc.com/whitepapers.nsf/URL/WP-17/%24FILE/WP17.pdf" target="_top">Understanding
Power Factor, Crest Factor, and Surge Factor</a> on the APC
website.</p><p>But even if you know the watt rating of the UPS, it is the ratio of
that figure with the wattage dissipation of your computer that
controls the dwell time.  Your dissipation is hard to predict; it can
even be effected by things like the size of monitor you use (big ones
can be quite power-hungry).</p><p>Manufacturers try to get around this technical thicket by
putting an expected dwell time on the box.  But they exaggerate and
even lie about their dwell times a lot (this is called
<span class="quote">&#8220;<span class="quote">marketing</span>&#8221;</span>).  What they'll do is quote you the dwell
time you would get driving a bare minimum system with the disk drives
shut off and a tiny monitor, in much the same way laptop manufacturers
lie about their battery dwell times.  The more honest UPS
manufacturers give you a little table showing expected dwell times for
different system configurations (<span class="quote">&#8220;<span class="quote">desktop</span>&#8221;</span>,
<span class="quote">&#8220;<span class="quote">tower</span>&#8221;</span>, etc.). As a rule of thumb, assume you will get
about 50% of the dwell time listed on the box for your configuration
type.</p><p>My advice is to forget the numbers game.  Just go online or to
your local computer store and buy one of the higher-end consumer or
home-office models from APC, Best, Tripp-Lite, Belkin, or some other
reputable manufacturer.  Go ahead and grab the model with the longest
dwell time, highest watt rating, or biggest VA number you can find;
the premium for it is not likely to be more than $75 over the
bargain-basement model.  I guarantee you will feel very good about
your decision not to pinch pennies come your first extended power
outage.</p><p>Perhaps a more compelling reason it is better to over-buy
capacity rather than ending up with a UPS that is too weak for your
power drain is that overstrained UPSes can fail in ugly ways,
including catching fire and exploding.</p><p>Be sure you get a <em class="firstterm">line interactive</em> UPS
rather than the older <em class="firstterm">standby</em> or
<em class="firstterm">SPS</em> type.  The older technology doesn't
actually filter your power through the battery, so you're not assured
of good voltage conditioning.  The main advantage of an SPS (low cost)
has been eroded now that line-interactive UPSes are so inexpensive.
There are other UPS types, but they are either obsolescent or targeted
at large data-center installations.  For a detailed discussion of the
different UPS types, see <a class="ulink" href="http://sturgeon.apcc.com/whitepapers.nsf/URL/WP-1/%24FILE/WP1.pdf" target="_top">The
different types of UPS systems</a>, a white paper on the APC
site.</p><p>Another important consideration is how your UPS will communicate
with your computer.  Do not buy a serial line UPS (one that
communicates via an RS-232C cable).  These are passing out of use in
favor of UPS designs that use USB or Ethernet, for the very excellent
reason that RS-232C interfaces are flaky, difficult to configure,
and difficult to debug.  Ethernet is overkill for this application;
UPSes simply don't need that kind of bandwidth.  We recommend sticking 
with USB, which is well-matched in price/performance to this job
and relatively easy to troubleshoot.</p><p>Until recently there was an important distinction between
<em class="firstterm">smart</em> and <em class="firstterm">dumb</em> UPSes.
Dumb UPSes did voltage-level signaling through individual pins; smart
ones used the link as a primitive character channel and could pass
more status information over it.  But if you avoid RS232C UPSes you
will never see a dumb one; indeed, it is likely that by the time you
read this no dumb UPses will be in production any longer.</p><p>Some UPSes advertise that they deliver a sinusoidal waveform.  Those
that don't may be delivering something more like a square wave or a very
noisy sine wave.  There are differing schools of thought about how
important this is. One school of thought holds that one should always run
equipment on the best approximation of sinusoidal input that one can, and
that deviations produce harmonics which may either be interpreted as signal
if they get through a power supply, or may actually damage the
equipment. Another school holds that since almost all computers use
switching-type power supplies, which only draw power at or near the peaks
of the waveforms, the shape of the input power waveform is not
important.</p><p>Who's right? We don't know. Nick's opinion is that sinusoidal output
is worth the extra money, especially for on-line UPS systems that
continually provide their waveform to the computer; Eric is inclined to
doubt it matters much with modern power supplies.  If you don't know that
your equipment has a switching-type power supply, you certainly might want
to think twice before buying a low quality UPS.</p><p>Personally, I (Eric) like APC UPSes (nether Eric nor Nick has any
connection with the company).  But this is not the kind of widget for which
manufacturer makes a whole lot of difference as long as you stick with one
of the reputable brands.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm173"></a>3.2. Deploying your UPS and other devices: the total picture</h3></div></div></div><p>Our recommendation for a production Unix environment is a
configuration like the following:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>An UPS for the computer system. </p></li><li class="listitem"><p>Surge suppression on all phone lines, and also on 
serial/parallel lines that leave the room.</p></li><li class="listitem"><p>Line conditioners on any devices not connected to the UPS.  If
you do take a power hit, it's cheaper to replace a $50 line
conditioner than a $1500 laser printer.</p></li></ol></div><p>If this is too expensive for you, then downgrade the UPS to
a line conditioner like the TrippLite.  But don't go without at least
that.  Running unprotected is false economy, because you
<span class="emphasis"><em>will</em></span> lose equipment to electrical storms &#8212;
and, Murphy's Law being what it is, you will always get hit at the
worst possible time.</p><p>One thing to note is that you typically shouldn't put a laser printer
on the brownout-protected sockets in a UPS &#8212; toner heaters draw
enough current to overload a UPS and cause a shutdown within
seconds. Modern UPSes generally have some plugs that are marked
surge-suppressed but not filtered through the battery; plug your
printer into one of those.</p><p>A UPS should be wired directly to (or plugged directly into) the
AC supply (i.e. a surge suppressor is neither required nor suggested
between the wall and the UPS).  In addition, a surge suppressor
between the UPS and the equipment connected to it is redundant.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm187"></a>3.3. Software Assistance</h3></div></div></div><p>Your UPS communicates with your computer so it can gracefully
shut the computer down when an outage has lasted too long for the
battery to cope.  In order for graceful shutdown to actually happen,
your computer needs to have a background process &#8212; a daemon, in
Unix terms &#8212; watching whatever messages come over the UPS cable
for the one that says <em class="firstterm">terminate</em>. Then it
needs to tell the operating system to shut down.</p><p>Your UPS probably comes with a CD full of such software.  Throw
it away, as (a) most of it will be useless bits written for Windows
systems, and (b) in the unlikely event you get Linux software it will
almost certainly be stale binaries for a version you don't run.</p><p>Back in the days of dumb serial-line UPses, there used to be
about half a dozen different open-source UPS monitor daemons:
<span class="application">apcd</span>, <span class="application">dumbupsd</span>,
<span class="application">genpowerd</span>.
<span class="application">powerd</span>, <span class="application">smupsd</span>,
<span class="application">usvd</span> and more. These were fairly stupid
programs for a simple job.  Many required you to hand-wire a custom
RS232C cable to get around various evil things that UPS manufacturers
did to their ports in order to lock in customers.</p><p>Those days are gone.  USB UPSes get rid of the cable-hacking and
hardware klugery, but require a bit more smarts from a monitor daemon.
Accordingly the field has narrowed considerably.  There appear 
to be only two such projects left standing.</p><p>The <a class="ulink" href="http://www.networkupstools.org/" target="_top">Network UPS
Tools</a> project is a generic UPS monitor daemon that aims to
communicate intelligently with all current UPS designs.</p><p><a class="ulink" href="http://www.apcupsd.org/" target="_top">apcupsd</a> is a daemon
specifically designed for communicating with UPSes made by APC, the
American Power Corporation.</p><p>Both are solid, well-run projects.  Their development groups are
mutually friendly, and there has been occasional talk of a merger.
Awkwardly, the <span class="application">apcupsd</span> project is in many ways
the more featureful of the two, with, among other things, better USB
support and better documentation &#8212; but the NUT tools have a cleaner
architecture, more developers, and acceptance in Red Hat and other major
distributions.</p><p>My advice is simple; run <span class="application">apcupsd</span> if
you buy an APC UPS, and the NUT tools if you buy anything else.  RPMs
and Debian packages (which will modify your system's boot sequence
appropriately as well as installing the daemon binaries) are available
for both, so installation should be easy either way.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm208"></a>3.4. Preparing Your System For Auto-Reboot</h3></div></div></div><p>If you are using your UPS to try to keep a DNS/Web/mailserver up
24/7, you will want to make sure the machine can be configured to
boot automatically when it is powered up.</p><p>This is not the normal behavior of most computers as shipped
from the factory. Normally after the power is cut and restored, you
must explicitly press a button for the power to actually be turned
on. You can test your computer by powering it down; shutting off the
power (pull the plug); then plugging the cord back in. If your
computer immediately starts up, good. There is nothing more to
do.</p><p>If your computer does not start up, manually turn on the
power (by pressing the power on button) and enter your computer's
SETUP program (often by pressing DEL during the power up sequence;
sometimes by pressing F10). You must then find and change the
appropriate configuration parameter to permit instant power
on.</p><p>Normally, this is located under the <span class="bold"><strong>BOOT</strong></span> menu item, and will be called something
such as <span class="bold"><strong>Restore on AC/Power Loss</strong></span> or
<span class="bold"><strong>Full-On</strong></span>. The exact words will vary
according to the ROM BIOS provider. Generally you will have three
options: <span class="bold"><strong>Last State</strong></span>, <span class="bold"><strong>Power On</strong></span>, and <span class="bold"><strong>Power
Off</strong></span>.</p><p>Some BIOSes do not support such an option.  This is idiotically
bad design, but it does happen.  If so, your only practical remedy is 
to get a new motherboard.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s02.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2. An Overview of Power Protection </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 4. Testing Your UPS</td></tr></table></div></body></html>
