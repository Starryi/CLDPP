<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Caudium HOWTO</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="description" content="This is the Caudium HOWTO. This document will give an overview of the Caudium server. New users will learn how to set a basic virtual server up. More experienced users will find useful tips on development and optimization. Finally at the end I give some documentation on Caudium top priorities for people who want to contribute."></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="index"></a>Caudium HOWTO</h1></div><div><div class="author"><h3 class="author"><span class="firstname">David</span> <span class="surname">Gourdelier</span></h3><span class="contrib">And other contributors</span> <div class="affiliation"><span class="orgname">Caudium Group<br></span><div class="address"><p><br>
	  <code class="email">&lt;<a class="email" href="mailto:vida%20at%20caudium%20dot%20net">vida at caudium dot net</a>&gt;</code><br>
	</p></div></div></div></div><div><p class="copyright">Copyright © 2002 The Caudium Group.</p></div><div><p class="pubdate">September 2002</p></div><div><div class="revhistory"><table style="border-style:solid; width:100%;" summary="Revision History"><tr><th align="left" valign="top" colspan="3"><b>Revision History</b></th></tr><tr><td align="left">Revision 2.2</td><td align="left">2002-09-20</td><td align="left">dg</td></tr><tr><td align="left" colspan="3">
	  Few more fixes, document now contains images and icons.
	  See revision history for more information.
	</td></tr><tr><td align="left">Revision 2.1</td><td align="left">2002-06-14</td><td align="left">dg</td></tr><tr><td align="left" colspan="3">
          Document is now well-formed XML, one more example.
          See revision history for more information.
        </td></tr><tr><td align="left">Revision 2.0</td><td align="left">2002-06-14</td><td align="left">Tab</td></tr><tr><td align="left" colspan="3">
          Converted to DocBook XML 4.1.2.
          See revision history for more information.
        </td></tr><tr><td align="left">Revision 1.0</td><td align="left">2002-06-06</td><td align="left">dg</td></tr><tr><td align="left" colspan="3">
          Initial release
        </td></tr><tr><td align="left">Revision 0.91</td><td align="left"></td><td> </td></tr><tr><td align="left" colspan="3">
          Indentation of the SGML document and one more paragraph.
	  See revision history for more.
        </td></tr><tr><td align="left">Revision 0.9</td><td align="left"></td><td> </td></tr><tr><td align="left" colspan="3">
	  This Howto is going into stable state.
	  See the revision history for more information.
	</td></tr><tr><td align="left">Revision 0.05</td><td align="left">2002-04-04</td><td> </td></tr><tr><td align="left" colspan="3">
	  This HOWTO is in the DocBook format.
	  See the revision history for more information.
	</td></tr><tr><td align="left">Revision 0.04</td><td align="left"></td><td> </td></tr><tr><td align="left" colspan="3">
	  Added Introduction and license. 
	  See the revision history for more information.
	</td></tr><tr><td align="left">Revision 0.03</td><td align="left"></td><td> </td></tr><tr><td align="left" colspan="3">
	  Added some useful corrections.
	  See the revision history for more information.
	</td></tr><tr><td align="left">Revision 0.02</td><td align="left"></td><td> </td></tr><tr><td align="left" colspan="3">
	  Minor correction in other answers.
	  See the revision history for more information.
	</td></tr><tr><td align="left">Revision 0.01</td><td align="left">2002-03-11</td><td> </td></tr><tr><td align="left" colspan="3">
	  Initial revision.
	  See the revision history for more information.
	</td></tr></table></div></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>
    This is the Caudium HOWTO. This document will give an overview of the Caudium server. New users will learn how to set a basic virtual server up. More experienced users will find useful tips on development and optimization. Finally at the end I give some documentation on Caudium top priorities for people who want to contribute.
  </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="chapter"><a href="#copyright">1. License</a></span></dt><dt><span class="chapter"><a href="#Overview">2. Overview</a></span></dt><dd><dl><dt><span class="sect1"><a href="#whatiscaudium">1. What is Caudium?</a></span></dt><dt><span class="sect1"><a href="#fork">2. Caudium vs Roxen: Why a fork?</a></span></dt><dt><span class="sect1"><a href="#apache">3. Comparing Caudium with Apache</a></span></dt><dt><span class="sect1"><a href="#advantages">4. Advantages of Caudium</a></span></dt><dt><span class="sect1"><a href="#disadvantages">5. Disadvantages of Caudium</a></span></dt></dl></dd><dt><span class="chapter"><a href="#gettingpackages">3. Getting packages</a></span></dt><dd><dl><dt><span class="sect1"><a href="#debian">1. How to get packages for Debian GNU/Linux</a></span></dt><dt><span class="sect1"><a href="#freebsd">2. How to get packages for FreeBSD</a></span></dt><dt><span class="sect1"><a href="#solaris">3. How to get packages for Solaris</a></span></dt><dt><span class="sect1"><a href="#camassrc">4. How to get CAMAS from CVS/source</a></span></dt></dl></dd><dt><span class="chapter"><a href="#creating">4. Creating your first server</a></span></dt><dd><dl><dt><span class="sect1"><a href="#installing">1. Installing Caudium from sources</a></span></dt><dt><span class="sect1"><a href="#starting">2. Starting</a></span></dt><dt><span class="sect1"><a href="#stopping">3. Stopping from command line</a></span></dt><dt><span class="sect1"><a href="#directory">4. Directory organization</a></span></dt><dt><span class="sect1"><a href="#upgrade">5. Upgrading Caudium</a></span></dt><dt><span class="sect1"><a href="#cifconf">6. Configuration InterFace (<abbr class="abbrev">CIF.</abbr>)</a></span></dt><dt><span class="sect1"><a href="#adding">7. Adding your first server</a></span></dt><dd><dl><dt><span class="sect2"><a href="#servervariables">7.1. Server variables</a></span></dt><dt><span class="sect2"><a href="#selectingfs">7.2. Selecting file system</a></span></dt><dt><span class="sect2"><a href="#creatingavs">7.3. Creating a virtual server</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#customizing">5. Customizing your server</a></span></dt><dd><dl><dt><span class="sect1"><a href="#secure">1. How to run Caudium as a non-privileged user; How to secure Caudium</a></span></dt><dt><span class="sect1"><a href="#benchmark">2. How to benchmark a web server</a></span></dt><dt><span class="sect1"><a href="#tune">3. How to tune your system for best Caudium performances</a></span></dt><dd><dl><dt><span class="sect2"><a href="#linuxtune">3.1. Linux</a></span></dt><dt><span class="sect2"><a href="#freebsdtune">3.2. FreeBSD</a></span></dt><dt><span class="sect2"><a href="#suntune">3.3. Solaris 2.x</a></span></dt></dl></dd><dt><span class="sect1"><a href="#useyourownfonts">4. How to use your own fonts</a></span></dt><dt><span class="sect1"><a href="#UltraLogworking">5. How to get UltraLog working</a></span></dt></dl></dd><dt><span class="chapter"><a href="#developing">6. Developing with Caudium</a></span></dt><dd><dl><dt><span class="sect1"><a href="#firstrxml">1. Your first RXML file</a></span></dt><dt><span class="sect1"><a href="#thePiketag">2. The Pike tag</a></span></dt><dt><span class="sect1"><a href="#firstPikescript">3. Your first Pike script</a></span></dt><dt><span class="sect1"><a href="#firstmodule">4. Your first module</a></span></dt><dt><span class="sect1"><a href="#backtrace">5. How to use a backtrace</a></span></dt><dt><span class="sect1"><a href="#printsomethingtodebuglogfile">6. How to print something to debug log file</a></span></dt></dl></dd><dt><span class="chapter"><a href="#helpCaudiumcommunity">7. How to help the Caudium community</a></span></dt><dd><dl><dt><span class="sect1"><a href="#promoteCaudium">1. How to promote Caudium</a></span></dt><dt><span class="sect1"><a href="#writedoc">2. How to write documentation</a></span></dt><dt><span class="sect1"><a href="#CVSaccount">3. How to get a CVS account</a></span></dt><dt><span class="sect1"><a href="#testCaudium">4. How to test Caudium</a></span></dt><dt><span class="sect1"><a href="#bugreport">5. How to send a bug report</a></span></dt></dl></dd><dt><span class="chapter"><a href="#idm1096">8. Revision History/Credits/The End</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idm1098">1. Revision History</a></span></dt><dt><span class="sect1"><a href="#idm1189">2. Credits and contributors</a></span></dt><dt><span class="sect1"><a href="#idm1209">3. The End</a></span></dt></dl></dd><dt><span class="appendix"><a href="#gfdl">A. GNU Free Documentation License</a></span></dt><dd><dl><dt><span class="sect1"><a href="#gfdl-0">1. PREAMBLE</a></span></dt><dt><span class="sect1"><a href="#gfdl-1">2. APPLICABILITY AND DEFINITIONS</a></span></dt><dt><span class="sect1"><a href="#gfdl-2">3. VERBATIM COPYING</a></span></dt><dt><span class="sect1"><a href="#gfdl-3">4. COPYING IN QUANTITY</a></span></dt><dt><span class="sect1"><a href="#gfdl-4">5. MODIFICATIONS</a></span></dt><dt><span class="sect1"><a href="#gfdl-5">6. COMBINING DOCUMENTS</a></span></dt><dt><span class="sect1"><a href="#gfdl-6">7. COLLECTIONS OF DOCUMENTS</a></span></dt><dt><span class="sect1"><a href="#gfdl-7">8. AGGREGATION WITH INDEPENDENT WORKS</a></span></dt><dt><span class="sect1"><a href="#gfdl-8">9. TRANSLATION</a></span></dt><dt><span class="sect1"><a href="#gfdl-9">10. TERMINATION</a></span></dt><dt><span class="sect1"><a href="#gfdl-10">11. FUTURE REVISIONS OF THIS LICENSE</a></span></dt><dt><span class="sect1"><a href="#gfdl-11">12. How to use this License for your documents</a></span></dt></dl></dd></dl></div><div class="list-of-figures"><p><b>List of Figures</b></p><dl><dt>4.1. <a href="#cif_ports">Ports in the CIF</a></dt><dt>4.2. <a href="#cif_filesystem">Filesystem in the CIF</a></dt><dt>4.3. <a href="#cif_filesystem_example">Example of output</a></dt></dl></div><div class="list-of-examples"><p><b>List of Examples</b></p><dl><dt>4.1. <a href="#idm605">Your user filesystem.</a></dt><dt>4.2. <a href="#idm660">A simple virtual hosting regular expression.</a></dt><dt>4.3. <a href="#idm664">A better and quicker regular expression.</a></dt><dt>6.1. <a href="#idm884">Some simple RXML tags.</a></dt><dt>6.2. <a href="#idm896">The PHP documentation as a Pike tag.</a></dt><dt>6.3. <a href="#idm923">A basic Pike script.</a></dt><dt>6.4. <a href="#idm927">A real world script.</a></dt><dt>6.5. <a href="#idm931">A script for the power user.</a></dt><dt>6.6. <a href="#idm988">A sample module.</a></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="copyright"></a>Chapter 1. License</h1></div></div></div><p>
      Permission is granted to copy, distribute and/or modify this document under the terms of the <a class="ulink" href="http://www.gnu.org/copyleft/fdl.html#SEC1" target="_top">GNU Free Documentation License</a>, Version 1.1 or any later version published as by the Free Software Foundation; with no Invariant Sections, with no Front-Cover Texts, and with no Back-Cover Texts. A copy of the license can be found in <a class="xref" href="#gfdl" title="Appendix A. GNU Free Documentation License">Appendix A, <i>GNU Free Documentation License</i></a>.
  </p><p>
    This document is a volunteer effort. Feel free to improve and make
    changes. If you catch any mistakes, please correct them.
  </p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="Overview"></a>Chapter 2. Overview</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#whatiscaudium">1. What is Caudium?</a></span></dt><dt><span class="sect1"><a href="#fork">2. Caudium vs Roxen: Why a fork?</a></span></dt><dt><span class="sect1"><a href="#apache">3. Comparing Caudium with Apache</a></span></dt><dt><span class="sect1"><a href="#advantages">4. Advantages of Caudium</a></span></dt><dt><span class="sect1"><a href="#disadvantages">5. Disadvantages of Caudium</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="whatiscaudium"></a>1. What is Caudium?</h2></div></div></div><p>
      Caudium is a Web server based on a fork of the <a class="ulink" href="http://www.roxen.com/" target="_top">Roxen Challenger 1.3 WebServer</a>. Like Roxen, Caudium is written in <a class="ulink" href="http://pike.roxen.com/" target="_top">Pike</a> with parts written in C for performance reasons. Pike is an interpreted language developed by Frederik Hübinette and Roxen Internet Software (RIS), a Swedish company which also created the Roxen Web Server. Caudium, like Pike, is distributed under the terms of the GPL license; several companies and people are involved in its development.
    </p><p>
      Caudium features include:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
  Single-process architecture.
      </p></li><li class="listitem"><p>
	Optional multi-threaded mode.
      </p></li><li class="listitem"><p>
	Backwards compatible with Roxen 1.3 on the API and RXML level.
      </p></li><li class="listitem"><p>
	Runs on many Unix-like systems (GNU/Linux, FreeBSD, OpenBSD, NetBSD, Solaris, AIX, Darwin/MacOS X).
      </p></li><li class="listitem"><p>
	Web based interface for easy administration.
      </p></li><li class="listitem"><p>
	Built in SSL capabilities. Enabling SSL on Caudium is as easy as filing a web form.
      </p></li><li class="listitem"><p>
	Written in Pike. Unlike most web servers, you don't need to learn C or C++ and those pesky details like memory allocation to enhance the server's capabilities.
      </p></li><li class="listitem"><p>
	Extensible with custom modules.
      </p></li><li class="listitem"><p>
	Powerful API.
      </p></li><li class="listitem"><p>
	Lots of standard modules distributed with the server, including an FTP server, the CAMAS web mail application, and the UltraLog log analysis tool. The <span class="quote">&#8220;<span class="quote">module</span>&#8221;</span> directory in Caudium 1.2 with CAMAS contains 192 code-only files. Most of the modules are in a single file.
      </p></li><li class="listitem"><p>
	RXML language. RXML stands for Roxen eXtensible Markup Language and is a set of tags, containers and simple programming language constructs that you put in your HTML source. Those tags and containers will be interpreted at run-time by Caudium. This allows non-programmers to do development.
      </p></li><li class="listitem"><p>
	XML language. Using Sablotron, Caudium can render XML pages processed with XSLT, DOM and XPath. You can find more information on Sablotron on <a class="ulink" href="http://www.gingerall.com/" target="_top">http://www.gingerall.com/</a>. It allows you to use pages designed for Apache mod_xslt in Caudium without modifications. Also the output of these generated pages can also be parsed by our RXML parser before sending the result to the client.

      </p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="fork"></a>2. Caudium vs Roxen: Why a fork?</h2></div></div></div><p>
    Caudium is backward compatible with Roxen Challenger 1.3. It has all the Roxen 1.3 RXML tags and the Roxen 1.3 API, so, from a technical point of view, it is quite the same (although Caudium has many improvements over Roxen 1.3). The main legal difference between Roxen 1.3 and Caudium is that Roxen is property of Roxen Internet Software whereas Caudium is owned by its developers, The Caudium Group. There are many functional extensions, improvements and bug fixes over the original Roxen 1.3 code base from which Caudium was created. Here you may say it is not a problem since it is under GPL. The problem is that even it is licensed under the GPL, RIS may not include your patch in its CVS tree, you may not have a CVS account, so you can't really do all you want. The main reason for the fork, however, was that RIS didn't pay attention to the users' needs, and proceeded to make the new versions of the Roxen Web Server largely incompatible with the previous versions, to the point where one couldn't switch to the new version of the software without much effort put into conversion of the old source code. Rewriting huge portions of RXML/Pike code just to switch to a new version of the web server seemed to be quite counter-productive, and thus the Caudium Project was born.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="apache"></a>3. Comparing Caudium with Apache</h2></div></div></div><p>
      Caudium differs from Apache in many ways including the directory structure, programming language, and type of configuration. Caudium has a fully integrated web interface, while Apache relies on editing text files directly. Moreover, any change to the Apache configuration requires a restart of the server, while Caudium sees the changes immediately after you save them from the web interface. There are also some differences in the vocabulary used in the configuration interface. Another difference is that Apache 1.3 uses a forked process model while Caudium uses threads or a monolithic process model, depending on the features present in the copy of Pike it uses. Caudium allows the programmer/user to easily extend the server using modules/scripts written in Pike that integrate tightly with the core server and, thus, create a more robust, faster and more intuitive entity than an Apache server augmented with a set of external dynamically loadable libraries. While changing anything in the source code of any Apache extension (or the server itself) requires recompilation, relinking and restarting of the whole server, Caudium allows one to add/remove/modify code without any interruption of the server operation. If you modify a module all you need to do to see the effects of your work is to reload the module in question using the configuration interface. Caudium's architecture also provides easy means of building highly dynamic web pages that use SQL, gdbm, Mird databases, LDAP, dynamically generated graphics (including business graphics modules) and more. The same effect can be achieved with Apache almost only by using external set of Perl, Python, or other language, scripts running as CGI or embedded using a dynamically loaded module. While allowing the programmer/designer to use CGI modules, Caudium offers more power when the source code is integrated with the Caudium core.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="advantages"></a>4. Advantages of Caudium</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	Stable multi-threaded programming (Roxen has been multi-threaded since 1994).
      </p></li><li class="listitem"><p>
	Mostly written in an interpreted, object-oriented, language - Pike:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
	    Easy to program and extend. Just imagine if you could code extensions to the Apache core in PHP or Perl.
	  </p></li><li class="listitem"><p>
	    No buffer overflows, segmentation faults or any other problems of that nature.
	  </p></li><li class="listitem"><p>
	    RealNetworks is still using Roxen 1.3 as their main web platform for its stability and speed.
          </p></li></ul></div><p>
      </p></li><li class="listitem"><p>
	Low level API available for end-users.
      </p></li><li class="listitem"><p>
	RXML tags.
      </p></li><li class="listitem"><p>
	Lots of modules.
      </p></li><li class="listitem"><p>
	Backwards compatible with Roxen 1.3.
      </p></li><li class="listitem"><p>
	Different. If you are a Linux or BSD user for some time you already know the most used is not always the best.
      </p></li><li class="listitem"><p>
	Caudium won't run under win32 (thus letting us more time for useful things). However some people are trying to port it using cygwin without code modification.
      </p></li><li class="listitem"><p>
  Embedded PHP4 support.
      </p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="disadvantages"></a>5. Disadvantages of Caudium</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
         Too small of a community, and quite unknown in web server world. One example of the problem you may have is if you write Pike code for Caudium, and your hosting company doesn't support Pike, and you don't have root access to your server. Of course, it is possible to compile Pike on your account and run Caudium without the superuser privileges.
      </p></li><li class="listitem"><p>
        RIS (Roxen Internet Software) owns Pike, but this is likely to change in the not-so-distant future.
      </p></li><li class="listitem"><p>
        Needs more testing for exotic modules or modules we don't use often. Example of such modules include htaccess support. 
      </p></li><li class="listitem"><p>
        Too little documentation. One example is the lack of documentation about FastCGI support.
      </p></li><li class="listitem"><p>
        CGI performance on busy CGI based sites was lackluster -- no one will take the time to rewrite CGIs.  This seems to be somewhat resolved with Pike 7.2/Caudium 1.2.
      </p></li><li class="listitem"><p>
          It is sometimes impossible to get some features when you are a normal user because configuration is only accessible with the <abbr class="abbrev">CIF.</abbr> (Configuration InterFace). And the <abbr class="abbrev">CIF.</abbr> is accessible only by the admin (this is being taken care of in the development series of the server). Here is list of day to day problems submitted by Chris Davies:
        </p><div class="blockquote"><blockquote class="blockquote"><p>
          Webmasters like to use mod_rewrite in the .htaccess files to protect their sites from leeching, etc. Yes, there is referrerdeny and browserdeny, but these are accessible to the System Administrator, not the casual web user.  On Apache, one can easily specify rules on a per directory basis.  This isn't easy in Caudium, however, it is rare that someone would have more than two or three different conditions.
        </p></blockquote></div><div class="blockquote"><blockquote class="blockquote"><p>
          Now, for people that are running their own server, many of these issues disappear.  Administration and adding servers is much easier.  I'm not sure I agree with the templates, but perhaps an Apache Template could be tweaking beyond that to the System Administrator.  In most cases, Apache has SSI turned on for shtml files -- getting the exec command enabled to mimic this in Caudium is not a task for the beginner.  The maze of options to find that one setting will certainly frustrate anyone getting started.
        </p></blockquote></div></li><li class="listitem"><p>
        A graphical interface is not always the best. To create a virtual server with Apache, you have to copy and paste five lines. If you use the Caudium Interface it will take you more than one minute. And if you want to change Caudium text file directly, you will have to write sed script.
      </p></li></ul></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="gettingpackages"></a>Chapter 3. Getting packages</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#debian">1. How to get packages for Debian GNU/Linux</a></span></dt><dt><span class="sect1"><a href="#freebsd">2. How to get packages for FreeBSD</a></span></dt><dt><span class="sect1"><a href="#solaris">3. How to get packages for Solaris</a></span></dt><dt><span class="sect1"><a href="#camassrc">4. How to get CAMAS from CVS/source</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="debian"></a>1. How to get packages for Debian GNU/Linux</h2></div></div></div><p>
      In Debian GNU/Linux Woody, also known as Debian 3.0, Caudium
      and Pike 7.0 and 7.2 are included in the distribution. If you
      use Woody, you will have Caudium 1.0 and Pike 7.0/7.2. If you
      use Sid you will have the latest Caudium and the latest Pike;
      these two packages are actively maintained by the Caudium
      community, and you will have frequent updates.  If you want to
      test the latest Caudium under Woody, add this to your
      /etc/apt/sources.list:

      </p><pre class="programlisting"><code class="computeroutput">
deb http://grendel.firewall.com/debian/caudium/1.2 unstable main
      </code></pre><p>

      This location is mirrored in other locations, so you can also use:
      
      </p><pre class="programlisting"><code class="computeroutput">
deb http://ftp.oav.net/caudium unstable main 
deb ftp://ftp.oav.net/caudium unstable main
      </code></pre><p>
    </p><p>
      If you want php4 Debian package for Caudium, you can do:
      </p><pre class="programlisting"><code class="computeroutput">
# su -
# apt-get update
# apt-get install -f caudium caudium-modules \ 
  caudium-ultralog caudium-pixsl caudium-dev
      </code></pre><p>

      And then grab the PHP4 sources:

      </p><pre class="programlisting"><code class="computeroutput">
# exit
$ cd /usr/src; apt-get source -d php4; apt-get build-dep php4
      </code></pre><p>

      If you don't have devscripts and debhelper installed, install them now. Then enter the /usr/src/php-4* directory and do:

      </p><pre class="programlisting"><code class="computeroutput">
$ debuild binary



      </code></pre><p>

        After some time and some coffee you should have php4 packages for Apache, CGI and your fresh Caudium.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="freebsd"></a>2. How to get packages for FreeBSD</h2></div></div></div><p>
      Caudium 1.0 and Pike 7.0 are in the official FreeBSD ports. There are
      also available as a binary package in the FreeBSD 4.7 CDROMs.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Caudium 1.2 and Pike 7.2 are available as ports tarballs at
        <a class="ulink" href="ftp://ftp.oav.net/pkg_freebsd/ports.tar.gz" target="_top">ftp://ftp.oav.net/pkg_freebsd/ports.tar.gz</a>.
        If you take the latest ports from this site use the following command:
      </p><pre class="programlisting"><code class="computeroutput">
$ cd /tmp
$ fetch ftp://ftp.oav.net/pkg_freebsd/ports.tar.gz
Receiving ports.tar.gz (32468 bytes): 100%
32468 bytes transferred in 0.6 seconds (53.87 kBps)
$ su -
# cd /usr/
# tar xzf /tmp/ports.tar.gz
      </code></pre><p>
      Another note, since Caudium and Pike have been added recently to FreeBSD
      port tree, you must have an up to date port tree. 
      See the FreeBSD handbook at <a class="ulink" href="http://www.freebsd.org/handbook/cvsup.html" target="_top">http://www.freebsd.org/handbook/cvsup.html</a>
      about cvsup handling.
      </p></div><p>
      As root, go to <code class="filename">/usr/ports/www/caudium10</code> to install
      current stable version, <code class="filename">/usr/ports/www/caudium12</code> to
      install the next stable version in Release Candidate process, or 
      <code class="filename">/usr/ports/www/caudium-dev</code> to install the current
      developer's version. The script will automatically fetch and install Pike, try to detect what
      library you've installed and compile all the necessary libs for Caudium and Pike.
    </p><p>
      Here is the current Pike / Caudium options supported by the current port :
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
         <code class="constant">WITH_MOST</code> : Install the FreeType1 and FreeType2 support.
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_OPTIMIZED_CFLAGS</code> : Add some performance flags to the compiler.
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_TTF</code> : Install the FreeType1 support. 
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_FREETYPE</code> : Install the FreeType2 support.
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_MYSQL</code> : Install the MySQL support.
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_POSTGRES</code> : Install the PostgreSQL support.
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_MSQL</code> : Install mSQL support.
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_UNIXODBC</code> : Install UnixODBC support (incompatible option with <code class="constant">WITH_IODBC</code>).
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_IODBC</code> : Install iODBC support (incompatible option with <code class="constant">WITH_UNIXODBC</code>).
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_SANE</code> : Install SANE backend.
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_PDF</code> : Install PDF support
       </p></li><li class="listitem"><p>
         <code class="constant">WITH_MESA</code>/<code class="constant">HAVE_MESA</code> : Install MesaGL support.
       </p></li><li class="listitem"><p>
         <code class="constant">HAVE_GNOME</code>/<code class="constant">WANT_GNOME</code> : Install GNOME support.
       </p></li></ul></div><p>
      There are some options related only to Pike, like the GNOME / Mesa ones that are uninteresting
      to Caudium, but exist for Pike support.
    </p><p>
      A little example on how to install Caudium on FreeBSD :

      </p><pre class="programlisting"><code class="computeroutput">
# cd /usr/ports/www/caudium12
# make WITH_MOST=yes WITH_MYSQL=yes WITH_OPTIMIZED_CFLAGS=yes install clean
===&gt;  Extracting for caudium-1.2.6
&gt;&gt; Checksum OK for caudium-1.2.6.tar.gz.
===&gt;   caudium-1.2.6 depends on executable: pike - found
===&gt;   caudium-1.2.6 depends on executable: gmake - found
===&gt;   caudium-1.2.6 depends on shared library: sablot.67 - found
[...] 
===&gt;   Generating temporary packing list
***************************************************************
  If this is the first installation of Caudium, please go the 
  caudium's directory and execute the server/install script
  to finish the Caudium installation.

  If your are upgrading, just start caudium as usual.

  NOTE: there is an automatic starting script in etc/rc.d/
*************************************************************** 
===&gt;   Registering installation for caudium-1.2.6
===&gt;  SECURITY NOTE: 
      This port has installed the following startup scripts which may cause
      network services to be started at boot time.
/usr/local/etc/rc.d/caudium.sh.sample

      If there are vulnerabilities in these programs there may be a security
      risk to the system. FreeBSD makes no guarantee about the security of
      ports included in the Ports Collection. Please type 'make deinstall'
      to deinstall the port if this is a concern.

      For more information, and contact details about the security
      status of this software, see the following webpage: 
http://caudium.net/
===&gt;  Cleaning for libiconv-1.7_5
===&gt;  Cleaning for gdbm-1.8.0
===&gt;  Cleaning for mird-1.0.7
===&gt;  Cleaning for mysql-client-3.23.49
===&gt;  Cleaning for autoconf-2.53
===&gt;  Cleaning for autoconf213-2.13.000227_1
===&gt;  Cleaning for automake14-1.4.5
===&gt;  Cleaning for bison-1.35_1
===&gt;  Cleaning for gettext-0.11.1_3
===&gt;  Cleaning for gmake-3.79.1_1
===&gt;  Cleaning for libtool-1.3.4_3
===&gt;  Cleaning for m4-1.4_1
===&gt;  Cleaning for nasm-0.98,1
===&gt;  Cleaning for jpeg-6b_1
===&gt;  Cleaning for tiff-3.5.7
===&gt;  Cleaning for pexts-20020121
===&gt;  Cleaning for pike72cvs-7.2.356_5
===&gt;  Cleaning for libgmp-4.0.1
===&gt;  Cleaning for freetype-1.3.1_2
===&gt;  Cleaning for freetype2-2.0.9
===&gt;  Cleaning for libmcrypt-2.5.0
===&gt;  Cleaning for mhash-0.8.14
===&gt;  Cleaning for expat-1.95.2
===&gt;  Cleaning for Sablot-0.81_1
===&gt;  Cleaning for caudium-1.2.6
#
     </code></pre><p>
     Now if you need to install PHP4 support for Caudium, just go to <code class="filename">/usr/ports/www/caudium_php4</code> and do a make install clean as well. 
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="solaris"></a>3. How to get packages for Solaris</h2></div></div></div><p>
      Bill Welliver has made some packages. They are available on 
      <a class="ulink" href="http://hww3.riverweb.com/dist/" target="_top">Riverweb</a> and mirrored
      to <a class="ulink" href="ftp://ftp.oav.net/caudium/pkg/solaris/" target="_top">Oav.net</a>.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="camassrc"></a>4. How to get CAMAS from CVS/source</h2></div></div></div><p>
    To get CAMAS from the CVS, go to the <a class="ulink" href="http://camas.caudium.net/" target="_top">CAMAS web site</a> and follow the link.
  </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="creating"></a>Chapter 4. Creating your first server</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#installing">1. Installing Caudium from sources</a></span></dt><dt><span class="sect1"><a href="#starting">2. Starting</a></span></dt><dt><span class="sect1"><a href="#stopping">3. Stopping from command line</a></span></dt><dt><span class="sect1"><a href="#directory">4. Directory organization</a></span></dt><dt><span class="sect1"><a href="#upgrade">5. Upgrading Caudium</a></span></dt><dt><span class="sect1"><a href="#cifconf">6. Configuration InterFace (<abbr class="abbrev">CIF.</abbr>)</a></span></dt><dt><span class="sect1"><a href="#adding">7. Adding your first server</a></span></dt><dd><dl><dt><span class="sect2"><a href="#servervariables">7.1. Server variables</a></span></dt><dt><span class="sect2"><a href="#selectingfs">7.2. Selecting file system</a></span></dt><dt><span class="sect2"><a href="#creatingavs">7.3. Creating a virtual server</a></span></dt></dl></dd></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="installing"></a>1. Installing Caudium from sources</h2></div></div></div><p>
      You need to install Pike before you can install Caudium. The version of Pike is different depending on the Caudium version you want to install. For Caudium 1.0, use Pike 7.0; for Caudium 1.2, use Pike 7.2. You can find some Pike packages for the most popular systems: Debian GNU/Linux (Woody/Sid), FreeBSD, Solaris. 
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      To take a CVS source snapshot of Pike 7.2+, you will need to have a preinstalled Pike (any version) on your system in order to compile the fresh CVS checkout. This is because the CVS sources need to pre-process certain parts of the sources with some special Pike scripts. Downloading a tarball from the RIS site (always outdated) will free you from the requirement of having the Pike installed before compiling the CVS snapshot.
    </p></div><p>
      For more information, see the quick start guide at <a class="ulink" href="http://caudium.net/" target="_top">http://caudium.net/</a>.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="starting"></a>2. Starting</h2></div></div></div><p>
      The first time you install Caudium from the sources, you will need to type the following commands:
    </p><pre class="programlisting"><code class="computeroutput">
# su -
# cd /usr/local/caudium
# ./install
    </code></pre><p>
      This script will allow you to give login information for the Configuration InterFace (<abbr class="abbrev">CIF.</abbr>), the web based configuration interface, and the port address for the <abbr class="abbrev">CIF.</abbr>. But if you want to start Caudium manually, you don't need to use install, just use the <span class="command"><strong>start</strong></span> script. This script will fork Caudium once and restart it automatically if it dies. A consequence is that if you kill <span class="command"><strong>start</strong></span>, the server will always be running but it will not restart if it dies.
    </p><p>
      There are many useful options to <span class="command"><strong>start</strong></span>. The first is <code class="option">--help</code>. Here is a non-exhaustive list of options:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	<code class="option">--once</code>: Do not fork Caudium and output debug to stdout (screen). If you hit <span class="keycap"><strong>CTRL</strong></span>-<span class="keycap"><strong>C</strong></span>, Caudium will be killed
      </p></li><li class="listitem"><p>
	<code class="option">-t</code>: Display all Pike calls
      </p></li><li class="listitem"><p>
	<code class="option">--gdb</code>: Run Caudium inside gdb, useful only for developers.
      </p></li><li class="listitem"><p>
	<code class="option">--with-threads</code>: Run Caudium with threads (run better on *BSD and Solaris) 
      </p></li><li class="listitem"><p>
	<code class="option">--without-threads</code>: The opposite of <code class="option">--with-threads</code>. It doesn't mean that the Pike scripts/modules aren't able to use threads. It merely means that the Caudium core server will not use threaded handler backend.
      </p></li><li class="listitem"><p>
	<code class="option">--with-keep-alive</code>: Enable keep-alive in HTTP. In the
	old days of the web, the HTTP protocol was simple but not efficient: 
	one connection was made for each objects requested by a client. That 
	means a web browser made 20 connections to the webserver if there was
	19 images on a webpage and the HTML page itself. This result in 
	a lot of overhead and response time delay. With keep alive, the server
	don't close the connection for each objects so the browser can request
	several objects with one HTTP connection and does not need to 
	reconnect each time. As a result, the website seems to be faster for
	the client and the webserver can handle more users.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Currently, the keep-alive option doesn't work with CAMAS (I use CAMAS-1.1.7-DEV, Caudium 1.2RC1). Generally speaking, it is also not ready for production use. Here is a comment from Xavier Beaudouin: </p><div class="blockquote"><blockquote class="blockquote"><p>keep-alive is somewhat buggy on Caudium. My test shows that high number of connections on keep-alived Caudium show some random dropped returns. I do not recommend using keep-alive. If you'd like keep-alive a "black box" like redline seems the best solution... but expensive.</p></blockquote></div><p>
        </p></div><p>
      </p></li><li class="listitem"><p>
        <code class="option">--config-dir=DIR</code>: Allows you to specify where your configuration
	files are, where <span class="quote">&#8220;<span class="quote">DIR</span>&#8221;</span> is the name of the directory holding the configuration 
	files (typically <code class="computeroutput">/usr/local/caudium/configurations/</code>).
	This is a very useful option. For example you can start several Caudium instances
	with different configurations by using different configuration
	directories. This is also useful if you put the configuration files in a non-standard
	directory:
	<code class="computeroutput">
/usr/local/caudium/server/start --config-dir=/home/david/etc/my_caudium_configuration/
	</code>
        For Apache users, this is the equivalent of the <code class="option">-f</code> option but points to
	the directory that contains the files.
    </p></li></ul></div><p>
      Finally, the most important thing is debug log files. These files are stored in <code class="filename">../logs/debug</code> (relative to <code class="filename">/usr/local/caudium/server</code> in our example). The current log file is named <code class="filename">default.1</code>. The log file from the last Caudium start is <code class="filename">default.2</code> and so on. If you didn't enable debug, these files are always used but contain very few messages.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      The location of files may be different on your system if you are
      using a prepackaged version of the software.
    </p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stopping"></a>3. Stopping from command line</h2></div></div></div><p>
      There are two ways to stop Caudium:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	  Kill Caudium with a <code class="option">-9</code> signal. If you do this Caudium will restart. Actually it will be restarted by the start script.
        </p></li><li class="listitem"><p>
	  Kill Caudium (with kill(1)'s default TERM signal) . In this case, Caudium will stop cleanly. If you use Caudium 1.2 and later, you can use the <span class="command"><strong>caudiumctl</strong></span> command. A man page for <span class="command"><strong>caudiumctl</strong></span> should be available on your system.
	</p></li></ul></div><p>
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In both cases Caudium will stop only after a few moments.</p></div><p>
    </p><p>
      On Debian GNU/Linux, you can use the following commands to manipulate the server status:
    </p><pre class="programlisting"><code class="computeroutput">
# /etc/init.d/caudium stop
# /etc/init.d/caudium start
# /etc/init.d/caudium restart
    </code></pre></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="directory"></a>4. Directory organization</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	  configurations:
        </p><p>
	  Contains the config files used by the <abbr class="abbrev">CIF.</abbr>. These files use the XML syntax. You don't have to modify them by hand. If for some reason you do, make sure to do it when Caudium is stopped because they will get overwritten with the server's current configuration when the server is stopped. An alternate method is to edit the file, then send the HUP signal to the Caudium process. Another method is to use the <abbr class="abbrev">CIF.</abbr>: Go into <code class="option">Action</code> -&gt; <code class="option">Maintenance</code> -&gt; <code class="option">Reload configurations from disk</code>. This will cause Caudium to reload its configuration from disk. As you may have guessed, each file has the name of the corresponding virtual server. One file however has a special name - <code class="filename">Global_Variables</code>. This file contains information about Caudium's global variables (See the Global Variables tab in the <abbr class="abbrev">CIF.</abbr>).
        </p></li><li class="listitem"><p>
	  logs:
	</p><p>
	  Contains useful information such as debug log, virtual server logs, start/stop status. See also <a class="xref" href="#starting" title="2. Starting">Section 2, &#8220;Starting&#8221;</a>.
        </p></li><li class="listitem"><p>
	  readme:
	</p><p>
	  It's all in the name.
	</p></li><li class="listitem"><p>
	  server:
	</p><p>
	  This directory contains the actual server.
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
	    base_server:
	  </p><p>
	    Contains the server core Pike code: API, <abbr class="abbrev">CIF.</abbr>, etc. Newbies should not modify these files.
	  </p></li><li class="listitem"><p>
	    bin:
	  </p><p>
	    First binary code that is run when you use the start script. There are also some Pike scripts running as CGIs and without Caudium API. 
	  </p></li><li class="listitem"><p>
	    caudium-images:
	  </p><p>
	    This directory contains Caudium static images from the Caudium Group, such as the <span class="quote">&#8220;<span class="quote">powered by</span>&#8221;</span> series.
	  </p></li><li class="listitem"><p>
	    config_actions:
	  </p><p>
	    These are files used in the <code class="option">Action</code> tab on the <abbr class="abbrev">CIF.</abbr>. You may use some of these functions in your code.
	  </p></li><li class="listitem"><p>
	    etc:
	  </p><p>
	    Caudium includes files used by the Caudium core and its modules. For example, it contains .html files for error messages. Two directories are important for a module developer:
	  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
		include:
	      </p><p>
		Put your .h files here.
	      </p></li><li class="listitem"><p>
		module:
	      </p><p>
		Put your module files here (.pmod). Pike module files are used to provide two-level functions/class/methods for your modules. When you modify any of these files, you must restart the server.
	      </p></li></ul></div></li><li class="listitem"><p>
	    fonts:
	  </p><p>
	    Contains some compatibility fonts with some older versions. The new directory is nfonts.
	  </p></li><li class="listitem"><p>
	    languages:
	  </p><p>
	    Some basic language translations for time/date.
	  </p></li><li class="listitem"><p>
	    lib:
	  </p><p>
	    Some of the C code used to speed Caudium up. This code is a set of dynamic libraries (.so).
	  </p></li><li class="listitem"><p>
	    modules:
	  </p><p>
	    Contains Caudium modules. These are all the modules you see when you click <span class="command"><strong>Add Module</strong></span> after you have selected one of your servers in the <abbr class="abbrev">CIF.</abbr>. Browsing this directory will be useful to understand Caudium. 
	    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
		  3rdparty:
		</p><p>
		  This special directory contains third party modules for Caudium. These may be useful but are provided without any warranty and will not be maintained by the Caudium Group but they may be by the individuals who wrote them.
		</p></li></ul></div><p>
	  </p></li><li class="listitem"><p>
	    more_modules:
	  </p><p>
	    Some modules that meet a specific need, are not up-to-date, or are humorous.
	  </p></li><li class="listitem"><p>
	    nfonts:
	  </p><p>
	    Fonts for graphical things like &lt;gtext&gt; and &lt;gbutton&gt;. 
	    You can have several types of properties like bold or italic for the same font name.
	  </p></li><li class="listitem"><p>
	    Perl:
	  </p><p>
	    Needed to run Perl scripts within Caudium. At the time of writing this document, Perl support is broken, and we will be pleased to get help on this issue. 
	  </p></li><li class="listitem"><p>
	    protocols:
	  </p><p>
	    Contains protocol modules (for handling HTTP, FTP and the like).
	  </p></li><li class="listitem"><p>
	    server_templates:
	  </p><p>
	    The templates you can choose from when you create a new a virtual server.
	  </p></li><li class="listitem"><p>
	    unfinished_modules:
	  </p><p>
	    For modules in development.
	  </p></li></ul></div></li></ul></div><p>
      You can also see <code class="filename">readme/README</code> relative to <code class="filename">/usr/local/caudium</code> in our example.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="upgrade"></a>5. Upgrading Caudium</h2></div></div></div><p>
      Upgrading Caudium is simple. You should install it as if for the first time. That is, get the new sources, unpack them, run <code class="computeroutput">./configure; make; make install</code> and that's all. The new Caudium installation will detect your old Caudium and keep all your old installation including your config files. The config files will be compatible with the new version so you will never have to begin the configuration task a second time. The old server directory will be saved as server.old and so the new one will be put in the classical server directory.
    </p><p>
      If you use a package system, just use the upgrading features of your packaging system.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cifconf"></a>6. Configuration InterFace (<abbr class="abbrev">CIF.</abbr>)</h2></div></div></div><p>
      The <abbr class="abbrev">CIF.</abbr> is where the administrator manages the server. When you first login it looks like this.
    </p><div class="mediaobject"><img src="images/cif_1stpage.png" alt="The first page on the CIF"><div class="caption"><p>The first page you will see when you login on the CIF.</p></div></div><p>
      In the CIF, you'll find four tabs:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
	  <span class="guimenu">
	    <span class="inlinemediaobject"><img src="images/virtual_servers.png" alt="Virtual Servers"></span>
	  </span>
	</p><p>
	  The server(s) you have created in this Caudium installation. This is where you will tune each server configuration.
	</p></li><li class="listitem"><p>
	  <span class="guimenu">
	    <span class="inlinemediaobject"><img src="images/global_variables.png" alt="Global Variables"></span>
	  </span>
	</p><p>
	  The configuration variables that affect Caudium as a whole, including all virtual servers.
	</p></li><li class="listitem"><p>
	  <span class="guimenu">
	    <span class="inlinemediaobject"><img src="images/event_log.png" alt="Event Log"></span>
	  </span>
	</p><p> 
	  The log file output as a nice looking log. Note however, that neither errors nor startup events are displayed in the event log. This means developers should always look in the plain log file.
	</p></li><li class="listitem"><p>
	  <span class="guimenu">
	    <span class="inlinemediaobject"><img src="images/actions.png" alt="Actions"></span>
	  </span>
	</p><p>
	  Some actions you may take on you servers such as shutting down Caudium or generating an SSL certificate. This allows you to avoid some of the command line stuff. 
	</p></li></ol></div><p>
      As the <abbr class="abbrev">CIF.</abbr> is quite easy to cope with, I will try to describe some of the hidden things you may need to know about. One of them is the
      <span class="guibutton">
	<span class="inlinemediaobject"><img src="images/more_options.png" alt="more options"></span>
      </span> button. This button is very useful. Furthermore, some Basic options will not be available unless you turn it on. With this option, you will have more control over Global Variables and some modules in Virtual Servers.
    </p><p>
      One of these controls is the 
      <span class="guibutton">
	<span class="inlinemediaobject"><img src="images/reload_module.png" alt="reload module"></span>
      </span> button that you will have when you
      are in a module. This button will allow developers to check the new code of
      their modules without restarting Caudium. You should also know that very
      few options in some modules will not be activated unless you reload the
      module. So always reload a module when you think an option has not been
      read by Caudium.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="adding"></a>7. Adding your first server</h2></div></div></div><p>
      In this section, I will give you a step-by-step tutorial on how to create
      your first site (virtual server) with Caudium. If you want to do something
      useful with Caudium, you have to create at least one virtual
      server. Without this first server, Caudium will not do anything. If you use
      your browser to access your server, you will only get a dialog box
      prompting for the <abbr class="abbrev">CIF.</abbr> login/password.

    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      A virtual server allows you to have several servers running on
      the same port. For example you can have www.foo.com and www.foo.org running
      on the same port and machine. This is why it is called virtual server.
    </p></div><p>
      To create your first server, log into the web based <abbr class="abbrev">CIF.</abbr>. Click on the
      <span class="guimenu">Virtual Servers</span> tab, then the 
      <span class="guibutton">
	<span class="inlinemediaobject"><img src="images/new_virtual_server.png" alt="new virtual server"></span>
      </span> button.
    </p><p>
      Here, you are prompted for the server name:
      </p><div class="mediaobject"><img src="images/cif_newserver.png"></div><p>
      Type in an easily identifiable
      name. You also have to select the configuration type. Depending on the
      configuration you choose, your server will have a different set of
      modules. In other words, your server will have different capabilities. For
      your first server, choose <code class="option">Basic server</code>, and 
      click <span class="guibutton">OK</span>.
    </p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="servervariables"></a>7.1. Server variables</h3></div></div></div><p>
	Now you'll see the Virtual Servers page again. As you can see, you have two
	different folders to work on: <span class="guisubmenu">Server variables</span> (<a class="xref" href="#cif_ports" title="Figure 4.1. Ports in the CIF">Figure 4.1, &#8220;Ports in the CIF&#8221;</a>) and <span class="guisubmenu">File system</span> (<a class="xref" href="#cif_filesystem" title="Figure 4.2. Filesystem in the CIF">Figure 4.2, &#8220;Filesystem in the CIF&#8221;</a>). 
	</p><div class="figure"><a name="cif_ports"></a><p class="title"><b>Figure 4.1. Ports in the CIF</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/cif_ports.png" alt="Ports in the CIF"></div></div></div><p><br class="figure-break">
	</p><div class="figure"><a name="cif_filesystem"></a><p class="title"><b>Figure 4.2. Filesystem in the CIF</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/cif_filesystem.png" alt="Filesystem in the CIF"></div></div></div><p><br class="figure-break">
	Server variables contain the URL of your site, and the port on which it will be
	available. File system describes the files/directories containing the .html
	and other files you want Caudium to serve.
      </p><p>
	In server variables, go into <span class="guisubmenu">Listen ports</span> and choose <span class="guibutton">Configure a new
	port</span>. Use the default values, choose <span class="guibutton">Use these values</span>, and click
        <span class="guibutton">
	<span class="inlinemediaobject"><img src="images/save.png" alt="save"></span>
      </span>. Now select the URL of your site, and select <span class="guibutton">Continue</span>. You can now
	go back to the page displaying all of your modules, that is, where you were
	before you had gone into Server Variables.
      </p><p>
	Under your server name, you'll see the status of your server. If it
	contains the word <span class="quote">&#8220;<span class="quote">Open</span>&#8221;</span> in blue everything is okay, and you can continue
	with configuring the file system.
      </p><p>
	If it contains the words <span class="quote">&#8220;<span class="quote">Not open</span>&#8221;</span> in red, there is a problem. You can go
	into the Event Log via the <abbr class="abbrev">CIF.</abbr> tab to investigate. If you have an error <span class="guiicon">
	<span class="inlinemediaobject"><img src="images/err_3.png" alt="error icon"></span>
        </span>
	<span class="errorname">Failed to open socket on 0:80 (already bound ?)</span>, you may have another
	program or Caudium itself already running on this port. To fix the problem,
	identify the program which is using this port, and restart Caudium
	<a href="#ftn.idm579" class="footnote" name="idm579"><sup class="footnote">[1]</sup></a>.
	To restart Caudium, go into <span class="guimenu">Action</span> &#8594; <span class="guisubmenu">Shutdown</span> &#8594; <span class="guisubmenu">Shutdown Caudium</span> &#8594; <span class="guimenuitem">Restart Caudium</span>. Wait a few seconds, and when prompted, select <span class="guimenu">Virtual Servers</span>. Now select your
	server, and you should have the word <span class="quote">&#8220;<span class="quote">Open</span>&#8221;</span> in blue.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">In the <abbr class="abbrev">CIF.</abbr> you may wonder what are those two different protocols http and http2?</h3><p>
	  The difference is that http2 uses Caudium's internal memory cache while
	  http is plain Pike http subsystem. 
	  So http2 is faster than http as you might expect. However, 
	  there are some issues on some specific sites.
        </p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="selectingfs"></a>7.2. Selecting file system</h3></div></div></div><p>
	By selecting a file system, you tell Caudium which files it will send to
	people browsing your site. For those who know other web servers, please pay
	close attention to these explanations, because Caudium is quite different
	from other servers in this respect.
      </p><p>
	Caudium file systems use the Unix philosophy of mount point, rather than
	<code class="constant">c:</code>, <code class="constant">d:</code>, and so forth. The mount point concept allows
	you to put your files/directory under any URL you want without changing the
	files on your local file system. For example, assume you have the
	following local file system: 
      </p><div class="example"><a name="idm605"></a><p class="title"><b>Example 4.1. Your user filesystem.</b></p><div class="example-contents"><pre class="programlisting"><code class="computeroutput">
/home/customers/customer1
/home/customers/customer2
/home/customers/bigcustomer3
/home/friends/franck
/home/friends/bertrand
/home/friends/didier
        </code></pre></div></div><br class="example-break"><p>
	And suppose your URL is http://www.iteam.org/.
      </p><p>
	With a default configuration, you would say that http://www.iteam.org points to /home/ so that you will have customer1 under http://www.iteam.org/customers/customer1, bertrand under http://www.iteam.org/friends/bertrand and bigcustomer3 under http://www.iteam.org/customers/bigcustomer3.
      </p><p>
	But bigcustomer3 gives you a lot of money and he asks you for an URL such
	as http://www.iteam.org/bigcustomer3. However, he doesn't want to be moved
	from /home/customers/bigcustomer3 because of his FTP client's
	configuration. Moreover, you can't move the other accounts. With the mount
	point philosophy, you just have to create another mount point saying that
	/home/customers/bigcustomer3 is mounted on /bigcustomer3 so that when
	someone uses http://www.iteam.org/bigcustomer3, Caudium will serve them files
	from /home/customers/bigcustomer3.
      </p><p>
	Now let's return to our setup. Go into the <code class="option">File System</code> module, and select
	<code class="option">NONE/ mounted on /</code> -&gt; <code class="option">Path</code> -&gt; <code class="option">Search Path</code>. 
        Here you will decide which of
	your directories will be available when someone hits the root of your
	server. Write, for example, <strong class="userinput"><code>/home</code></strong>.
      </p><p>
	You can now launch your favorite browser to the URL of your site and
	enjoy.
      </p><p>
  	If you don't want visitors to get a listing of your files for
	security reasons, you can disable listing by setting <code class="option">Directory Settings</code> -&gt;
	<code class="option">Enable directory listing per default</code> to <code class="option">No</code>. Next you have to hit the
	<code class="option">More options</code> button, and then reload the module. Don't forget to click
	<code class="option">Save</code>. It is possible to put one of two <span class="quote">&#8220;<span class="quote">magic files</span>&#8221;</span> in any directory to
	make it browsable/not browsable despite the setting in the <abbr class="abbrev">CIF.</abbr> for that particular file system:
      </p><pre class="programlisting"><code class="computeroutput">
.www_browsable - the directory will always be browsable
.www_not_browsable - the directory will never be browsable
      </code></pre><p>
	Finally, to allow bigcustomer3 to get to his URL, go to <code class="option">File System</code> -&gt; <code class="option">Copy
	Module</code>. Next, go to <code class="option">Path</code> -&gt; <code class="option">Search Path</code> and type
	<strong class="userinput"><code>/home/customers/bigcustomer3</code></strong>, then type <strong class="userinput"><code>/bigcustomer3</code></strong> in 
        <code class="option">Mount point</code>.
      </p><p>
        The <a class="xref" href="#cif_filesystem_example" title="Figure 4.3. Example of output">Figure 4.3, &#8220;Example of output&#8221;</a> shows the output you 
	should have.
	</p><div class="figure"><a name="cif_filesystem_example"></a><p class="title"><b>Figure 4.3. Example of output</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/cif_filesystem_example.png" alt="Example of output"></div></div></div><p><br class="figure-break">
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	  If you created these files/directories after you point Caudium to
	  your site, it is safe to go in the <code class="option">Actions</code> tab, then to <code class="option">Cache</code> -&gt;
          <code class="option">Cache status</code> -&gt; <code class="option">Flush caches</code>.
        </p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="creatingavs"></a>7.3. Creating a virtual server</h3></div></div></div><p>
	A web server is usually running on a single port and on a single IP
	address. So how can someone have different sites on this single port and
	single IP?  The solution is to tell Caudium that the server is different
	based on the URL. This is the task of the Virtual Hosting module. As this
	module is not present in the Generic template we use, you will have to add
	it. Just use the <code class="option">Add module</code> button, and click the image named <span class="quote">&#8220;<span class="quote">Virtual
	Host Matcher</span>&#8221;</span>.
      </p><p>
	You are now able to do redirection with the help of regular expressions. If
	you don't know what regular expressions (<span class="quote">&#8220;<span class="quote">regexp</span>&#8221;</span> for short) are, check the
	man page for regexp, see Pike/Perl manual, or maybe buy a book on regular
	expressions. To write these redirections based on the URL, go into <code class="option">Regular
	expression rewrite rules</code> and add the following rule:
      </p><div class="example"><a name="idm660"></a><p class="title"><b>Example 4.2. A simple virtual hosting regular expression.</b></p><div class="example-contents"><pre class="programlisting"><code class="computeroutput">
www\.virtualhost\.com	www.virtualhost.com
         </code></pre></div></div><br class="example-break"><div class="example"><a name="idm664"></a><p class="title"><b>Example 4.3. A better and quicker regular expression.</b></p><div class="example-contents"><pre class="programlisting"><code class="computeroutput">
^www\.virtualhost\.com$|^virtualhost\.com$ www.virtualhost.com
        </code></pre></div></div><br class="example-break"><p>
	Save and type this command on your command line in order to get your
	browser resolving www.virtualhost.com:
      </p><pre class="programlisting"><code class="computeroutput">
# echo "127.0.0.1   www.virtualhost.com" &gt;&gt; /etc/hosts.
      </code></pre><p>
	You now have to add another virtual server with the button <code class="option">New Virtual
	Server</code> at the root of the virtual server tab. Put <strong class="userinput"><code>Virtual host</code></strong> as the
	server name and choose the <code class="option">Generic server</code> configuration type. Go into
	<code class="option">Server variables</code> -&gt; <code class="option">Server URL</code> and type <strong class="userinput"><code>http://www.virtualhost.com/</code></strong>. You should see:
      </p><p>
	This server is handled by the port in my first virtual server. Server URL:
	http://www.virtualhost.com/
      </p><p>
	Change the file system root and /tmp in <code class="option">File system</code> -&gt; <code class="option">NONE/ mounted on /</code>
	-&gt; <code class="option">Paths</code> -&gt; <code class="option">Search path</code>.
      </p><p>
	You can now point your favorite browser to http://localhost/ and
	http://www.virtualhost.com/ and see the result.
      </p><p>
	If you have an error telling you www.virtualhost.com is unknown check your host file.
      </p><p>
	For more information about virtual hosting, see the Virtual-Web Mini-HOWTO
	available at the <a class="ulink" href="http://www.tldp.org/" target="_top">LDP</a> or in 
	<code class="computeroutput">/usr/share/doc/HOWTO</code> or
	<code class="computeroutput">/usr/doc/HOWTO</code> under Debian GNU/Linux.
      </p></div></div><div class="footnotes"><br><hr style="width:100; text-align:left;margin-left: 0"><div id="ftn.idm579" class="footnote"><p><a href="#idm579" class="para"><sup class="para">[1] </sup></a>
	    To identify you can use lsof(8). If you want to know which programs
	    listen on port 80 just issue the following command as root</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>You need to be root if lsof has been compiled with the HASSECURITY option which is the default for some GNU/Linux distributions</p></div><p>:
          </p><pre class="programlisting"><code class="computeroutput">
# lsof -i TCP:80
          </code></pre><p>
	    Here is the result:
          </p><pre class="programlisting"><code class="computeroutput">
COMMAND  PID USER   FD   TYPE DEVICE SIZE NODE NAME
caudium 1001 root   12u  IPv4   3993       TCP *:www (LISTEN)
         </code></pre></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="customizing"></a>Chapter 5. Customizing your server</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#secure">1. How to run Caudium as a non-privileged user; How to secure Caudium</a></span></dt><dt><span class="sect1"><a href="#benchmark">2. How to benchmark a web server</a></span></dt><dt><span class="sect1"><a href="#tune">3. How to tune your system for best Caudium performances</a></span></dt><dd><dl><dt><span class="sect2"><a href="#linuxtune">3.1. Linux</a></span></dt><dt><span class="sect2"><a href="#freebsdtune">3.2. FreeBSD</a></span></dt><dt><span class="sect2"><a href="#suntune">3.3. Solaris 2.x</a></span></dt></dl></dd><dt><span class="sect1"><a href="#useyourownfonts">4. How to use your own fonts</a></span></dt><dt><span class="sect1"><a href="#UltraLogworking">5. How to get UltraLog working</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="secure"></a>1. How to run Caudium as a non-privileged user; How to secure Caudium</h2></div></div></div><p>
      Web servers are usually publicly accessible and represent your company, group
      or entity so there are chances you want to strengthen the security of this
      service.
    </p><p>
      As I already mentioned Caudium has a good security for public access behind
      mostly written in a script language. However Caudium runs as root by
      default. In the case a non-authorized user gains access to Caudium's
      process, he might gain root privileges. Consequently,a lot of web servers run
      as another user with minimal privileges. Doing this may require some
      work, as you will have to change the owner of all the files Caudium needs
      access to, so I give step-by-step instructions how to change those
      permissions:
   </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
	 Find a good user name. This user name should be a normal user with the least privileges. Lots of distributions already have a special account for this.  Common names include <span class="quote">&#8220;<span class="quote">www</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">www-data</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">httpd</span>&#8221;</span>, <span class="quote">&#8220;<span class="quote">nobody</span>&#8221;</span> (Caudium on Debian GNU/Linux runs as www-data:www-data by default). We don't recommend <span class="quote">&#8220;<span class="quote">nobody</span>&#8221;</span> though; to quote Theo de Raadt: </p><div class="blockquote"><blockquote class="blockquote"><p>The user <span class="quote">&#8220;<span class="quote">nobody</span>&#8221;</span> has historically been doing too much.  If you could break into the user <span class="quote">&#8220;<span class="quote">nobody</span>&#8221;</span>, you could cause great damage.</p></blockquote></div><p> 
       </p></li><li class="listitem"><p>
	 Change the owner of the files which Caudium needs to write to. These include:
       </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	     Caudium internal log file (default.*).
	   </p></li><li class="listitem"><p>
	      Per virtual server log file.
	   </p></li><li class="listitem"><p>
	     All caches.
	   </p></li><li class="listitem"><p>
	     The configurations files (they are written by the <abbr class="abbrev">CIF.</abbr>).
	   </p></li></ul></div><p>
	 On a Caudium source install the following command should do the job:
       </p><pre class="programlisting"><code class="computeroutput">
# chown -R  www-data.www-data logs/ var/ 
argument_cache/ bgcache/ configurations/ server/*.pem server
       </code></pre><p>
	 Here is the result:
       </p><pre class="programlisting"><code class="computeroutput">
$ ls -l 
total 32
drwxr-sr-x    6 www-data www-data     4096 Feb 13 23:17 argument_cache
drwxr-sr-x    2 www-data www-data     4096 Feb 19 09:27 bgcache
drwxr-sr-x    2 www-data www-data     4096 Mar  4 22:28 configurations
drwxr-sr-x    4 root     staff        4096 Feb 13 23:16 local
drwxr-sr-x    7 www-data www-data     4096 Mar  3 11:50 logs
drwxr-sr-x    2 root     staff        4096 Feb 13 23:16 readme
drwxr-sr-x   19 www-data www-data     4096 Feb 19 20:13 server
drwxr-sr-x    2 www-data www-data     4096 Mar  3 19:28 var

$ id www-data
uid=33(www-data) gid=33(www-data) groups=33(www-data)
       </code></pre><p>
	 If users are allowed to log on the server, you might also change the 
	 permissions of the logs directory.
       </p><p>
	 If you have a Caudium specific distribution for your system (such as Debian GNU/Linux) check manually.
       </p></li><li class="listitem"><p>
	 Don't forget to change the permissions of any script/directory you made
	 and for which Caudium needs to write to in your public filesystem.
       </p></li><li class="listitem"><p>
	 Log into the <abbr class="abbrev">CIF.</abbr>, go in the main <code class="option">Global variables</code> tab, then in 
	 <code class="option">Change uid and gid</code> type the uid:gid data you choose. We typed <strong class="userinput"><code>33:33</code></strong> 
         in our example. You can also type a login name and group name: <strong class="userinput"><code>www-data:www-data</code></strong>. 
	 You can also enable the <code class="option">Change uid and gid permanently</code> option but be sure to read the documentation first.</p></li></ol></div><p>
     I will now speak about general security measures you can take if you are
     very strict about security.
   </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
	 Don't allow users to execute scripts that are part of the server.
       </p><p>
	 As Caudium is a single process server, it is possible to stop it, restart 
	 it, access it, etc. with a user script. This include pike scripts, pike tag, 
	 and PHP modules for Caudium.
       </p><p>
	 If you do want to let your users run scripts, you can always use 
	 CGI, or better uniscript (in this case it will be transparent to the user), in 
	 order to run a script in a separate process using the fork(2) system call.
	 This will decrease the performance of Caudium but the security has a price, 
	 and it is up to you to decide how much you want to pay.

       </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Uniscript is a CGI-like wrapper. It will execute programs
       as if they were CGI scripts but unlike CGI, it does not require you
       to put these programs under a specific directory like /cgi-bin/. For
       example each user can have his or her CGI script in his or her directory.
       Moreover Caudium can execute them with the uid of the owner.
       </p></div></li><li class="listitem"><p>
	 Don't use anything you don't need. Remove any modules you don't need in your virtual server.
       </p></li><li class="listitem"><p>
	 Physically restrict access to the <abbr class="abbrev">CIF.</abbr>.  Don't access it from the Internet if 
	 possible. Few people know this, but it is now possible to see SSL 
	 connections in clear text with a man-in-the-middle attack.
	 The <span class="application">dsniff</span> software contains all the tools and explanation for this.
       </p></li><li class="listitem"><p>
	 Turn off these options:
       </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	     <code class="option">Global Variables</code> -&gt; <code class="option">show_internals</code>.
	   </p></li><li class="listitem"><p>
	     <code class="option">Global Variables</code> -&gt; <code class="option">Version numbers</code> -&gt; <code class="option">Show Caudium Version Number</code>.
	   </p></li><li class="listitem"><p>
	     <code class="option">Global Variables</code> -&gt; <code class="option">Version numbers</code> -&gt; <code class="option">Show Pike Version Number</code>.
	   </p></li></ul></div><p>
	 Turn off any debug options specific to a module. These
	 options are for developers, and they don't have security in
	 mind when they debug output. 
         </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
               Actually, this is security through obscurity and doesn't 
               increase the security of the server.
              </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Grendel</span></td></tr></table></div><p>

       </p></li><li class="listitem"><p>
	 Output Caudium's log files to a separate partition. <code class="filename">/var</code> is a good choice for 
	 that purpose.
       </p></li><li class="listitem"><p>
	 Check the Caudium web site for patches.
       </p></li><li class="listitem"><p>
	 If your job relies on your web server security, check the Caudium source.
       </p></li></ol></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="benchmark"></a>2. How to benchmark a web server</h2></div></div></div><p>
      First, benchmarking a web server is not an easy thing. To benchmark a 
      web server the time it will take to give a page is not important: you don't
      care if a user can have his page in 0.1 ms or in 0.05 ms as nobody can have 
      such delays on the Internet.
    </p><p>
      What is important is the average time it will take when you have
      a maximum number of users on your site simultaneously.  Another
      important thing is how much more time it will take when there
      are 2 times more users: a server that take 2 times more for 2
      times more users is better than another that take 4 times more
      for the same amount of users.  If you run more than a web server
      on your computer, you will also want to look at the load average
      and CPU time of your system. Here is a typical output of the
      command <span class="command"><strong>uptime</strong></span>:
    </p><p>
      <code class="computeroutput">
        22:39:49 up  2:22,  5 users,  load average: 0.01, 0.01, 0.00
      </code>
    </p><p>
      And an extract from the top(1) man page:
    </p><p>
      <span class="quote">&#8220;<span class="quote">
	The load averages are the average number of process ready to run during 
	the last 1, 5 and 15 minutes
      </span>&#8221;</span>
    </p><p>
      So the lower your load average is, the better for the other
      programs on your machine.
    </p><p>
      Now comes the next problem: how can you stress your web server with a maximum 
      number of connections when your client (the machine making the request) will
      usually not be able to cope with the server and with the number of users you 
      have. 
    </p><p>
      To do this, increase the number of sockets you can have on your
      system. Under some systems it is 1024, which is too low, see
      <a class="xref" href="#tune" title="3. How to tune your system for best Caudium performances">Section 3, &#8220;How to tune your system for best Caudium performances&#8221;</a> for more information.  The
      next thing to do is to have a good client program written with
      threads and non-blocking sockets.  If you use a multi-fork
      program on a single client, it will never cope with any web
      server. It is also good to have several clients stressing the
      server together.

    </p><p>
      Last, if you want to compare two web servers, be sure that they are on the
      same hardware, OS, and network. The same holds for the client(s).
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tune"></a>3. How to tune your system for best Caudium performances</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="linuxtune"></a>3.1. Linux</h3></div></div></div><p>
	Until a Linux guru has time to make some nice documentation, here is 
	something that came from PureFtpd software :
      </p><p>
        </p><pre class="programlisting"><code class="computeroutput">
 o Increase your system max descriptors numbers :
 
 # echo 60000 &gt; /proc/sys/fs/file-max
 # echo 180000 &gt; /proc/sys/fs/inode-max
 # ulimit -n 60000
 o mount your filesystems with the "noatime" option
 o make sure your disks holding the logs are "fast enough"

 o You can tweak a bit your TCP/IP stack :
 # echo 0 &gt; /proc/sys/net/ipv4/tcp_syncookies
 # echo 0 &gt; /proc/sys/net/ipv4/tcp_ecn
 # echo 0 &gt; /proc/sys/net/ipv4/tcp_timestamps
 # echo 0 &gt; /proc/sys/net/ipv4/tcp_window_scaling
	</code></pre><p>
      </p><p>
        Finally don't forget to compile Pike with <code class="option">--with-max-fd=60000</code> (already done in Debian packages).
      </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning from Caudium people</h3><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Personally deactivate window scaling seems to be a bad idea.</p></li><li class="listitem"><p>This needs some touches. 2.2 and 2.4 options are mixed above very badly. Also, turning off ECN might do you more harm than gain.</p></li></ul></div></div><p>
	 Also see <a class="ulink" href="http://linuxperf.nl.linux.org/" target="_top">LinuxPerf</a>, and <a class="ulink" href="http://linuxperf.nl.linux.org/general/kerneltuning.html" target="_top">LinuxPerf kernel tuning section</a>.
      </p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="freebsdtune"></a>3.2. FreeBSD</h3></div></div></div><p>
	Here are the optimizations you can try on your servers. They are provided without any warranty.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>All this is for FreeBSD 4.2 or more recent.</p></div><p>
	First, check to see if your filesystems use <code class="option">Soft Updates</code>:
	</p><pre class="programlisting"><code class="computeroutput">
# tunefs -p /dev/da0s1a
tunefs: soft updates:  (-n)                                disabled
tunefs: maximum contiguous block count: (-a)               15
tunefs: rotational delay between contiguous blocks: (-d)   0 ms
tunefs: maximum blocks per file in a cylinder group: (-e)  2048
tunefs: average file size: (-f)                            16384
tunefs: average number of files in a directory: (-s)       64
tunefs: minimum percentage of free space: (-m)             8%
tunefs: optimization preference: (-o)                      time
	</code></pre><p>
	If <code class="option">soft updates</code> are set to <code class="option">disabled</code> it may be a good idea to enable them. 
	We do not recommend you enable them on "/" filesystem on servers machines, there are issues and in general this is not recommended by the FreeBSD team.
	If you can unmount the others filesystems do this and remount them later:
	</p><pre class="programlisting"><code class="computeroutput">
# tunefs -n enable /dev/"whatever"
	</code></pre><p>
        If you cannot unmount the others filesystem, drop into single mode (do a <span class="command"><strong>shutdown now</strong></span> or a <span class="command"><strong>boot -s</strong></span>) and then type:
	</p><pre class="programlisting"><code class="computeroutput">
# tunefs -n enable "filesystem"
	</code></pre><p>
	I suggest /usr or /var.
	In the fstab you can add <strong class="userinput"><code>,async</code></strong> to the options of all filesystems. As for soft updates we do not recommend that on server machines for the root (/) filesystem.
      </p><p>
	In <code class="filename">/boot/loader.conf</code> add the following:
	</p><pre class="programlisting"><code class="computeroutput">
kern.ipc.maxsockets="5000"
kern.ipc.nmbclusters="65536"
	</code></pre><p>
        If you have ATA (IDE / UltraDMA) disks you can add also in <code class="filename">/boot/loader.conf</code>:
	</p><pre class="programlisting"><code class="computeroutput">
hw.ata.wc="1"
	</code></pre><p>
	Then in <code class="filename">/etc/sysctl.conf</code> you can add:
	</p><pre class="programlisting"><code class="computeroutput">
vfs.vmiodirenable=1
kern.ipc.maxsockbuf=2097152
kern.ipc.somaxconn=8192
kern.ipc.maxsockets=16424
kern.maxfiles=65536
kern.maxfilesperproc=32768
net.inet.tcp.rfc1323=1
net.inet.tcp.delayed_ack=0
net.inet.tcp.sendspace=65535
net.inet.tcp.recvspace=65535
net.inet.udp.recvspace=65535
net.inet.udp.maxdgram=57344
net.local.stream.recvspace=65535
net.local.stream.sendspace=65535
	</code></pre><p>
	  And then reboot (or for <code class="filename">/etc/sysctl.conf</code> use the sysctl(8) tool to setup this by hand.
      </p><p>
        Another way to have good performance is to make a custom kernel, with the minimum of drivers and processor support. A maxuser size = size of memory (for example you have 512M of RAM, then set the maxusers value in your kernel configuration variable to 512). 
        Add Posix 1003.1b real time extensions to the kernel with:
        </p><pre class="programlisting"><code class="computeroutput">
options         P1003_1B                #Posix P1003_1B real-time extensions
options         _KPOSIX_PRIORITY_SCHEDULING
        </code></pre><p>
	Enable the SMP options (only for FreeBSD 4.x, the FreeBSD 5.0 is now automatic).
      </p><p>
	For French users, check these URLs :
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	    <a class="ulink" href="http://gcu-squad.org/?viewtip+&amp;tip_id=59" target="_top">http://gcu-squad.org/?viewtip+&amp;tip_id=59</a>.
	  </p></li><li class="listitem"><p>
	    <a class="ulink" href="http://gcu-squad.org/?viewtip+&amp;tip_id=54" target="_top">http://gcu-squad.org/?viewtip+&amp;tip_id=54</a>.
	  </p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="suntune"></a>3.3. Solaris 2.x</h3></div></div></div><p>
	Most of the optimization values are in <code class="filename">/etc/system</code> file. This file is read by
	the kernel when it is loading. Please notice that the following optimization is focused on Solaris 8 machines
	with at least 256M of RAM.
	</p><pre class="programlisting"><code class="computeroutput">
* A comment is started by a star '*'
* 
* 1 maxusers per mega of ram. This machine has 512M then maxusers = 512
set maxusers=512
set hires_tick=1
set rlim_fd_max=10000
set rlim_fd_cur=4096
*set tcp:tcp_conn_hash_size=8192
* Don't setup this if you don't have more than 256M of RAM
set bufhwm=48000

* Folling are used to delay page reaping with databases.
set fastscan = 32000
set slowscan = 200
set maxpgio =  280
set lotsfree = 1024
set desfree = 512
set minfree = 128
set autoup = 280

*  Hash buffer sizes during Specweb testing
set tcp:tcp_conn_hash_size = 2097152

* Nic Interface
set hme:hme_adv_100fdx_cap=1
set hme:hme_adv_100hdx_cap=0
set hme:hme_adv_10fdx_cap=0
set hme:hme_adv_10hdx_cap=0
set hme:hme_adv_autoneg_cap=0

* To prevent buffer overflow
set noexec_user_stack=1
set noexec_user_stack_log=1
	</code></pre><p>

	  Please notice that Solaris needs fast disks. If you have IDE / UDMA disks, 
	  double check they are recent. For example the disks in Ultra 5 / 10 
	  machines are snail slow, and slow down the whole machine when you make read 
	  write operation. Please consider getting faster disks.
      </p><p>
	Also, if you use software raid (Solaris Disk Suite) you will have optimal
	performance if you have more than one SCSI controller in the machine.
      </p><p>
	Another good read is the well known <a class="ulink" href="http://sunsite.uakom.sk/sunworldonline/common/cockcroft.letters.html" target="_top">document</a> from Adrian Cockroft about tuning Solaris.
	Sunhelp.org has also a good <a class="ulink" href="http://sunhelp.org/info-faq.ph" target="_top">section</a> about tuning.
	Finally, you can read a network guide at <a class="ulink" href="http://www.sean.de/Solaris/tune.html" target="_top">http://www.sean.de/Solaris/tune.html</a>.
      </p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="useyourownfonts"></a>4. How to use your own fonts</h2></div></div></div><p>
      Use the xdumpfont program in the tool directory of Caudium's sources.
      This program will convert your X fonts to Caudium fonts.
    </p><p>
      If your Pike supports TrueType Fonts, (type <strong class="userinput"><code>pike --features</code></strong> and check if <code class="constant">Image.TTF</code> is available) you can import TTF font by copying them into <code class="filename">/usr/local/caudium/server/fonts/ttf</code>.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="UltraLogworking"></a>5. How to get UltraLog working</h2></div></div></div><p>
      See the Caudium documentation project at <a class="ulink" href="http://caudium.info/" target="_top">http://caudium.info/</a>, and <a class="ulink" href="http://daviesinc.com/modules/docs/ultralog.rxml" target="_top">http://daviesinc.com/modules/docs/ultralog.rxml</a>.
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="developing"></a>Chapter 6. Developing with Caudium</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#firstrxml">1. Your first RXML file</a></span></dt><dt><span class="sect1"><a href="#thePiketag">2. The Pike tag</a></span></dt><dt><span class="sect1"><a href="#firstPikescript">3. Your first Pike script</a></span></dt><dt><span class="sect1"><a href="#firstmodule">4. Your first module</a></span></dt><dt><span class="sect1"><a href="#backtrace">5. How to use a backtrace</a></span></dt><dt><span class="sect1"><a href="#printsomethingtodebuglogfile">6. How to print something to debug log file</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="firstrxml"></a>1. Your first RXML file</h2></div></div></div><p>
      You can try this code. This is a basic one with only four tags/containers. 
      You should go to 
      <a class="ulink" href="http://caudium.info/" target="_top">http://caudium.info/</a> and download 
      the Roxen 1.3 documentation.
    </p><div class="example"><a name="idm884"></a><p class="title"><b>Example 6.1. Some simple RXML tags.</b></p><div class="example-contents"><pre class="programlisting">
&lt;html&gt;
  &lt;comment&gt;You have to put bgcolor for gtext to work properly&lt;/comment&gt;
  &lt;body bgcolor="#FFFFFF"&gt;
    &lt;h1&gt;Basic RXML examples&lt;/h1&gt;
    &lt;table border="1"&gt;
      &lt;tr&gt;
        &lt;td&gt;This is a list of all RXML tags&lt;/td&gt;
        &lt;td&gt;&lt;list-tags&gt;&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
    &lt;table border="1"&gt;
      &lt;tr&gt;
        &lt;td&gt;Gtext render text as graphic&lt;/td&gt;
        &lt;td&gt;&lt;gtext scale=0.5&gt;This is a gif/png graphic&lt;/gtext&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Last modification of this page&lt;/td&gt;
        &lt;td&gt;&lt;modified&gt;&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
  &lt;/body&gt;
&lt;/html&gt;
      </pre></div></div><br class="example-break"></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="thePiketag"></a>2. The Pike tag</h2></div></div></div><p>
      For a complete tutorial and reference manual on Pike, see 
      <a class="ulink" href="http://pike.oav.net/" target="_top">http://pike.oav.net/</a>.
    </p><p>
      The Pike tag allows you to easily insert Pike code into your HTML page à la
      PHP. This is a good way of learning Pike if you have a PHP background or if
      you want to do things very easily and don't worry about perfect results.
    </p><p>
      To do this, you have to load a module in your server. Just select <code class="option">Load
      module</code> in the <abbr class="abbrev">CIF.</abbr> and click the <span class="quote">&#8220;<span class="quote">Pike tag</span>&#8221;</span> image. Then hit save and create
      an .html file where your public web files are. Since everybody tells me
      that PHP is easy, which is why it's so popular, I took the PHP examples and
      converted them to Pike. Here is the result:
    </p><div class="example"><a name="idm896"></a><p class="title"><b>Example 6.2. The PHP documentation as a Pike tag.</b></p><div class="example-contents"><pre class="programlisting">
&lt;html&gt;
  &lt;body bgcolor="#FFFFFF"&gt;
    &lt;h2&gt;Escaping from HTML&lt;/h2&gt;
    &lt;p&gt;
      There is one way of escaping from HTML and entering "Pike code mode"
      &lt;br /&gt;
      &lt;Pike&gt;
	output("This is the simplest, and SGML processing instruction");
      &lt;/Pike&gt;
    &lt;/p&gt;
    &lt;h2&gt;Instruction separation&lt;/h2&gt;
    &lt;p&gt;
      Instructions are separated the same as in C or Perl: 
      terminate each statement with a semicolon. 
      The closing tag (container, in fact) also implies the end of the statement,
      so the following are equivalent:
      &lt;br /&gt;
      &lt;Pike&gt;
	output ("This is a test");
      &lt;/Pike&gt;
      &lt;br /&gt;
      &lt;Pike&gt; output ("This is a test"); &lt;/Pike&gt;
    &lt;/p&gt;
    &lt;h2&gt;Comments&lt;/h2&gt;
    &lt;p&gt;
      Pike supports C, C++ but not Unix shell-style comments. For example:
      &lt;Pike&gt;
	string tests = "This is a test&lt;br /&gt;";  // this is a one-line C++ style comment
	/* This is a multi line comment
         yet another line of comment */
	tests += "Yet another test";
	return tests;
      &lt;/Pike&gt;
    &lt;/p&gt;
    &lt;h2&gt;Melding RXML and Pike&lt;/h2&gt;
    You will never see this in PHP.
    <a href="#ftn.idm899" class="footnote" name="idm899"><sup class="footnote">[2]</sup></a>
    This will create a .gif image of 1-2-...-255. 
    This took 0.4s on my Duron 750 the first time and 0.1s after.
    &lt;p&gt;
      &lt;gtext scale=0.5&gt;
	&lt;Pike&gt;
	  string output = "";
	  for(int I = 1; I &lt; 255; I++) 
	    output += I + "-";
	  return output;
	&lt;/Pike&gt;
      &lt;/gtext&gt;
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
      </pre></div></div><br class="example-break"><p>
      The problem with using this is that you will soon see it is not powerful:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	  The code will become an ugly mixture of data and code even if you use an object
	  orientation method. The more your project grows, the less you will be able
	  to produce something useful.
	</p></li><li class="listitem"><p>
	  The URL will require plenty of those <span class="quote">&#8220;<span class="quote">&amp;</span>&#8221;</span> symbols and you will have a lot of files
	  without real organization.
	</p></li><li class="listitem"><p>
	  The performance will not be the best.
	</p></li><li class="listitem"><p>
	  This can be considered as a security risk for servers that are opened
	  to unknown users (eg. public web servers).
	</p></li></ul></div><p>
      The next step is to write your first Pike script.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="firstPikescript"></a>3. Your first Pike script</h2></div></div></div><p>
      A Pike script is quite like a Perl script. It is executed when the user
      tries to access it. So a Pike script is usually where your public web files
      are. This is a good choice if you already have a Perl background and want
      to try Pike.
    </p><p>
      You have two choices when doing this. You can execute Pike as a CGI script
      or internally within the server. If you don't know what CGI is, look up the
      Apache-Overview-HOWTO at 
      <a class="ulink" href="http://www.tldp.org/" target="_top">http://www.tldp.org/</a>.
    </p><p>
      Here, we will run Pike scripts internally within Caudium. To achieve this,
      you have to load another module in your server by selecting <code class="option">Load module</code>
      in the <abbr class="abbrev">CIF.</abbr>. You now have the list of all modules available in Caudium. As
      you see, there are a lot of modules and reading this page should give you
      some ideas for future development. To select the Pike script module, just
      click on the image named <span class="quote">&#8220;<span class="quote">Pike script support</span>&#8221;</span> if you use a graphical
      browser.
    </p><p>
      You can now create a .pike file containing, for example, 
    </p><div class="example"><a name="idm923"></a><p class="title"><b>Example 6.3. A basic Pike script.</b></p><div class="example-contents"><pre class="programlisting">
// you have to inherit caudiumlib to have some basic things
// like the id object and response mapping
inherit "caudiumlib";

// the same as the main
// if you modify this script and you see that Caudium don't take your
// modification into account, reload the Pike script support module
// This is because Caudium uses a cache for performance reasons
string parse(object id)
{
  string html = "&lt;html&gt;&lt;body&gt;The id object contain some "
  "very useful information&lt;br /&gt;";
  html += sprintf("The id-&gt;variables contain a list of "
  "arguments given to this script %O\n", id-&gt;variables);
  return html;
}  
      </pre></div></div><br class="example-break"><p>
       Pike scripts are usually used for little internal development. Pike scripts can be very useful in this case because you can create something with very little lines. Here is an example of such a script:
    </p><div class="example"><a name="idm927"></a><p class="title"><b>Example 6.4. A real world script.</b></p><div class="example-contents"><pre class="programlisting">
/* Here is a Pike script (not a Caudium module).
   This script is less than 20 lines (comments
   and blank lines excluded) and will randomly
   return one file to the web browser from a list of files.
   This script was kindly provided by Xavier Beaudouin */

// first we need to inherit from caudiumlib in order to get
// the parse, http_redirect functions and id object
// recognized.
inherit "caudiumlib";

// we declare an array of files
array (string)files;

// an ASCII text containing the name of a file
// on the real filesystem.
// Each file name in this file will be
// randomly return (the files name have to be on
// a separate line).
#define FILELIST "/list"

#define BASEDIR "/thepath2yourfiles/"

// this function is the constructor, it will be loaded first
void create () {
 // the array of strings 'files' will contain
 // all the files we serve provided the file
 // FILELIST list each file name on one line.
 files = Stdio.read_bytes(FILELIST)/"\n";
}

// if no_reload return 1, Caudium will cache the
// result of this script for maximum performances
// and will not execute it a second time.
// As a result, If you give the argument 
// ?reload=1 to your script, Caudium will 
// reload it. 
// This is useful to use cache for average
// content delivery unless you are doing
// developpement
int no_reload(object id)
{
 if(!id-&gt;variables-&gt;reload)
   return 1;
 return 0;
}

// As this is a simple pike script (CGI like), this function
// will be called by Caudium and should return a string that
// will be display to the client's browser.
// It can also return a mapping containing all the HTTP response
// (headers + text)
mapping parse(object id)
{
 // We randomly return one of the file we list in the FILELIST file
 // (relative to BASEDIR directory).
 // http_redirect will send a HTTP 301 header telling the browser
 // where to get randomly selected file.
 return http_redirect(BASEDIR + files[random(sizeof(files))],id);
}
      </pre></div></div><br class="example-break"><p>
      But you can also create some powerful scripts:
    </p><div class="example"><a name="idm931"></a><p class="title"><b>Example 6.5. A script for the power user.</b></p><div class="example-contents"><pre class="programlisting">
inherit "caudiumlib";

string|mapping|object parse( object id )
{
  id-&gt;my_fd-&gt;write(id-&gt;clientprot + " 200 Ok\r\n");
  id-&gt;my_fd-&gt;write("Server: Caudium !\r\n");
  id-&gt;my_fd-&gt;write("Expires: 0\r\n");
  id-&gt;my_fd-&gt;write("Content-Type: text/html\r\n");
  id-&gt;my_fd-&gt;write("pragma: no-cache\r\n\r\n");
  id-&gt;my_fd-&gt;set_id( ({ id-&gt;my_fd }) );
  id-&gt;my_fd-&gt;set_nonblocking(0,send_data);
  return http_pipe_in_progress();
}

void send_data(array (object) id)
{

  id[0]-&gt;write("&lt;pre&gt;");
  id[0]-&gt;write("test......................\n");
  id[0]-&gt;write("test......................\n");
  id[0]-&gt;write("test......................\n");
  id[0]-&gt;write("sleep for 10 sec\n");
  sleep(10);
  id[0]-&gt;write("Done&lt;/pre&gt;");
  id[0]-&gt;close();
  destruct(id[0]);
}
      </pre></div></div><br class="example-break"><p>
      This example uses non-blocking sockets. my_fd is the file descriptor of the
      HTTP socket. Here we change the type of the HTTP socket from blocking
      sockets (default type) to non-blocking sockets. Non-blocking sockets are
      sockets that won't block the program waiting for data. Instead, a <code class="function">read</code> and
      <code class="function">write</code> function (the so-called callback functions) will be called
      automatically when there is some data to read or write to the HTTP
      socket. Moreover, we return here a special function,
      <code class="function">http_pipe_in_progress</code>. This is because as the HTTP socket is set to
      non-blocking, Caudium won't be able to wait for processing the HTTP stuff
      like headers and so on. So we have to tell it not to wait for us and send a
      <code class="function">http_pipe_in_progress</code>.
    </p><p>
      This mechanism is very useful when you have to do some communication with
      slow sockets on a single process server (multi-threaded one). In the case
      of a single process, when you wait for a socket it is all the server, which
      will wait. So all your users will be stalled. With non blocking sockets
      there is no problem anymore; the server won't wait for each socket. Example
      of such code includes CAMAS IMAP/NNTP clients. If you don't understand,
      don't worry, you usually don't have to understand these mechanisms.
    </p><p>
      However, the Pike script allows you to write some complex code it is not 
      well suited for big projects. If this is the case, read the next paragraph and enjoy. 
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	The Caudium API is available at 
	<a class="ulink" href="http://caudium.net/" target="_top">http://caudium.net/</a>. You should also
	read the Roxen 1.3 PDF available at 
	<a class="ulink" href="http://caudium.info/" target="_top">http://caudium.info/</a>.
	Pike scripts are blocking, and allow your users to run scripts with
	the same privilege as the server. Blocking means that the server will
	be stalled if a socket from a pike script is stalled (usually waiting for
	something). This applies even if you use non-blocking sockets
	in your script. You don't have this problem with modules.
      </p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="firstmodule"></a>4. Your first module</h2></div></div></div><p>
      With a custom module you can do all sorts of things:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	  You can create a professional quality administration center very easily.
	</p></li><li class="listitem"><p>
	  You don't need any more <span class="quote">&#8220;<span class="quote">&amp;</span>&#8221;</span> symbols in the URL.
	</p></li><li class="listitem"><p>
	  You can also use <code class="option">per user variables</code>, also known as <code class="option">session variables</code>.
	</p></li><li class="listitem"><p>
	  You'll get better performance since the module is part of the server.
	</p></li><li class="listitem"><p>
	  You can separate big projects into different modules, and do calls
	  between different modules. This way, your project is not a big complex
	  of messy code, but a set of simple, easy to extend code modules. 
	</p></li><li class="listitem"><p>
	  You can separate data from code by using tags and containers. This also
	  allows you to delegate the appearance to your webmaster, and lets you focus
	  on the important code. 
	</p></li><li class="listitem"><p>
	  You can easily share your code with the Caudium community. If your code
	  is good and useful, it can become part of the Caudium distribution. This way
	  more people will test it, you will have more feedback, and some people may
	  help you with your project, and may even maintain it. 
	</p></li></ul></div><p>
      There are different types of modules, for example:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	  Location:
	</p><p>
	  This is the most common module, your code is called when
	  the user hits the URL you specify in the mount point.
	</p></li><li class="listitem"><p>
	  Parser:
	</p><p>
	  Your code is called when Caudium parse a file containing 
	  the tags and/or containers you define.
	</p></li><li class="listitem"><p>
	  Authentication:
	</p><p>
	  Used to authenticate users with, for example, LDAP,
	  shadow, or SQL.
	</p></li><li class="listitem"><p>
	  Directory:
	</p><p>
	  For indexing files in a directory.
	</p></li><li class="listitem"><p>
	  First module:
	</p><p>
	  Module that is called just after the authentication
	  module, thus letting you handle the whole request before normal processing.
	</p></li></ul></div><p>
      There are other module types.  For a complete reference see the Roxen 1.3
      Programmer's Guide at 
      <a class="ulink" href="http://caudium.info/" target="_top">http://caudium.info/</a>.
    </p><p>
      For an example on how to write a container, see <code class="filename">fnord.pike</code> in
      <code class="filename">/Caudium/sources</code>. Because the location module is a must, here is another
      example:
    </p><div class="example"><a name="idm988"></a><p class="title"><b>Example 6.6. A sample module.</b></p><div class="example-contents"><pre class="programlisting">
// It is intended to show a simple example of a location module.

// This module output the result of the who(1) command. It is not meant to
// be really useful since it would be better to do a &lt;who /&gt; tag thus
// having data in the HTML files and code here

// This variable is shown in the configuration interface as the
// version of the module.
string CVS_version = "$Id";

// Tell Caudium that this module is 'thread safe', that is, there is no
// request-specific data in global variables.
int thread_safe=1;

#include &lt;module.h&gt;
inherit "module";
// for the http_string_answer API
inherit "caudiumlib"; 
 
// Documentation:
 
constant module_type = MODULE_LOCATION;
constant module_name = "Who";
constant module_doc  = "Send the result of the who(1) command ";
constant module_unique = 1;

// The constructor of this module.
// This function is called each time you/Caudium load the module
void create()
{
  defvar("location", "/who", "Mount point", TYPE_LOCATION, 
  "The mount point of this module"); 
  /* each string have to be on a single
   line, don't do: "The mount point of
   this module".
   You can however do "The mount point of "
   "this module";
   */
  defvar("path2who", "/usr/bin/who", 
  "Path to the who command", TYPE_FILE);
  defvar("options2who", "-a", 
  "Options given to who", TYPE_STRING);
  defvar("codebeforewho", "&lt;html&gt;&lt;body&gt;&lt;p&gt;", 
  "The code to output before who", TYPE_STRING);
  defvar("codeafterwho", "&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;", "The code to output after who",
  TYPE_STRING);
}

// This function is called when a user access mount point
// path is the path to the URL he used
// id contains Caudium global variables such as browser name,...
mixed find_file(string path, object id)
{
  // get the contents of the CIF. variables path2who and options2who 
  // and put a single space between it.
  string command = QUERY(path2who)+" "+QUERY(options2who);
  // this will write the result of command to the debug log file
  // very useful for debug
  write(sprintf("command=%s\n", command));
  string result = Process.popen(command);
  // replacing \n by \n&lt;br /&gt; for better output
  result = replace(result, "\n","\n&lt;br /&gt;");
  return http_string_answer(QUERY(codebeforewho)+result+QUERY(codeafterwho));
}
      </pre></div></div><br class="example-break"><p>
      Put this code in <code class="filename">../local/modules/who.pike</code> relative to 
      <code class="filename">/usr/local/caudium/server</code> 
      in our example. Log into the <abbr class="abbrev">CIF.</abbr>, if it is not
      the case and go into the main <code class="option">Action</code> tab -&gt; <code class="option">Cache</code> -&gt; 
      <code class="option">Flush caches</code>. Check the <code class="option">Module cache</code> check the box and press
      <code class="option">Next</code>, then <code class="option">OK</code>.
    </p><p>
      Come back to the main <code class="option">Virtual servers</code> tab and choose one of your
      servers. Do <code class="option">Add module</code> and select the <code class="option">who</code> module. If you don't have the
      who module, check your events log.
    </p><p>
      You don't need to compile to have a working module. You
      don't even need to restart the web server. When you develop a module and
      change the code every 30 seconds, you just have to push the <code class="option">Reload</code> button
      to get the changes. It takes about one second and if there was a
      compilation error the old copy remains for users.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="backtrace"></a>5. How to use a backtrace</h2></div></div></div><p>
      A backtrace is text that will show you where your program come before the 
      error. This is very useful for developers when they debug.
      The best is to take an example. Did you try the who module at the end of <a class="xref" href="#firstmodule" title="4. Your first module">Section 4, &#8220;Your first module&#8221;</a>?
      If so take it and check it works. Now change the line 
      <code class="computeroutput">string command = QUERY(path2who)+" "+QUERY(options2who);</code> to <code class="computeroutput">string command = 0;</code>.
      This will create an error because we put an int into a string. If we want to
      do that, we have to cast it (for example, use (string) 0).
      If you have not done it yet, press the <code class="option">More options</code> button in the <abbr class="abbrev">CIF.</abbr> and
      reload the module. Check that the <code class="option">Global Variables</code> -&gt; <code class="option">show_internals</code> option
      is set to yes, and try your module. You will have an error which should look like this:
    </p><div class="informalexample"><pre class="programlisting">
Caudium version: Caudium (Caudium/1.2.0)
Requested URL: /who

Error: Sprintf: Wrong type for argument 2: expected string, got int.
../local/modules/who.pike:76: 
CaudiumModule(Who,My first virtual server)-&gt;find_file("",object)
base_server/configuration.pike (version 1.91):1587: 
Configuration(My first virtual server)-&gt;low_get_file(object,0)
base_server/configuration.pike (version 1.91):1779: 
Configuration(My first virtual server)-&gt;get_file(object,0)
base_server/configuration.pike (version 1.91):1760: 
Configuration(My first virtual server)-&gt;handle_request(object)
protocols/http.pike (version 1.71):1549: unknown function()
protocols/http.pike (version 1.71):1610: 
unknown function(0,"GET /who HTTP/1.1\r\nHost: localhost\r\nUser-Agent:
Mozilla/5.0 (X11; U; Linux i686; en-US; rv:0.9.8) 
Gecko/20020214\r\nAccept: text/xml,application/xml,
application/xhtml+xml,text/html;q=0.9,text/plain"+[246])
/usr/local/pike/7.2.262/lib/modules/Stdio.pmod/module.pmod
(version 1.114):683:
Stdio.File("socket", "127.0.0.1 1260", 777 /* fd=-1 */)
-&gt;__stdio_read_callback()
      </pre></div><p>
      This seems awful but it is not. The first line is the error in itself:
    </p><div class="informalexample"><pre class="programlisting">
"Error: Sprintf: Wrong type for argument 2: expected string, got int."
The next line "../local/modules/who.pike:76: 
CaudiumModule(Who,My first virtual server)-&gt;find_file("",object)"
is the program (../local/modules/who.pike at line 76)
      </pre></div><p>
      where the error occurred. <code class="function">find_file</code> is the name of the function where the
      error occurred and you have also the arguments given to it.
      If you use the source, you see mixed find_file(string path, object id). So
      here path="" and id=object <a href="#ftn.idm1023" class="footnote" name="idm1023"><sup class="footnote">[3]</sup></a>.
      Next line is the function (<code class="function">low_get_file</code> in <code class="filename">configuration.pike</code>) that has 
      called <code class="function">find_file</code> in <code class="filename">who.pike</code>. You also have its arguments and so on.
      This backtrace is very useful when the error doesn't come directly 
      from your code but from another code before.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="printsomethingtodebuglogfile"></a>6. How to print something to debug log file</h2></div></div></div><p>
      With Caudium you can output something to the web page or to the debug log file
      located in <code class="filename">../logs/debug/default.*</code>. This way the end-user will not see any
      line you can output in your debug log file. Sending output to the debug log file is simple, just write to stdout:
      </p><pre class="programlisting">
write("my message to log file\n");
      </pre><p>
	It is also usually useful to use <code class="function">sprintf</code> to format what you want to output:
      </p><pre class="programlisting">
int i = 2; write(sprintf("i=%d\n", i));
      </pre><p>
      This line will output <code class="computeroutput">i=2</code>, but it is better when you output array or mapping, 
      as Pike is able to print them in a human-comprehensible format:
      </p><pre class="programlisting">
array a = ({ "test", "test2", 2 }); write(sprintf("a=%O\n", a));
      </pre><p>
      Which will output:
      </p><pre class="programlisting">
a = ({ /* 2 elements */
    "test",
    "test2"
})
      </pre><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	the %O format is very useful since it can output any type from 
	int to mapping. The only type you can't format is object.
      </p></div></div><div class="footnotes"><br><hr style="width:100; text-align:left;margin-left: 0"><div id="ftn.idm899" class="footnote"><p><a href="#idm899" class="para"><sup class="para">[2] </sup></a>In fact you can... just compile PHP for Caudium :)</p></div><div id="ftn.idm1023" class="footnote"><p><a href="#idm1023" class="para"><sup class="para">[3] </sup></a>Pike can't display contents of an object but can display any other types.</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="helpCaudiumcommunity"></a>Chapter 7. How to help the Caudium community</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#promoteCaudium">1. How to promote Caudium</a></span></dt><dt><span class="sect1"><a href="#writedoc">2. How to write documentation</a></span></dt><dt><span class="sect1"><a href="#CVSaccount">3. How to get a CVS account</a></span></dt><dt><span class="sect1"><a href="#testCaudium">4. How to test Caudium</a></span></dt><dt><span class="sect1"><a href="#bugreport">5. How to send a bug report</a></span></dt></dl></div><p>
    Caudium is a great product, but even with the best programmers in the world it 
    would be nothing if you didn't help us. This doesn't necessarily mean working 
    for Caudium twelve hours a day but thinking of it for a few seconds.
  </p><p>
    The next paragraph is mainly for users who just want to help us without getting
    involved too much.
  </p><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="promoteCaudium"></a>1. How to promote Caudium</h2></div></div></div><p>
      Caudium, and Roxen problems are not technical. Instead, they are
      advertising and marketing. Caudium needs to become
      recognized. It could the best product in the world, but if
      nobody knows, it will not be used. To help Caudium to become
      recognized for its quality there are some simple things we can
      do together:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	  Try it, and give us feedback about your experience. 
	</p></li><li class="listitem"><p>
	   Write some documentation. Without documentation, a project is useless.
	</p></li><li class="listitem"><p>
	  Recommend Caudium to some people you know. You don't really have to tell
	  them to try it now or they will die, just tell him about it. If other
	  people tell them the same thing, chances are that they will install it.
	  When these people install Caudium, they will look for documentation.
	</p></li><li class="listitem"><p>
	   Mention Caudium in newsgroups/web sites telling them what you think of it.
	</p></li><li class="listitem"><p>
	   Translate documentation.
	</p></li></ul></div><p>
      If you do this, you will help promote Caudium's
      success. Remember, one of Caudium disadvantages is that the
      community is too small right now.
    </p><p>
      The next paragraph is for people who want to get involved a little more, but
      don't have lot of time, and/or are not technically minded.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="writedoc"></a>2. How to write documentation</h2></div></div></div><p>
      There are two types of documentation needed for Caudium:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
	  Press articles.
	</p><p> 
	  You can write press articles about Caudium.
	</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">
	    Note for French writers:
	  </h3><p>
	    You can contact us for that.
	  </p></div><p>
	  This type of documentation is usually not really helpful since few in the
	  community will read it. It is useful mainly for advertising (even if you
	  made a very technical article, this is useful).
	</p></li><li class="listitem"><p>
	  Documentation available from Internet.
	</p><p>
	  This type of documentation is a must; Caudium can't exist
	  without it. This documentation will help Caudium's newbies,
	  and will also be useful for developers. One good way to
	  start with Caudium is using the Roxen 1.3 documentation. The
	  developers should also see the autodoc. These are in-line
	  documents made in the sources, and available as formatted 
	  HTML output at <a class="ulink" href="http://caudium.net/" target="_top">http://caudium.net/</a>.
	</p><p>
	  There is also a lack for a more in-depth documentation for
	  developer. Examples include how to code non-blocking
	  sockets, how to use a backtrace, how to use the
	  <code class="function">do_output_tag</code>, and when should I put <em class="parameter"><code>thread_safe=1</code></em>.  I
	  remember spending hours trying to understand some
	  of these things on IRC without any documentation
	  available. This sort of documentation should be written by
	  one of the top developers.
	</p><p>
	  This documentation is written using XSLT, but if you don't
	  know it, that's not a problem. Give us whatever format you
	  want, we will translate it.  It is the same for the
	  language. If you don't speak English, you can write it in
	  your own language and we will translate. We will also proof-read
          your work carefully in order to correct any typos or inaccuracies
	  you might leave.
	</p><p>
	  To write this type of documentation, contact the person in charge of the
	  documentation project, ice at caudium dot net.
	</p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="CVSaccount"></a>3. How to get a CVS account</h2></div></div></div><p>
      Unlike other projects, it's relatively not much hassle to get access to
      Caudium cvs tree. Even if you are a beginner you can have cvs access;
      we just ask you not to change Caudium's core at the beginning.
    </p><p>
      To get a CVS account, come on IRC or send a mail to kiwi at caudium dot net and
      explain your plan.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="testCaudium"></a>4. How to test Caudium</h2></div></div></div><p>
      There is a test suite for Caudium written in Expect which uses
      TCL and DejaGNU. If you want to use it, fetch it from Caudium's
      CVS repository with the <code class="option">-P</code> testsuite option (the information on
      this CVS repository is on <a class="ulink" href="http://caudium.net/" target="_top">http://caudium.net/</a>.) 
      Note that this test suite is not maintained, and needs some work.
    </p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bugreport"></a>5. How to send a bug report</h2></div></div></div><p>
      To send a bug report, copy/paste the error from Caudium's log file (including 
      backtrace, see <a class="xref" href="#backtrace" title="5. How to use a backtrace">Section 5, &#8220;How to use a backtrace&#8221;</a>), your configuration, and the context in
      which it happened.
    </p><p>
      Go to <a class="ulink" href="http://caudium.net/" target="_top">http://caudium.net/</a> and choose bug tracking on the left and follow the instructions.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="idm1096"></a>Chapter 8. Revision History/Credits/The End</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#idm1098">1. Revision History</a></span></dt><dt><span class="sect1"><a href="#idm1189">2. Credits and contributors</a></span></dt><dt><span class="sect1"><a href="#idm1209">3. The End</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm1098"></a>1. Revision History</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Version 2.2 : September 20, 2002</p><table border="0" summary="Simple list" class="simplelist"><tr><td>Added images and icons.</td></tr><tr><td>Better use of Docbook.</td></tr><tr><td>Updates in the FreeBSD ports section.</td></tr><tr><td>Few more fixes.</td></tr></table></li><li class="listitem"><p>Version 2.1 : June 26, 2002</p><table border="0" summary="Simple list" class="simplelist"><tr><td>Little language and cosmetic corrections.</td></tr><tr><td>Added the script for image selection in the your first Pike script.</td></tr><tr><td>Corrections in the FreeBSD ports section.</td></tr><tr><td>The file is now well-formed XML.</td></tr></table></li><li class="listitem"><p>Version 2.0 :  June 14, 2002</p><table border="0" summary="Simple list" class="simplelist"><tr><td>LDP Review of documentation.</td></tr><tr><td>Added cross reference to full GFDL in Appendix A.</td></tr><tr><td>Converted to Docbook XML 4.1.2.</td></tr><tr><td>Removed editing notations that are corrected.</td></tr><tr><td>Corrected links to LDP (Linux Documentation Project).</td></tr><tr><td>Made sentence level corrections-spelling, grammar, etc.</td></tr></table></li><li class="listitem"><p>Version 1.0 :  June 6, 2002</p><table border="0" summary="Simple list" class="simplelist"><tr><td>Initial Release</td></tr><tr><td>Submitted to the LDP</td></tr></table></li><li class="listitem"><p>Version 0.91 : May 22, 2002</p><table border="0" summary="Simple list" class="simplelist"><tr><td>The SGML source is now the authoritative source</td></tr><tr><td>The SGML source is now correctly indented</td></tr><tr><td>Many little SGML changes in the document</td></tr><tr><td>Added the Upgrading Caudium paragraph</td></tr><tr><td>Added a note about the start script config-dir option</td></tr></table></li><li class="listitem"><p>Version 0.9 : May 7, 2002</p><table border="0" summary="Simple list" class="simplelist"><tr><td>Better HTML conformance to avoid Caudium crash on caudium.info.</td></tr><tr><td>Inserting the notes from Kiwi, Grendel and other into the document.</td></tr><tr><td>Removed all TODO and #define sections.</td></tr><tr><td>Completed the test suite section.</td></tr><tr><td>Added the contributors section.</td></tr><tr><td>Now docbook2ps and docbook2pdf correctly parse the SGML file.</td></tr></table></li><li class="listitem"><p>Version 0.05 : April 4, 2002</p><p>This HOWTO is in Docbook format. Thanks to Thomas Marteau.</p></li><li class="listitem"><p>Version 0.04 : March 26, 2002</p><table border="0" summary="Simple list" class="simplelist"><tr><td>Added Introduction and license.</td></tr><tr><td>Added a note in "Your first pike script".</td></tr><tr><td>Corrected typo in paragraph number.</td></tr><tr><td>Re-organization of the document.</td></tr></table></li><li class="listitem"><p>Version 0.03 : March 22, 2002</p><p>More Caudium disadvantages and some useful corrections from people at the Caudium general mailing list.</p><p>Answers:
	  </p><table border="0" summary="Simple list" class="simplelist"><tr><td>How to get UltraLog working.</td></tr><tr><td>How to benchmark a web server.</td></tr><tr><td>How to use a backtrace.</td></tr><tr><td>How to print something to debug log file.</td></tr><tr><td>How to get CAMAS from cvs/source.</td></tr></table></li><li class="listitem"><p>Version 0.02 : March 18, 2002</p><p>Minor correction in other answers.</p><p>Answers:
	  </p><table border="0" summary="Simple list" class="simplelist"><tr><td>How to run Caudium as a non-privileged user.</td></tr><tr><td>How to secure Caudium.</td></tr><tr><td>How to tune Caudium for best performance.</td></tr><tr><td>How to get packages for Debian GNU/Linux.</td></tr><tr><td>How to get packages for FreeBSD.</td></tr><tr><td>How to get packages for Solaris.</td></tr><tr><td>How to use your own fonts.</td></tr><tr><td>How to help Caudium Community.</td></tr></table></li><li class="listitem"><p>Version 0.01 : March 11, 2002</p><p>Initial revision. Plain text format.</p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm1189"></a>2. Credits and contributors</h2></div></div></div><p>Here is the list of people that helped me in one way or another to
      get this HOWTO written:
    </p><table border="0" summary="Simple list" class="simplelist"><tr><td>Joe Follansbee &lt;joef at compelinteractive dot com&gt;</td></tr><tr><td>Grammar, spelling and syntax cleanup.</td></tr><tr><td>Bill Welliver &lt;Bill.Welliver at fairchildsemi dot com&gt;</td></tr><tr><td>Minor changes.</td></tr><tr><td>Chris Davies &lt;mcd at daviesinc dot com&gt;</td></tr><tr><td>Major contribution to the Caudium's disadvantages, many little fixes and spelling corrections.</td></tr><tr><td>Martin Friese &lt;mf at bauko dot bv dot tu-berlin dot de&gt;</td></tr><tr><td>Update in the platform section.</td></tr><tr><td>Xavier Beaudouin &lt;kiwi at oav dot net&gt;</td></tr><tr><td>All tuning sections, cosmetics changes.</td></tr><tr><td>Marek Habersack &lt;grendel at caudium dot net&gt;</td></tr><tr><td>Minor fixes and latex conversion.</td></tr><tr><td>Thomas Marteau &lt;marteaut at tuxfamily dot org&gt;</td></tr><tr><td>Minor fixes and SGML conversion.</td></tr><tr><td>John Wenger &lt;JohnWenger at EarthLink dot Net&gt;</td></tr><tr><td>Editing, review and comments.</td></tr></table></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm1209"></a>3. The End</h2></div></div></div><p>Thanks for reading. I hope this HOWTO will help you
    discover Caudium's power. And remember this quotation:

    </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>Documentation is like sex: when it is good, it is very, very good; and
      when it is bad, it is better than nothing.</p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Dick Brandon</span></td></tr></table></div><p>
    </p><p>If you have any questions about this documentation, contact me at <code class="email">&lt;<a class="email" href="mailto:vida%20at%20caudium%20dot%20net">vida at caudium dot net</a>&gt;</code> or the Caudium general mailing list at <code class="email">&lt;<a class="email" href="mailto:general%20at%20oav%20dot%20net">general at oav dot net</a>&gt;</code></p></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="gfdl"></a>Appendix A. GNU Free Documentation License</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#gfdl-0">1. PREAMBLE</a></span></dt><dt><span class="sect1"><a href="#gfdl-1">2. APPLICABILITY AND DEFINITIONS</a></span></dt><dt><span class="sect1"><a href="#gfdl-2">3. VERBATIM COPYING</a></span></dt><dt><span class="sect1"><a href="#gfdl-3">4. COPYING IN QUANTITY</a></span></dt><dt><span class="sect1"><a href="#gfdl-4">5. MODIFICATIONS</a></span></dt><dt><span class="sect1"><a href="#gfdl-5">6. COMBINING DOCUMENTS</a></span></dt><dt><span class="sect1"><a href="#gfdl-6">7. COLLECTIONS OF DOCUMENTS</a></span></dt><dt><span class="sect1"><a href="#gfdl-7">8. AGGREGATION WITH INDEPENDENT WORKS</a></span></dt><dt><span class="sect1"><a href="#gfdl-8">9. TRANSLATION</a></span></dt><dt><span class="sect1"><a href="#gfdl-9">10. TERMINATION</a></span></dt><dt><span class="sect1"><a href="#gfdl-10">11. FUTURE REVISIONS OF THIS LICENSE</a></span></dt><dt><span class="sect1"><a href="#gfdl-11">12. How to use this License for your documents</a></span></dt></dl></div><p>Version 1.1, March 2000</p><div class="blockquote"><blockquote class="blockquote"><p>Copyright (C) 2000  Free Software Foundation, Inc.
59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.</p></blockquote></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-0"></a>1. PREAMBLE</h2></div></div></div><p>The purpose of this License is to make a manual, textbook,
    or other written document "free" in the sense of freedom: to
    assure everyone the effective freedom to copy and redistribute it,
    with or without modifying it, either commercially or
    noncommercially.  Secondarily, this License preserves for the
    author and publisher a way to get credit for their work, while not
    being considered responsible for modifications made by
    others.</p><p>This License is a kind of "copyleft", which means that
    derivative works of the document must themselves be free in the
    same sense.  It complements the GNU General Public License, which
    is a copyleft license designed for free software.</p><p>We have designed this License in order to use it for manuals
    for free software, because free software needs free documentation:
    a free program should come with manuals providing the same
    freedoms that the software does.  But this License is not limited
    to software manuals; it can be used for any textual work,
    regardless of subject matter or whether it is published as a
    printed book.  We recommend this License principally for works
    whose purpose is instruction or reference.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-1"></a>2. APPLICABILITY AND DEFINITIONS</h2></div></div></div><p>This License applies to any manual or other work that
    contains a notice placed by the copyright holder saying it can be
    distributed under the terms of this License.  The "Document",
    below, refers to any such manual or work.  Any member of the
    public is a licensee, and is addressed as "you".</p><p>A "Modified Version" of the Document means any work
    containing the Document or a portion of it, either copied
    verbatim, or with modifications and/or translated into another
    language.</p><p>A "Secondary Section" is a named appendix or a front-matter
    section of the Document that deals exclusively with the
    relationship of the publishers or authors of the Document to the
    Document's overall subject (or to related matters) and contains
    nothing that could fall directly within that overall subject.
    (For example, if the Document is in part a textbook of
    mathematics, a Secondary Section may not explain any mathematics.)
    The relationship could be a matter of historical connection with
    the subject or with related matters, or of legal, commercial,
    philosophical, ethical or political position regarding
    them.</p><p>The "Invariant Sections" are certain Secondary Sections
    whose titles are designated, as being those of Invariant Sections,
    in the notice that says that the Document is released under this
    License.</p><p>The "Cover Texts" are certain short passages of text that
    are listed, as Front-Cover Texts or Back-Cover Texts, in the
    notice that says that the Document is released under this
    License.</p><p>A "Transparent" copy of the Document means a
    machine-readable copy, represented in a format whose specification
    is available to the general public, whose contents can be viewed
    and edited directly and straightforwardly with generic text
    editors or (for images composed of pixels) generic paint programs
    or (for drawings) some widely available drawing editor, and that
    is suitable for input to text formatters or for automatic
    translation to a variety of formats suitable for input to text
    formatters.  A copy made in an otherwise Transparent file format
    whose markup has been designed to thwart or discourage subsequent
    modification by readers is not Transparent.  A copy that is not
    "Transparent" is called "Opaque".</p><p>Examples of suitable formats for Transparent copies include
    plain ASCII without markup, Texinfo input format, LaTeX input
    format, SGML or XML using a publicly available DTD, and
    standard-conforming simple HTML designed for human modification.
    Opaque formats include PostScript, PDF, proprietary formats that
    can be read and edited only by proprietary word processors, SGML
    or XML for which the DTD and/or processing tools are not generally
    available, and the machine-generated HTML produced by some word
    processors for output purposes only.</p><p>The "Title Page" means, for a printed book, the title page
    itself, plus such following pages as are needed to hold, legibly,
    the material this License requires to appear in the title page.
    For works in formats which do not have any title page as such,
    "Title Page" means the text near the most prominent appearance of
    the work's title, preceding the beginning of the body of the
    text.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-2"></a>3. VERBATIM COPYING</h2></div></div></div><p>You may copy and distribute the Document in any medium,
    either commercially or noncommercially, provided that this
    License, the copyright notices, and the license notice saying this
    License applies to the Document are reproduced in all copies, and
    that you add no other conditions whatsoever to those of this
    License.  You may not use technical measures to obstruct or
    control the reading or further copying of the copies you make or
    distribute.  However, you may accept compensation in exchange for
    copies.  If you distribute a large enough number of copies you
    must also follow the conditions in section 3.</p><p>You may also lend copies, under the same conditions stated
    above, and you may publicly display copies.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-3"></a>4. COPYING IN QUANTITY</h2></div></div></div><p>If you publish printed copies of the Document numbering more
    than 100, and the Document's license notice requires Cover Texts,
    you must enclose the copies in covers that carry, clearly and
    legibly, all these Cover Texts: Front-Cover Texts on the front
    cover, and Back-Cover Texts on the back cover.  Both covers must
    also clearly and legibly identify you as the publisher of these
    copies.  The front cover must present the full title with all
    words of the title equally prominent and visible.  You may add
    other material on the covers in addition.  Copying with changes
    limited to the covers, as long as they preserve the title of the
    Document and satisfy these conditions, can be treated as verbatim
    copying in other respects.</p><p>If the required texts for either cover are too voluminous to
    fit legibly, you should put the first ones listed (as many as fit
    reasonably) on the actual cover, and continue the rest onto
    adjacent pages.</p><p>If you publish or distribute Opaque copies of the Document
    numbering more than 100, you must either include a
    machine-readable Transparent copy along with each Opaque copy, or
    state in or with each Opaque copy a publicly-accessible
    computer-network location containing a complete Transparent copy
    of the Document, free of added material, which the general
    network-using public has access to download anonymously at no
    charge using public-standard network protocols.  If you use the
    latter option, you must take reasonably prudent steps, when you
    begin distribution of Opaque copies in quantity, to ensure that
    this Transparent copy will remain thus accessible at the stated
    location until at least one year after the last time you
    distribute an Opaque copy (directly or through your agents or
    retailers) of that edition to the public.</p><p>It is requested, but not required, that you contact the
    authors of the Document well before redistributing any large
    number of copies, to give them a chance to provide you with an
    updated version of the Document.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-4"></a>5. MODIFICATIONS</h2></div></div></div><p>You may copy and distribute a Modified Version of the
    Document under the conditions of sections 2 and 3 above, provided
    that you release the Modified Version under precisely this
    License, with the Modified Version filling the role of the
    Document, thus licensing distribution and modification of the
    Modified Version to whoever possesses a copy of it.  In addition,
    you must do these things in the Modified Version:</p><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem"><p>Use in the Title Page
      (and on the covers, if any) a title distinct from that of the
      Document, and from those of previous versions (which should, if
      there were any, be listed in the History section of the
      Document).  You may use the same title as a previous version if
      the original publisher of that version gives permission.</p></li><li class="listitem"><p>List on the Title Page,
      as authors, one or more persons or entities responsible for
      authorship of the modifications in the Modified Version,
      together with at least five of the principal authors of the
      Document (all of its principal authors, if it has less than
      five).</p></li><li class="listitem"><p>State on the Title page
      the name of the publisher of the Modified Version, as the
      publisher.</p></li><li class="listitem"><p>Preserve all the
      copyright notices of the Document.</p></li><li class="listitem"><p>Add an appropriate
      copyright notice for your modifications adjacent to the other
      copyright notices.</p></li><li class="listitem"><p>Include, immediately
      after the copyright notices, a license notice giving the public
      permission to use the Modified Version under the terms of this
      License, in the form shown in the Addendum below.</p></li><li class="listitem"><p>Preserve in that license
      notice the full lists of Invariant Sections and required Cover
      Texts given in the Document's license notice.</p></li><li class="listitem"><p>Include an unaltered
      copy of this License.</p></li><li class="listitem"><p>Preserve the section
      entitled "History", and its title, and add to it an item stating
      at least the title, year, new authors, and publisher of the
      Modified Version as given on the Title Page.  If there is no
      section entitled "History" in the Document, create one stating
      the title, year, authors, and publisher of the Document as given
      on its Title Page, then add an item describing the Modified
      Version as stated in the previous sentence.</p></li><li class="listitem"><p>Preserve the network
      location, if any, given in the Document for public access to a
      Transparent copy of the Document, and likewise the network
      locations given in the Document for previous versions it was
      based on.  These may be placed in the "History" section.  You
      may omit a network location for a work that was published at
      least four years before the Document itself, or if the original
      publisher of the version it refers to gives permission.</p></li><li class="listitem"><p>In any section entitled
      "Acknowledgements" or "Dedications", preserve the section's
      title, and preserve in the section all the substance and tone of
      each of the contributor acknowledgements and/or dedications
      given therein.</p></li><li class="listitem"><p>Preserve all the
      Invariant Sections of the Document, unaltered in their text and
      in their titles.  Section numbers or the equivalent are not
      considered part of the section titles.</p></li><li class="listitem"><p>Delete any section
      entitled "Endorsements".  Such a section may not be included in
      the Modified Version.</p></li><li class="listitem"><p>Do not retitle any
      existing section as "Endorsements" or to conflict in title with
      any Invariant Section.</p></li></ol></div><p>If the Modified Version includes new front-matter sections
    or appendices that qualify as Secondary Sections and contain no
    material copied from the Document, you may at your option
    designate some or all of these sections as invariant.  To do this,
    add their titles to the list of Invariant Sections in the Modified
    Version's license notice.  These titles must be distinct from any
    other section titles.</p><p>You may add a section entitled "Endorsements", provided it
    contains nothing but endorsements of your Modified Version by
    various parties--for example, statements of peer review or that
    the text has been approved by an organization as the authoritative
    definition of a standard.</p><p>You may add a passage of up to five words as a Front-Cover
    Text, and a passage of up to 25 words as a Back-Cover Text, to the
    end of the list of Cover Texts in the Modified Version.  Only one
    passage of Front-Cover Text and one of Back-Cover Text may be
    added by (or through arrangements made by) any one entity.  If the
    Document already includes a cover text for the same cover,
    previously added by you or by arrangement made by the same entity
    you are acting on behalf of, you may not add another; but you may
    replace the old one, on explicit permission from the previous
    publisher that added the old one.</p><p>The author(s) and publisher(s) of the Document do not by
    this License give permission to use their names for publicity for
    or to assert or imply endorsement of any Modified Version.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-5"></a>6. COMBINING DOCUMENTS</h2></div></div></div><p>You may combine the Document with other documents released
    under this License, under the terms defined in section 4 above for
    modified versions, provided that you include in the combination
    all of the Invariant Sections of all of the original documents,
    unmodified, and list them all as Invariant Sections of your
    combined work in its license notice.</p><p>The combined work need only contain one copy of this
    License, and multiple identical Invariant Sections may be replaced
    with a single copy.  If there are multiple Invariant Sections with
    the same name but different contents, make the title of each such
    section unique by adding at the end of it, in parentheses, the
    name of the original author or publisher of that section if known,
    or else a unique number.  Make the same adjustment to the section
    titles in the list of Invariant Sections in the license notice of
    the combined work.</p><p>In the combination, you must combine any sections entitled
    "History" in the various original documents, forming one section
    entitled "History"; likewise combine any sections entitled
    "Acknowledgements", and any sections entitled "Dedications".  You
    must delete all sections entitled "Endorsements."</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-6"></a>7. COLLECTIONS OF DOCUMENTS</h2></div></div></div><p>You may make a collection consisting of the Document and
    other documents released under this License, and replace the
    individual copies of this License in the various documents with a
    single copy that is included in the collection, provided that you
    follow the rules of this License for verbatim copying of each of
    the documents in all other respects.</p><p>You may extract a single document from such a collection,
    and distribute it individually under this License, provided you
    insert a copy of this License into the extracted document, and
    follow this License in all other respects regarding verbatim
    copying of that document.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-7"></a>8. AGGREGATION WITH INDEPENDENT WORKS</h2></div></div></div><p>A compilation of the Document or its derivatives with other
    separate and independent documents or works, in or on a volume of
    a storage or distribution medium, does not as a whole count as a
    Modified Version of the Document, provided no compilation
    copyright is claimed for the compilation.  Such a compilation is
    called an "aggregate", and this License does not apply to the
    other self-contained works thus compiled with the Document, on
    account of their being thus compiled, if they are not themselves
    derivative works of the Document.</p><p>If the Cover Text requirement of section 3 is applicable to
    these copies of the Document, then if the Document is less than
    one quarter of the entire aggregate, the Document's Cover Texts
    may be placed on covers that surround only the Document within the
    aggregate.  Otherwise they must appear on covers around the whole
    aggregate.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-8"></a>9. TRANSLATION</h2></div></div></div><p>Translation is considered a kind of modification, so you may
    distribute translations of the Document under the terms of section
    4.  Replacing Invariant Sections with translations requires
    special permission from their copyright holders, but you may
    include translations of some or all Invariant Sections in addition
    to the original versions of these Invariant Sections.  You may
    include a translation of this License provided that you also
    include the original English version of this License.  In case of
    a disagreement between the translation and the original English
    version of this License, the original English version will
    prevail.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-9"></a>10. TERMINATION</h2></div></div></div><p>You may not copy, modify, sublicense, or distribute the
    Document except as expressly provided for under this License.  Any
    other attempt to copy, modify, sublicense or distribute the
    Document is void, and will automatically terminate your rights
    under this License.  However, parties who have received copies, or
    rights, from you under this License will not have their licenses
    terminated so long as such parties remain in full
    compliance.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-10"></a>11. FUTURE REVISIONS OF THIS LICENSE</h2></div></div></div><p>The Free Software Foundation may publish new, revised
    versions of the GNU Free Documentation License from time to time.
    Such new versions will be similar in spirit to the present
    version, but may differ in detail to address new problems or
    concerns.  See <a class="ulink" href="http://www.gnu.org/copyleft/" target="_top">http://www.gnu.org/copyleft/</a>.</p><p>Each version of the License is given a distinguishing
    version number.  If the Document specifies that a particular
    numbered version of this License "or any later version" applies to
    it, you have the option of following the terms and conditions
    either of that specified version or of any later version that has
    been published (not as a draft) by the Free Software Foundation.
    If the Document does not specify a version number of this License,
    you may choose any version ever published (not as a draft) by the
    Free Software Foundation.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gfdl-11"></a>12. How to use this License for your documents</h2></div></div></div><p>To use this License in a document you have written, include
    a copy of the License in the document and put the following
    copyright and license notices just after the title page:</p><div class="blockquote"><blockquote class="blockquote"><p>
      Copyright (c)  YEAR  YOUR NAME.
      Permission is granted to copy, distribute and/or modify this document
      under the terms of the GNU Free Documentation License, Version 1.1
      or any later version published by the Free Software Foundation;
      with the Invariant Sections being LIST THEIR TITLES, with the
      Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.
      A copy of the license is included in the section entitled "GNU
      Free Documentation License".
</p></blockquote></div><p>If you have no Invariant Sections, write "with no Invariant
    Sections" instead of saying which ones are invariant.  If you have
    no Front-Cover Texts, write "no Front-Cover Texts" instead of
    "Front-Cover Texts being LIST"; likewise for Back-Cover
    Texts.</p><p>If your document contains nontrivial examples of program
    code, we recommend releasing these examples in parallel under your
    choice of free software license, such as the GNU General Public
    License, to permit their use in free software.</p></div></div></div></body></html>
