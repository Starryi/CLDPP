<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.72">
 <TITLE>Diskless Nodes HOW-TO document for Linux: Diskless with "Live Linux CDROM" </TITLE>
 <LINK HREF="Diskless-HOWTO-4.html" REL=next>
 <LINK HREF="Diskless-HOWTO-2.html" REL=previous>
 <LINK HREF="Diskless-HOWTO.html#toc3" REL=contents>
</HEAD>
<BODY>
<A HREF="Diskless-HOWTO-4.html">Next</A>
<A HREF="Diskless-HOWTO-2.html">Previous</A>
<A HREF="Diskless-HOWTO.html#toc3">Contents</A>
<HR>
<H2><A NAME="livecdrom"></A> <A NAME="s3">3.</A> <A HREF="Diskless-HOWTO.html#toc3">Diskless with "Live Linux CDROM" </A></H2>

<P>The "Live Linux CDROM" is a CDROM which has the entire Linux Operating System filesystem
on the CDROM. It is made by copying the live Linux system on to CDROM. The "Live Linux CDROM"
directly boots the Linux operating system from the CDROM drive.
But you need to setup the BIOS to first boot from CDROM. Generally the boot order is :
Floppy Drive, Hard disk, CDROM. You can enter BIOS setup, by powering on the computer and 
presssing the DEL key.</P>
<P>Get the "Live Linux CDROM" from 
<UL>
<LI> 
<A HREF="ftp://ftp-linux.cc.gatech.edu/pub/linux/distributions/suse/suse/i386">Suse live-eval</A> and look for live-eval.
The main site 
<A HREF="http://www.suse.com">http://www.suse.com</A> click on download.</LI>
<LI> 
<A HREF="http://www.demolinux.org">http://www.demolinux.org</A></LI>
<LI> 
<A HREF="http://www.knopper.net/knoppix">http://www.knopper.net/knoppix</A></LI>
<LI> 
<A HREF="http://www.ocslink.com/~blunier">http://www.ocslink.com/~blunier</A></LI>
<LI> 
<A HREF="http://lab.dyne.org/DyneBolic">http://lab.dyne.org/DyneBolic</A></LI>
<LI> 
<A HREF="http://directory.google.com/Top/Computers/Software/Operating_Systems/Linux/Distributions/Live_CD/?tc=1">Google Live Linux</A></LI>
</UL>
</P>
<P>Diskless workstation with "Live Linux CDROM" is becoming a reality because
of the following reasons:
<OL>
<LI> RAM prices are all time low and 512MB RAM costs only US$70.</LI>
<LI> CDROM drives are becoming extremely fast and current read speed is topping at 72X.</LI>
<LI> CDROM IDE drives are very cheap, CDROM with 52X read speed is costing only US$33.</LI>
<LI> DVD-ROM is also getting very cheap and can carry 5 Gigabyte of Linux software and
is three times faster than CDROM drive.</LI>
</OL>
</P>
<P>A big advantage of Live Linux CDROM over other methods of diskless operations like
EEPROM is that it is very easy to setup and you can very easily upgrade the Linux CDROM
with new versions of the Linux kernel every three months. Simply throw away the old Live
Linux CDROM and pop-in the new version Live Linux CDROM. Upgrade is just 20 seconds and 
the cost of Linux CDROM is 30 cents (less than a US dollar!).
In near future, Live Linux CDROM + DVD-ROM will rule the computer desktops.</P>
<P><B>FIVE SECONDS UPGRADE:
<I>Live Linux CDROM promotes RAPID Operating Sytem UPGRADE. You can upgrade an OS in less
than 5 seconds!! Live Linux CDROM introduces the concept of mass upgrade and RAPID ACTION.
Simply throw away the old Live Linux CDROM and pop in new CDROM and you are done upgrading!</I></B></P>
<P>With Live Linux CDROM, you do not need a hard-disk, floppy drives and others. All you need to 
build a diskless workstation is :
<OL>
<LI> Live Linux CDROM</LI>
<LI> CPU</LI>
<LI> Mother board</LI>
<LI> NIC (Network Interface Card)</LI>
<LI> CDROM drive (IDE or SCSI)</LI>
<LI> RAM (32 MB minimum for full graphics and 16 MB minimum for console mode)</LI>
</OL>
</P>
<P>For best prices on RAM and CDROM IDE drives check 
auctions in online stores like 
Egghead 
<A HREF="http://www.egghead.com">http://www.egghead.com</A> or local stores in your city like
<A HREF="http://www.ubm.com">UBM, Houston</A>.</P>
<P>After you boot "Live Linux CDROM", you can mount the hard disk partitions from remote
Linux servers. And you can use 
<A HREF="http://www.uk.research.att.com/vnc">VNC</A>
to access MS Windows 2000 and Linux servers.
Or you can use 
<A HREF="http://www.thincomputinginc.com">WinConnect</A> to access
MS Windows applications like MS Office, Outlook etc. But WinConnect needs MS Windows XP/2000/NT
server.</P>
<P>To evaluate the CDROM/DVD drives use the following software from
<A HREF="http://www.cdspeed2000.com">http://www.cdspeed2000.com</A>. This site also gives the speed comparison of
drives from different vendors. The top speed CDROM drive is from Kenwood at
<A HREF="http://www.kenwoodtech.com">http://www.kenwoodtech.com</A> at 72x speed.</P>
<H2><A NAME="ss3.1">3.1</A> <A HREF="Diskless-HOWTO.html#toc3.1">Build a Live Linux CDROM</A>
</H2>

<P>You can build your own Live Linux CDROM and customize the kernel, hardware support, loadable
module support etc.</P>
<P>This section was originally written by Hans de Goede 
<A HREF="mailto:    j.w.r.degoede@et.tudelft.nl     ">    j.w.r.degoede@et.tudelft.nl     </A>
for the Diskless-root-NFS-HOWTO. I modified it slightly in order to reflect some differences
between this document and the Diskless-root-NFS-HOWTO.</P>
<P>Much of the above also goes for booting from cdrom. Why would one want to boot a machine
from cdrom? Booting from cdrom is interesting everywhere one wants to run a very specific
application, like a kiosk, a library database program or an internet cafe, and one
doesn't have a network or a server to use a root over nfs setup.</P>
<P>Creating a test setup</P>
<P>Now that we know what we want to do and how, it's time to create a test setup: </P>
<P>
<UL>
<LI>    For starters just take one of the machines which you want to use and put in a big
disk and a cd burner.
</LI>
<LI>    Install your linux of choice on this machine, and leave a 650 MB partition free for
the test setup. This install will be used to make the iso image and to burn the cd's
from, so install the necessary tools. It will also be used to restore any booboo's
which leave the test setup unbootable.
</LI>
<LI>    On the 650 mb partition install your linux of choice with the setup you want to have
on the cd, this will be the test setup.
</LI>
<LI>    Boot the test setup.
</LI>
<LI>    Compile a kernel with isofs and cdrom support compiled in.
</LI>
<LI>    Configure the test setup as described above with the root filesystem mounted read
only.
</LI>
<LI>    Verify that the test setup automagically boots and everything works.
</LI>
<LI>    Boot the main install and mount the 650 MB partition on /test of the main install.
</LI>
<LI>    Put the following in a file called /test/etc/rc.d/rc.iso, this file will be sourced
at the beginning of rc.sysinit to create /var: 
<HR>
<PRE>
                    #/var
                    echo Creating /var ...
                    mke2fs -q -i 1024 /dev/ram1 16384
                    mount /dev/ram1 /var -o defaults,rw
                    cp -a /lib/var /
</PRE>
<HR>

</LI>
<LI>    Edit /test/etc/rc.sysinit, comment the lines where the root is remounted rw, and add
the following 2 lines directly after setting the PATH: 
<HR>
<PRE>
                    #to boot from cdrom
                    . /etc/rc.d/rc.iso
</PRE>
<HR>

</LI>
<LI>    Copy the following to a script and execute it to make a template for /var and create
/tmp and /etc/mtab links. 
<HR>
<PRE>
                    #!/bin/sh
                    echo tmp
                    rm -fR /test/tmp
                    ln -s var/tmp /test/tmp

                    ###
                    echo mtab
                    touch /test/proc/mounts
                    rm /test/etc/mtab
                    ln -s /proc/mounts /test/etc/mtab

                    ###
                    echo var
                    mv /test/var/lib /test/lib/var-lib
                    mv /test/var /test/lib
                    mkdir /test/var
                    ln -s /lib/var-lib /test/lib/var/lib
                    rm -fR /test/lib/var/catman
                    rm -fR /test/lib/var/log/httpd
                    rm -f /test/lib/var/log/samba/*
                    for i in `find /test/lib/var/log -type f`; do
                      cat /dev/null > $i;
                    done
                    rm `find /test/lib/var/lock -type f`
                    rm `find /test/lib/var/run -type f`
</PRE>
<HR>

</LI>
<LI>    Remove the creation of /etc/issue* from /test/etc/rc.local: it will only fail.
</LI>
<LI>    Now boot the test partition again, it will be read only just like a cdrom. If
something doesn't work reboot to the working partition fix it, try again etc. Or you
could remount / rw, fix it, then reboot straight into to test partition again. To
remount / rw type: 
<HR>
<PRE>
                    # mount -o remount,rw /
</PRE>
<HR>
</LI>
</UL>
</P>
<P>Creating the CD</P>
<P>If you need more information than you can find below, please refer to the
CD-Writing-HOWTO.</P>
<P>Creating a boot image</P>
<P>First of all, boot into the working partition. To create a bootable cd we'll need an
image of a bootable floppy. Just dd-ing a zImage doesn't work since the loader at the
beginning of the zimage doesn't seem to like the fake floppydrive a bootable cd creates.
So we'll use syslinux instead. </P>
<P>
<UL>
<LI>    Get boot.img from a redhat cd.
</LI>
<LI>    Mount boot.img somewhere through loopback by typing: 
<HR>
<PRE>
                    # mount boot.img somewhere -o loop -t vfat
</PRE>
<HR>

</LI>
<LI>    Remove everything from boot.img except for ldlinux.sys and syslinux.cfg.
</LI>
<LI>    Cp the kernel-image from the test partition to boot.img.
</LI>
<LI>    Edit syslinux.cfg so that it contains the following, of course replace zImage by the
appropriate image name: 

<HR>
<PRE>
                    default linux 

                    label linux
                    kernel zImage
                    append root=/dev/&lt;insert your cdrom device here>
</PRE>
<HR>

</LI>
<LI>    Umount boot.img: 
<HR>
<PRE>
                    # umount somewhere
</PRE>
<HR>

</LI>
<LI>    If your /etc/mtab is a link to /proc/mounts, umount won't automagically free
/dev/loop0 so free it by typing: 
<HR>
<PRE>
                    # losetup -d /dev/loop0
</PRE>
<HR>
</LI>
</UL>
</P>
<P>Creating the iso image</P>
<P>Now that we have the boot image and an install that can boot from a readonly mount it's
time to create an iso image of the cd: </P>
<P>
<UL>
<LI>    Copy boot.img to /test
</LI>
<LI>    Cd to the directory where you want to store the image and make sure it's on a
partition with enough free space.
</LI>
<LI>    Now generate the image by typing: 
<HR>
<PRE>
                      # mkisofs -R -b boot.img -c boot.catalog -o boot.iso /test
</PRE>
<HR>
</LI>
</UL>
</P>
<P>Verifying the iso image</P>
<P>
<UL>
<LI>    Mounting the image through the loopbackdevice by typing: 
<HR>
<PRE>
                      # mount boot.iso somewhere -o loop -t iso9660
</PRE>
<HR>

</LI>
<LI>    Umount boot.iso: 
<HR>
<PRE>
                      # umount somewhere
</PRE>
<HR>

</LI>
<LI>    If your /etc/mtab is a link to /proc/mounts umount won't automagically free
/dev/loop0 so free it by typing: 
<HR>
<PRE>
                    # losetup -d /dev/loop0
</PRE>
<HR>
</LI>
</UL>
</P>
<P>Writing the actual CD</P>
<P>Assuming that you've got cdrecord installed and configured for your cd-writer type: 
<HR>
<PRE>
             # cdrecord -v speed=&lt;desired writing speed> dev=&lt;path to your writers generic scsi device> boot.iso
</PRE>
<HR>
</P>
<P>Boot the cd and test it</P>
<P>Well the title of this paragraph says it all;)</P>
<HR>
<A HREF="Diskless-HOWTO-4.html">Next</A>
<A HREF="Diskless-HOWTO-2.html">Previous</A>
<A HREF="Diskless-HOWTO.html#toc3">Contents</A>
</BODY>
</HTML>
