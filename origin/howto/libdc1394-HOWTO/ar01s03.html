<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>3. Installation</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Libdc1394 Library Support for IEEE 1394 Cameras HOWTO"><link rel="up" href="index.html" title="Libdc1394 Library Support for IEEE 1394 Cameras HOWTO"><link rel="prev" href="ar01s02.html" title="2. Requirements"><link rel="next" href="ar01s04.html" title="4. Concepts and Basic Programs"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3. Installation</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s02.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s04.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="install"></a>3. Installation</h2></div></div></div><p>Prerequisite: Make sure that the kernel is compiled with IEEE1394 built-in support. This is critical!</p><p>You can add support for the IEEE1394 devices by compiling the kernel again. Don't panic! Here are the steps to compile the kernel:</p><p>Go to the directory where your kernel source code is
  present. Normally it is in <code class="filename">/usr/src</code>. We suggest that you download
  a fresh copy of the kernel source code (2.6.10) from <a class="ulink" href="http://www.kernel.org/" target="_top">www.kernel.org</a>.</p><p>Thus, <span class="command"><strong>cd /usr/src/kernel-2.6.10</strong></span> (<code class="filename">kernel-2.6.10</code> is the name of the source code directory. It can vary from system to system.)</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="command"><strong>make menuconfig</strong></span></p></li><li class="listitem"><p>The menu will come up. Select <span class="guimenuitem">Device Drivers</span></p></li><li class="listitem"><p>The <span class="guimenu">Device Drivers</span> menu will
   come up. Select <span class="guimenuitem">IEEE1394 (Firewire) Support</span></p></li><li class="listitem"><p>Mark the following as &lt;M&gt; in the menu that is shown:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>OHCI-1394 support</p></li><li class="listitem"><p>OHCI-1394 Video Support</p></li><li class="listitem"><p>OHCI-1394 DVI/O Support</p></li><li class="listitem"><p>RAW IEEE1394 I/O Support</p></li></ol></div></li><li class="listitem"><p>Press <span class="keycap"><strong>ESC</strong></span> to come out of the menu</p></li><li class="listitem"><p>Save the configuration</p></li></ol></div><div class="orderedlist"><p class="title"><b>Install libraw1394-1.2.0</b></p><p>The following steps are required to successfully install
     the library (libdc1394). As a rule of thumb, the installation has
     to be done as the <code class="envar">root</code> user.</p><p>We already had this library installed in our Linux, so we skipped this step. If you do not have this library installed, make sure you install it before moving further. Here are the steps for the installation: </p><ol class="orderedlist" type="1"><li class="listitem"><p><span class="command"><strong>su root</strong></span></p></li><li class="listitem"><p><span class="command"><strong>tar -xvzf libraw1394-1.2.0.tar.gz</strong></span></p></li><li class="listitem"><p><span class="command"><strong>cd libraw1394-1.2.0</strong></span></p></li><li class="listitem"><p><span class="command"><strong>./configure</strong></span></p></li><li class="listitem"><p><span class="command"><strong>make</strong></span></p></li><li class="listitem"><p><span class="command"><strong>make install</strong></span></p></li></ol></div><div class="orderedlist"><p class="title"><b>Install libdc1394-1.1.0</b></p><ol class="orderedlist" type="1"><li class="listitem"><p><span class="command"><strong>su root</strong></span> (if you haven't already)</p></li><li class="listitem"><p><span class="command"><strong>tar -xvzf libdc1394-1.1.0.tar.gz</strong></span></p></li><li class="listitem"><p><span class="command"><strong>cd libdc1394-1.1.0</strong></span> </p></li><li class="listitem"><p><span class="command"><strong>./configure</strong></span></p></li><li class="listitem"><p><span class="command"><strong>cd libdc1394</strong></span></p></li><li class="listitem"><p><span class="command"><strong>make</strong></span></p></li><li class="listitem"><p><span class="command"><strong>make install</strong></span></p></li></ol></div><div class="orderedlist"><p class="title"><b>Install the modules</b></p><ol class="orderedlist" type="1"><li class="listitem"><p><span class="command"><strong>modprobe ohci1394</strong></span></p></li><li class="listitem"><p><span class="command"><strong>modprobe video 1394</strong></span></p></li><li class="listitem"><p><span class="command"><strong>modprobe ieee1394</strong></span></p></li><li class="listitem"><p><span class="command"><strong>modprobe raw1394</strong></span></p></li><li class="listitem"><p><span class="command"><strong>lsmod</strong></span> to view that all the modules (ieee1394, raw1394, ohci1394 and video1394) are now installed.</p></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note on dependencies:</h3><p>The modules have some dependencies:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ohci1394 to video1394</p></li><li class="listitem"><p>ieee1394 to video1394, ohci1394, and raw1394</p></li></ul></div><p>
       So if you are installing modules with <span class="command"><strong>insmod</strong></span>, video1394 and raw1394 have to be installed first, followed by ohci1394 and ieee1394.</p></div><div class="orderedlist"><p class="title"><b>Create proper 1394 devices</b></p><ol class="orderedlist" type="1"><li class="listitem"><p><span class="command"><strong>cd /dev</strong></span></p></li><li class="listitem"><p><span class="command"><strong>mknod raw1394 c 171 0</strong></span></p></li><li class="listitem"><p><span class="command"><strong>chmod 666 /dev/raw1394</strong></span></p></li><li class="listitem"><p><span class="command"><strong>mkdir video1394</strong></span></p></li><li class="listitem"><p><span class="command"><strong>cd video1394</strong></span></p></li><li class="listitem"><p><span class="command"><strong>mknod 0 c 171 16</strong></span></p></li><li class="listitem"><p><span class="command"><strong>mknod 1 c 171 17</strong></span></p></li><li class="listitem"><p><span class="command"><strong>chmod 666 /dev/video1394/*</strong></span></p></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note on automating module start-up:</h3><p>Every time the system is restarted, the nodes are destroyed and the modules are removed automatically. So we wrote a script to automate this installation task at start-up, to undo all the damage done during rebooting!</p></div><div class="orderedlist"><p class="title"><b>Set user paths</b></p><ol class="orderedlist" type="1"><li class="listitem"><p><span class="command"><strong>su user</strong></span></p></li><li class="listitem"><p>Check for the
       <code class="envar">LD_LIBRARY_PATH</code>. It should contain <code class="filename">/usr/local/lib</code>.  This is necessary
       to run the applications with the help of the shared
       <code class="filename">libdc1394_cotrol.so.13</code> object
       file.</p></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note on setting path:</h3><p>You can also set the path by adding <code class="filename">/usr/local/lib</code> in <code class="filename">/etc/ld.so.conf</code>.</p></div><p>This completes the installation phase.</p><p>In order to make sure the installation is correct, connect the
  camera to the IEEE1394 card (assuming that the IEEE1394 card is
  already installed on the system) and just run <span class="command"><strong>testlibraw</strong></span>:</p><p><strong class="userinput"><code>$ testlibraw</code></strong></p><p>This tests for the presence of the host card, camera and other related parameters. Below is a typical output from testlibraw:</p><pre class="screen">
Successfully got handle
current generation number: 17
1 card(s) found
nodes on bus: 2, card name: ohci1394 
using first card found: 2 nodes on bus, local ID is 0, IRM is 1

doing transactions with custom tag handler 
trying to send read request to node 0... completed with value 0x23127bac
trying to send read request to node 1... completed with value 0x60217dac

using standard tag handler and synchronous calls
trying to read from node 0... completed with value 0x04477dac
trying to read from node 1... completed with value 0xd37380ac

testing FCP monitoring on local node
got fcp command from node 0 of 8 bytes: 01 23 45 67 89 ab cd ef
got fcp response from node 0 of 8 bytes: 01 23 45 67 89 ab cd ef

polling for leftover messages
</pre><p>The <code class="filename">libdc1394-1.1.0</code> library comes with
  some example programs which are very helpful in understanding how
  the programs are to be written. There is a Makefile available in the
  <code class="filename">examples</code> folder of the tar file. To compile and execute the programs:</p><p><strong class="userinput"><code>cd libdc1394-1.1.0/examples</code></strong></p><p><strong class="userinput"><code>make</code></strong></p><p>You can get programs exclusively written for the Point Grey
  cameras at <a class="ulink" href="http://www.ptgrey.com/support/kb/data/grabdma.tgz" target="_top">http://www.ptgrey.com/support/kb/data/grabdma.tgz</a>.</p><p>Fortunately, we have an open source graphical application
  developed for the IEEE1394 cameras, known as <span class="application"><span class="command"><strong>Coriander</strong></span></span> that provides a nice Graphical User
  Interface for libdc1394 to help the user work with the camera more
  efficiently. Later we will discuss how <span class="application">Coriander</span> helped us in debugging. Next,
  we briefly explain how to install <span class="application">Coriander</span>.</p><div class="orderedlist"><p class="title"><b>Installation of <span class="application">Coriander</span></b></p><ol class="orderedlist" type="1"><li class="listitem"><p>Make sure that you have libdc1394 and the Gnome
    libraries (<span class="application">Coriander</span> uses
    <code class="filename">gnome.h</code>) installed on your Linux
    machine. For more details regarding the requirements, look into the user
    manual provided by <span class="application">Coriander</span>:  <a class="ulink" href="http://damien.douxchamps.net/ieee1394/coriander/manual.php" target="_top">http://damien.douxchamps.net/ieee1394/coriander/manual.php</a>.</p></li><li class="listitem"><p>Download the following tar file from sourceforge.net:
    <code class="filename">coriander-1.0.1.tar.gz</code>, then proceed as shown below:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p><span class="command"><strong>su root</strong></span></p></li><li class="listitem"><p><span class="command"><strong>tar -xvzf coriander-1.0.1.tar.gz</strong></span></p></li><li class="listitem"><p><span class="command"><strong>cd coriander-1.0.1</strong></span></p></li><li class="listitem"><p><span class="command"><strong>./configure</strong></span></p></li><li class="listitem"><p><span class="command"><strong>cd src</strong></span></p></li><li class="listitem"><p><span class="command"><strong>make</strong></span></p></li><li class="listitem"><p><span class="command"><strong>make install</strong></span></p></li></ol></div></li><li class="listitem"><p>Run <span class="application">Coriander</span> as follows:
</p><pre class="screen">
cd coriander-1.0.1/coriander-1.0.1/src
./coriander
</pre><p>Fortunately, the installation of the libdc1394 and related modules is simple and does not pose any major problems. Some minor problems you may face are due to mistakes such as not installing it as root or not changing the permissions of the newly created IEEE1394 devices.</p></li></ol></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s02.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2. Requirements </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 4. Concepts and Basic Programs </td></tr></table></div></body></html>
