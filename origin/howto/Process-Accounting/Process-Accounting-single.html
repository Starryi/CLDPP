<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Enabling Process Accounting on Linux HOWTO</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>Enabling Process Accounting on Linux HOWTO</A
></H1
><H3
CLASS="AUTHOR"
><A
NAME="AEN4"
>Albert M.C. Tam</A
></H3
><DIV
CLASS="AFFILIATION"
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
><CODE
CLASS="EMAIL"
>&#60;<A
HREF="mailto:bertie@scn.org"
>bertie@scn.org</A
>&#62;</CODE
></P
></DIV
></DIV
><P
CLASS="OTHERCREDIT"
><B
>Kristin Thomas - </B
><SPAN
CLASS="CONTRIB"
>Converted document from HTML to DocBook v4.1 (SGML)</SPAN
></P
><P
CLASS="PUBDATE"
>2001-02-09<BR></P
><DIV
CLASS="REVHISTORY"
><TABLE
WIDTH="100%"
BORDER="0"
><TR
><TH
ALIGN="LEFT"
VALIGN="TOP"
COLSPAN="3"
><B
>Revision History</B
></TH
></TR
><TR
><TD
ALIGN="LEFT"
>Revision 1.1</TD
><TD
ALIGN="LEFT"
>2001-02-09</TD
><TD
ALIGN="LEFT"
>Revised by: KET</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
></TD
></TR
><TR
><TD
ALIGN="LEFT"
>Revision 1.0</TD
><TD
ALIGN="LEFT"
>1997-08-08</TD
><TD
ALIGN="LEFT"
>Revised by: AMCT</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
></TD
></TR
></TABLE
></DIV
><DIV
><DIV
CLASS="ABSTRACT"
><P
></P
><A
NAME="AEN10"
></A
><P
>Describes the basics of enabling process accounting on
				Linux.</P
><P
></P
></DIV
></DIV
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
>1. <A
HREF="#PREAMBLE"
>Preamble</A
></DT
><DT
>2. <A
HREF="#INTRODUCTION"
>Introduction</A
></DT
><DT
>3. <A
HREF="#PA"
>What is process accounting?</A
></DT
><DT
>4. <A
HREF="#CURRENTSTATUS"
>Current Status of Process Accounting under Linux</A
></DT
><DT
>5. <A
HREF="#REQUIREMENTS"
>Requirements for Process Accounting on Linux</A
></DT
><DD
><DL
><DT
>5.1. <A
HREF="#KERNEL"
>Kernel</A
></DT
><DT
>5.2. <A
HREF="#PASOFTWARE"
>Process Accounting Software</A
></DT
></DL
></DD
><DT
>6. <A
HREF="#PASETUP"
>Process Accounting Setup on Linux</A
></DT
><DT
>7. <A
HREF="#MISCCOMMANDS"
>Miscellaneous Process Accounting Commands</A
></DT
></DL
></DIV
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="PREAMBLE"
>1. Preamble</A
></H2
><P
>This document is copylefted by Albert M.C. Tam
			(<A
HREF="mailto:bertie@scn.org"
TARGET="_top"
>bertie@scn.org</A
>). Permission to use, copy, distribute this
			document for non-commerical purposes is hereby granted, provided that the
			author's/editor's name and this notice appear in all copies and/or supporting
			documents and provided that this document is not modified. This document is distributed in
			hope that it will be useful, but WITHOUT ANY WARRANTY, either expressed or
			implied. While every effort has been taken to ensure the accuracy of the
			information documented herein, the author/editor/maintainer assumes NO
			RESPONSIBILITY for errors, or for damages resulting for the use of the
			information documented herein. </P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INTRODUCTION"
>2. Introduction</A
></H2
><P
>This document describes how to enable system process accounting on
			a Linux host and the usage of various process accounting commands. It is
			intended for users running kernel versions greater than or equal to 1.3.73
			(tested on RedHat&#8482; 4.1 kernel 2.0.27). Kernels older than 1.3.73 may
			need a patch in order to use the process accounting feature. </P
><P
>Feel free to send any feedback or comments to <A
HREF="bertie@scn.org"
TARGET="_top"
>bertie@scn.org</A
> 
			if you find an error, or if any information is missing. I appreciate it. </P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="PA"
>3. What is process accounting?</A
></H2
><P
>Process accounting is the method of recording and summarizing
			commands executed on Linux. The modern Linux kernel is capable of keeping
			process accounting records for the commands being run, the user who executed
			the command, the CPU time, and much more. </P
><P
>Process accounting enables you to keep detailed accounting
			information for the system resources used, their allocation among users, and
			system monitoring. </P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="CURRENTSTATUS"
>4. Current Status of Process Accounting under Linux</A
></H2
><P
>Process accounting support has been integrated into the newer
			kernels (version &#62;= 1.3.73). If you are running an older kernel, you may
			need some patch files. The patches are available from 
			<A
HREF="ftp://iguana.hut.fi/pub/linux/Kernel/process_accounting"
TARGET="_top"
>ftp://iguana.hut.fi/pub/linux/Kernel/process_accounting</A
>
			</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="REQUIREMENTS"
>5. Requirements for Process Accounting on Linux</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="KERNEL"
>5.1. Kernel</A
></H3
><P
>A Linux kernel version greater than or equal to version 1.3.73 is required, and I
				recommended 2.x. The kernel source is available from 
				<A
HREF="http://sunsite.unc.edu/pub/Linux/kernel/v2.0"
TARGET="_top"
>http://sunsite.unc.edu/pub/Linux/kernel/v2.0</A
>
				</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="PASOFTWARE"
>5.2. Process Accounting Software</A
></H3
><P
>Depending on the Linux distribution you have, you may
				not have the process accounting software package installed on your system. If
				you don't have it, try downloading the package from 
				<A
HREF="http://sunsite.unc.edu/pub/Linux/system/admin/quota-acct-modified.tgz"
TARGET="_top"
>http://sunsite.unc.edu/pub/Linux/system/admin/quota-acct-modified.tgz</A
>
				</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="PASETUP"
>6. Process Accounting Setup on Linux</A
></H2
><P
></P
><OL
TYPE="1"
><LI
><P
>Compile and install process accounting software.</P
><P
>The process accounting software package is available from 
					<A
HREF="http://sunsite.unc.edu/pub/Linux/system/admin/quota-acct-modified.tgz"
TARGET="_top"
>http://sunsite.unc.edu/pub/Linux/system/admin/quota-acct-modified.tgz</A
>
					</P
></LI
><LI
><P
>Modify your system init script and turn on process accounting
					at boot time.</P
><P
>Here's an example:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
># Turn process accounting on. 
if [ -x /sbin/accton ]
then 
		/sbin/accton /var/log/pacct 
		echo "Process accounting turned on." 
fi
						</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>Create accounting record file <TT
CLASS="FILENAME"
>"pacct."</TT
> </P
><P
>Your process accounting software will print out all commands
					executed to the file <TT
CLASS="FILENAME"
>/var/log/pacct</TT
> by default. </P
><P
>To create the accounting record file: 
					<TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>touch /var/log/pacct</PRE
></FONT
></TD
></TR
></TABLE
> </P
><P
>This record file should be owned by root, and it has read-write
					permission for root and read permission for anybody else: </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>chown root /var/log/pacct
chmod 0644 /var/log/pacct</PRE
></FONT
></TD
></TR
></TABLE
></LI
><LI
><P
>Reboot.</P
><P
>Now reboot your system for changes you made to take effect.
					</P
></LI
></OL
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MISCCOMMANDS"
>7. Miscellaneous Process Accounting Commands</A
></H2
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><B
CLASS="COMMAND"
>ac</B
></DT
><DD
><P
><B
CLASS="COMMAND"
>ac</B
> prints out statistics about users' connection times in
						hours based on the logins and logouts in the current <TT
CLASS="FILENAME"
> /var/log/wtmp</TT
> file. <B
CLASS="COMMAND"
>ac</B
> is
						also capable of printing out time totals for each day (-d option), and for each
						user (-p option). </P
></DD
><DT
><B
CLASS="COMMAND"
>accton</B
></DT
><DD
><P
><B
CLASS="COMMAND"
>accton</B
> is used to turn on or turn off process accounting.
						The file is normally executed at system bootup or shutdown via system init
						scripts. </P
></DD
><DT
><B
CLASS="COMMAND"
>last</B
></DT
><DD
><P
><B
CLASS="COMMAND"
>last</B
> goes through the <TT
CLASS="FILENAME"
>/var/log/wtmp</TT
> file and prints out
						information about users' connection times. </P
></DD
><DT
><B
CLASS="COMMAND"
>sa</B
></DT
><DD
><P
><B
CLASS="COMMAND"
>sa</B
> summarizes accounting information from previously
						executed commands, software I/O operation times, and CPU times, as recorded in the
						accounting record file <TT
CLASS="FILENAME"
> /var/account/pacct</TT
>. </P
></DD
><DT
><B
CLASS="COMMAND"
>lastcomm</B
></DT
><DD
><P
><B
CLASS="COMMAND"
>lastcomm</B
> prints out the information about all previously
						executed commands, recorded in <TT
CLASS="FILENAME"
>/var/account/pacct</TT
>. </P
></DD
></DL
></DIV
></DIV
></DIV
></BODY
></HTML
>