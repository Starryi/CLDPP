<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Spam Filtering for Mail Exchangers</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="anti-spam, anti-virus, bogus virus warnings, collateral spam, delivery status notification, dsn, exim, exim4, exiscan, exiscan-acl, greylisting, junk mail, sa-exim, smtp, spam, spamassassin, teergrubing, transaction delay"><link rel="home" href="index.html" title="Spam Filtering for Mail Exchangers"><link rel="next" href="introduction.html" title="Introduction"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Spam Filtering for Mail Exchangers</th></tr><tr><td width="20%" align="left"> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="introduction.html">Next</a></td></tr></table><hr></div><div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="idm1"></a>Spam Filtering for Mail Exchangers</h1></div><div><h2 class="subtitle">
      How to reject junk mail in incoming SMTP transactions.
    </h2></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Tor</span> <span class="surname">Slettnes</span></h3><div class="affiliation"><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:tor@slett.net">tor@slett.net</a>&gt;</code></p></div></div></div><div class="editor"><h4 class="editedby">Edited by</h4><h3 class="editor"><span class="firstname">Joost</span> <span class="surname">De Cock</span></h3><span class="contrib">Technical Review</span> <div class="affiliation"><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:joost.decock%20(at)%20astrid.be">joost.decock (at) astrid.be</a>&gt;</code></p></div></div></div><div class="editor"><h3 class="editor"><span class="firstname">Devdas</span> <span class="surname">Bhagat</span></h3><span class="contrib">Technical Review</span> <div class="affiliation"><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:devdas%20(at)%20dvb.homelinux.org">devdas (at) dvb.homelinux.org</a>&gt;</code></p></div></div></div><div class="editor"><h3 class="editor"><span class="firstname">Tom</span> <span class="surname">Wright</span></h3><span class="contrib">Language Review</span> <div class="affiliation"><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:tom%20(at)%20maladmin.com">tom (at) maladmin.com</a>&gt;</code></p></div></div></div></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="preface"><a href="introduction.html">Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="intro-purpose.html">1. Purpose of this Document</a></span></dt><dt><span class="section"><a href="intro-audience.html">2. Audience</a></span></dt><dt><span class="section"><a href="intro-updates.html">3. New versions of this document</a></span></dt><dt><span class="section"><a href="intro-history.html">4. Revision History</a></span></dt><dt><span class="section"><a href="intro-credits.html">5. Credits</a></span></dt><dt><span class="section"><a href="intro-feedback.html">6. Feedback</a></span></dt><dt><span class="section"><a href="intro-translations.html">7. Translations</a></span></dt><dt><span class="section"><a href="intro-copyright.html">8. Copyright information</a></span></dt><dt><span class="section"><a href="intro-prerequisites.html">9. What do you need?</a></span></dt><dt><span class="section"><a href="intro-conventions.html">10. Conventions used in this document</a></span></dt><dt><span class="section"><a href="intro-organization.html">11. Organization of this document</a></span></dt></dl></dd><dt><span class="chapter"><a href="background.html">1. Background</a></span></dt><dd><dl><dt><span class="section"><a href="whysmtptime.html">1. Why Filter Mail During the SMTP Transaction?</a></span></dt><dd><dl><dt><span class="section"><a href="whysmtptime.html#statusquo">1.1. Status Quo</a></span></dt><dt><span class="section"><a href="whysmtptime.html#cause">1.2. The Cause</a></span></dt><dt><span class="section"><a href="whysmtptime.html#solution">1.3. The Solution</a></span></dt></dl></dd><dt><span class="section"><a href="goodbadugly.html">2. The Good, The Bad, The Ugly</a></span></dt><dt><span class="section"><a href="smtpintro.html">3. The SMTP Transaction</a></span></dt></dl></dd><dt><span class="chapter"><a href="techniques.html">2. Techniques</a></span></dt><dd><dl><dt><span class="section"><a href="smtpdelays.html">1. SMTP Transaction Delays</a></span></dt><dt><span class="section"><a href="dnschecks.html">2. DNS Checks</a></span></dt><dd><dl><dt><span class="section"><a href="dnschecks.html#dnsbl">2.1. DNS Blacklists</a></span></dt><dt><span class="section"><a href="dnschecks.html#rdns">2.2. DNS Integrity Check</a></span></dt></dl></dd><dt><span class="section"><a href="smtpchecks.html">3. SMTP checks</a></span></dt><dd><dl><dt><span class="section"><a href="smtpchecks.html#helocheck">3.1. Hello (HELO/EHLO) checks</a></span></dt><dt><span class="section"><a href="smtpchecks.html#senderchecks">3.2. Sender Address Checks</a></span></dt><dt><span class="section"><a href="smtpchecks.html#rcptchecks">3.3. Recipient Address Checks</a></span></dt></dl></dd><dt><span class="section"><a href="greylisting.html">4. Greylisting</a></span></dt><dd><dl><dt><span class="section"><a href="greylisting.html#greylisting-theory">4.1. How it works</a></span></dt><dt><span class="section"><a href="greylisting.html#greylisting-multimx">4.2. Greylisting in Multiple Mail Exchangers</a></span></dt><dt><span class="section"><a href="greylisting.html#greylisting-results">4.3. Results</a></span></dt></dl></dd><dt><span class="section"><a href="senderauth.html">5. Sender Authorization Schemes</a></span></dt><dd><dl><dt><span class="section"><a href="senderauth.html#spf">5.1. Sender Policy Framework (SPF)</a></span></dt><dt><span class="section"><a href="senderauth.html#ms-cide">5.2. Microsoft Caller-ID for E-Mail</a></span></dt><dt><span class="section"><a href="senderauth.html#rmxplus">5.3. RMX++</a></span></dt></dl></dd><dt><span class="section"><a href="datachecks.html">6. Message data checks</a></span></dt><dd><dl><dt><span class="section"><a href="datachecks.html#headerchecks">6.1. Header checks</a></span></dt><dt><span class="section"><a href="datachecks.html#jmsr">6.2. Junk Mail Signature Repositories</a></span></dt><dt><span class="section"><a href="datachecks.html#garbagechars">6.3. Binary garbage checks</a></span></dt><dt><span class="section"><a href="datachecks.html#mimeerrors">6.4. MIME checks</a></span></dt><dt><span class="section"><a href="datachecks.html#fileext">6.5. File Attachment Check</a></span></dt><dt><span class="section"><a href="datachecks.html#virusscanners">6.6. Virus Scanners</a></span></dt><dt><span class="section"><a href="datachecks.html#spamscanners">6.7. Spam Scanners</a></span></dt></dl></dd><dt><span class="section"><a href="collateral.html">7. Blocking Collateral Spam</a></span></dt><dd><dl><dt><span class="section"><a href="collateral.html#bogusviruswarning">7.1. Bogus Virus Warning Filter</a></span></dt><dt><span class="section"><a href="collateral.html#addspf">7.2. Publish SPF info for your domain</a></span></dt><dt><span class="section"><a href="collateral.html#signedsender">7.3. Enveloper Sender Signature</a></span></dt><dt><span class="section"><a href="collateral.html#dsnrealuser">7.4. Accept Bounces Only for Real Users</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="considerations.html">3. Considerations</a></span></dt><dd><dl><dt><span class="section"><a href="multimx.html">1. Multiple Incoming Mail Exchangers</a></span></dt><dt><span class="section"><a href="otherservers.html">2. Blocking Access to Other SMTP Servers</a></span></dt><dt><span class="section"><a href="forwardedmail.html">3. Forwarded Mail</a></span></dt><dt><span class="section"><a href="usersettings.html">4. User Settings and Data</a></span></dt></dl></dd><dt><span class="chapter"><a href="qanda.html">4. Questions &amp; Answers</a></span></dt><dt><span class="appendix"><a href="exim.html">A. Exim Implementation</a></span></dt><dd><dl><dt><span class="section"><a href="exim-prereq.html">1. Prerequisites</a></span></dt><dt><span class="section"><a href="exim-configfile.html">2. The Exim Configuration File</a></span></dt><dd><dl><dt><span class="section"><a href="exim-configfile.html#exim-acl">2.1. Access Control Lists</a></span></dt><dt><span class="section"><a href="exim-configfile.html#exim-expansions">2.2. Expansions</a></span></dt></dl></dd><dt><span class="section"><a href="exim-options.html">3. Options and Settings</a></span></dt><dt><span class="section"><a href="exim-firstpass.html">4. Building the ACLs - First Pass</a></span></dt><dd><dl><dt><span class="section"><a href="exim-firstpass.html#acl_connect_1">4.1. acl_connect</a></span></dt><dt><span class="section"><a href="exim-firstpass.html#acl_helo_1">4.2. acl_helo</a></span></dt><dt><span class="section"><a href="exim-firstpass.html#acl_mail_from_1">4.3. acl_mail_from</a></span></dt><dt><span class="section"><a href="exim-firstpass.html#acl_rcpt_to_1">4.4. acl_rcpt_to</a></span></dt><dt><span class="section"><a href="exim-firstpass.html#acl_data_1">4.5. acl_data</a></span></dt></dl></dd><dt><span class="section"><a href="exim-smtpdelays.html">5. Adding SMTP transaction delays</a></span></dt><dd><dl><dt><span class="section"><a href="exim-smtpdelays.html#exim-smtpdelays-simple">5.1. The simple way</a></span></dt><dt><span class="section"><a href="exim-smtpdelays.html#exim-smtpdelays-selective">5.2. Selective Delays</a></span></dt></dl></dd><dt><span class="section"><a href="exim-greylisting.html">6. Adding Greylisting Support</a></span></dt><dd><dl><dt><span class="section"><a href="exim-greylisting.html#exim-greylistd">6.1. greylistd</a></span></dt><dt><span class="section"><a href="exim-greylisting.html#exim-greylist-mysql">6.2. MySQL implementation</a></span></dt></dl></dd><dt><span class="section"><a href="exim-spf.html">7. Adding SPF Checks</a></span></dt><dd><dl><dt><span class="section"><a href="exim-spf.html#exim-spf-exiscan">7.1. SPF checks via Exiscan-ACL</a></span></dt><dt><span class="section"><a href="exim-spf.html#exim-spf-query-perl">7.2. SPF checks via Mail::SPF::Query</a></span></dt></dl></dd><dt><span class="section"><a href="exim-mime.html">8. Adding MIME and Filetype Checks</a></span></dt><dt><span class="section"><a href="exim-av.html">9. Adding Anti-Virus Software</a></span></dt><dt><span class="section"><a href="exim-sa.html">10. Adding SpamAssassin</a></span></dt><dd><dl><dt><span class="section"><a href="exim-sa.html#exim-sa-exiscan">10.1. Invoke SpamAssassin via Exiscan</a></span></dt><dt><span class="section"><a href="exim-sa.html#exim-sa-config">10.2. Configure SpamAssassin</a></span></dt><dt><span class="section"><a href="exim-sa.html#exim-per-user">10.3. User Settings and Data</a></span></dt></dl></dd><dt><span class="section"><a href="exim-sign.html">11. Adding Envelope Sender Signatures</a></span></dt><dd><dl><dt><span class="section"><a href="exim-sign.html#exim-sign-transport">11.1. Create a Transport to Sign the Sender Address</a></span></dt><dt><span class="section"><a href="exim-sign.html#exim-sign-router-remote">11.2. Create a New Router for Remote Deliveries</a></span></dt><dt><span class="section"><a href="exim-sign.html#exim-sign-router-redirect">11.3. Create New Redirect Router for Local Deliveries</a></span></dt><dt><span class="section"><a href="exim-sign.html#exim-sign-acl">11.4. ACL Signature Check</a></span></dt></dl></dd><dt><span class="section"><a href="exim-bounces.html">12. Accept Bounces Only for Real Users</a></span></dt><dd><dl><dt><span class="section"><a href="exim-bounces.html#exim-dsn-mailbox">12.1. Check for Recipient Mailbox</a></span></dt><dt><span class="section"><a href="exim-bounces.html#exim-dsn-noalias">12.2. Check for Empty Sender in Aliases Router</a></span></dt></dl></dd><dt><span class="section"><a href="exim-forward.html">13. Exempting Forwarded Mail</a></span></dt><dt><span class="section"><a href="exim-final.html">14. Final ACLs</a></span></dt><dd><dl><dt><span class="section"><a href="exim-final.html#acl_connect_final">14.1. acl_connect</a></span></dt><dt><span class="section"><a href="exim-final.html#acl_helo_final">14.2. acl_helo</a></span></dt><dt><span class="section"><a href="exim-final.html#acl_mail_from_final">14.3. acl_mail_from</a></span></dt><dt><span class="section"><a href="exim-final.html#acl_rcpt_to_final">14.4. acl_rcpt_to</a></span></dt><dt><span class="section"><a href="exim-final.html#acl_data_final">14.5. acl_data</a></span></dt></dl></dd></dl></dd><dt><span class="glossary"><a href="gloss.html">Glossary</a></span></dt><dt><span class="appendix"><a href="gpl.html">B. GNU General Public License</a></span></dt><dd><dl><dt><span class="sect1"><a href="gpl-1.html">1. Preamble</a></span></dt><dt><span class="sect1"><a href="gpl-2.html">2. TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</a></span></dt><dd><dl><dt><span class="sect2"><a href="gpl-2.html#gpl-2-0">2.1. Section 0</a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-1">2.2. Section 1</a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-2">2.3. Section 2</a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-3">2.4. Section 3
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-4">2.5. Section 4
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-5">2.6. Section 5
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-6">2.7. Section 6
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-7">2.8. Section 7
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-8">2.9. Section 8
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-9">2.10. Section 9
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-10">2.11. Section 10
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-11">2.12. NO WARRANTY Section 11
      </a></span></dt><dt><span class="sect2"><a href="gpl-2.html#gpl-2-12">2.13. Section 12
      </a></span></dt></dl></dd><dt><span class="sect1"><a href="gpl-3.html">3. How to Apply These Terms to Your New Programs
    </a></span></dt></dl></dd></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>1. <a href="intro-conventions.html#conventiontable">Typographic and usage conventions</a></dt><dt>1.1. <a href="smtpintro.html#smtpdialogue">Simple SMTP dialogue</a></dt><dt>A.1. <a href="exim-smtpdelays.html#aclvarusage">Use of ACL connection/message variables</a></dt></dl></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="introduction.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"> </td><td width="40%" align="right" valign="top"> Introduction</td></tr></table></div></body></html>
