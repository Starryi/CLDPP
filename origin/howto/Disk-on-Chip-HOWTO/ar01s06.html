<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>6. Install Development ToolChain on DiskOnChip</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Booting Linux from DiskOnChip HOWTO"><link rel="up" href="index.html" title="Booting Linux from DiskOnChip HOWTO"><link rel="prev" href="ar01s05.html" title="5. Install Linux and LILO on DiskOnChip"><link rel="next" href="ar01s07.html" title="7. References"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6. Install Development ToolChain on DiskOnChip</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s05.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s07.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="devtools"></a>6. Install Development ToolChain on DiskOnChip</h2></div></div></div><p>This section may be left out if the requirement is not to have a development environment on the DiskOnChip. The following steps will install the necessary libraries and tools that are required for developing and executing programs on DiskOnChip.  This will completely eliminate the concept of having a host system and target system since now the complete application development can be done on the target system itself. For this purpose we will use uClibc which is a C library that has been developed primarily for embedded systems. Also since our root filesystem that was created in the previous section is bulky (35 MB) we will remove the unnecessary files and make it smaller, approximately 11MB.</p><p>We will use the Buildroot package from www.uclibc.org to replace the existing bulky root filesystem of DOC with a tiny filesystem and to install the necessary development ToolChain which includes uClibc library, gcc, g++, make, ncurses, busybox, GNU tar, GNU grep and the GNU coreutils . For more details on Buildroot refer to <a class="ulink" href="http://buildroot.uclinux.org/buildroot.html" target="_top">http://buildroot.uclinux.org/buildroot.html</a>. The <a class="ulink" href="http://www.uclibc.org" target="_top">http://www.uclibc.org</a> website provides a precompiled package containing all the tools, which can be downloaded and used. We will use the precompiled package, which is available as <code class="filename">root_fs</code> image. Refer to the <a class="ulink" href="http://www.uclibc.org/FAQ.html" target="_top">uClibc FAQ</a> for more details.</p><p>Follow these steps in order to get the software working on your DOS:</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="getimage"></a>6.1. Step1: Obtain the latest copy of root_fs_i386.ext2</h3></div></div></div><p>Download <code class="filename">root_fs_i386.ext2.tar.gz</code> from <a class="ulink" href="www.uclibc.org/downloads/root_fs_i386.ext2.tar.gz" target="_top">www.uclibc.org/downloads/root_fs_i386.ext2.tar.gz</a>.</p><p>It is around 22MB in size. This actually gets decompressed to a 100MB size file.</p><p>Untar the file in <code class="filename">/usr/src</code>:</p><div class="cmdsynopsis"><p><code class="command">tar <code class="option">-xvzf</code> <code class="filename">root_fs_i386.ext2.tar.gz</code></code> </p></div><p>This will create a file <code class="filename">root_fs_i386.ext2</code>.</p><p>We need to mount this file using a loopback device. Do the following steps:</p><div class="cmdsynopsis"><p><code class="command">mkdir <code class="filename">root_fs</code></code> </p></div><div class="cmdsynopsis"><p><code class="command">mount <code class="option">-o</code> <em class="parameter"><code>loop</code></em> <code class="filename">root_fs_i386.ext2 root_fs</code></code> </p></div><p>Now you can access the content of the file <code class="filename">root_fs_i386.ext2</code> through the <code class="filename">root_fs</code> directory. <code class="filename">The root_fs</code> directory contains a number of directories which makes the root filesystem, like <code class="filename">bin</code>, <code class="filename">var</code>, <code class="filename">sbin</code>, <code class="filename">opt</code>, <code class="filename">root</code>, <code class="filename">home</code>, <code class="filename">etc</code>, <code class="filename">usr</code>, <code class="filename">lib</code>, <code class="filename">tmp</code>, <code class="filename">dev</code>, and <code class="filename">proc</code>.</p><p>The <code class="filename">usr</code> and <code class="filename">lib</code> directories contain the development tools like <span class="command"><strong>gcc</strong></span> and <span class="command"><strong>g++</strong></span>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="fs_swap"></a>6.2. Step2: Replace the root filesystem of the DiskOnChip</h3></div></div></div><p>Replace the <code class="filename">bin</code>, <code class="filename">var</code>, <code class="filename">sbin</code>, <code class="filename">etc</code>, <code class="filename">lib</code>, <code class="filename">usr</code>, <code class="filename">proc</code>, <code class="filename">mnt</code>, <code class="filename">home</code> and <code class="filename">opt</code> directories of the DiskOnChip with the ones of the <code class="filename">root_fs</code> image.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Do not replace boot and dev!</h3><p>The <code class="filename">boot</code> directory of the DiskOnChip has to be kept intact since it contains the kernel image, <code class="filename">initrd</code> image and Map file that is used by LILO to load the kernel into memory.</p><p>The <code class="filename">dev</code> directory should also not be replaced since it contains the device nodes for DOC (The replacement task will take 5-10 minutes.)</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="DOS_fstab"></a>6.3. Step3: Modify etc/fstab of DiskOnChip root file system</h3></div></div></div><p>Open the newly replaced <code class="filename">/mnt/doc/etc/fstab</code> and edit the line where the mount point is <code class="filename">/</code>.  Change that line to:</p><pre class="screen">
/dev/msys/fla1  /  ext2  rw.noauto 0 1
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="reboot"></a>6.4. Step4: Reboot</h3></div></div></div><p>Reboot from DiskOnChip and enjoy the uClibc development environment.</p><p>You will get the message</p><pre class="screen">
Welcome to the Erik.s uClibc development environment.
</pre><p>The entire root filesystem + boot directory + development tools take 84Mb of space.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s05.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s07.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">5. Install Linux and LILO on DiskOnChip </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 7. References</td></tr></table></div></body></html>
