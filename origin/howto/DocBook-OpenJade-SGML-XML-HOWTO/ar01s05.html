<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>5. Serving DocBook 4.1.2 XML</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="DocBook XML/SGML Processing Using OpenJade"><link rel="up" href="index.html" title="DocBook XML/SGML Processing Using OpenJade"><link rel="prev" href="ar01s04.html" title="4. Using OpenJade"><link rel="next" href="ar01s06.html" title="6. Further Information"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5. Serving DocBook 4.1.2 XML</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s04.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s06.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm512"></a>5. Serving DocBook 4.1.2 XML</h2></div></div></div><p>There are 3 ways to serve DocBook 4.1.2 XML from a web server:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Command line Pre-processed Open Jade, XSLT</p></li><li class="listitem"><p>Scripting - PHP, Perl, Python</p></li><li class="listitem"><p>Application server - Tomcat + Cocoon</p></li></ul></div><p>Using an application server like Cocoon is the best the option.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Cocoon in Action</h3><p>To see an example of web server running Tomcat + Cocoon serving DocBook 4.1.2 XML content, please visit <a class="ulink" href="http://www.xml-dev.com:8080/cocoon/mount/docbook/" target="_top">http://www.xml-dev.com:8080/cocoon/mount/docbook/</a></p></div><p> In this section we will see how to serve DocBook 4.1.2 XML content using Tomcat + Cocoon.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm528"></a>5.1. Tomcat + Cocoon</h3></div></div></div><p>Tomcat is the Java Servlet Container. For more information please visit <a class="ulink" href="http://jakarta.apache.org/tomcat/index.html" target="_top">http://jakarta.apache.org/tomcat/index.html</a>.</p><p>Apache Cocoon is an XML publishing framework. For more information please visit <a class="ulink" href="http://xml.apache.org/cocoon/index.html" target="_top">http://xml.apache.org/cocoon/index.html</a>.</p><p>This HOWTO will not go into details of setting up Tomcat + Cocoon, since it is already explained in the document <a class="ulink" href="http://xml.apache.org/cocoon/installing/index.html" target="_top">http://xml.apache.org/cocoon/installing/index.html</a>. Setting up Tomcat + Cocoon is an easy process and should take less than five minutes.</p><p>Once you have the Cocoon + Tomcat setup and working, please follow the next the sections to server DocBook 4.1.2 XML content.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>One important caveat: users in the field have experienced compatibility issues with the DocBook stylesheets and some versions of the Xalan XML parser. Xalan is the parser bundled with Sun's JRE, so that's what you're using by default. </p></div><p><span class="emphasis"><em>At the very least, make sure you're using the latest JRE from Sun (at this writing, 1.4.2).</em></span></p><p>Also consider upgrading the Xalan parser to the latest release. At this writing, the latest Sun JRE, 1.4.2, is bundled with Xalan 2.4.1, while Xalan itself is up to version 2.5.1.</p><p>To check the version currently installed, type</p><pre class="screen"><span class="command"><strong> # java org.apache.xalan.xslt.EnvironmentCheck</strong></span></pre><p>For more info, visit <a class="ulink" href="http://xml.apache.org/xalan-j/faq.html" target="_top">http://xml.apache.org/xalan-j/faq.html</a> .</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm547"></a>5.2. Installing Norman Walsh's XSL</h3></div></div></div><p>In this step we will install the Norman Walsh's XSL under the <code class="filename">/usr/local/dbtools/</code> directory.</p><p>Change to the <code class="filename">/tmp/downloads</code> directory and untar the docbook-xsl file.</p><pre class="screen"><span class="command"><strong># cd /tmp/downloads/</strong></span></pre><pre class="screen"><span class="command"><strong># gzip -d docbook-xsl-1.53.0.tar.gz</strong></span></pre><pre class="screen"><span class="command"><strong># tar -xvf docbook-xsl-1.53.0.tar</strong></span></pre><p>To install the docbook-xsl please move the files to the <code class="filename">/usr/local/dbtools</code>.</p><pre class="screen"><span class="command"><strong># mv docbook-xsl-1.53.0 /usr/local/dbtool/docbook-xsl</strong></span></pre><p>Next install the LDP XSL.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm564"></a>5.3. Installing LDP XSL</h3></div></div></div><p>Unzip the <code class="filename">tldp-xsl-xxxxx.tar.gz</code> and the copy all the files to the <code class="filename">/usr/local/dbtools/docbook-xsl/html</code> directory.</p><pre class="screen"><span class="command"><strong># cd /tmp/downloads</strong></span></pre><pre class="screen"><span class="command"><strong># gzip tldp-xsl-xxxxx.tar.gz</strong></span></pre><pre class="screen"><span class="command"><strong># gzip tldp-xsl-xxxxx.tar</strong></span></pre><pre class="screen"><span class="command"><strong># mv tldp-html*.xsl /usr/local/dbtools/docbook-xsl/html</strong></span></pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm577"></a>5.4. Setting up sitemap.xmap</h3></div></div></div><p>$COCOON_HOME points to the Cocoon Web Application Directory. This directory is typically <code class="filename">/usr/local/jakarta-tomcat-4.1.9/webapps/cocoon/</code></p><p>Create a directory named <code class="filename">docbook</code> under the <code class="filename">$COCOON_HOME/mount</code>. This is where we will put all our DocBook XML 4.1.2 content.</p><pre class="screen"><span class="command"><strong># mkdir $COCOON_HOME/mount/docbook</strong></span></pre><p>Create a file name sitemap.xmap in the <code class="filename">$COCOON_HOME/mount/docbook</code> with the following content:</p><pre class="screen"><span class="command"><strong># cd $COCOON_HOME/mount/docbook</strong></span></pre><pre class="screen"><span class="command"><strong># vi sitemap.xmap</strong></span></pre><pre class="screen">
&lt;map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0"&gt;

    &lt;!-- use the standard components --&gt;
    &lt;map:components&gt;
        &lt;map:generators default="file"/&gt;
        &lt;map:transformers default="xslt"/&gt;
        &lt;map:readers default="resource"/&gt;
        &lt;map:serializers default="html"/&gt;
        &lt;map:selectors default="browser"/&gt;
        &lt;map:matchers default="wildcard"/&gt;
        &lt;map:transformers default="xslt"/&gt;
    &lt;/map:components&gt;
      
    &lt;map:pipelines&gt;
        &lt;map:pipeline&gt;

   &lt;map:match pattern=""&gt;
    &lt;map:generate src="samples.xml"/&gt;
    &lt;map:transform src="/usr/local/jakarta-tomcat-4.1.9/webapps/cocoon/mount/editor/stylesheets/simple-page2html.xsl"/&gt;
    &lt;map:serialize/&gt;
   &lt;/map:match&gt;

            &lt;!-- respond to *.html requests with 
                 our docs processed by .xsl --&gt;
            &lt;map:match pattern="*.html"&gt;
                &lt;map:generate src="{1}.xml"/&gt;
                &lt;map:transform src="/usr/local/dbtools/docbook-xsl/html/tldp-html.xsl"/&gt;
                &lt;map:serialize type="html"/&gt;
            &lt;/map:match&gt;
            
            &lt;!-- later, respond to *.pdf requests with 
                 our docs processed by doc2pdf.xsl --&gt;
            &lt;map:match pattern="*.pdf"&gt;
                &lt;map:generate src="{1}.xml"/&gt;
                &lt;map:transform src="/usr/local/dbtools/docbook-xsl/fo/docbook.xsl"/&gt;
                &lt;map:serialize type="fo2pdf"/&gt;
            &lt;/map:match&gt;

            &lt;map:match pattern="*.xml"&gt;
                &lt;map:generate src="{1}.xml"/&gt;
                &lt;map:serialize type="xml"/&gt;
            &lt;/map:match&gt;


        &lt;/map:pipeline&gt;
    &lt;/map:pipelines&gt;
&lt;/map:sitemap&gt;
</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm593"></a>5.5. Accessing DocBook 4.1.2 XML Content from a Web Browser</h3></div></div></div><p>Place a DocBook 4.1.2 XML file in the <code class="filename">$COCOON_HOME/mount/docbook/</code> directory.</p><p>A sample file is available from <a class="ulink" href="http://www.xml-dev.com:8080/cocoon/mount/docbook/openjade.xml" target="_top">http://www.xml-dev.com:8080/cocoon/mount/docbook/openjade.xml</a>.</p><p>Now you can access the document using a browser at http://localhost:8080/cocoon/mount/sample.html (HTML) or http://localhost:8080/cocoon/mount/sample.pdf (PDF).</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s04.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s06.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">4. Using OpenJade </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 6. Further Information</td></tr></table></div></body></html>
