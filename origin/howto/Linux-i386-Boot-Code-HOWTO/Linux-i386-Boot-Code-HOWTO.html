<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Linux i386 Boot Code HOWTO</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="description" content="This document describes Linux i386 boot code, serving as a study guide and source commentary. In addition to C-like pseudocode source commentary, it also presents keynotes of toolchains and specs related to kernel development. It is designed to help: kernel newbies to understand Linux i386 boot code, andkernel veterans to recall Linux boot procedure."><link rel="home" href="index.html" title="Linux i386 Boot Code HOWTO"><link rel="next" href="ar01s01.html" title="1. Introduction"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Linux i386 Boot Code HOWTO</th></tr><tr><td width="20%" align="left"> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s01.html">Next</a></td></tr></table><hr></div><div class="article"><div class="titlepage"><div><div><h2 class="title"><a name="Linux-i386-Boot-Code-HOWTO"></a>Linux i386 Boot Code HOWTO</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Feiyun</span> <span class="surname">Wang</span></h3><div class="affiliation"><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:feiyunw@yahoo.com">feiyunw@yahoo.com</a>&gt;</code></p></div></div></div></div><div><p class="pubdate">2004-01-23</p></div><div><div class="revhistory"><table style="border-style:solid; width:100%;" summary="Revision History"><tr><th align="left" valign="top" colspan="3"><b>Revision History</b></th></tr><tr><td align="left">Revision 1.0</td><td align="left">2004-02-19</td><td align="left">FW</td></tr><tr><td align="left" colspan="3">Initial release, reviewed by LDP</td></tr><tr><td align="left">Revision 0.3.3</td><td align="left">2004-01-23</td><td align="left">fyw</td></tr><tr><td align="left" colspan="3">
            Add decompress_kernel() details;
            Fix bugs reported in TLDP final review.
          </td></tr><tr><td align="left">Revision 0.3</td><td align="left">2003-12-07</td><td align="left">fyw</td></tr><tr><td align="left" colspan="3">
            Add contents on SMP, GRUB and LILO; Fix and enhance.
          </td></tr><tr><td align="left">Revision 0.2</td><td align="left">2003-08-17</td><td align="left">fyw</td></tr><tr><td align="left" colspan="3">Adapt to Linux 2.4.20.</td></tr><tr><td align="left">Revision 0.1</td><td align="left">2003-04-20</td><td align="left">fyw</td></tr><tr><td align="left" colspan="3">Change to DocBook XML format.</td></tr></table></div></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>
         This document describes Linux i386 boot code,
         serving as a study guide and source commentary.
         In addition to C-like pseudocode source commentary, it also presents
         keynotes of toolchains and specs related to kernel development.
         It is designed to help:
         </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>kernel newbies to understand Linux i386 boot code, and</p></li><li class="listitem"><p>kernel veterans to recall Linux boot procedure.</p></li></ul></div><p>
        </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="ar01s01.html">1. Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s01.html#copyright">1.1. Copyright and License</a></span></dt><dt><span class="sect2"><a href="ar01s01.html#disclaimer">1.2. Disclaimer</a></span></dt><dt><span class="sect2"><a href="ar01s01.html#credits">1.3. Credits / Contributors</a></span></dt><dt><span class="sect2"><a href="ar01s01.html#feedback">1.4. Feedback</a></span></dt><dt><span class="sect2"><a href="ar01s01.html#translations">1.5. Translations</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s02.html">2. Linux Makefiles</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s02.html#linux_makefile">2.1. linux/Makefile</a></span></dt><dt><span class="sect2"><a href="ar01s02.html#vmlinux.lds">2.2. linux/arch/i386/vmlinux.lds</a></span></dt><dt><span class="sect2"><a href="ar01s02.html#i386_makefile">2.3. linux/arch/i386/Makefile</a></span></dt><dt><span class="sect2"><a href="ar01s02.html#i386_boot_makefile">2.4. linux/arch/i386/boot/Makefile</a></span></dt><dt><span class="sect2"><a href="ar01s02.html#i386_boot_compressed_makefile">2.5. linux/arch/i386/boot/compressed/Makefile</a></span></dt><dt><span class="sect2"><a href="ar01s02.html#i386_tools_build.c">2.6. linux/arch/i386/tools/build.c</a></span></dt><dt><span class="sect2"><a href="ar01s02.html#makefile_ref">2.7. Reference</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s03.html">3. linux/arch/i386/boot/bootsect.S</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s03.html#move_bootsect">3.1. Move Bootsect</a></span></dt><dt><span class="sect2"><a href="ar01s03.html#get_disk_para">3.2. Get Disk Parameters</a></span></dt><dt><span class="sect2"><a href="ar01s03.html#load_setup">3.3. Load Setup Code</a></span></dt><dt><span class="sect2"><a href="ar01s03.html#load_compressed">3.4. Load Compressed Image</a></span></dt><dt><span class="sect2"><a href="ar01s03.html#go_setup">3.5. Go Setup</a></span></dt><dt><span class="sect2"><a href="ar01s03.html#read_disk">3.6. Read Disk</a></span></dt><dt><span class="sect2"><a href="ar01s03.html#bootsect_helper">3.7. Bootsect Helper</a></span></dt><dt><span class="sect2"><a href="ar01s03.html#bootsect_misc">3.8. Miscellaneous</a></span></dt><dt><span class="sect2"><a href="ar01s03.html#bootsect_ref">3.9. Reference</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s04.html">4. linux/arch/i386/boot/setup.S</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s04.html#setup_header">4.1. Header</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#check_code">4.2. Check Code Integrity</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#check_loader">4.3. Check Loader Type</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#get_mem_size">4.4. Get Memory Size</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#hw_support">4.5. Hardware Support</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#apm_support">4.6. APM Support</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#prepare_protmode">4.7. Prepare for Protected Mode</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#enable_a20">4.8. Enable A20</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#switch_protmode">4.9. Switch to Protected Mode</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#setup_misc">4.10. Miscellaneous</a></span></dt><dt><span class="sect2"><a href="ar01s04.html#setup_ref">4.11. Reference</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s05.html">5. linux/arch/i386/boot/compressed/head.S</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s05.html#decompress_kernel">5.1. Decompress Kernel</a></span></dt><dt><span class="sect2"><a href="ar01s05.html#gunzip">5.2. gunzip()</a></span></dt><dt><span class="sect2"><a href="ar01s05.html#inflate">5.3. inflate()</a></span></dt><dt><span class="sect2"><a href="ar01s05.html#chead_ref">5.4. Reference</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s06.html">6. linux/arch/i386/kernel/head.S</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s06.html#enable_paging">6.1. Enable Paging</a></span></dt><dt><span class="sect2"><a href="ar01s06.html#get_kernel_para">6.2. Get Kernel Parameters</a></span></dt><dt><span class="sect2"><a href="ar01s06.html#check_cpu_type">6.3. Check CPU Type</a></span></dt><dt><span class="sect2"><a href="ar01s06.html#go_start_kernel">6.4. Go Start Kernel</a></span></dt><dt><span class="sect2"><a href="ar01s06.html#khead_misc">6.5. Miscellaneous</a></span></dt><dt><span class="sect2"><a href="ar01s06.html#khead_ref">6.6. Reference</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s07.html">7. linux/init/main.c</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s07.html#start_kernel">7.1. start_kernel()</a></span></dt><dt><span class="sect2"><a href="ar01s07.html#init_proc">7.2. init()</a></span></dt><dt><span class="sect2"><a href="ar01s07.html#idle_proc">7.3. cpu_idle()</a></span></dt><dt><span class="sect2"><a href="ar01s07.html#main_ref">7.4. Reference</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s08.html">8. SMP Boot</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s08.html#before_smpinit">8.1. Before smp_init()</a></span></dt><dt><span class="sect2"><a href="ar01s08.html#smp_init">8.2. smp_init()</a></span></dt><dt><span class="sect2"><a href="ar01s08.html#trampoline">8.3. linux/arch/i386/kernel/trampoline.S</a></span></dt><dt><span class="sect2"><a href="ar01s08.html#initialize_secondary">8.4. initialize_secondary()</a></span></dt><dt><span class="sect2"><a href="ar01s08.html#start_secondary">8.5. start_secondary()</a></span></dt><dt><span class="sect2"><a href="ar01s08.html#smpboot_ref">8.6. Reference</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s09.html">A. Kernel Build Example</a></span></dt><dt><span class="sect1"><a href="ar01s10.html">B. Internal Linker Script</a></span></dt><dt><span class="sect1"><a href="ar01s11.html">C. GRUB and LILO</a></span></dt><dd><dl><dt><span class="sect2"><a href="ar01s11.html#grub">C.1. GNU GRUB</a></span></dt><dt><span class="sect2"><a href="ar01s11.html#lilo">C.2. LILO</a></span></dt><dt><span class="sect2"><a href="ar01s11.html#bootloader_ref">C.3. Reference</a></span></dt></dl></dd><dt><span class="sect1"><a href="ar01s12.html">D. FAQ</a></span></dt></dl></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s01.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"> </td><td width="40%" align="right" valign="top"> 1. Introduction</td></tr></table></div></body></html>
