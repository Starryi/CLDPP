<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Linux Security HOWTO</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="description" content='This document is a general overview of security issues that face the administrator of Linux systems. It covers general security philosophy and a number of specific examples of how to better secure your Linux system from intruders. Also included are pointers to security-related material and programs. Improvements, constructive criticism, additions and corrections are gratefully accepted. Please mail your feedback to both authors, with "Security HOWTO" in the subject.'></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article"><div class="titlepage"><div><div><h2 class="title"><a name="Security-HOWTO"></a>Linux Security HOWTO</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Kevin</span> <span class="surname">Fenzi</span></h3><div class="affiliation"><span class="orgname">tummy.com, ltd.<br></span><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:kevin-securityhowto@tummy.com">kevin-securityhowto@tummy.com</a>&gt;</code></p></div></div></div></div><div><div class="author"><h3 class="author"><span class="firstname">Dave</span> <span class="surname">Wreski</span></h3><div class="affiliation"><span class="orgname">linuxsecurity.com<br></span><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:dave@linuxsecurity.com">dave@linuxsecurity.com</a>&gt;</code></p></div></div></div></div><div><p class="pubdate">v2.3, 22 January 2004</p></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>
This document is a general overview of security issues that face the
administrator of Linux systems. It covers general security philosophy
and a number of specific examples of how to better secure your Linux
system from intruders. Also included are pointers to security-related
material and programs. Improvements, constructive criticism, additions and corrections are
gratefully accepted. Please mail your feedback to both authors,
with "Security HOWTO" in the subject.
</p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#idm21">1. Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm27">1.1. New Versions of this Document</a></span></dt><dt><span class="sect2"><a href="#idm49">1.2. Feedback</a></span></dt><dt><span class="sect2"><a href="#idm62">1.3. Disclaimer</a></span></dt><dt><span class="sect2"><a href="#idm68">1.4. Copyright Information</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idm82">2. Overview</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm85">2.1. Why Do We Need Security?</a></span></dt><dt><span class="sect2"><a href="#idm89">2.2. How Secure Is Secure?</a></span></dt><dt><span class="sect2"><a href="#idm95">2.3. What Are You Trying to Protect?</a></span></dt><dt><span class="sect2"><a href="#idm133">2.4. Developing A Security Policy</a></span></dt><dt><span class="sect2"><a href="#idm147">2.5. Means of Securing Your Site</a></span></dt><dt><span class="sect2"><a href="#idm162">2.6. Organization of This Document</a></span></dt></dl></dd><dt><span class="sect1"><a href="#physical-security">3. Physical Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm190">3.1. Computer locks</a></span></dt><dt><span class="sect2"><a href="#idm195">3.2. BIOS Security</a></span></dt><dt><span class="sect2"><a href="#idm206">3.3. Boot Loader Security</a></span></dt><dt><span class="sect2"><a href="#idm234">3.4. xlock and vlock</a></span></dt><dt><span class="sect2"><a href="#idm247">3.5. Security of local devices</a></span></dt><dt><span class="sect2"><a href="#idm250">3.6. Detecting Physical Security Compromises</a></span></dt></dl></dd><dt><span class="sect1"><a href="#local-security">4. Local Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm281">4.1. Creating New Accounts</a></span></dt><dt><span class="sect2"><a href="#root-security">4.2. Root Security</a></span></dt></dl></dd><dt><span class="sect1"><a href="#file-security">5. Files and File system Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#umask">5.1. Umask Settings</a></span></dt><dt><span class="sect2"><a href="#idm432">5.2. File Permissions</a></span></dt><dt><span class="sect2"><a href="#idm513">5.3. Integrity Checking</a></span></dt><dt><span class="sect2"><a href="#idm533">5.4. Trojan Horses</a></span></dt></dl></dd><dt><span class="sect1"><a href="#password-security">6. Password Security and Encryption </a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm553">6.1. PGP and Public-Key Cryptography</a></span></dt><dt><span class="sect2"><a href="#idm571">6.2. SSL, S-HTTP and S/MIME</a></span></dt><dt><span class="sect2"><a href="#idm588">6.3. Linux IPSEC Implementations</a></span></dt><dt><span class="sect2"><a href="#ssh">6.4. <code class="literal">ssh</code> (Secure Shell) and <code class="literal">stelnet</code></a></span></dt><dt><span class="sect2"><a href="#idm631">6.5. PAM - Pluggable Authentication Modules</a></span></dt><dt><span class="sect2"><a href="#idm650">6.6. Cryptographic IP Encapsulation (CIPE)</a></span></dt><dt><span class="sect2"><a href="#idm662">6.7. Kerberos</a></span></dt><dt><span class="sect2"><a href="#idm674">6.8. Shadow Passwords.</a></span></dt><dt><span class="sect2"><a href="#crack">6.9. "Crack" and "John the Ripper"</a></span></dt><dt><span class="sect2"><a href="#idm690">6.10. CFS - Cryptographic File System and TCFS - Transparent Cryptographic File System</a></span></dt><dt><span class="sect2"><a href="#idm698">6.11. X11, SVGA and display security</a></span></dt></dl></dd><dt><span class="sect1"><a href="#kernel-security">7. Kernel Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm735">7.1. 2.0 Kernel Compile Options</a></span></dt><dt><span class="sect2"><a href="#idm783">7.2. 2.2 Kernel Compile Options</a></span></dt><dt><span class="sect2"><a href="#idm806">7.3. Kernel Devices</a></span></dt></dl></dd><dt><span class="sect1"><a href="#network-security">8. Network Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm835">8.1. Packet Sniffers</a></span></dt><dt><span class="sect2"><a href="#idm847">8.2. System services and tcp_wrappers</a></span></dt><dt><span class="sect2"><a href="#idm914">8.3. Verify Your DNS Information</a></span></dt><dt><span class="sect2"><a href="#idm917">8.4. identd</a></span></dt><dt><span class="sect2"><a href="#idm935">8.5. Configuring and Securing the Postfix MTA</a></span></dt><dt><span class="sect2"><a href="#idm941">8.6. SATAN, ISS, and Other Network Scanners</a></span></dt><dt><span class="sect2"><a href="#idm961">8.7. sendmail, qmail and MTA's</a></span></dt><dt><span class="sect2"><a href="#idm976">8.8. Denial of Service Attacks</a></span></dt><dt><span class="sect2"><a href="#idm1003">8.9. NFS (Network File System) Security. </a></span></dt><dt><span class="sect2"><a href="#idm1019">8.10. NIS (Network Information Service) (formerly YP). </a></span></dt><dt><span class="sect2"><a href="#idm1026">8.11. Firewalls</a></span></dt><dt><span class="sect2"><a href="#idm1054">8.12. IP Chains - Linux Kernel 2.2.x Firewalling</a></span></dt><dt><span class="sect2"><a href="#idm1076">8.13. Netfilter - Linux Kernel 2.4.x Firewalling</a></span></dt><dt><span class="sect2"><a href="#idm1104">8.14. VPNs - Virtual Private Networks</a></span></dt></dl></dd><dt><span class="sect1"><a href="#secure-prep">9. Security Preparation (before you go on-line)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm1129">9.1. Make a Full Backup of Your Machine</a></span></dt><dt><span class="sect2"><a href="#idm1133">9.2. Choosing a Good Backup Schedule</a></span></dt><dt><span class="sect2"><a href="#idm1136">9.3. Testing your backups</a></span></dt><dt><span class="sect2"><a href="#idm1139">9.4. Backup Your RPM or Debian File Database</a></span></dt><dt><span class="sect2"><a href="#logs">9.5. Keep Track of Your System Accounting Data</a></span></dt><dt><span class="sect2"><a href="#idm1183">9.6. Apply All New System Updates.</a></span></dt></dl></dd><dt><span class="sect1"><a href="#after-breakin">10. What To Do During and After a Breakin</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idm1189">10.1. Security Compromise Underway.</a></span></dt><dt><span class="sect2"><a href="#idm1202">10.2. Security Compromise has already happened</a></span></dt></dl></dd><dt><span class="sect1"><a href="#sources">11. Security Sources</a></span></dt><dd><dl><dt><span class="sect2"><a href="#linuxsecurity">11.1. LinuxSecurity.com References</a></span></dt><dt><span class="sect2"><a href="#ftpsites">11.2. FTP Sites</a></span></dt><dt><span class="sect2"><a href="#websites">11.3. Web Sites</a></span></dt><dt><span class="sect2"><a href="#idm1324">11.4. Mailing Lists</a></span></dt><dt><span class="sect2"><a href="#idm1332">11.5. Books - Printed Reading Material</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idm1357">12. Glossary</a></span></dt><dt><span class="sect1"><a href="#q-and-a">13. Frequently Asked Questions</a></span></dt><dt><span class="sect1"><a href="#conclusion">14. Conclusion</a></span></dt><dt><span class="sect1"><a href="#idm1505">15. Acknowledgments</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm21"></a>1. Introduction</h2></div></div></div><p>
This document covers some of the main issues that affect
Linux security. General philosophy and net-born resources are
discussed. 
</p><p>
A number of other HOWTO documents overlap with security issues, and
those documents have been pointed to wherever appropriate. 
</p><p>
This document is <span class="emphasis"><em>not</em></span> meant to be a up-to-date exploits document. Large
numbers of new exploits happen all the time. This document will tell
you where to look for such up-to-date information, and will give some general
methods to prevent such exploits from taking place. 
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm27"></a>1.1. New Versions of this Document</h3></div></div></div><p>
New versions of this document will be periodically posted to
<span class="emphasis"><em>comp.os.linux.answers</em></span>.  They will also be added to the
various sites that archive such information, including:
</p><p>
<code class="literal"><a class="ulink" href="http://www.linuxdoc.org/" target="_top">http://www.linuxdoc.org/</a></code>
</p><p>
The very latest version of this document should also be
available in various formats from:
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<code class="literal"><a class="ulink" href="http://scrye.com/~kevin/lsh/" target="_top">http://scrye.com/~kevin/lsh/</a></code>
</p></li><li class="listitem"><p>
<code class="literal"><a class="ulink" href="http://www.linuxsecurity.com/docs/Security-HOWTO" target="_top">http://www.linuxsecurity.com/docs/Security-HOWTO</a></code>
</p></li><li class="listitem"><p>
<code class="literal"><a class="ulink" href="http://www.tummy.com/security-howto" target="_top">http://www.tummy.com/security-howto</a></code>
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm49"></a>1.2. Feedback</h3></div></div></div><p>
All comments, error reports, additional information and criticism
of all sorts should be directed to:
</p><p>
<code class="literal"><a class="ulink" href="mailto:kevin-securityhowto@tummy.com" target="_top">kevin-securityhowto@tummy.com</a></code>
</p><p>
and
</p><p>
<code class="literal"><a class="ulink" href="mailto:dave@linuxsecurity.com" target="_top">dave@linuxsecurity.com</a></code>
</p><p>
<span class="emphasis"><em>Note</em></span>: Please send your feedback to <span class="emphasis"><em>both</em></span> authors. Also, be sure and
include "Linux" "security", or "HOWTO" in your subject to avoid Kevin's 
spam filter.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm62"></a>1.3. Disclaimer</h3></div></div></div><p>
No liability for the contents of this document can be accepted.
Use the concepts, examples and other content at your own risk.
Additionally, this is an early version, possibly with many
inaccuracies or errors.
</p><p>
A number of the examples and descriptions use the RedHat(tm) package
layout and system setup. Your mileage may vary. 
</p><p>
As far as we know, only programs that, under certain terms may be
used or evaluated for personal purposes will be described. Most
of the programs will be available, complete with source, under
<a class="ulink" href="http://www.gnu.org/copyleft/gpl.html" target="_top">GNU</a> terms.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm68"></a>1.4. Copyright Information</h3></div></div></div><p>
This document is copyrighted (c)1998-2000 Kevin Fenzi and Dave Wreski,
and distributed under the following terms:
</p><p>
 
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
 Linux HOWTO documents may be reproduced and distributed in
whole or in part, in any medium, physical or electronic, as long
as this copyright notice is retained on all copies. Commercial
redistribution is allowed and encouraged; however, the authors
would like to be notified of any such distributions.
</p></li><li class="listitem"><p>
 All translations, derivative works, or aggregate works
incorporating any Linux HOWTO documents must be covered under
this copyright notice.  That is, you may not produce a derivative
work from a HOWTO and impose additional restrictions on its
distribution. Exceptions to these rules may be granted under
certain conditions; please contact the Linux HOWTO coordinator at
the address given below.
</p></li><li class="listitem"><p>
 If you have questions, please contact Tim Bynum, the
Linux HOWTO coordinator, at
</p></li></ul></div><p>

</p><p>
<code class="literal"><a class="ulink" href="mailto:tjbynum@metalab.unc.edu" target="_top">tjbynum@metalab.unc.edu</a></code>
</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm82"></a>2. Overview</h2></div></div></div><p>
This document will attempt to explain some procedures and commonly-used 
software to help your Linux system be more secure.  It is
important to discuss some of the basic concepts first, and create a
security foundation, before we get started.
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm85"></a>2.1. Why Do We Need Security?</h3></div></div></div><p>
In the ever-changing world of global data communications, inexpensive
Internet connections, and fast-paced software development, security is
becoming more and more of an issue.  Security is now a basic
requirement because global computing is inherently insecure.  As your
data goes from point A to point B on the Internet, for example, it may
pass through several other points along the way, giving other users
the opportunity to intercept, and even alter, it.  Even other
users on your system may maliciously transform your data into
something you did not intend.  Unauthorized access to your system may
be obtained by intruders, also known as "crackers", who then use
advanced knowledge to impersonate you, steal information from you, or
even deny you access to your own resources.  If you're wondering
what the difference is between a "Hacker" and a "Cracker", see Eric
Raymond's document, "How to Become A Hacker", available at <a class="ulink" href="http://www.catb.org/~esr/faqs/hacker-howto.html" target="_top">http://www.catb.org/~esr/faqs/hacker-howto.html</a>.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm89"></a>2.2. How Secure Is Secure?</h3></div></div></div><p>
First, keep in mind that no computer system can ever be completely
secure. All you can do is make it increasingly difficult for someone
to compromise your system. For the average home Linux user, not much
is required to keep the casual cracker at bay. However, for
high-profile Linux users (banks, telecommunications companies, etc),
much more work is required.
</p><p>
Another factor to take into account is that the more secure your
system is, the more intrusive your security becomes. You need to
decide where in this balancing act your system will still be usable,
and yet secure for your purposes. For instance, you could require
everyone dialing into your system to use a call-back modem to call
them back at their home number. This is more secure, but if someone is
not at home, it makes it difficult for them to login. You could also
setup your Linux system with no network or connection to the Internet,
but this limits its usefulness.
</p><p>
If you are a medium to large-sized site, you should establish a
security policy stating how much security is required by your site
and what auditing is in place to check it. You can find a well-known
security policy example at <a class="ulink" href="http://www.faqs.org/rfcs/rfc2196.html" target="_top">http://www.faqs.org/rfcs/rfc2196.html</a>.  It has been recently
updated, and contains a great framework for establishing a security
policy for your company.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm95"></a>2.3. What Are You Trying to Protect?</h3></div></div></div><p>
Before you attempt to secure your system, you should determine what
level of threat you have to protect against, what risks you should or
should not take, and how vulnerable your system is as a result.  You
should analyze your system to know what you're protecting,
why you're protecting it, what value it has, and who has
responsibility for your data and other assets.
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<span class="emphasis"><em>Risk</em></span> is the possibility that an intruder may be successful in
attempting to access your computer.  Can an intruder read or write
files, or execute programs that could cause damage?  Can they delete
critical data? Can they prevent you or your company from getting important work 
done? Don't forget: someone gaining access to your account, or your
system, can also impersonate you.
</p><p>
Additionally, having one insecure account on your system can result in 
your entire network being compromised.  If you allow a single user
to login using a <code class="literal">.rhosts</code> file, or to use an insecure
service such as <code class="literal">tftp</code>, you risk an intruder getting 'his
foot in the door'.  Once the intruder has a user account on your
system, or someone else's system, it can be used to gain access to
another system, or another account.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>Threat</em></span> is typically from someone with motivation to gain unauthorized
access to your network or computer.  You must decide whom you trust to 
have access to your system, and what threat they could pose.
</p><p>
There are several types of intruders, and it is useful to keep their
different characteristics in mind as you are securing your systems.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
<span class="emphasis"><em>The Curious</em></span> - This type of intruder is basically
interested in finding out what type of system and data you have.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>The Malicious</em></span> - This type of intruder is out to either
bring down your systems, or deface your web page, or otherwise force you
to spend time and money recovering from the damage he has caused. 
</p></li><li class="listitem"><p>
<span class="emphasis"><em>The High-Profile Intruder</em></span> - This type of intruder is
trying to use your system to gain popularity and infamy.  He might use 
your high-profile system to advertise his abilities.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>The Competition</em></span> - This type of intruder is interested in
what data you have on your system.  It might be someone who thinks you 
have something that could benefit him, financially or otherwise.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>The Borrowers</em></span> - This type of intruder is interested in
setting up shop on your system and using its resources for their own
purposes. He typically will run chat or irc servers, porn archive
sites, or even DNS servers. 
</p></li><li class="listitem"><p>
<span class="emphasis"><em>The Leapfrogger</em></span> - This type of intruder is only
interested in your system to use it to get into other systems. If your 
system is well-connected or a gateway to a number of internal hosts,
you may well see this type trying to compromise your system.
</p></li></ul></div></li><li class="listitem"><p>
Vulnerability describes how well-protected your computer is from
another network, and the potential for someone to gain unauthorized
access.
</p><p>
What's at stake if someone breaks into your system?  Of course the
concerns of a dynamic PPP home user will be different from those of a
company connecting their machine to the Internet, or another large
network.
</p><p>
How much time would it take to retrieve/recreate any data that was
lost?  An initial time investment now can save ten times more time
later if you have to recreate data that was lost.  Have you checked
your backup strategy, and verified your data lately?
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm133"></a>2.4. Developing A Security Policy</h3></div></div></div><p>
Create a simple, generic policy for your system that your users can
readily understand and follow.  It should protect the data you're
safeguarding as well as the privacy of the users.  Some things to
consider adding are: who has access to the system (Can my friend use my
account?), who's allowed to install software on the system, who owns
what data, disaster recovery, and appropriate use of the system.
</p><p>
A generally-accepted security policy starts with the phrase
</p><p>
<span class="quote">&#8220;<span class="quote"><span class="emphasis"><em>		That which is not permitted is prohibited</em></span></span>&#8221;</span>
</p><p>
This means that unless you grant access to a service for a user, that
user shouldn't be using that service until you do grant access. Make
sure the policies work on your regular user account. Saying, "Ah, I
can't figure out this permissions problem, I'll just do it as root"
can lead to security holes that are very obvious, and even ones that
haven't been exploited yet. 
</p><p>
<a class="ulink" href="ftp://www.faqs.org/rfcs/rfc1244.html" target="_top">rfc1244</a>
is a document that describes how to create your own network security
policy.
</p><p>
<a class="ulink" href="ftp://www.faqs.org/rfcs/rfc1281.html" target="_top">rfc1281</a>
is a document that shows an example security policy with detailed
descriptions of each step. 
</p><p>
Finally, you might want to look at the COAST policy archive at <a class="ulink" href="ftp://coast.cs.purdue.edu/pub/doc/policy" target="_top">ftp://coast.cs.purdue.edu/pub/doc/policy</a> to see what some
real-life security policies look like.  
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm147"></a>2.5. Means of Securing Your Site</h3></div></div></div><p>
This document will discuss various means with which you can secure
the assets you have worked hard for: your local machine,
your data, your users, your network, even your reputation.  What would 
happen to your reputation if an intruder deleted some of your users'
data?  Or defaced your web site?  Or published your company's
corporate project plan for next quarter?  If you are planning a network 
installation, there are many factors you must take into account before
adding a single machine to your network.
</p><p>
Even if you have a single dial up PPP account, or just a small site,
this does not mean intruders won't be interested in your systems.
Large, high-profile sites are not the only targets -- many intruders
simply want to exploit as many sites as possible, regardless of their
size. Additionally, they may use a security hole in your site to gain
access to other sites you're connected to.
</p><p>
Intruders have a lot of time on their hands, and can avoid guessing
how you've obscured your system just by trying all the
possibilities.  There are also a number of reasons an intruder may be
interested in your systems, which we will discuss later.
</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm152"></a>2.5.1. Host Security</h4></div></div></div><p>
Perhaps the area of security on which administrators concentrate most is
host-based security.  This typically involves making sure your own
system is secure, and hoping everyone else on your network does the
same.  Choosing good passwords, securing your host's local network
services, keeping good accounting records, and upgrading programs with
known security exploits are among the things the local security
administrator is responsible for doing.  Although this is absolutely
necessary, it can become a daunting task once your network becomes
larger than a few machines.
</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm155"></a>2.5.2. Local Network Security </h4></div></div></div><p>
Network security is as necessary as local host security.  With
hundreds, thousands, or more computers on the same network,
you can't rely on each one of those systems being secure.  Ensuring
that only authorized users can use your network,
building firewalls, using strong encryption, and ensuring
there are no "rogue" (that is, unsecured) machines on your network are all
part of the network security administrator's duties.
</p><p>
This document will discuss some of the techniques used to secure your
site, and hopefully show you some of the ways to prevent an intruder
from gaining access to what you are trying to protect.
</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm159"></a>2.5.3. Security Through Obscurity</h4></div></div></div><p>
One type of security that must be discussed is "security through
obscurity". This means, for example, moving a service that has known
security vulnerabilities to a non-standard port in hopes that attackers 
won't notice it's there and thus won't exploit it. Rest assured that
they can determine that it's there and will exploit it. Security
through obscurity is no security at all. Simply because you may have a
small site, or a relatively low profile, does not mean an intruder
won't be interested in what you have.  We'll discuss what you're
protecting in the next sections. 
</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm162"></a>2.6. Organization of This Document</h3></div></div></div><p>
This document has been divided into a number of sections. They cover
several broad security issues. The first, 
<a class="xref" href="#physical-security" title="3. Physical Security">Section 3, &#8220;Physical Security&#8221;</a>,
covers how you need to protect your physical machine from
tampering. The second, 
<a class="xref" href="#local-security" title="4. Local Security">Section 4, &#8220;Local Security&#8221;</a>, describes how to 
protect your system from tampering by local users. The third, 
<a class="xref" href="#file-security" title="5. Files and File system Security">Section 5, &#8220;Files and File system Security&#8221;</a>,
shows you how to setup your file systems and permissions on your
files. The next, <a class="xref" href="#password-security" title="6. Password Security and Encryption">Section 6, &#8220;Password Security and Encryption &#8221;</a>, discusses how to use encryption to better secure 
your machine and network. 
<a class="xref" href="#kernel-security" title="7. Kernel Security">Section 7, &#8220;Kernel Security&#8221;</a> discusses what kernel 
options you should set or be aware of for a more secure system. 
<a class="xref" href="#network-security" title="8. Network Security">Section 8, &#8220;Network Security&#8221;</a>, describes how to 
better secure your Linux system from network attacks. 
<a class="xref" href="#secure-prep" title="9. Security Preparation (before you go on-line)">Section 9, &#8220;Security Preparation (before you go on-line)&#8221;</a>, discusses how to 
prepare your machine(s) before bringing them on-line. Next, 
<a class="xref" href="#after-breakin" title="10. What To Do During and After a Breakin">Section 10, &#8220;What To Do During and After a Breakin&#8221;</a>,
discusses what to do when you detect a system compromise in progress
or detect one that has recently happened. In <a class="xref" href="#sources" title="11. Security Sources">Section 11, &#8220;Security Sources&#8221;</a>, some primary security resources are enumerated.
The Q and A section <a class="xref" href="#q-and-a" title="13. Frequently Asked Questions">Section 13, &#8220;Frequently Asked Questions&#8221;</a>,
answers some frequently-asked questions, and finally a conclusion in
<a class="xref" href="#conclusion" title="14. Conclusion">Section 14, &#8220;Conclusion&#8221;</a>
</p><p>
The two main points to realize when reading this document are: 
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
Be aware of your system. Check system logs such as
<code class="literal">/var/log/messages</code> and keep an eye on your system, and  
</p></li><li class="listitem"><p>
Keep your system up-to-date by making sure you have installed the
current versions of software and have upgraded per security alerts.
Just doing this will help make your system markedly more secure.
</p></li></ul></div><p>

</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="physical-security"></a>3. Physical Security</h2></div></div></div><p>
The first layer of security you need to take into account is the
physical security of your computer systems. Who has direct physical
access to your machine? Should they? Can you protect your machine from
their tampering? Should you? 
</p><p>
How much physical security you need on your system is very dependent
on your situation, and/or budget. 
</p><p>
If you are a home user, you probably don't need a lot (although you
might need to protect your machine from tampering by children or
annoying relatives).  If you are in a lab, you need
considerably more, but users will still need to be able to get work
done on the machines. Many of the following sections will help out. If
you are in an office, you may or may not need to secure your machine
off-hours or while you are away. At some companies, leaving your
console unsecured is a termination offense. 
</p><p>
Obvious physical security methods such as locks on doors, cables,
locked cabinets, and video surveillance are all good ideas, but beyond
the scope of this document. :)
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm190"></a>3.1. Computer locks</h3></div></div></div><p>
Many modern PC cases include a "locking" feature. Usually this
will be a socket on the front of the case that allows you to turn an
included key to a locked or unlocked position. Case locks can help
prevent someone from stealing your PC, or opening up the case and
directly manipulating/stealing your hardware. They can also sometimes
prevent someone from rebooting your computer from their own floppy or
other hardware. 
</p><p>
These case locks do different things according to the support in the
motherboard and how the case is constructed. On many PC's they make it
so you have to break the case to get the case open. On some others,
they will not let you plug in new keyboards or
mice. Check your motherboard or case instructions for more
information. This can sometimes be a very useful feature, even though
the locks are usually very low-quality and can easily be defeated by
attackers with locksmithing. 
</p><p>
Some machines (most notably SPARC's and macs) have a dongle on the back
that, if you put a cable through, attackers would have to cut the cable
or break the case to get into it. Just putting a padlock or combo lock
through these can be a good deterrent to someone stealing your
machine.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm195"></a>3.2. BIOS Security</h3></div></div></div><p>
The BIOS is the lowest level of software that configures or
manipulates your x86-based hardware. LILO and other Linux boot methods
access the BIOS to determine how to boot up your Linux machine. Other
hardware that Linux runs on has similar software (Open Firmware on Macs
and new Suns, Sun boot PROM, etc...). You can use your BIOS to prevent 
attackers from rebooting your machine and manipulating your Linux
system. 
</p><p>
Many PC BIOSs let you set a boot password. This
doesn't provide all that much security (the BIOS can be reset, or removed
if someone can get into the case), but might be a good deterrent (i.e. it
will take time and leave traces of tampering). Similarly, on
S/Linux (Linux for SPARC(tm) processor machines), your EEPROM
can be set to require a boot-up password. This might slow attackers down.  
</p><p>
Another risk of trusting BIOS passwords to secure your system is the
default password problem. Most BIOS makers don't expect people to
open up their computer and disconnect batteries if they forget their
password and have equipped their BIOSes with default passwords that
work regardless of your chosen password. Some of the more common
passwords include:
</p><p>
j262
AWARD_SW
AWARD_PW
lkwpeter
Biostar
AMI
Award
bios
BIOS
setup
cmos
AMI!SW1
AMI?SW1
password
hewittrand
shift + s y x z
</p><p>
I tested an Award BIOS and AWARD_PW worked. These passwords are quite
easily available from manufacturers' websites and
<a class="ulink" href="http://astalavista.box.sk" target="_top">http://astalavista.box.sk</a> 
and as such a BIOS password cannot be considered adequate protection
from a knowledgeable attacker. 
</p><p>
Many x86 BIOSs also allow you to specify various other good security
settings. Check your BIOS manual or look at it the next time you boot
up. For example, some BIOSs disallow booting from floppy drives and some
require passwords to access some BIOS features. 
</p><p>
<span class="emphasis"><em>Note</em></span>: If you have a server machine, and you set up a boot password,
your machine will not boot up unattended. Keep in mind that you will
need to come in and supply the password in the event of a power
failure. ;(
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm206"></a>3.3. Boot Loader Security</h3></div></div></div><p>
The various Linux boot loaders also can have a boot password set.
LILO, for example, has <code class="literal">password</code> and <code class="literal">restricted</code>
settings; <code class="literal">password</code> requires password at boot time,
whereas <code class="literal">restricted</code> requires a boot-time password only if you
specify options (such as <code class="literal">single</code>) at the <code class="literal">LILO </code> prompt.
</p><p>
&gt;From the lilo.conf man page: 

</p><pre class="screen">
password=password
              The per-image option `password=...' (see below) applies to all images.

restricted
              The per-image option `restricted' (see below) applies to all images.

       password=password
              Protect the image by a password.

       restricted
              A password is only required to boot the image if
              parameters are specified  on  the  command  line 
              (e.g. single).
</pre><p>

</p><p>
Keep in mind when setting all these passwords that you need to
remember them. :) Also remember that these passwords will merely slow
the determined attacker.  They won't prevent someone from booting from 
a floppy, and mounting your root partition.  If you are using security 
in conjunction with a boot loader, you might as well disable booting
from a floppy in your computer's BIOS, and password-protect the BIOS.
</p><p>
Also keep in mind that the /etc/lilo.conf will need to be mode "600"
(readable and writing for root only), or others will be able to read
your passwords!
</p><p>
&gt;From the GRUB info page:  
GRUB provides "password" feature, so that only administrators
    can start the interactive operations (i.e. editing menu entries and
    entering the command-line interface). To use this feature, you need to
    run the command `password' in your configuration file (*note
    password::), like this:
</p><p>
	 password --md5 PASSWORD
</p><p>
       If this is specified, GRUB disallows any interactive control, until
    you press the key &lt;p&gt; and enter a correct password.  The option `--md5'
    tells GRUB that `PASSWORD' is in MD5 format.  If it is omitted, GRUB
    assumes the `PASSWORD' is in clear text.
</p><p>
       You can encrypt your password with the command `md5crypt' (*note
    md5crypt::). For example, run the grub shell (*note Invoking the grub
    shell::), and enter your password:
</p><p>
	 grub&gt; md5crypt
	 Password: **********
	 Encrypted: $1$U$JK7xFegdxWH6VuppCUSIb.
</p><p>
       Then, cut and paste the encrypted password to your configuration
    file.
</p><p>
Grub also has a 'lock' command that will allow you to lock a partition
if you don't provide the correct password. Simply add 'lock' and the
partition will not be accessable until the user supplies a password. 
</p><p>
If anyone has security-related information from a different boot
loader, we would love to hear it. (<code class="literal">grub</code>, <code class="literal">silo</code>, <code class="literal">milo</code>, <code class="literal">linload</code>, etc). 
</p><p>
<span class="emphasis"><em>Note</em></span>: If you have a server machine, and you set up a boot password,
your machine will <span class="emphasis"><em>not</em></span> boot up unattended. Keep in mind that you will
need to come in and supply the password in the event of a power
failure. ;(
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm234"></a>3.4. xlock and vlock</h3></div></div></div><p>
If you wander away from your machine from time to time, it is nice to
be able to "lock" your console so that no one can tamper with, or look at,
your work. Two programs that do this are: <code class="literal">xlock</code> and <code class="literal">vlock</code>. 
</p><p>
<code class="literal">xlock</code> is a X display locker. It should be included in any Linux
distributions that support X. Check out the man page for it for more
options, but in general you can run <code class="literal">xlock</code> from any xterm on your
console and it will lock the display and require your password to
unlock. 
</p><p>
<code class="literal">vlock</code> is a simple little program that allows you to lock some or all
of the virtual consoles on your Linux box. You can lock just the one
you are working in or all of them. If you just lock one, others can
come in and use the console; they will just not be able to use your
virtual console until you unlock it. <code class="literal">vlock</code> ships with RedHat
Linux, but your mileage may vary. 
</p><p>
Of course locking your console will prevent someone from tampering
with your work, but won't prevent them from rebooting your machine
or otherwise disrupting your work. It also does not prevent them from
accessing your machine from another machine on the network and causing 
problems.
</p><p>
More importantly, it does not prevent someone from switching out of
the X Window System entirely, and going to a normal virtual console
login prompt, or to the VC that X11 was started from, and suspending
it, thus obtaining your privileges.  For this reason, you might
consider only using it while under control of xdm.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm247"></a>3.5. Security of local devices</h3></div></div></div><p>
If you have a webcam or a microphone attached to your system, you
should consider if there is some danger of a attacker gaining access
to those devices. When not in use, unplugging or removing such devices
might be an option. Otherwise you should carefully read and look at
any software with provides access to such devices. 
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm250"></a>3.6. Detecting Physical Security Compromises</h3></div></div></div><p>
The first thing to always note is when your machine was
rebooted. Since Linux is a robust and stable OS, the only times your
machine should reboot is when <span class="emphasis"><em>you</em></span> take it down for OS upgrades,
hardware swapping, or the like. If your machine has rebooted without
you doing it, that may be a sign that an intruder has compromised
it. Many of the ways that your machine can be compromised require the
intruder to reboot or power off your machine. 
</p><p>
Check for signs of tampering on the case and computer area. Although
many intruders clean traces of their presence out of logs, it's a good
idea to check through them all and note any discrepancy.
</p><p>
It is also a good idea to store log data at a secure location, such as 
a dedicated log server within your well-protected network.  Once a
machine has been compromised, log data becomes of little use as it
most likely has also been modified by the intruder.
</p><p>
The syslog daemon can be configured to automatically send log data to
a central syslog server, but this is typically sent unencrypted, 
allowing an intruder to view data as it is being transferred.  This
may reveal information about your network that is not intended to be
public.  There are syslog daemons available that encrypt the data as
it is being sent. 
</p><p>
Also be aware that faking syslog messages is easy -- with an exploit
program having been published.  Syslog even accepts net log entries
claiming to come from the local host without indicating their true origin.
</p><p>
Some things to check for in your logs:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
Short or incomplete logs.
</p></li><li class="listitem"><p>
Logs containing strange timestamps.
</p></li><li class="listitem"><p>
Logs with incorrect permissions or ownership. 
</p></li><li class="listitem"><p>
Records of reboots or restarting of services. 
</p></li><li class="listitem"><p>
missing logs. 
</p></li><li class="listitem"><p>
<code class="literal">su</code> entries or logins from strange places. 
</p></li></ul></div><p>

</p><p>
We will discuss system log data <a class="xref" href="#logs" title="9.5. Keep Track of Your System Accounting Data">Section 9.5, &#8220;Keep Track of Your System Accounting Data&#8221;</a>
in the HOWTO.
</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="local-security"></a>4. Local Security</h2></div></div></div><p>
The next thing to take a look at is the security in your system
against attacks from local users. Did we just say <span class="emphasis"><em>local</em></span> users? Yes!
</p><p>
Getting access to a local user account is one of the first things that system
intruders attempt while on their way to exploiting the root
account. With lax local security, they can then "upgrade" their normal
user access to root access using a variety of bugs and poorly setup
local services. If you make sure your local security is tight, then
the intruder will have another hurdle to jump.
</p><p>
Local users can also cause a lot of havoc with your system even
(especially) if they really are who they say they are. Providing
accounts to people you don't know or for whom you have no contact information
is a very bad idea.
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm281"></a>4.1. Creating New Accounts</h3></div></div></div><p>
You should make sure you provide user accounts with only the minimal
requirements for the task they need to do. If you provide your son
(age 10) with an account, you might want him to only have access to a
word processor or drawing program, but be unable to delete data that
is not his.
</p><p>
Several good rules of thumb when allowing other people legitimate
access to your Linux machine:
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
Give them the minimal amount of privileges they need.
</p></li><li class="listitem"><p>
Be aware when/where they login from, or should be logging in from. 
</p></li><li class="listitem"><p>
Make sure you remove inactive accounts, which you can determine by
using the 'last' command and/or checking log files for any activity by
the user. 
</p></li><li class="listitem"><p>
The use of the same userid on all computers and networks is advisable 
to ease account maintenance, and permits easier analysis of log
data.
</p></li><li class="listitem"><p>
The creation of group user-id's should be absolutely prohibited.  User
accounts also provide accountability, and this is not possible with
group accounts.
</p></li></ul></div><p>

</p><p>
Many local user accounts that are used in security compromises have
not been used in months or years. Since no one is using
them they, provide the ideal attack vehicle.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="root-security"></a>4.2. Root Security</h3></div></div></div><p>
The most sought-after account on your machine is the root (superuser)
account.  This account has authority over the entire machine, which
may also include authority over other machines on the network.
Remember that you should only use the root account for very short,
specific tasks, and should mostly run as a normal user. Even small
mistakes made while logged in as the root user can cause problems. The 
less time you are on with root privileges, the safer you will be. 
</p><p>
Several tricks to avoid messing up your own box as root:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
When doing some complex command, try running it first in a
non-destructive way...especially commands that use globing: e.g., if
you want to do <code class="literal">rm foo*.bak</code>, first do <code class="literal">ls foo*.bak</code> and make
sure you are going to delete the files you think you are. Using <code class="literal">echo</code>
in place of destructive commands also sometimes works. 
</p></li><li class="listitem"><p>
Provide your users with a default alias to the <code class="literal">rm</code> command to ask for
confirmation for deletion of files.
</p></li><li class="listitem"><p>
 
Only become root to do single specific tasks. If you find yourself
trying to figure out how to do something, go back to a normal user
shell until you are <span class="emphasis"><em>sure</em></span> what needs to be done by root. 
</p></li><li class="listitem"><p>
The command path for the root user is very important.  The command
path (that is, the <code class="literal">PATH</code> environment variable) specifies the
directories in which the shell searches for programs.  Try to limit
the command path for the root user as much as possible, and <span class="emphasis"><em>never</em></span>
include <code class="literal">.</code> (which means "the current directory") in your PATH.
Additionally, never have writable directories in your search path, as
this can allow attackers to modify or place new binaries in your
search path, allowing them to run as root the next time you run that
command.
</p></li><li class="listitem"><p>
Never use the rlogin/rsh/rexec suite of tools (called the r-utilities)
as root. They are subject to many sorts of attacks, and are downright
dangerous when run as root. Never create a <code class="literal">.rhosts</code> file for root.
</p></li><li class="listitem"><p>
The <code class="literal">/etc/securetty</code> file contains a list of terminals that root can
login from. By default (on Red Hat Linux) this is set to only the local
virtual consoles(vtys). Be very wary of adding anything else to
this file. You should be able to login remotely as your regular user
account and then <code class="literal">su</code> if you need to (hopefully over 
<a class="xref" href="#ssh" title="6.4. ssh (Secure Shell) and stelnet">Section 6.4, &#8220;<code class="literal">ssh</code> (Secure Shell) and <code class="literal">stelnet</code>&#8221;</a> or other encrypted channel), so there is no
need to be able to login directly as root. 
</p></li><li class="listitem"><p>
Always be slow and deliberate running as root. Your actions could
affect a lot of things. Think before you type!
</p></li></ul></div><p>

</p><p>
If you absolutely positively need to allow someone (hopefully very
trusted) to have root access to your machine, there are a few
tools that can help. <code class="literal">sudo</code> allows users to use their password to access
a limited set of commands as root. This would allow you to, for
instance, let a user be able to eject and mount removable media on
your Linux box, but have no other root privileges. <code class="literal">sudo</code> also keeps a
log of all successful and unsuccessful sudo attempts, allowing you to
track down who used what command to do what. For this reason <code class="literal">sudo</code>
works well even in places where a number of people have root access,
because it helps you keep track of changes made.
</p><p>
Although <code class="literal">sudo</code> can be used to give specific users specific privileges
for specific tasks, it does have several shortcomings. It should be
used only for a limited set of tasks, like restarting a server, or
adding new users.  Any program that offers a shell escape will give
root access to a user invoking it via <code class="literal">sudo</code>.  This includes
most editors, for example.  Also, a program as innocuous as
<code class="literal">/bin/cat</code> can be used to overwrite files, which could allow
root to be exploited.  Consider <code class="literal">sudo</code> as a means for
accountability, and don't expect it to replace the root user and still
be secure.
</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="file-security"></a>5. Files and File system Security</h2></div></div></div><p>
A few minutes of preparation and planning ahead before putting your
systems on-line can help to protect them and the data
stored on them.

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
There should never be a reason for users' home directories to allow
SUID/SGID programs to be run from there.  Use the <code class="literal">nosuid</code> option in
<code class="literal">/etc/fstab</code> for partitions that are writable by others than root.  You
may also wish to use <code class="literal">nodev</code> and <code class="literal">noexec</code> on users' home partitions,
as well as <code class="literal">/var</code>, thus prohibiting execution of programs, and
creation of character or block devices, which should never be
necessary anyway. 
</p></li><li class="listitem"><p>
If you are exporting file-systems using NFS, be sure to configure
<code class="literal">/etc/exports</code> with the most restrictive access possible.  This means
not using wild cards, not allowing root write access, and exporting
read-only wherever possible.
</p></li><li class="listitem"><p>
Configure your users' file-creation <code class="literal">umask</code> to be as restrictive as
possible.  See <a class="xref" href="#umask" title="5.1. Umask Settings">Section 5.1, &#8220;Umask Settings&#8221;</a>.
</p></li><li class="listitem"><p>
If you are mounting file systems using a network file system such as
NFS, be sure to configure /etc/exports with suitable restrictions.
Typically, using `nodev', `nosuid', and perhaps `noexec', are
desirable.
</p></li><li class="listitem"><p>
Set file system limits instead of allowing <code class="literal">unlimited</code> as is the
default.  You can control the per-user limits using the
resource-limits PAM module and <code class="literal">/etc/pam.d/limits.conf</code>.  For example,
limits for group <code class="literal">users</code> might look like this:
</p><p>

</p><pre class="screen">
		@users     hard  core    0
		@users     hard  nproc   50
		@users     hard  rss     5000
</pre><p>

</p><p>
This says to prohibit the creation of core files, restrict the
number of processes to 50, and restrict memory usage per user to
5M.
</p><p>
You can also use the /etc/login.defs configuration file to set the
same limits. 
</p></li><li class="listitem"><p>
The <code class="literal">/var/log/wtmp</code> and <code class="literal">/var/run/utmp</code> files contain the login records
for all users on your system.  Their integrity must be maintained
because they can be used to determine when and from where a user (or
potential intruder) has entered your system.  These files should
also have <code class="literal">644</code> permissions, without affecting normal system
operation.
</p></li><li class="listitem"><p>
The immutable bit can be used to prevent accidentally deleting or
overwriting a file that must be protected.  It also prevents someone
from creating a hard link to the file. See the <code class="literal">chattr</code>(1)
man page for information on the immutable bit. 
</p></li><li class="listitem"><p>

SUID and SGID files on your system are a potential security risk, and
should be monitored closely.  Because these programs grant special
privileges to the user who is executing them, it is necessary to
ensure that insecure programs are not installed.  A favorite trick of
crackers is to exploit SUID-root programs, then leave a SUID
program as a back door to get in the next time, even if the original
hole is plugged.
</p><p>
Find all SUID/SGID programs on your system, and keep track of what
they are, so you are aware of any changes which could indicate a
potential intruder.  Use the following command to find all SUID/SGID
programs on your system:
</p><p>

</p><pre class="screen">
                root#  find / -type f \( -perm -04000 -o -perm -02000 \)
</pre><p>

</p><p>
The Debian distribution runs a job each night to determine what SUID
files exist. It then compares this to the previous night's run. You can 
look in <code class="literal">/var/log/setuid*</code> for this log.
</p><p>
You can remove the SUID or SGID permissions on a
suspicious program with <code class="literal">chmod</code>, then restore them back if you
absolutely feel it is necessary.
</p></li><li class="listitem"><p>
World-writable files, particularly system files, can be a security
hole if a cracker gains access to your system and modifies them.
Additionally, world-writable directories are dangerous, since they
allow a cracker to add or delete files as he wishes.  To locate all
world-writable files on your system, use the following command:
</p><p>

</p><pre class="screen">
		root# find / -perm -2 ! -type l -ls
</pre><p>

and be sure you know why those files are writable.  In the normal
course of operation, several files will be world-writable, including some
from <code class="literal">/dev</code>, and symbolic links, thus the <code class="literal">! -type l</code>
which excludes these from the previous <code class="literal">find</code> command.
</p></li><li class="listitem"><p>
</p><p>
Unowned files may also be an indication an intruder has accessed your
system.  You can locate files on your system that have no
owner, or belong to no group with the command:
</p><p>

</p><pre class="screen">
		root# find / \( -nouser -o -nogroup \) -print
</pre><p>

</p></li><li class="listitem"><p>
Finding <code class="literal">.rhosts</code> files should be a part of your regular system
administration duties, as these files should not be permitted on your
system.  Remember, a cracker only needs one insecure account to
potentially gain access to your entire network.  You can locate all
<code class="literal">.rhosts</code> files on your system with the following command:

</p><pre class="screen">
               root# find /home -name .rhosts -print
</pre><p>

</p></li><li class="listitem"><p>
</p><p>
Finally, before changing permissions on any system files, make sure
you understand what you are doing. Never change permissions on a file
because it seems like the easy way to get things working. Always
determine why the file has that permission before changing it.
</p></li></ul></div><p>

</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="umask"></a>5.1. Umask Settings</h3></div></div></div><p>
The <code class="literal">umask</code> command can be used to determine the default file creation
mode on your system. It is the octal complement of the desired file
mode. If files are created without any regard to their permissions
settings, the user could inadvertently give read or write permission
to someone that should not have this permission. Typical <code class="literal">umask</code>
settings include <code class="literal">022</code>, <code class="literal">027</code>, and <code class="literal">077</code> (which is the most
restrictive). Normally the umask is set in <code class="literal">/etc/profile</code>, so it applies
to all users on the system.  The resulting permission is calculated as
follows: The default permission of  user/group/others (7 for
directories, 6 for files) is combined with the  inverted mask (NOT)
using AND on a per-bit-basis. 
</p><p>
Example 1:
</p><p>
file, default 6, binary:      110
mask, eg. 2: 010, NOT:        101
</p><p>
resulting permission, AND:    100  (equals 4, r__)
</p><p>
Example 2:
</p><p>
file, default 6, binary:      110
mask, eg. 6: 110, NOT:        001
</p><p>
resulting permission, AND:    000  (equals 0, ___)
</p><p>
Example 3:
</p><p>
directory, default 7, binary: 111                
mask, eg. 2: 010, NOT:        101 
</p><p>
resulting permission, AND:    101  (equals 5, r_x)
</p><p>
Example 4:
</p><p>
directory, default 7, binary: 111                
mask, eg. 6: 110, NOT:        001 
</p><p>
resulting permission, AND:    001  (equals 1, __x)
</p><p>

</p><pre class="screen">
		# Set the user's default umask
		umask 033
</pre><p>

Be sure to make root's umask <code class="literal">077</code>, which will disable read, write, and
execute permission for other users, unless explicitly changed using
<code class="literal">chmod</code>.  In this case, newly-created directories would have 744
permissions, obtained by subtracting 033 from 777.  Newly-created files
using the 033 umask would have permissions of 644.
</p><p>
If you are using Red Hat, and adhere to their user and group ID
creation scheme (User Private Groups), it is only necessary to use <code class="literal">002</code>
for a <code class="literal">umask</code>.  This is due to the fact that the default configuration
is one user per group.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm432"></a>5.2. File Permissions</h3></div></div></div><p>
It's important to ensure that your system files are not open for
casual editing by users and groups who shouldn't be doing such system
maintenance.
</p><p>
Unix separates access control on files and directories according to
three characteristics:  owner, group, and other.  There is always
exactly one owner, any number of members of the group, and everyone
else.
</p><p>
A quick explanation of Unix permissions:
</p><p>
Ownership      - Which user(s) and group(s) retain(s) control of the
permission settings of the node and parent of the node
</p><p>
Permissions    - Bits capable of being set or reset to allow certain
types of access to it.  Permissions for directories may have a
different meaning than the same set of permissions on files.
</p><p>
<span class="emphasis"><em>Read:</em></span>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
To be able to view contents of a file
</p></li><li class="listitem"><p>
To be able to read a directory
</p></li></ul></div><p>

</p><p>
<span class="emphasis"><em>Write:</em></span>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
To be able to add to or change a file
</p></li><li class="listitem"><p>
To be able to delete or move files in a directory
</p></li></ul></div><p>

</p><p>
<span class="emphasis"><em>Execute:</em></span>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
To be able to run a binary program or shell script
</p></li><li class="listitem"><p>
To be able to search in a directory, combined with read permission
</p></li></ul></div><p>

</p><p>
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Save Text Attribute: (For directories)</span></dt><dd><p>
The "sticky bit" also has a different meaning when 
applied to directories than when applied to files.  If the sticky bit is set on a directory, then 
a user may only delete files that the he owns or for which he has
explicit write permission granted, even when he has write access to
the directory.  This is designed for directories like <code class="literal">/tmp</code>, which are
world-writable, but where it may not be desirable to allow any user to 
delete files at will.  The sticky bit is seen as a <code class="literal">t</code> in a long
directory listing.
</p></dd></dl></div><p>
</p><p>
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">SUID Attribute: (For Files)</span></dt><dd><p>
This describes set-user-id permissions on the file.  When the set user
ID access mode is set in the owner permissions, and the file is
executable, processes which run it are granted access to system
resources based on user who owns the file, as opposed to the user who
created the process. This is the cause of many "buffer overflow" exploits.
</p></dd></dl></div><p>
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">SGID Attribute: (For Files)</span></dt><dd><p>
If set in the group permissions, this bit controls the "set group id" 
status of a file.  This behaves the same way as SUID, except the group 
is affected instead.  The file must be executable for this to
have any effect.
</p></dd></dl></div><p>
</p><p>
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">SGID Attribute: (For directories)</span></dt><dd><p>
If you set the SGID bit on a directory (with <code class="literal">chmod g+s directory</code>),
files created in that directory will have their group set to the
directory's group.
</p></dd></dl></div><p>
</p><p>
You          - The owner of the file
</p><p>
Group        - The group you belong to
</p><p>
Everyone     - Anyone on the system that is not the owner or a member
of the group
</p><p>
<span class="emphasis"><em>File Example:</em></span>
</p><p>

</p><pre class="screen">
        -rw-r--r--  1 kevin  users         114 Aug 28  1997 .zlogin
        1st bit - directory?             (no)
         2nd bit - read by owner?         (yes, by kevin)
          3rd bit - write by owner?        (yes, by kevin)
           4th bit - execute by owner?      (no)
            5th bit - read by group?         (yes, by users)
             6th bit - write by group?        (no)
              7th bit - execute by group?      (no)
               8th bit - read by everyone?      (yes, by everyone)
                9th bit - write by everyone?     (no)
                 10th bit - execute by everyone?  (no)

</pre><p>

</p><p>
The following lines are examples of the minimum sets of permissions
that are required to perform the access described.  You may want to
give more permission than what's listed here, but this should
describe what these minimum permissions on files do:
</p><p>

</p><pre class="screen">

-r--------  Allow read access to the file by owner
--w-------  Allows the owner to modify or delete the file
            (Note that anyone with write permission to the directory
             the file is in can overwrite it and thus delete it)
---x------  The owner can execute this program, but not shell scripts, 
	     which still need read permission
---s------  Will execute with effective User ID = to owner
--------s-  Will execute with effective Group ID = to group
-rw------T  No update of "last modified time".  Usually used for swap
	     files
---t------  No effect.  (formerly sticky bit)

</pre><p>

<span class="emphasis"><em>Directory Example:</em></span>

</p><pre class="screen">

        drwxr-xr-x  3 kevin  users         512 Sep 19 13:47 .public_html/
        1st bit - directory?             (yes, it contains many files)
         2nd bit - read by owner?         (yes, by kevin)
          3rd bit - write by owner?        (yes, by kevin)
           4th bit - execute by owner?      (yes, by kevin)
            5th bit - read by group?         (yes, by users
             6th bit - write by group?        (no)
              7th bit - execute by group?      (yes, by users)
               8th bit - read by everyone?      (yes, by everyone)
                9th bit - write by everyone?     (no)
                 10th bit - execute by everyone?  (yes, by everyone)

</pre><p>

</p><p>
The following lines are examples of the minimum sets of permissions 
that are required to perform the access described.  You may want to
give more permission than what's listed, but this should describe what 
these minimum permissions on directories do:
</p><p>

</p><pre class="screen">
dr--------  The contents can be listed, but file attributes can't be read
d--x------  The directory can be entered, and used in full execution paths
dr-x------  File attributes can be read by owner
d-wx------  Files can be created/deleted, even if the directory
	     isn't the current one
d------x-t  Prevents files from deletion by others with write
	     access. Used on /tmp
d---s--s--  No effect
</pre><p>

</p><p>
System configuration files (usually in <code class="literal">/etc</code>) are usually mode <code class="literal">640</code>
(<code class="literal">-rw-r-----</code>), and owned by root. Depending on your site's security
requirements, you might adjust this. Never leave any system files
writable by a group or everyone.  Some configuration files, including
<code class="literal">/etc/shadow</code>, should only be readable by root, and directories in <code class="literal">/etc</code>
should at least not be accessible by others.
</p><p>
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">SUID Shell Scripts</span></dt><dd><p>
SUID shell scripts are a serious security risk, and for this reason
the kernel will not honor them.  Regardless of how secure you think
the shell script is, it can be exploited to give the cracker a root
shell.
</p></dd></dl></div><p>
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm513"></a>5.3. Integrity Checking</h3></div></div></div><p>
Another very good way to detect local (and also network) attacks on
your system is to run an integrity checker like <code class="literal">Tripwire</code>,
<code class="literal">Aide</code> or <code class="literal">Osiris</code>.
These integrety checkers run a number of checksums on all your important
binaries and config files and compares them against a database of former,
known-good values as a reference. Thus, any changes in the files will 
be flagged.
</p><p>
It's a good idea to install these sorts of programs onto a floppy, and then
physically set the write protect on the floppy. This way intruders
can't tamper with the integrety checker itself or change the database. Once you
have something like this setup, it's a good idea to run it as part of your normal
security administration duties to see if anything has changed.
</p><p>
You can even add a <code class="literal">crontab</code> entry to run the checker from your floppy
every night and mail you the results in the morning. Something like:

</p><pre class="screen">
		# set mailto
		MAILTO=kevin
		# run Tripwire
		15 05 * * * root /usr/local/adm/tcheck/tripwire 
</pre><p>

will mail you a report each morning at 5:15am. 
</p><p>
Integrity checkers can be a godsend to detecting intruders before you would
otherwise notice them. Since a lot of files change on the average
system, you have to be careful what is cracker activity and what is
your own doing. 
</p><p>
You can find the freely available unsusported version of
<code class="literal">Tripwire</code> at <a class="ulink" href="http://www.tripwire.org" target="_top">http://www.tripwire.org</a>, 
free of charge.  Manuals and support can be purchased.
</p><p>
<code class="literal">Aide</code> can be found at <a class="ulink" href="http://www.cs.tut.fi/~rammer/aide.html" target="_top">http://www.cs.tut.fi/~rammer/aide.html</a>. 
</p><p>
<code class="literal">Osiris</code> can be found at <a class="ulink" href="http://www.shmoo.com/osiris/" target="_top">http://www.shmoo.com/osiris/</a>.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm533"></a>5.4. Trojan Horses</h3></div></div></div><p>
"Trojan Horses" are named after the fabled ploy in Virgil's  "Aenid".
The idea is that a cracker distributes a program or binary that sounds
great, and encourages other people to download it and run it as root. Then
the program can compromise their system while they are not paying
attention. While they think the binary they just pulled down does one
thing (and it might very well), it also compromises their security. 
</p><p>
You should take care of what programs you install on your
machine. RedHat provides MD5 checksums and PGP signatures on its RPM 
files so you can verify you are installing the real thing. Other 
distributions have similar methods. You should never run any unfamiliar 
binary, for which you don't have the source, as root. Few attackers are 
willing to release source code to public scrutiny.
</p><p>
Although it can be complex, make sure you are getting the source for
a program from its real distribution site. If the program is going to
run as root, make sure either you or someone you trust has looked over
the source and verified it.
</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="password-security"></a>6. Password Security and Encryption </h2></div></div></div><p>
One of the most important security features used today are
passwords. It is important for both you and all your users to have
secure, unguessable passwords. Most of the more recent Linux
distributions include <code class="literal">passwd</code> programs that do not allow you to set a
easily guessable password. Make sure your <code class="literal">passwd</code> program is up to date
and has these features.
</p><p>
In-depth discussion of encryption is beyond the scope of this
document, but an introduction is in order. Encryption is very useful,
possibly even necessary in this day and age. There are all sorts of
methods of encrypting data, each with its own set of
characteristics.
</p><p>
Most Unicies (and Linux is no exception) primarily use a one-way
encryption algorithm, called DES (Data Encryption Standard) to encrypt
your passwords. This encrypted password is then stored in (typically)
<code class="literal">/etc/passwd</code> (or less commonly) <code class="literal">/etc/shadow</code>. When you attempt to login,
the password you type in is encrypted again and compared with the entry in
the file that stores your passwords. If they match, it must be the
same password, and you are allowed access. Although DES is a two-way
encryption algorithm (you can code and then decode a message, given
the right keys), the variant that most Unixes use is one-way. This
means that it should not be possible to reverse the encryption to get
the password from the contents of <code class="literal">/etc/passwd</code> (or <code class="literal">/etc/shadow</code>).
</p><p>
Brute force attacks, such as "Crack" or "John the Ripper" (see section <a class="xref" href="#crack" title='6.9. "Crack" and "John the Ripper"'>Section 6.9, &#8220;"Crack" and "John the Ripper"&#8221;</a>) can often guess passwords unless your password is sufficiently
random. PAM modules (see below) allow you to use a different
encryption routine with your passwords (MD5 or the like).  You can use
Crack to your advantage, as well.  Consider periodically running Crack
against your own password database, to find insecure passwords.  Then
contact the offending user, and instruct him to change his password.
</p><p>
You can go to <a class="ulink" href="http://consult.cern.ch/writeup/security/security_3.html" target="_top">http://consult.cern.ch/writeup/security/security_3.html</a> for
information on how to choose a good password.
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm553"></a>6.1. PGP and Public-Key Cryptography</h3></div></div></div><p>
Public-key cryptography, such as that used for PGP,
uses one key for encryption, and one key for
decryption.  Traditional cryptography, however, uses the same key
for encryption and decryption; this key must
be known to both parties, and thus somehow transferred from one to the other
securely.
</p><p>
To alleviate the need to securely transmit the encryption
key, public-key encryption uses two separate keys: a public key
and a private key.  Each person's public key is available by anyone to
do the encryption, while at the same time each person keeps his or her
private key to decrypt messages encrypted with the correct public key.
</p><p>
There are advantages to both public key and private key cryptography,
and you can read about those differences in <a class="ulink" href="http://www.rsa.com/rsalabs/faq/" target="_top">the RSA Cryptography FAQ</a>,
listed at the end of this section.
</p><p>
PGP (Pretty Good Privacy) is well-supported on Linux. Versions 2.6.2
and 5.0 are known to work well. For a good primer on PGP and how to
use it, take a look at the PGP FAQ: <a class="ulink" href="http://www.pgp.com/service/export/faq/55faq.cgi" target="_top">http://www.pgp.com/service/export/faq/55faq.cgi</a>
</p><p>
Be sure to use the version that is applicable to your country. Due
to export restrictions by the US Government, strong-encryption is
prohibited from being transferred in electronic form outside the
country.
</p><p>
US export controls are now managed by EAR (Export Administration
Regulations).  They are no longer governed by ITAR.
</p><p>
There is also a step-by-step guide for configuring PGP on Linux
available at <a class="ulink" href="http://mercury.chem.pitt.edu/~angel/LinuxFocus/English/November1997/article7.html" target="_top">http://mercury.chem.pitt.edu/~angel/LinuxFocus/English/November1997/article7.html</a>.
It was written for the international version of PGP, but is easily
adaptable to the United States version.  You may also need a patch for
some of the latest versions of Linux; the patch is available at <a class="ulink" href="ftp://metalab.unc.edu/pub/Linux/apps/crypto" target="_top">ftp://metalab.unc.edu/pub/Linux/apps/crypto</a>.
</p><p>
There is a project maintaining a free re-implementation of pgp with
open source. GnuPG is a complete and free replacement for PGP. Because
it does not use IDEA or RSA it can be used without any
restrictions. GnuPG is in compliance with <a class="ulink" href="http://www.faqs.org/rfcs/rfc2440.html" target="_top">OpenPGP</a>. 
See the GNU Privacy Guard web page for more information:
<a class="ulink" href="http://www.gnupg.org" target="_top">http://www.gnupg.org/</a>.
</p><p>
More information on cryptography can be found in the RSA cryptography
FAQ, available at <a class="ulink" href="http://www.rsa.com/rsalabs/newfaq/" target="_top">http://www.rsa.com/rsalabs/newfaq/</a>.  Here you will find
information on such terms as "Diffie-Hellman", "public-key
cryptography", "digital certificates", etc.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm571"></a>6.2. SSL, S-HTTP and S/MIME</h3></div></div></div><p>
Often users ask about the differences between the various
security and encryption protocols, and how to use them.  While this
isn't an encryption document, it is a good idea to explain briefly
what each  protocol is, and where to find more information.

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<span class="emphasis"><em>SSL:</em></span> - SSL, or Secure Sockets Layer, is an encryption
method developed by Netscape to provide security over the Internet.
It supports several different encryption protocols, and provides
client and server authentication.  SSL operates at the transport
layer, creates a secure encrypted channel of data, and thus can
seamlessly encrypt data of many types.  This is most commonly seen
when going to a secure site to view a secure online document with
Communicator, and serves as the basis for secure communications with
Communicator, as well as many other Netscape Communications data
encryption.  More information can be found at <a class="ulink" href="http://www.consensus.com/security/ssl-talk-faq.html" target="_top">http://www.consensus.com/security/ssl-talk-faq.html</a>.
Information on Netscape's other security implementations, and a good
starting point for these protocols is available at <a class="ulink" href="http://home.netscape.com/info/security-doc.html" target="_top">http://home.netscape.com/info/security-doc.html</a>. It's also
worth noting that the SSL protocol can be used to pass many other
common protocols, "wrapping" them for security. See 
<a class="ulink" href="http://www.quiltaholic.com/rickk/sslwrap/" target="_top">http://www.quiltaholic.com/rickk/sslwrap/</a>
</p></li><li class="listitem"><p>
<span class="emphasis"><em>S-HTTP:</em></span> - S-HTTP is another protocol that provides
security services across the Internet.  It was designed to provide
confidentiality, authentication, integrity, and non-repudiability [cannot be mistaken for someone else] while supporting multiple
key-management mechanisms and cryptographic algorithms via option 
negotiation between the parties involved in each transaction. S-HTTP
is limited to the specific software that is implementing it, and
encrypts each message individually. [ From RSA Cryptography FAQ,
page 138]
</p></li><li class="listitem"><p>
<span class="emphasis"><em>S/MIME:</em></span> - S/MIME, or Secure Multipurpose Internet Mail
Extension, is an encryption standard used to encrypt electronic mail
and other types of messages on the Internet.  It is an open standard
developed by RSA, so it is likely we will see it on Linux one day
soon.  More information on S/MIME can be found at <a class="ulink" href="http://home.netscape.com/assist/security/smime/overview.html" target="_top">http://home.netscape.com/assist/security/smime/overview.html</a>.
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm588"></a>6.3. Linux IPSEC Implementations</h3></div></div></div><p>
Along with CIPE, and other forms of data encryption, there are also 
several other implementations of IPSEC for Linux.  IPSEC is an effort
by the IETF to create cryptographically-secure communications at the
IP network level, and to provide authentication, integrity, access control,
and confidentiality.  Information on IPSEC and Internet draft can be
found at <a class="ulink" href="http://www.ietf.org/html.charters/ipsec-charter.html" target="_top">http://www.ietf.org/html.charters/ipsec-charter.html</a>. You can
also find links to other protocols involving key management, and an
IPSEC mailing list and archives.
</p><p>
The x-kernel Linux implementation, which is being developed at the University
of Arizona, uses an object-based framework for implementing network
protocols called x-kernel, and can be found at <a class="ulink" href="http://www.cs.arizona.edu/xkernel/hpcc-blue/linux.html" target="_top">http://www.cs.arizona.edu/xkernel/hpcc-blue/linux.html</a>.  Most
simply, the x-kernel is a method of passing messages at the kernel
level, which makes for an easier implementation.
</p><p>
Another freely-available IPSEC implementation is the Linux FreeS/WAN
IPSEC.  Their web page states,
<span class="quote">&#8220;<span class="quote">"These services allow you to build 
secure tunnels through untrusted networks. Everything passing through 
the untrusted net is encrypted by the IPSEC gateway machine and
decrypted by the gateway at the other end. The result is Virtual 
Private Network or VPN. This is a network which is effectively private
even though it includes machines at several different sites connected
by the insecure Internet."</span>&#8221;</span>
</p><p>
It's available for download from <a class="ulink" href="http://www.xs4all.nl/~freeswan/" target="_top">http://www.xs4all.nl/~freeswan/</a>, and has just reached 1.0 at the
time of this writing.
</p><p>
As with other forms of cryptography, it is not distributed with the
kernel by default due to export restrictions.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="ssh"></a>6.4. <code class="literal">ssh</code> (Secure Shell) and <code class="literal">stelnet</code></h3></div></div></div><p>
<code class="literal">ssh</code> and <code class="literal">stelnet</code> are suites of programs that
allow you to login to remote systems and have a encrypted connection.
</p><p>
<code class="literal">openssh</code> is a suite of programs used as a secure replacement 
for <code class="literal">rlogin</code>, <code class="literal">rsh</code> and <code class="literal">rcp</code>.  It uses public-key
cryptography to encrypt communications between two hosts, as well as to 
authenticate users.  It can be used to securely login to a remote host
or copy data between hosts, while preventing man-in-the-middle attacks
(session hijacking) and DNS spoofing.  It will perform data compression
on your connections, and secure X11 communications between hosts. 
</p><p>
There are several ssh implementiations now. The original commercial
implementation by Data Fellows can be found at 
The <code class="literal">ssh</code> home page can be found at <a class="ulink" href="http://www.datafellows.com" target="_top">http://www.datafellows.com</a>. 
</p><p>
The excellent Openssh implementation is based on a early version of
the datafellows ssh and has been totally reworked to not include any
patented or proprietary pieces. It is free and under a BSD
license. It can be found at: <a class="ulink" href="http://www.openssh.com" target="_top">http://www.openssh.com</a>. 
</p><p>
There is also a open source
project to re-implement ssh from the ground up called "psst...". For
more information see: <a class="ulink" href="http://www.net.lut.ac.uk/psst/" target="_top">http://www.net.lut.ac.uk/psst/</a> 
</p><p>
You can also use <code class="literal">ssh</code> from your Windows workstation to your 
Linux <code class="literal">ssh</code>
server.  There are several freely available Windows client
implementations, including the one at <a class="ulink" href="http://guardian.htu.tuwien.ac.at/therapy/ssh/" target="_top">http://guardian.htu.tuwien.ac.at/therapy/ssh/</a> as well as a
commercial implementation from DataFellows, at <a class="ulink" href="http://www.datafellows.com" target="_top">http://www.datafellows.com</a>. 
</p><p>
SSLeay is a free implementation of Netscape's Secure Sockets Layer
protocol, developed by Eric Young.  It includes several applications,
such as Secure telnet, a module for Apache, several databases, as well
as several algorithms including DES, IDEA and Blowfish.
</p><p>
Using this library, a secure telnet replacement has been created that
does encryption over a telnet connection.  Unlike SSH, stelnet uses
SSL, the Secure Sockets Layer protocol developed by Netscape.  You can
find Secure telnet and Secure FTP by starting with the SSLeay FAQ,
available at <a class="ulink" href="http://www.psy.uq.oz.au/~ftp/Crypto/" target="_top">http://www.psy.uq.oz.au/~ftp/Crypto/</a>.
</p><p>
SRP is another secure telnet/ftp implementation. From their web page:
</p><p>
<span class="quote">&#8220;<span class="quote">"The SRP project is developing secure Internet software for free
worldwide use. Starting with a fully-secure Telnet and FTP
distribution, we hope to supplant weak networked authentication
systems with strong replacements that do not sacrifice
user-friendliness for security. Security should be the default, not an
option!" </span>&#8221;</span>
</p><p>
For more information, go to <a class="ulink" href="http://www-cs-students.stanford.edu/~tjw/srp/" target="_top">http://www-cs-students.stanford.edu/~tjw/srp/</a>
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm631"></a>6.5. PAM - Pluggable Authentication Modules</h3></div></div></div><p>
Newer versions of the Red Hat Linux and Debian Linux distributions ship with a unified
authentication scheme called "PAM". PAM allows you to change
your authentication methods and requirements on the
fly, and encapsulate all
local authentication methods without recompiling any of your
binaries.  Configuration of PAM is beyond the scope of this document,
but be sure to take a look at the PAM web site for more
information. <a class="ulink" href="http://www.kernel.org/pub/linux/libs/pam/index.html" target="_top">http://www.kernel.org/pub/linux/libs/pam/index.html</a>.
</p><p>
Just a few of the things you can do with PAM:
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
Use encryption other than DES for your passwords. (Making them harder to
brute-force decode)
</p></li><li class="listitem"><p>
Set resource limits on all your users so they can't perform
denial-of-service attacks (number of processes, amount of memory, etc) 
</p></li><li class="listitem"><p>
Enable shadow passwords (see below) on the fly
</p></li><li class="listitem"><p>
allow specific users to login only at specific times from specific
places
</p></li></ul></div><p>

</p><p>
Within a few hours of installing and configuring your system, you can
prevent many attacks before they even occur.  For example, use PAM to
disable the system-wide usage of <code class="literal">.rhosts</code> files in user's home
directories by adding these lines to <code class="literal">/etc/pam.d/rlogin</code>:

</p><pre class="screen">
		#
		# Disable rsh/rlogin/rexec for users
		#
		login auth required pam_rhosts_auth.so no_rhosts
</pre><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm650"></a>6.6. Cryptographic IP Encapsulation (CIPE)</h3></div></div></div><p>
The primary goal of this software is to provide a facility for secure
(against eavesdropping, including traffic analysis, and faked message
injection) subnetwork interconnection across an insecure packet
network such as the Internet.
</p><p>
CIPE encrypts the data at the network level.  Packets traveling
between hosts on the network are encrypted.  The encryption engine is
placed near the driver which sends and receives packets.
</p><p>
This is unlike SSH, which encrypts the data by connection, at the
socket level.  A logical connection between programs running on
different hosts is encrypted.
</p><p>
CIPE can be used in tunnelling, in order to create a Virtual Private
Network.  Low-level encryption has the advantage that it can be made
to work transparently between the two networks connected in the VPN,
without any change to application software.
</p><p>
Summarized from the CIPE documentation:
</p><p>
<span class="quote">&#8220;<span class="quote">The IPSEC standards define a set of protocols which can be used (among 
other things) to build encrypted VPNs.  However, IPSEC is a rather
heavyweight and complicated protocol set with a lot of options,
implementations of the full protocol set are still rarely used and
some issues (such as key management) are still not fully resolved.
CIPE uses a simpler approach, in which many things which can be
parameterized (such as the choice of the actual encryption algorithm
used) are an install-time fixed choice.  This limits flexibility, but
allows for a simple (and therefore efficient, easy to debug...)
implementation.</span>&#8221;</span>
</p><p>
Further information can be found at
<a class="ulink" href="http://www.inka.de/~bigred/devel/cipe.html" target="_top">http://www.inka.de/~bigred/devel/cipe.html</a>
</p><p>
As with other forms of cryptography, it is not distributed with the
kernel by default due to export restrictions.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm662"></a>6.7. Kerberos</h3></div></div></div><p>
Kerberos is an authentication system developed by the Athena Project
at MIT. When a user logs in, Kerberos authenticates that user (using a 
password), and provides the user with a way to prove her identity to
other servers and hosts scattered around the network.
</p><p>
This authentication is then used by programs such as <code class="literal">rlogin</code> to allow
the user to login to other hosts without a password (in place of the
<code class="literal">.rhosts</code> file).  This authentication method can also used by the mail
system in order to guarantee that mail is delivered to the correct
person, as well as to guarantee that the sender is who he claims to
be.
</p><p>
Kerberos and the other
programs that come with it, prevent users from "spoofing" the system
into believing they are someone else. 
Unfortunately, installing Kerberos is very intrusive, requiring the
modification or replacement of numerous standard programs.
</p><p>
You can find more information about kerberos by looking at <a class="ulink" href="http://www.cis.ohio-state.edu/hypertext/faq/usenet/kerberos-faq/general/faq.html" target="_top">the kerberos FAQ</a>, and the code can be found at <a class="ulink" href="http://nii.isi.edu/info/kerberos/" target="_top">http://nii.isi.edu/info/kerberos/</a>.
</p><p>
[From: Stein, Jennifer G., Clifford Neuman, and Jeffrey L. Schiller.
"Kerberos: An Authentication Service for Open Network Systems." USENIX 
Conference Proceedings, Dallas, Texas, Winter 1998.]
</p><p>
Kerberos should not be your first step in improving security of your
host.  It is quite involved, and not as widely used as, say, SSH.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm674"></a>6.8. Shadow Passwords.</h3></div></div></div><p>
Shadow passwords are a means of keeping your encrypted password
information secret from normal users. Recent versions of both Red Hat
and Debian Linux use shadow passwords by default, but on other
systems, encrypted passwords 
are stored in <code class="literal">/etc/passwd</code> file for all to read. Anyone can then run
password-guesser programs on them and attempt to determine what they are.
Shadow passwords, by contrast, are saved in <code class="literal">/etc/shadow</code>, which
only privileged users can read. In order to use shadow passwords, you
need to make sure all your utilities that need access to password
information are recompiled to support them. PAM (above) also allows you
to just plug in a shadow module; it doesn't require re-compilation of
executables.  You can refer to the Shadow-Password HOWTO for further
information if necessary.  It is available at <a class="ulink" href="http://metalab.unc.edu/LDP/HOWTO/Shadow-Password-HOWTO.html" target="_top">http://metalab.unc.edu/LDP/HOWTO/Shadow-Password-HOWTO.html</a>
It is rather dated now, and will not be required for distributions
supporting PAM.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="crack"></a>6.9. "Crack" and "John the Ripper"</h3></div></div></div><p>
If for some reason your <code class="literal">passwd</code> program is not enforcing hard-to-guess
passwords, you might want to run a password-cracking program
and make sure your users' passwords are secure. 
</p><p>
Password cracking programs work on a simple idea: they try every word
in the dictionary, and then variations on those words, encrypting
each one and checking it against your encrypted password. If they get a
match they know what your password is. 
</p><p>
There are a number of programs out there...the two most notable of
which are "Crack" and "John the Ripper"
(<a class="ulink" href="http://www.openwall.com/john/" target="_top">http://www.openwall.com/john/</a>) . They will take
up a lot of your CPU time, but you should be able to tell if an
attacker could get in using them by running them first yourself and
notifying users with weak passwords. Note that an attacker would have
to use some other hole first in order to read your 
<code class="literal">/etc/passwd</code> file, but such holes are more common than you might think.
</p><p>
Because security is only as strong as the most insecure host, it is worth
mentioning that if you have any Windows machines on your network, you should
check out L0phtCrack, a Crack implementation for Windows.  It's available
from <a class="ulink" href="http://www.l0pht.com" target="_top">http://www.l0pht.com</a>
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm690"></a>6.10. CFS - Cryptographic File System and TCFS - Transparent Cryptographic File System</h3></div></div></div><p>
CFS is a way of encrypting entire directory trees and allowing users
to store encrypted files on them. It uses an NFS server running on the
local machine. RPMS are available at <a class="ulink" href="http://www.zedz.net/redhat/" target="_top">http://www.zedz.net/redhat/</a>, and more information on how it
all works is at <a class="ulink" href="ftp://ftp.research.att.com/dist/mab/" target="_top">ftp://ftp.research.att.com/dist/mab/</a>.
</p><p>
TCFS improves on CFS by adding more integration with the file system, so
that it's transparent to users that the file system that is
encrypted. More information at: <a class="ulink" href="http://www.tcfs.it/" target="_top">http://www.tcfs.it/</a>.
</p><p>
It also need not be used on entire file systems. It works on
directory trees as well.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm698"></a>6.11. X11, SVGA and display security</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm700"></a>6.11.1. X11</h4></div></div></div><p>
It's important for you to secure your graphical display to prevent
attackers from grabbing your passwords as you type
them, reading documents or information you are
reading on your screen, or even using a hole to gain root
access. Running remote X applications over a network also can be
fraught with peril, allowing sniffers to see all your interaction with 
the remote system. 
</p><p>
X has a number of access-control mechanisms. The simplest of them is
host-based: you use <code class="literal">xhost</code> to specify the hosts that are allowed access
to your display. This is not very secure at all, because if someone has access
to your machine, they can <code class="literal">xhost + their machine</code> and get in
easily. Also, if you have to allow access from an untrusted machine,
anyone there can compromise your display. 
</p><p>
When using <code class="literal">xdm</code> (X Display Manager) to log in, you get a much better
access method: MIT-MAGIC-COOKIE-1. A 128-bit "cookie" is generated and
stored in your <code class="literal">.Xauthority</code> file. If you need to allow a remote machine
access to your display, you can use the <code class="literal">xauth</code> command and the
information in your <code class="literal">.Xauthority</code> file to provide access to only that connection.
See the Remote-X-Apps mini-howto, available at <a class="ulink" href="http://metalab.unc.edu/LDP/HOWTO/mini/Remote-X-Apps.html" target="_top">http://metalab.unc.edu/LDP/HOWTO/mini/Remote-X-Apps.html</a>.
</p><p>
You can also use <code class="literal">ssh</code> (see <a class="xref" href="#ssh" title="6.4. ssh (Secure Shell) and stelnet">Section 6.4, &#8220;<code class="literal">ssh</code> (Secure Shell) and <code class="literal">stelnet</code>&#8221;</a>, above) to allow secure X
connections. This has the advantage of also being transparent to the
end user, and means that no unencrypted data flows across the
network. 
</p><p>
You can also disable any remote connections to your X server by using
the '-nolisten tcp' options to your X server. This will prevent any
network connections to your server over tcp sockets. 
</p><p>
Take a look at the <code class="literal">Xsecurity</code> man page for more information on X
security. The safe bet is to use <code class="literal">xdm</code> to login to your console and then
use <code class="literal">ssh</code> to go to remote sites on which you wish to run X programs. 
</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm720"></a>6.11.2. SVGA </h4></div></div></div><p>
SVGAlib programs are typically SUID-root in order to access all your
Linux machine's video hardware. This makes them very dangerous. If they
crash, you typically need to reboot your machine to get a usable
console back. Make sure any SVGA programs you are running are
authentic, and can at least be somewhat trusted. Even better, don't
run them at all. 
</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm723"></a>6.11.3. GGI (Generic Graphics Interface project)</h4></div></div></div><p>
The Linux GGI project is trying to solve several of the problems with
video interfaces on Linux. GGI will move a small piece of the video
code into the Linux kernel, and then control access to the video
system. This means GGI will be able to restore your console at any
time to a known good state. They will also allow a secure attention
key, so you can be sure that there is no Trojan horse <code class="literal">login</code> program
running on your console. <a class="ulink" href="http://synergy.caltech.edu/~ggi/" target="_top">http://synergy.caltech.edu/~ggi/</a> 
</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kernel-security"></a>7. Kernel Security</h2></div></div></div><p>
This is a description of the kernel configuration options that relate
to security, and an explanation of what they do, and how to use them.
</p><p>
As the kernel controls your computer's networking, it is important
that it be very secure, and not be
compromised. To prevent some of the latest networking attacks, you 
should try to keep your kernel version current. You can find new
kernels at <a class="ulink" href="ftp://ftp.kernel.org" target="_top">&#65533;</a> or from your distribution
vendor.
</p><p>
There is also a international group providing a single unified crypto
patch to the mainstream Linux kernel. This patch provides support for
a number of cryptographic subsystems and things that cannot be
included in the mainstream kernel due to export restrictions. For more 
information, visit their web page at: <a class="ulink" href="http://www.kerneli.org" target="_top">http://www.kerneli.org</a>
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm735"></a>7.1. 2.0 Kernel Compile Options</h3></div></div></div><p>
For 2.0.x kernels, the following options apply. You should see these
options during the kernel configuration process.  Many of the comments
here are from <code class="literal">./linux/Documentation/Configure.help</code>, which is
the same document that is referenced while using the Help facility during 
the <code class="literal">make config</code> stage of compiling the kernel. 
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
Network Firewalls
(CONFIG_FIREWALL)
</p><p>
This option should be on if you intend to run any firewalling or
masquerading on your Linux machine. If it's just going to be a regular 
client machine, it's safe to say no.
</p></li><li class="listitem"><p>
IP: forwarding/gatewaying
(CONFIG_IP_FORWARD)
</p><p>
If you enable IP forwarding, your Linux box essentially becomes a
router.  If your machine is on a network, you could be forwarding data
from one network to another, and perhaps subverting a firewall that
was put there to prevent this from happening.  Normal dial-up users
will want to disable this, and other users should concentrate on the
security implications of doing this.  Firewall machines will want this
enabled, and used in conjunction with firewall software.
</p><p>
You can enable IP forwarding dynamically using the following command:
</p><p>

</p><pre class="screen">
	root#  echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</pre><p>

and disable it with the command:

</p><pre class="screen">
	root#  echo 0 &gt; /proc/sys/net/ipv4/ip_forward
</pre><p>

Keep in mind the files in /proc are "virtual" files and the shown size
of the file might not reflect the data output from it. 
</p></li><li class="listitem"><p>
IP: syn cookies
(CONFIG_SYN_COOKIES)
</p><p>
a "SYN Attack" is a denial of service (DoS) attack that consumes all the
resources on your machine, forcing you to reboot.  We can't think of a
reason you wouldn't normally enable this. In the 2.2.x kernel series
this config option merely allows syn cookies, but does not enable
them. To enable them, you have to do:
</p><p>

</p><pre class="screen">
		root# echo 1 &gt; /proc/sys/net/ipv4/tcp_syncookies &lt;P&gt;
</pre><p>

</p></li><li class="listitem"><p>
IP: Firewalling
(CONFIG_IP_FIREWALL)
</p><p>
This option is necessary if you are going to configure your machine as
a firewall, do masquerading, or wish to protect your dial-up
workstation from someone entering via your PPP dial-up interface.
</p></li><li class="listitem"><p>
IP: firewall packet logging
(CONFIG_IP_FIREWALL_VERBOSE)
</p><p>
This option gives you information about packets your firewall
received, like sender, recipient, port, etc.
</p></li><li class="listitem"><p>
IP: Drop source routed frames
(CONFIG_IP_NOSR)
</p><p>
This option should be enabled.  Source routed frames contain the
entire path to their destination inside of the packet.  This means
that routers through which the packet goes do not need to inspect it,
and just forward it on. This could lead to data entering your system
that may be a potential exploit.
</p></li><li class="listitem"><p>
IP: masquerading
(CONFIG_IP_MASQUERADE)
If one of the computers on your local network for which your Linux
box acts as a firewall wants to send something to the outside, your
box can "masquerade" as that host, i.e., it forewords the traffic
to the intended destination, but makes it look like it came from the
firewall box itself.  See <a class="ulink" href="http://www.indyramp.com/masq" target="_top">http://www.indyramp.com/masq</a> for more information.
</p></li><li class="listitem"><p>
IP: ICMP masquerading
(CONFIG_IP_MASQUERADE_ICMP)
This option adds ICMP masquerading to the previous option of only 
masquerading TCP or UDP traffic.
</p></li><li class="listitem"><p>
IP: transparent proxy support
(CONFIG_IP_TRANSPARENT_PROXY)
This enables your Linux firewall to transparently redirect any
network traffic originating from the local network and
destined for a remote host to a local server, called a "transparent
proxy server".  This makes the local computers think they are talking
to the remote end, while in fact they are connected to the local proxy.
See the IP-Masquerading HOWTO and <a class="ulink" href="http://www.indyramp.com/masq" target="_top">http://www.indyramp.com/masq</a> for more information.
</p></li><li class="listitem"><p>
IP: always defragment
(CONFIG_IP_ALWAYS_DEFRAG)
</p><p>
Generally this option is disabled, but if you are building a firewall
or a masquerading host, you will want to enable it.  When data is sent
from one host to another, it does not always get sent as a single
packet of data, but rather it is fragmented into several pieces.  The
problem with this is that the port numbers are only stored in the
first fragment.  This means that someone can insert information into
the remaining packets that isn't supposed to be there.
It could also prevent a teardrop attack against an internal
host that is not yet itself patched against it.
</p></li><li class="listitem"><p>
Packet Signatures
(CONFIG_NCPFS_PACKET_SIGNING)
</p><p>
This is an option that is available in the 2.2.x kernel series that will
sign NCP packets for stronger security.  Normally you can leave it
off, but it is there if you do need it.
</p></li><li class="listitem"><p>
IP: Firewall packet netlink device
(CONFIG_IP_FIREWALL_NETLINK)
</p><p>
This is a really neat option that allows you to analyze the first 128
bytes of the packets in a user-space program, to determine if you would
like to accept or deny the packet, based on its validity.
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm783"></a>7.2. 2.2 Kernel Compile Options</h3></div></div></div><p>
For 2.2.x kernels, many of the options are the same, but a few new
ones have been developed.  Many of the comments here are from
<code class="literal">./linux/Documentation/Configure.help</code>, which is the same
document that is referenced while using the Help facility during 
the <code class="literal">make config</code> stage of compiling the kernel. Only the newly-
added options are listed below.  Consult the 2.0 description for a
list of other necessary options.  The most significant change in the
2.2 kernel series is the IP firewalling code.  The <code class="literal">ipchains</code>
program is now used to install IP firewalling, instead of the
<code class="literal">ipfwadm</code> program used in the 2.0 kernel.
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
Socket Filtering
(CONFIG_FILTER)
</p><p>
For most people, it's safe to say no to this option. This option
allows you to connect a user-space filter to any socket and determine
if packets should be allowed or denied. Unless you have a very
specific need and are capable of programming such a filter, you should 
say no. Also note that as of this writing, all protocols were
supported except TCP. 
</p></li><li class="listitem"><p>
Port Forwarding
</p><p>
Port Forwarding is an addition to IP Masquerading which allows some
forwarding of packets from outside to inside a firewall on given
ports. This could be useful if, for example, you want to run a web
server behind the firewall or masquerading host and that web server
should be accessible from the outside world. An external client
sends a request to port 80 of the firewall, the firewall forwards
this request to the web server, the web server handles the request
and the results are sent through the firewall to the original
client. The client thinks that the firewall machine itself is
running the web server. This can also be used for load balancing if
you have a farm of identical web servers behind the firewall.
</p><p>
Information about this feature is available from
http://www.monmouth.demon.co.uk/ipsubs/portforwarding.html (to
browse the WWW, you need to have access to a machine on the Internet
that has a program like lynx or Netscape). For general info, please
see ftp://ftp.compsoc.net/users/steve/ipportfw/linux21/
</p></li><li class="listitem"><p>
Socket Filtering
(CONFIG_FILTER)
</p><p>
Using this option, user-space programs can attach a filter to any
socket and thereby tell the kernel that it should allow or disallow
certain types of data to get through the socket.  Linux socket
filtering works on all socket types except TCP for now.  See the
text file <code class="literal">./linux/Documentation/networking/filter.txt</code> for
more information.
</p></li><li class="listitem"><p>
IP: Masquerading
</p><p>
The 2.2 kernel masquerading has been improved.  It provides additional
support for masquerading special protocols, etc. Be sure to read
the IP Chains HOWTO for more information.
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm806"></a>7.3. Kernel Devices</h3></div></div></div><p>
There are a few block and character devices available on Linux that
will also help you with security.
</p><p>
The two devices <code class="literal">/dev/random</code> and <code class="literal">/dev/urandom</code> are provided by the
kernel to provide random data at any time.
</p><p>
Both <code class="literal">/dev/random</code> and <code class="literal">/dev/urandom</code> should be secure enough to use in
generating PGP keys, <code class="literal">ssh</code> challenges, and other applications where
secure random numbers are required.  Attackers should be unable to
predict the next number given any initial sequence of numbers from these
sources.  There has been a lot of effort put in to ensuring that the
numbers you get from these sources are random in every sense of the word.
</p><p>
The only difference between the two devices, is that <code class="literal">/dev/random</code> runs out of random bytes
and it makes you wait for more to be accumulated.  Note that on some
systems, it can block for a long time waiting for new user-generated
entropy to be entered into the system.  So you have to use care before
using <code class="literal">/dev/random</code>.  (Perhaps the best thing to do is to use it when
you're generating sensitive keying information, and you tell the user to
pound on the keyboard repeatedly until you print out "OK, enough".)
</p><p>
<code class="literal">/dev/random</code> is high quality entropy, generated from measuring the
inter-interrupt times etc. It blocks until enough bits of random data
are available.
</p><p>
<code class="literal">/dev/urandom</code> is similar, but when the store of entropy is running low,
it'll return a cryptographically strong hash of what there is. This
isn't as secure, but it's enough for most applications.
</p><p>
You might read from the devices using something like:
</p><p>

</p><pre class="screen">
	root#  head -c 6 /dev/urandom | mimencode
</pre><p>

This will print six random characters on the console, suitable for
password generation.  You can find <code class="literal">mimencode</code> in the <code class="literal">metamail</code>
package.
</p><p>
See <code class="literal">/usr/src/linux/drivers/char/random.c</code> for a description of the
algorithm.
</p><p>
Thanks to Theodore Y. Ts'o, Jon Lewis, and others from Linux-kernel
for helping me (Dave) with this.
</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="network-security"></a>8. Network Security</h2></div></div></div><p>
Network security is becoming more and more important as people spend
more and more time connected. Compromising network security is often
much easier than compromising physical or local security, and is much more common. 
</p><p>
There are a number of good tools to assist with network security, and
more and more of them are shipping with Linux distributions. 
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm835"></a>8.1. Packet Sniffers</h3></div></div></div><p>
One of the most common ways intruders gain access to more systems on
your network is by employing a packet sniffer on a already compromised 
host. This "sniffer" just listens on the Ethernet port for things like 
<code class="literal">passwd</code> and <code class="literal">login</code> and <code class="literal">su</code> in the packet stream 
and then logs the traffic after that. This way, attackers gain passwords
for systems they are not even attempting to break into. Clear-text
passwords are very vulnerable to this attack. 
</p><p>
Example: Host A has been compromised. Attacker installs a
sniffer. Sniffer picks up admin logging into Host B from Host C. It
gets the admins personal password as they login to B. Then, the admin
does a <code class="literal">su</code> to fix a problem. They now have the root password for Host 
B. Later the admin lets someone <code class="literal">telnet</code> from his account to Host Z on
another site. Now the attacker has a password/login on Host Z. 
</p><p>
In this day and age, the attacker doesn't even need to compromise a
system to do this: they could also bring a laptop or pc into a
building and tap into your net. 
</p><p>
Using <code class="literal">ssh</code> or other encrypted password methods thwarts this
attack. Things like APOP for POP accounts also prevents this
attack. (Normal POP logins are very vulnerable to this, as is anything
that sends clear-text passwords over the network.)
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm847"></a>8.2. System services and tcp_wrappers</h3></div></div></div><p>
Before you put your Linux system on <span class="emphasis"><em>ANY</em></span> network the first thing to
look at is what services you need to offer. Services that you do not
need to offer should be disabled so that you have one less thing to
worry about and attackers have one less place to look for a hole. 
</p><p>
There are a number of ways to disable services under Linux. You can
look at your <code class="literal">/etc/inetd.conf</code> file and see what services are being
offered by your <code class="literal">inetd</code>. Disable any that you do not need by commenting
them out (<code class="literal">#</code> at the beginning of the line), and then sending
your inetd process a SIGHUP. 
</p><p>
You can also remove (or comment out) services in your <code class="literal">/etc/services</code>
file. This will mean that local clients will also be unable to find
the service (i.e., if you remove <code class="literal">ftp</code>, and try and ftp to a remote site
from that machine it will fail with an "unknown service" message). It's
usually not worth the trouble to remove services from <code class="literal">/etc/services</code>, since it provides no
additional security. If a local person wanted to use <code class="literal">ftp</code> even though
you had commented it out, they would make their own client that used
the common FTP port and would still work fine.  
</p><p>
Some of the services you might want to leave enabled are:
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<code class="literal">ftp</code>
</p></li><li class="listitem"><p>
<code class="literal">telnet</code> (or <code class="literal">ssh</code>)
</p></li><li class="listitem"><p>
mail, such as <code class="literal">pop-3</code> or <code class="literal">imap</code>
</p></li><li class="listitem"><p>
<code class="literal">identd</code>
</p></li></ul></div><p>

</p><p>
If you know you are not going to use some particular package, you can
also delete it entirely. <code class="literal">rpm -e packagename</code> under
the Red Hat distribution will erase an entire package. Under Debian
<code class="literal">dpkg --remove</code> does the same thing. 
</p><p>
Additionally, you really want to disable the rsh/rlogin/rcp utilities,
including login (used by <code class="literal">rlogin</code>), shell (used by <code class="literal">rcp</code>),
and exec (used
by <code class="literal">rsh</code>) from being started in <code class="literal">/etc/inetd.conf</code>.
These protocols are extremely insecure and have been the cause of exploits
in the past.
</p><p>
You should check <code class="literal">/etc/rc.d/rc[0-9].d</code> (on Red Hat;
<code class="literal">/etc/rc[0-9].d</code> on Debian), and see if any of the servers started in those
directories are not needed. The files in those directories are
actually symbolic links to files in the directory
<code class="literal">/etc/rc.d/init.d</code> (on Red Hat; <code class="literal">/etc/init.d</code> on Debian).
Renaming the files in the <code class="literal">init.d</code> directory 
disables all the symbolic links that point to that file.  If you
only wish to disable a service for a particular run level, rename the
appropriate symbolic link by replacing  the upper-case <code class="literal">S</code> with a lower-case
<code class="literal">s</code>, like this:
</p><p>

</p><pre class="screen">
       root#  cd /etc/rc6.d
       root#  mv S45dhcpd s45dhcpd
</pre><p>

</p><p>
If you have BSD-style <code class="literal">rc</code> files, you will want to check
<code class="literal">/etc/rc*</code> for programs you don't need.
</p><p>
Most Linux distributions ship with tcp_wrappers "wrapping" all your
TCP services. A tcp_wrapper (<code class="literal">tcpd</code>) is invoked from <code class="literal">inetd</code> instead of
the real server. <code class="literal">tcpd</code> then checks the host that is requesting the
service, and either executes the real server, or denies access from that
host. <code class="literal">tcpd</code> allows you to restrict access to your TCP services. You
should make a <code class="literal">/etc/hosts.allow</code> and add in only those hosts that need
to have access to your machine's services. 
</p><p>
If you are a home dial up user, we suggest you deny ALL. <code class="literal">tcpd</code> also logs
failed attempts to access services, so this can alert you if
you are under attack. If you add new services, you should be sure to
configure them to use tcp_wrappers if they are TCP-based.  For example, a normal
dial-up user can prevent outsiders from connecting to his machine,
yet still have the ability to retrieve mail, and make network
connections to the Internet.  To do this, you might add the following
to your <code class="literal">/etc/hosts.allow</code>:
</p><p>
ALL: 127.
</p><p>
And of course /etc/hosts.deny would contain:
</p><p>
ALL: ALL
</p><p>
which will prevent external connections to your machine, yet still
allow you from the inside to connect to servers on the Internet.
</p><p>
Keep in mind that tcp_wrappers only protects services executed from
<code class="literal">inetd</code>, and a select few others.  There very well may be other
services running on your machine.  You can use <code class="literal">netstat -ta</code> to
find a list of all the services your machine is offering.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm914"></a>8.3. Verify Your DNS Information</h3></div></div></div><p>
Keeping up-to-date DNS information about all hosts on your network can 
help to increase security.  If an unauthorized host
becomes connected to your network, you can recognize it by its lack of 
a DNS entry.  Many services can be configured to not accept
connections from hosts that do not have valid DNS entries.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm917"></a>8.4. identd</h3></div></div></div><p>
<code class="literal">identd</code> is a small program that typically runs out of your
<code class="literal">inetd</code> server. It keeps track of what user is running what TCP
service, and then reports this to whoever requests it. 
</p><p>
Many people misunderstand the usefulness of <code class="literal">identd</code>, and so disable it
or block all off site requests for it. <code class="literal">identd</code> is not there to help out
remote sites. There is no way of knowing if the data you get from the
remote <code class="literal">identd</code> is correct or not. There is no authentication in <code class="literal">identd</code>
requests. 
</p><p>
Why would you want to run it then? Because it helps <span class="emphasis"><em>you</em></span> out, and is
another data-point in tracking. If your <code class="literal">identd</code> is un compromised, then
you know it's telling remote sites the user-name or uid of people using
TCP services. If the admin at a remote site comes back to you and
tells you user so-and-so was trying to hack into their site, you can
easily take action against that user. If you are not running <code class="literal">identd</code>,
you will have to look at lots and lots of logs, figure out who was on
at the time, and in general take a lot more time to track down the
user.
</p><p>
The <code class="literal">identd</code> that ships with most distributions is more configurable
than many people think. You can disable it for specific users
(they can make a <code class="literal">.noident</code> file), you can log all
<code class="literal">identd</code> requests (We recommend it), you can even have identd
return a uid instead of a user name or even NO-USER.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm935"></a>8.5. Configuring and Securing the Postfix MTA</h3></div></div></div><p>
The Postfix mail server was written by Wietse Venema, author of 
Postfix and several other staple Internet security products, as an "attempt to 
provide an alternative to the widely-used Sendmail program. Postfix attempts 
to be fast, easy to administer, and hopefully secure, while at the same time 
being sendmail compatible enough to not upset your users." 
</p><p>
Further information on postfix can be found at the 
<a class="ulink" href="http://www.postfix.org" target="_top">Postfix home</a> and in the 
<a class="ulink" href="http://www.linuxsecurity.com/feature_stories/feature_story-91.html" target="_top">Configuring and Securing Postfix</a>.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm941"></a>8.6. SATAN, ISS, and Other Network Scanners</h3></div></div></div><p>
There are a number of different software packages out there that do
port and service-based scanning of machines or networks. SATAN, ISS,
SAINT, and Nessus are some of the more well-known ones. This software
connects to the target machine (or all the target machines on a
network) on all the ports they can, and try to determine what service
is running there. Based on this information, you can tell if the
machine is vulnerable to a specific exploit on that server. 
</p><p>
SATAN (Security Administrator's Tool for Analyzing Networks) is a port
scanner with a web interface. It can be configured to do light,
medium, or strong checks on a machine or a network of machines. It's a
good idea to get SATAN and scan your machine or network, and fix the
problems it finds. Make sure you get the copy of SATAN from <a class="ulink" href="http://metalab.unc.edu/pub/packages/security/Satan-for-Linux/" target="_top">metalab</a> or a reputable FTP or web site. There was a Trojan
copy of SATAN that was distributed out on the net. <a class="ulink" href="http://www.trouble.org/~zen/satan/satan.html" target="_top">http://www.trouble.org/~zen/satan/satan.html</a>. Note that SATAN
has not been updated in quite a while, and some of the other tools
below might do a better job. 
</p><p>
ISS (Internet Security Scanner) is another port-based scanner. It is
faster than Satan, and thus might be better for large
networks. However, SATAN tends to provide more information. 
</p><p>
Abacus is a suite of tools to provide host-based security and
intrusion detection. Look at it's home page on the web for more
information. <a class="ulink" href="http://www.psionic.com/abacus" target="_top">http://www.psionic.com/abacus/</a> 
</p><p>
SAINT is a updated version of SATAN. It is web-based and has many more 
up-to-date tests than SATAN. You can find out more about it at:
<a class="ulink" href="http://www.wwdsi.com/saint" target="_top">http://www.wwdsi.com/~saint</a>
</p><p>
Nessus is a free security scanner. It has a GTK graphical interface
for ease of use. It is also designed with a very nice plug in setup for 
new port-scanning tests. For more information, take a look at: <a class="ulink" href="http://www.nessus.org/" target="_top">http://www.nessus.org</a>
</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm954"></a>8.6.1. Detecting Port Scans</h4></div></div></div><p>
There are some tools designed to alert you to probes by SATAN and ISS
and other scanning software. However, if you liberally use tcp_wrappers, and
look over your log files regularly, you should be able
to notice such probes. Even on the lowest setting, SATAN still leaves
traces in the logs on a stock Red Hat system. 
</p><p>
There are also "stealth" port scanners.  A packet with the TCP ACK bit 
set (as is done with established connections) will likely get through
a packet-filtering firewall.  The returned RST packet from a port that 
<span class="emphasis"><em>_had no established session_</em></span> can be taken as proof of life on
that port.  I don't think TCP wrappers will detect this.
</p><p>
You might also look at SNORT, which is a free IDS (Intrusion Detection
System), which can detect other network intrusions. <a class="ulink" href="http://www.snort.org" target="_top">http://www.snort.org</a>
</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm961"></a>8.7. sendmail, qmail and MTA's</h3></div></div></div><p>
One of the most important services you can provide is a mail
server. Unfortunately, it is also one of the most vulnerable to attack,
simply due to the number of tasks it must perform and the privileges it
typically needs. 
</p><p>
If you are using <code class="literal">sendmail</code> it is very important to keep up on current
versions. <code class="literal">sendmail</code> has a long long history of security
exploits. Always make sure you are running the most recent version from
<a class="ulink" href="http://www.sendmail.org/" target="_top">http://www.sendmail.org</a>.
</p><p>
Keep in mind that sendmail does not have to be running in order for you
to send mail.  If you are a home user, you can disable sendmail entirely,
and simply use your mail client to send mail.  You might also choose to 
remove the "-bd" flag from the sendmail startup file, thereby disabling
incoming requests for mail.  In other words, you can execute sendmail
from your startup script using the following instead:

</p><pre class="screen">
		# /usr/lib/sendmail -q15m
</pre><p>

This will cause sendmail to flush the mail queue every fifteen minutes
for any messages that could not be successfully delivered on the first
attempt.
</p><p>
Many administrators choose not to use sendmail, and instead choose one
of the other mail transport agents. You might consider switching over 
to <code class="literal">qmail</code>. <code class="literal">qmail</code> was designed with security in mind 
from the ground up. It's fast, stable, and secure. Qmail can be found at
<a class="ulink" href="http://www.qmail.org" target="_top">http://www.qmail.org</a>
</p><p>
In direct competition to qmail is "postfix", written by Wietse Venema,
the author of tcp_wrappers and other security tools.  Formerly called
vmailer, and sponsored by IBM, this is also a mail transport agent
written from the ground up with security in mind.  You can find more
information about postfix at <a class="ulink" href="http:/www.postfix.org" target="_top">http://www.postfix.org</a>
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm976"></a>8.8. Denial of Service Attacks</h3></div></div></div><p>
A "Denial of Service" (DoS) attack is one where the attacker tries to make
some resource too busy to answer legitimate requests, or to deny
legitimate users access to your machine.
</p><p>
Denial of service attacks have increased greatly in recent years. Some
of the more popular and recent ones are listed below. Note that new
ones show up all the time, so this is just a few examples. Read the
Linux security lists and the bugtraq list and archives for more
current information.
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<span class="emphasis"><em>SYN Flooding</em></span> - SYN flooding is a network
denial of service attack. It takes advantage of a "loophole" in the
way TCP connections are created. The newer Linux kernels (2.0.30 and
up) have several configurable options to prevent SYN flood attacks
from denying people access to your machine or services. See <a class="xref" href="#kernel-security" title="7. Kernel Security">Section 7, &#8220;Kernel Security&#8221;</a> for proper kernel
protection options. 
</p></li><li class="listitem"><p>
<span class="emphasis"><em>Pentium "F00F" Bug</em></span> - It was recently discovered that a series of
assembly codes sent to a genuine Intel Pentium processor would reboot
the machine.  This affects every machine with a Pentium processor (not
clones, not Pentium Pro or PII), no matter what operating system it's
running. Linux kernels 2.0.32 and up contain a work around for this
bug, preventing it from locking your machine. Kernel 2.0.33 has an
improved version of the kernel fix, and is suggested over 2.0.32.  If
you are running on a Pentium, you should upgrade now!
</p></li><li class="listitem"><p>
<span class="emphasis"><em>Ping Flooding</em></span> - Ping flooding is a simple brute-force denial
of service attack. The attacker sends a "flood" of ICMP packets to
your machine. If they are doing this from a host with better bandwidth
than yours, your machine will be unable to send anything on the
network. A variation on this attack, called "smurfing", sends ICMP
packets to a host with <span class="emphasis"><em>your</em></span> machine's return IP, allowing them to
flood you less detectably.  You can find more information about the
"smurf" attack at <a class="ulink" href="http://www.quadrunner.com/~chuegen/smurf.txt" target="_top"> http://www.quadrunner.com/~chuegen/smurf.txt</a>
</p><p>
If you are ever under a ping flood attack, use a tool like <code class="literal">tcpdump</code> to
determine where the packets are coming from (or appear to be coming
from), then contact your provider with this information. Ping floods
can most easily be stopped at the router level or by using a firewall.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>Ping o' Death</em></span> - The Ping o' Death attack sends
ICMP ECHO REQUEST packets that are too large to fit in the kernel data
structures intended to store them.  Because sending a
single, large (65,510 bytes) "ping" packet to many systems will cause
them to hang or even crash, this problem was quickly dubbed the "Ping
o' Death."  This one has long been fixed, and is no longer anything to 
worry about.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>Teardrop / New Tear</em></span> - One of the most recent exploits
involves a bug present in the IP fragmentation code on Linux and
Windows platforms.  It is fixed in kernel version 2.0.33, and does not 
require selecting any kernel compile-time options to utilize the fix.
Linux is apparently not vulnerable to the "newtear" exploit.
</p></li></ul></div><p>

You can find code for most exploits, and a more in-depth description of how
they work, at <a class="ulink" href="http://www.rootshell.com" target="_top">http://www.rootshell.com</a> using their search engine.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1003"></a>8.9. NFS (Network File System) Security. </h3></div></div></div><p>
NFS is a very widely-used file sharing protocol. It allows servers
running <code class="literal">nfsd</code> and <code class="literal">mountd</code> to "export" entire file systems
to other machines using NFS filesystem support built in to their kernels
(or some other client support if they are not Linux machines).
<code class="literal">mountd</code> keeps track of mounted file systems in <code class="literal">/etc/mtab</code>,
and can display them with <code class="literal">showmount</code>. 
</p><p>
Many sites use NFS to serve home directories to users, so that 
no matter what machine in the cluster they login to, they will have
all their home files. 
</p><p>
There is some small amount of security allowed in exporting
file systems. You can make your <code class="literal">nfsd</code> map the remote root user (uid=0)
to the <code class="literal">nobody</code> user, denying them total access to the files
exported. However, since individual users have access to their own (or
at least the same uid) files, the remote root user can login or <code class="literal">su</code> to
their account and have total access to their files. This is only a
small hindrance to an attacker that has access to mount your remote
file systems. 
</p><p>
If you must use NFS, make sure you export to only those machines that
you really need to. Never export your entire root
directory; export only directories you need to export.
</p><p>
See the NFS HOWTO for more information on NFS, available at <a class="ulink" href="http://metalab.unc.edu/mdw/HOWTO/NFS-HOWTO.html" target="_top">http://metalab.unc.edu/mdw/HOWTO/NFS-HOWTO.html</a>
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1019"></a>8.10. NIS (Network Information Service) (formerly YP). </h3></div></div></div><p>
Network Information service (formerly YP) is a means of distributing
information to a group of machines. The NIS master holds the
information tables and converts them into NIS map files. These maps
are then served over the network, allowing NIS client machines to get
login, password, home directory and shell information (all the
information in a standard <code class="literal">/etc/passwd</code> file). This allows users to
change their password once and have it take effect on all the machines 
in the NIS domain.
</p><p>
NIS is not at all secure. It was never meant to be. It was meant to be
handy and useful. Anyone that can guess the name of your NIS domain
(anywhere on the net) can get a copy of your passwd file, and use
"crack" and "John the Ripper" against your users' passwords. Also, it is
possible to spoof NIS and do all sorts of nasty tricks. If you must
use NIS, make sure you are aware of the dangers. 
</p><p>
There is a much more secure replacement for NIS, called NIS+. 
Check out the NIS HOWTO for more information: <a class="ulink" href="http://metalab.unc.edu/mdw/HOWTO/NIS-HOWTO.html" target="_top">http://metalab.unc.edu/mdw/HOWTO/NIS-HOWTO.html</a> 
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1026"></a>8.11. Firewalls</h3></div></div></div><p>
Firewalls are a means of controlling what information is allowed into
and out of your local network. Typically the firewall host is
connected to the Internet and your local LAN, and the only access from 
your LAN to the Internet is through the firewall. This way the
firewall can control what passes back and forth from the Internet and
your LAN. 
</p><p>
There are a number of types of firewalls and methods of setting them up. Linux
machines make pretty good firewalls. Firewall code can be
built right into 2.0 and higher kernels. The user-space tools <code class="literal">ipfwadm</code> for 2.0 
kernels and <code class="literal">ipchains</code> for 2.2 kernels, 
allows you to change, on the fly, the types of network traffic you allow.
You can also log particular types of network traffic. 
</p><p>
Firewalls are a very useful and important technique in securing your
network. However, never think that because you have a firewall, you don't
need to secure the machines behind it. This is a fatal mistake. Check
out the very good <code class="literal">Firewall-HOWTO</code> at your latest metalab archive for
more information on firewalls and Linux. <a class="ulink" href="http://metalab.unc.edu/mdw/HOWTO/Firewall-HOWTO.html" target="_top">http://metalab.unc.edu/mdw/HOWTO/Firewall-HOWTO.html</a>
</p><p>
More information can also be found in the IP-Masquerade
mini-howto: <a class="ulink" href="http://metalab.unc.edu/mdw/HOWTO/mini/IP-Masquerade.html" target="_top">http://metalab.unc.edu/mdw/HOWTO/mini/IP-Masquerade.html</a> 
</p><p>
More information on <code class="literal">ipfwadm</code> (the tool that lets you change settings on 
your firewall, can be found at it's home page: <a class="ulink" href="http://www.xos.nl/linux/ipfwadm/" target="_top">http://www.xos.nl/linux/ipfwadm/</a>
</p><p>
If you have no experience with firewalls, and plan to set up one for
more than just a simple security policy, the Firewalls book by O'Reilly
and Associates or other online firewall document is mandatory reading.
Check out <a class="ulink" href="http://www.ora.com" target="_top">http://www.ora.com</a>
for more information.  The National Institute of Standards and Technology
have put together an excellent document on firewalls.  Although dated 1995,
it is still quite good.  You can find it at
<a class="ulink" href="http://csrc.nist.gov/nistpubs/800-10/main.html" target="_top">http://csrc.nist.gov/nistpubs/800-10/main.html</a>.  Also of interest:
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
 The Freefire Project -- a list of freely-available firewall tools,
available at <a class="ulink" href="http://sites.inka.de/sites/lina/freefire-l/index_en.html" target="_top">http://sites.inka.de/sites/lina/freefire-l/index_en.html</a> 
</p></li><li class="listitem"><p>
 SunWorld Firewall Design -- written by the authors of the O'Reilly
book, this provides a rough introduction to the different firewall types.
It's available at <a class="ulink" href="http://www.sunworld.com/swol-01-1996/swol-01-firewall.html" target="_top">http://www.sunworld.com/swol-01-1996/swol-01-firewall.html</a> 
</p></li><li class="listitem"><p>
Mason - the automated firewall builder for Linux. This is a
firewall script that learns as you do the things you need to do on
your network! More info at: <a class="ulink" href="http://www.pobox.com/~wstearns/mason/" target="_top">http://www.pobox.com/~wstearns/mason/</a>
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1054"></a>8.12. IP Chains - Linux Kernel 2.2.x Firewalling</h3></div></div></div><p>
Linux IP Firewalling Chains is an update to the 2.0 Linux firewalling
code for the 2.2 kernel.  It has many more features than
previous implementations, including:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
 More flexible packet manipulations
</p></li><li class="listitem"><p>
 More complex accounting
</p></li><li class="listitem"><p>
 Simple policy changes possible atomically
</p></li><li class="listitem"><p>
 Fragments can be explicitly blocked, denied, etc.
</p></li><li class="listitem"><p>
 Logs suspicious packets.
</p></li><li class="listitem"><p>
 Can handle protocols other than ICMP/TCP/UDP. 
</p></li></ul></div><p>
If you are currently using <code class="literal">ipfwadm</code> on your 2.0 kernel, there are scripts
available to convert the <code class="literal">ipfwadm</code> command format to the format <code class="literal">ipchains</code> uses.
</p><p>
Be sure to read the IP Chains HOWTO for further information.  It is
available at <a class="ulink" href="http://www.adelaide.net.au/~rustcorp/ipfwchains/ipfwchains.html" target="_top">http://www.adelaide.net.au/~rustcorp/ipfwchains/ipfwchains.html</a>
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1076"></a>8.13. Netfilter - Linux Kernel 2.4.x Firewalling</h3></div></div></div><p>
In yet another set of advancements to the kernel IP packet filtering code, 
netfilter allows users to set up, maintain, and inspect the packet filtering 
rules in the new 2.4 kernel. 
</p><p>
The netfilter subsystem is a complete rewrite of previous packet filtering 
implementations including ipchains and ipfwadm. Netfilter provides a large 
number of improvements, and it has now become an even more mature and robust 
solution for protecting corporate networks.
</p><p>

</p><pre class="programlisting">
iptables
</pre><p>
 is the command-line interface used to manipulate
the firewall tables within the kernel.
</p><p>
Netfilter provides a raw framework for manipulating packets as they traverse
through various parts of the kernel. Part of this framework includes support for
masquerading, standard packet filtering, and now more complete network
address translation. It even includes improved support for load balancing
requests for a particular service among a group of servers behind the 
firewall.
</p><p>
The stateful inspection features are especially powerful. Stateful inspection
provides the ability to track and control the flow of communication passing
through the filter. The ability to keep track of state and context information
about a session makes rules simpler and tries to interpret higher-level protocols.
</p><p>
Additionally, small modules can be developed to perform additional specific
functions, such as passing packets to programs in userspace for processing
then reinjecting back into the normal packet flow. The ability to develop these
programs in userspace reduces the level of complexity that was previously
associated with having to make changes directly at the kernel level.
</p><p>
Other IP Tables references include:
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/feature_stories/feature_story-94.html" target="_top">Oskar Andreasson IP Tables Tutorial</a></em></span> -- Oskar Andreasson speaks 
with LinuxSecurity.com about his comprehensive IP Tables tutorial and
how this document can be used to build a robust firewall for your organization.
</p></li><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/feature_stories/feature_story-93.html" target="_top">Hal Burgiss Introduces Linux Security Quick-Start Guides</a></em></span> -- Hal Burgiss has written two authoritative guides on securing Linux, 
including managing firewalling.
</p></li><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://netfilter.samba.org" target="_top">Netfilter Homepage</a></em></span> -- The netfilter/iptables homepage.
</p></li><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/feature_stories/kernel-netfilter.html" target="_top">Linux Kernel 2.4 Firewalling Matures: netfilter</a></em></span> -- This
LinuxSecurity.com article describes the basics of packet filtering, how to
get started using iptables, and a list of the new features available in
the latest generation of firewalling for Linux.
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1104"></a>8.14. VPNs - Virtual Private Networks</h3></div></div></div><p>
VPN's are a way to establish a "virtual" network on top of some
already-existing network. This virtual network often is encrypted and
passes traffic only to and from some known entities that have joined
the network. VPNs are often used to connect someone working at home
over the public Internet to an internal company network. 
</p><p>
If you are running a Linux masquerading firewall and need to pass MS
PPTP (Microsoft's VPN point-to-point product) packets, there is a
Linux kernel patch out to do just that. See: <a class="ulink" href="ftp://ftp.rubyriver.com/pub/jhardin/masquerade/ip_masq_vpn.html" target="_top">ip-masq-vpn</a>.
</p><p>
There are several Linux VPN solutions available:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
 vpnd. See the <a class="ulink" href="http://sunsite.dk/vpnd/" target="_top">http://sunsite.dk/vpnd/</a>.
</p></li><li class="listitem"><p>
 Free S/Wan, available at <a class="ulink" href="http://www.xs4all.nl/~freeswan/" target="_top">http://www.xs4all.nl/~freeswan/</a>
</p></li><li class="listitem"><p>
 ssh can be used to construct a VPN.  See the VPN mini-howto
for more information.
</p></li><li class="listitem"><p>
 vps (virtual private server) at <a class="ulink" href="http://www.strongcrypto.com" target="_top">http://www.strongcrypto.com</a>.
</p></li><li class="listitem"><p>
yawipin at <a class="ulink" href="mailto:http://yavipin.sourceforge.net" target="_top">http://yavipin.sourceforge.net</a>
</p></li></ul></div><p>

</p><p>
See also the section on IPSEC for pointers and more information.
</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="secure-prep"></a>9. Security Preparation (before you go on-line)</h2></div></div></div><p>
Ok, so you have checked over your system, and determined it's as secure
as feasible, and you're ready to put it online.  There are a few things
you should now do in order to prepare for an intrusion,
so you can quickly disable the intruder, and get
back up and running.
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1129"></a>9.1. Make a Full Backup of Your Machine</h3></div></div></div><p>
Discussion of backup methods and storage is beyond the scope of this
document, but here are a few words relating to backups and security: 
</p><p>
If you have less than 650mb of data to store on a partition, a CD-R
copy of your data is a good way to go (as it's hard to tamper with
later, and if stored properly can last a long time), you will of
course need at least 650MB of space to make the image. Tapes and other
re-writable media should be write-protected as soon as your backup is
complete, and then verified to prevent tampering. Make sure you store your
backups in a secure off-line area. A good backup will ensure that you
have a known good point to restore your system from.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1133"></a>9.2. Choosing a Good Backup Schedule</h3></div></div></div><p>
A six-tape cycle is easy to maintain.  This includes four tapes
for during the week, one tape for even Fridays, and one tape for odd
Fridays.  Perform an incremental backup every day, and a full backup
on the appropriate Friday tape. If you make some particularly important
changes or add some important data to your system, a full backup might
well be in order. 
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1136"></a>9.3. Testing your backups</h3></div></div></div><p>
You should do periodic tests of your backups to make sure they are
working as you might expect them to. Restores of files and checking
against the real data, sizes and listings of backups, and reading old
backups should be done on a regular basis. 
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1139"></a>9.4. Backup Your RPM or Debian File Database</h3></div></div></div><p>
In the event of an intrusion, you can use your RPM database like you
would use <code class="literal">tripwire</code>, but only if you can be sure it too hasn't been
modified.  You should copy the RPM database to a floppy, and keep this
copy off-line at all times. The Debian distribution likely has
something similar.
</p><p>
The files <code class="literal">/var/lib/rpm/fileindex.rpm</code> and
<code class="literal">/var/lib/rpm/packages.rpm</code> most likely won't fit on a single floppy.
But if compressed, each should fit on a seperate floppy.
</p><p>
Now, when your system is compromised, you can use the command:
</p><p>

</p><pre class="screen">
			root#  rpm -Va
</pre><p>

to verify each file on the system.  See the <code class="literal">rpm</code> man page, as there are
a few other options that can be included to make it less verbose.
Keep in mind you must also be sure your RPM binary has not been
compromised.
</p><p>
This means that every time a new RPM is added to the system, the RPM
database will need to be rearchived.  You will have to decide the
advantages versus drawbacks.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="logs"></a>9.5. Keep Track of Your System Accounting Data</h3></div></div></div><p>
It is very important that the information that comes from <code class="literal">syslog</code>
not be compromised.  Making the files in <code class="literal">/var/log</code> readable and
writable by only a limited number of users is a good start. 
</p><p>
Be sure to keep an eye on what gets written there, especially under
the <code class="literal">auth</code> facility.  Multiple login failures, for example, can
indicate an attempted break-in.
</p><p>
Where to look for your log file will depend on your distribution. In a
Linux system that conforms to the "Linux Filesystem Standard", such as
Red Hat, you will want to look in <code class="literal">/var/log</code> and check <code class="literal">messages</code>,
<code class="literal">mail.log</code>, and others.
</p><p>
You can find out where your distribution is logging to by looking at
your <code class="literal">/etc/syslog.conf</code> file. This is the file that tells
<code class="literal">syslogd</code> (the system logging daemon) where to log various messages.
</p><p>
You might also want to configure your log-rotating script or daemon to 
keep logs around longer so you have time to examine them. Take a look
at the <code class="literal">logrotate</code> package on recent Red Hat distributions. Other
distributions likely have a similar process. 
</p><p>
If your log files have been tampered with, see if you can determine
when the tampering started, and what sort of things appeared to be
tampered with. Are there large periods of time that cannot be accounted
for?  Checking backup tapes (if you have any) for untampered log files
is a good idea.
</p><p>
Intruders typically modify log files in order to cover their
tracks, but they should still be checked for strange happenings. You
may notice the intruder attempting to gain entrance, or exploit a
program in order to obtain the root account. You might see log entries
before the intruder has time to modify them.
</p><p>
You should also be sure to separate the <code class="literal">auth</code> facility from other log 
data, including attempts to switch users using <code class="literal">su</code>, login attempts,
and other user accounting information.
</p><p>
If possible, configure <code class="literal">syslog</code> to send a copy of the most important
data to a secure system.  This will prevent an intruder from covering
his tracks by deleting his login/su/ftp/etc attempts.  See the
<code class="literal">syslog.conf</code> man page, and refer to the <code class="literal">@</code> option.
</p><p>
There are several more advanced <code class="literal">syslogd</code> programs out
there. Take a look at <a class="ulink" href="http://www.core-sdi.com/ssyslog/" target="_top">http://www.core-sdi.com/ssyslog/</a> for Secure Syslog. Secure
Syslog allows you to encrypt your syslog entries and make sure no one
has tampered with them. 
</p><p>
Another <code class="literal">syslogd</code> with more features is <a class="ulink" href="http://www.balabit.hu/en/downloads/syslog-ng/" target="_top">syslog-ng</a>. It allows you a lot more flexibility in your
logging and also can has your remote syslog streams to prevent
tampering. 
</p><p>
Finally, log files are much less useful when no one is reading
them. Take some time out every once in a while to look over your log
files, and get a feeling for what they look like on a normal
day. Knowing this can help make unusual things stand out.
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1183"></a>9.6. Apply All New System Updates.</h3></div></div></div><p>
Most Linux users install from a CD-ROM. Due to the fast-paced nature of 
security fixes, new (fixed) programs are always being released. Before 
you connect your machine to the network, it's a good idea to check with your
distribution's ftp site and get all the updated packages since you 
received your distribution CD-ROM. Many times these packages contain 
important security fixes, so it's a good idea to get them installed. 
</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="after-breakin"></a>10. What To Do During and After a Breakin</h2></div></div></div><p>
So you have followed some of the advice here (or elsewhere) and have
detected a break-in? The first thing to do is to remain calm. Hasty
actions can cause more harm than the attacker would have.  
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1189"></a>10.1. Security Compromise Underway.</h3></div></div></div><p>
Spotting a security compromise under way can be a tense
undertaking. How you react can have large consequences. 
</p><p>
If the compromise you are seeing is a physical one, odds are you have
spotted someone who has broken into your home, office or lab. You
should notify your local authorities. In a lab, you might have
spotted someone trying to open a case or reboot a machine. Depending
on your authority and procedures, you might ask them to stop, or
contact your local security people. 
</p><p>
If you have detected a local user trying to compromise your security,
the first thing to do is confirm they are in fact who you think they
are. Check the site they are logging in from. Is it the site they
normally log in from? No? Then use a non-electronic means of getting in
touch. For instance, call them on the phone or walk over to their
office/house and talk to them. If they agree that they are on, you can
ask them to explain what they were doing or tell them to cease doing
it. If they are not on, and have no idea what you are talking about,
odds are this incident requires further investigation. Look into such
incidents , and have lots of information before making any
accusations. 
</p><p>
If you have detected a network compromise, the first thing to do (if
you are able) is to disconnect your network. If they are connected via
modem, unplug the modem cable; if they are connected via Ethernet,
unplug the Ethernet cable. This will prevent them from doing any
further damage, and they will probably see it as a network problem
rather than detection. 
</p><p>
If you are unable to disconnect the network (if you have a busy site,
or you do not have physical control of your machines), the next best
step is to use something like <code class="literal">tcp_wrappers</code> or <code class="literal">ipfwadm</code>
to deny access from the intruder's site. 
</p><p>
If you can't deny all people from the same site as the intruder,
locking the user's account will have to do. Note that locking an
account is not an easy thing. You have to keep in mind <code class="literal">.rhosts</code> files,
FTP access, and a host of possible backdoors.
</p><p>
After you have done one of the above (disconnected the network, denied
access from their site, and/or disabled their account), you need to
kill all their user processes and log them off. 
</p><p>
You should monitor your site well for the next few minutes, as the
attacker will try to get back in. Perhaps using a different account,
and/or from a different network address. 
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1202"></a>10.2. Security Compromise has already happened</h3></div></div></div><p>
So you have either detected a compromise that has already happened or
you have detected it and locked (hopefully) the offending attacker out
of your system. Now what?
</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm1205"></a>10.2.1. Closing the Hole</h4></div></div></div><p>
If you are able to determine what means the attacker used to get into
your system, you should try to close that hole. For instance, perhaps
you see several FTP entries just before the user logged in. Disable
the FTP service and check and see if there is an updated version, or
if any of the lists know of a fix. 
</p><p>
Check all your log files, and make a visit to your security lists and
pages and see if there are any new common exploits you can fix.  You
can find Caldera security fixes at <a class="ulink" href="http://www.caldera.com/tech-ref/security/" target="_top">http://www.caldera.com/tech-ref/security/</a>. Red Hat has not
yet separated their security fixes from bug fixes, but their
distribution errata is available at <a class="ulink" href="http://www.redhat.com/errata" target="_top">http://www.redhat.com/errata</a>
</p><p>
Debian now has a security mailing list and web page. See: <a class="ulink" href="http://www.debian.org/security/" target="_top">http://www.debian.org/security/</a> for more information. 
</p><p>
It is very likely that if one vendor has released a security update,
that most other Linux vendors will as well.
</p><p>
There is now a Linux security auditing project. They are methodically
going through all the user-space utilities and looking for possible
security exploits and overflows. From their announcement:
</p><p>
<span class="quote">&#8220;<span class="quote">"We are attempting a systematic audit of Linux sources with a view to
being as secure as OpenBSD. We have already uncovered (and fixed) some
problems, but more help is welcome. The list is unmoderated and also a
useful resource for general security discussions.  The list address
is: security-audit@ferret.lmh.ox.ac.uk To subscribe, send a mail to:
security-audit-subscribe@ferret.lmh.ox.ac.uk"</span>&#8221;</span>
</p><p>
If you don't lock the attacker out, they will likely be back. Not just 
back on your machine, but back somewhere on your network. If they were
running a packet sniffer, odds are good they have access to other
local machines.
</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm1218"></a>10.2.2. Assessing the Damage</h4></div></div></div><p>
The first thing is to assess the damage. What has been compromised?
If you are running an integrity checker like <code class="literal">Tripwire</code>, you 
can use it to perform an integrity check; it should help to tell you
what has been compromised.
If not, you will have to look around at all your important data. 
</p><p>
Since Linux systems are getting easier and easier to install, you
might consider saving your config files, wiping your disk(s),
reinstalling, then restoring your user files and your
config files from backups. This will ensure that you have a new, clean system.  If
you have to restore files from the compromised system, be especially
cautious of any binaries that you restore, as they may be Trojan horses 
placed there by the intruder.
</p><p>
Re-installation should be considered mandatory upon an intruder
obtaining root access.  Additionally, you'd like to keep any evidence
there is, so having a spare disk in the safe may make sense.
</p><p>
Then you have to worry about how long ago the compromise happened, and 
whether the backups hold any damaged work.  More on backups later.
</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm1225"></a>10.2.3. Backups, Backups, Backups!</h4></div></div></div><p>
Having regular backups is a godsend for security matters. If your
system is compromised, you can restore the data you need from
backups. Of course, some data is valuable to the attacker too, and they
will not only destroy it, they will steal it and have their own
copies; but at least you will still have the data. 
</p><p>
You should check several backups back into the past before restoring a 
file that has been tampered with. The intruder could have compromised
your files long ago, and you could have made many successful backups
of the compromised file!
</p><p>
Of course, there are also a raft of security concerns with
backups. Make sure you are storing them in a secure place. Know who
has access to them. (If an attacker can get your backups, they can
have access to all your data without you ever knowing it.) 
</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm1230"></a>10.2.4. Tracking Down the Intruder.</h4></div></div></div><p>
Ok, you have locked the intruder out, and recovered your system, but
you're not quite done yet. While it is unlikely that most intruders
will ever be caught, you should report the attack.
</p><p>
You should report the attack to the admin contact at
the site from which the attacker attacked your system. You can look up this
contact with <code class="literal">whois</code> or the Internic database. You might send them an
email with all applicable log entries and dates and times. If you
spotted anything else distinctive about your intruder, you might
mention that too. After sending the email, you should (if you are so
inclined) follow up with a phone call. If that admin in turn spots
your attacker, they might be able to talk to the admin of the site
where they are coming from and so on. 
</p><p>
Good crackers often use many intermediate systems, some (or many) of
which may not even know they have been compromised. Trying to track a
cracker back to their home system can be difficult. Being polite to
the admins you talk to can go a long way to getting help from them. 
</p><p>
You should also notify any security organizations you are a part of
(<a class="ulink" href="http://www.cert.org/" target="_top">CERT</a> or similar), as well as your Linux system vendor.
</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sources"></a>11. Security Sources</h2></div></div></div><p>
There are a LOT of good sites out there for Unix security in general
and Linux security specifically. It's very important to subscribe to
one (or more) of the security mailing lists and keep current on
security fixes. Most of these lists are very low volume, and very
informative.
</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="linuxsecurity"></a>11.1. LinuxSecurity.com References</h3></div></div></div><p>
The LinuxSecurity.com web site has numerous Linux and open source security
references written by the LinuxSecurity staff and people collectively around
the world.
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/vuln-newsletter.html" target="_top">Linux Advisory Watch</a></em></span> -- A comprehensive newsletter that outlines the security 
vulnerabilities that have been announced throughout the week. It includes 
pointers to updated packages and descriptions of each vulnerability. 
</p></li><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/newsletter.html" target="_top">Linux Security Week</a></em></span> --
The purpose of this document is to provide our readers with a quick summary 
of each week's most relevant Linux security headlines. 
</p></li><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/general/mailinglists.html" target="_top">Linux Security Discussion List</a></em></span> -- This mailing list is for general security-related questions and comments.
</p></li><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/general/mailinglists.html" target="_top">Linux Security Newsletters</a></em></span> -- Subscription information for all newsletters.
</p></li><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/docs/colsfaq.html" target="_top">comp.os.linux.security FAQ</a></em></span> -- Frequently Asked Questions with answers for the comp.os.linux.security newsgroup.
</p></li><li class="listitem"><p>
<span class="emphasis"><em><a class="ulink" href="http://www.linuxsecurity.com/docs/" target="_top">Linux Security Documentation</a></em></span> -- A great starting point for information pertaining to Linux and Open Source security.
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="ftpsites"></a>11.2. FTP Sites</h3></div></div></div><p>
CERT is the Computer Emergency Response Team. They often send out
alerts of current attacks and fixes. See <a class="ulink" href="ftp://ftp.cert.org" target="_top">ftp://ftp.cert.org</a> for more information.
</p><p>
ZEDZ (formerly Replay) (<a class="ulink" href="http://www.zedz.net" target="_top">http://www.zedz.net</a>)
has archives of many security programs. Since they are outside
the US, they don't need to obey US crypto restrictions. 
</p><p>
Matt Blaze is the author of CFS and a great security advocate.  Matt's
archive is available at <a class="ulink" href="ftp://ftp.research.att.com/pub/mab" target="_top">ftp://ftp.research.att.com/pub/mab</a>
</p><p>
<code class="literal">tue.nl</code> is a great security FTP site in the Netherlands. 
<a class="ulink" href="ftp://ftp.win.tue.nl/pub/security/" target="_top">ftp.win.tue.nl</a>
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="websites"></a>11.3. Web Sites</h3></div></div></div><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
The Hacker FAQ is a FAQ about hackers: <a class="ulink" href="http://www.solon.com/~seebs/faqs/hacker.html" target="_top">The Hacker FAQ</a>
</p></li><li class="listitem"><p>
The COAST archive has a large number of Unix security programs and
information: <a class="ulink" href="http://www.cs.purdue.edu/coast/" target="_top">COAST</a> 
</p></li><li class="listitem"><p>
 SuSe Security Page: <a class="ulink" href="http://www.suse.de/security/" target="_top">http://www.suse.de/security/</a>
</p></li><li class="listitem"><p>
Rootshell.com is a great site for seeing what exploits are currently
being used by crackers: <a class="ulink" href="http://www.rootshell.com/" target="_top">http://www.rootshell.com/</a> 
</p></li><li class="listitem"><p>
BUGTRAQ puts out advisories on security issues: <a class="ulink" href="http://www.netspace.org/lsv-archive/bugtraq.html" target="_top">BUGTRAQ archives</a> 
</p></li><li class="listitem"><p>
CERT, the Computer Emergency Response Team, puts out advisories on
common attacks on Unix platforms: <a class="ulink" href="http://www.cert.org/" target="_top">CERT home</a> 
</p></li><li class="listitem"><p>
Dan Farmer is the author of SATAN and many other security tools. His
home site has some interesting security survey information, as well as
security tools: <a class="ulink" href="http://www.trouble.org" target="_top">http://www.trouble.org</a>
</p></li><li class="listitem"><p>
The Linux security WWW is a good site for Linux security information: 
<a class="ulink" href="http://www.aoy.com/Linux/Security/" target="_top">Linux Security WWW</a>
</p></li><li class="listitem"><p>
Infilsec has a vulnerability engine that can tell you what
vulnerabilities affect a specific platform: <a class="ulink" href="http://www.infilsec.com/vulnerabilities/" target="_top">http://www.infilsec.com/vulnerabilities/</a>
</p></li><li class="listitem"><p>
CIAC sends out periodic security bulletins on common exploits: <a class="ulink" href="http://ciac.llnl.gov/cgi-bin/index/bulletins" target="_top">http://ciac.llnl.gov/cgi-bin/index/bulletins</a>
</p></li><li class="listitem"><p>
A good starting point for Linux Pluggable Authentication modules can
be found at <a class="ulink" href="http://www.kernel.org/pub/linux/libs/pam/" target="_top">http://www.kernel.org/pub/linux/libs/pam/</a>.
</p></li><li class="listitem"><p>
The Debian project has a web page for their security fixes and
information. It is at <a class="ulink" href="http://www.debian.com/security/" target="_top">http://www.debian.com/security/</a>.
</p></li><li class="listitem"><p>
 WWW Security FAQ, written by Lincoln Stein, is a great web
security reference. Find it at <a class="ulink" href="http://www.w3.org/Security/Faq/www-security-faq.html" target="_top">http://www.w3.org/Security/Faq/www-security-faq.html</a>
</p></li></ul></div><p>

</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1324"></a>11.4. Mailing Lists</h3></div></div></div><p>
Bugtraq:  To subscribe to bugtraq, send mail to listserv@netspace.org
containing the message body subscribe bugtraq. (see links above for
archives). 
</p><p>
CIAC: Send e-mail to majordomo@tholia.llnl.gov. In the BODY (not
subject) of the message put (either or both): subscribe ciac-bulletin
</p><p>
 
Red Hat has a number of mailing lists, the most important of which is
the redhat-announce list. You can read about security (and other)
fixes as soon as they come out.  Send email to
redhat-announce-list-request@redhat.com with the Subject Subscribe
See <a class="ulink" href="https://listman.redhat.com/mailman/listinfo/" target="_top">https://listman.redhat.com/mailman/listinfo/</a> for
more info and archives. 
</p><p>
The Debian project has a security mailing list that covers their
security fixes. See <a class="ulink" href="http://www.debian.com/security/" target="_top">http://www.debian.com/security/</a> for more information. 
</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm1332"></a>11.5. Books - Printed Reading Material</h3></div></div></div><p>
There are a number of good security books out there. This section
lists a few of them. In addition to the security specific books,
security is covered in a number of other books on system
administration. 
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
Building Internet Firewalls By D. Brent Chapman &amp; Elizabeth D. Zwicky,
1st Edition September 1995,
ISBN: 1-56592-124-0
</p></li><li class="listitem"><p>
Practical UNIX &amp; Internet Security, 2nd Edition By Simson Garfinkel &amp; Gene Spafford, 2nd Edition April 1996, ISBN: 1-56592-148-8
</p></li><li class="listitem"><p>
Computer Security Basics By Deborah Russell &amp; G.T. Gangemi, Sr., 1st 
Edition July 1991, ISBN: 0-937175-71-4
</p></li><li class="listitem"><p>
Linux Network Administrator's Guide By Olaf Kirch, 1st Edition January 
1995, ISBN: 1-56592-087-2
</p></li><li class="listitem"><p>
PGP: Pretty Good Privacy By Simson Garfinkel, 1st Edition December 1994, 
ISBN: 1-56592-098-8
</p></li><li class="listitem"><p>
Computer Crime A Crimefighter's Handbook By David Icove, Karl 
Seger &amp; William VonStorch (Consulting Editor Eugene H. Spafford),
1st Edition August 1995, ISBN: 1-56592-086-4
</p></li><li class="listitem"><p>
Linux Security By John S. Flowers, New Riders; ISBN: 0735700354, March 1999
</p></li><li class="listitem"><p>
Maximum Linux Security : A Hacker's Guide to Protecting Your Linux Server 
and Network, Anonymous, Paperback - 829 pages, Sams; ISBN: 0672313413, July 
1999
</p></li><li class="listitem"><p>
Intrusion Detection By Terry Escamilla, Paperback - 416 pages 
(September 1998), John Wiley and Sons; ISBN: 0471290009
</p></li><li class="listitem"><p>
Fighting Computer Crime, Donn Parker, Paperback - 526 pages (September 
1998), John Wiley and Sons; ISBN: 0471163783
</p></li></ul></div><p>

</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm1357"></a>12. Glossary</h2></div></div></div><p>
Included below are several of the most frequently used terms in computer
security. A comprehensive dictionary of computer security terms is available
in the <a class="ulink" href="http://www.linuxsecurity.com/dictionary/" target="_top">LinuxSecurity.com Dictionary</a>
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
<span class="emphasis"><em>authentication:</em></span> The process of knowing that the data
received is the same as the data that was sent, and that the claimed
sender is in fact the actual sender.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>bastion Host:</em></span> A computer system that must be highly
secured because it is vulnerable to attack, usually because it is
exposed to the Internet and is a main point of contact for users of
internal networks.  It gets its name from the highly fortified
projects on the outer walls of medieval castles.  Bastions overlook
critical areas of defense, usually having strong walls, room for
extra troops, and the occasional useful tub of boiling hot oil for
discouraging attackers.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>buffer overflow:</em></span> Common coding style is to never
allocate large enough buffers, and to not check for overflows.  When
such buffers overflow, the executing program (daemon or set-uid
program) can be tricked in doing some other things.  Generally this
works by overwriting a function's return address on the stack to point
to another location.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>denial of service:</em></span> An attack that consumes the
resources on your computer for things it was 
not intended to be doing, thus preventing normal use of your network
resources for legitimate purposes.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>dual-homed Host:</em></span> A general-purpose computer system that
has at least two network interfaces.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>firewall:</em></span> A component or set of components that restricts
access between a protected network and the Internet, or between other
sets of networks.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>host:</em></span> A computer system attached to a network.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>IP spoofing:</em></span> IP Spoofing is a complex technical attack
that is made up of several components.  It is a security exploit that
works by tricking computers in a trust relationship into thinking that
you are someone that you really aren't.  There is an extensive paper
written by daemon9, route, and infinity in the Volume Seven, Issue
Forty-Eight issue of Phrack Magazine.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>non-repudiation:</em></span> The property of a receiver being able
to prove that the sender of some data did in fact send the data even
though the sender might later deny ever having sent it. 
</p></li><li class="listitem"><p>
<span class="emphasis"><em>packet:</em></span> The fundamental unit of communication on the
Internet.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>packet filtering:</em></span> The action a device takes to
selectively control the flow of data to and from a network.  Packet
filters allow or block packets, usually while routing them from one
network to another (most often from the Internet to an internal
network, and vice-versa). To accomplish packet filtering, you set up
rules that specify what types of packets (those to or from a
particular IP address or port) are to be allowed and what types are to
be blocked.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>perimeter network:</em></span> A network added between a protected
network and an external network, in order to provide an additional
layer of security.  A perimeter network is sometimes called a DMZ.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>proxy server:</em></span> A program that deals with external
servers on behalf of internal clients.  Proxy clients talk to proxy
servers, which relay approved client requests to real servers, and
relay answers back to clients.
</p></li><li class="listitem"><p>
<span class="emphasis"><em>superuser:</em></span> An informal name for <code class="literal">root</code>.
</p></li></ul></div><p>

</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="q-and-a"></a>13. Frequently Asked Questions</h2></div></div></div><p>

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
 Is it more secure to compile driver support directly into the
kernel, instead of making it a module?
</p><p>
Answer: Some people think it is better to disable the ability to load
device drivers using modules, because an intruder could load a Trojan
module or a module that could affect system security.
</p><p>
However, in order to load modules, you must be root.  The module
object files are also only writable by root.  This means the intruder
would need root access to insert a module.  If the intruder gains root
access, there are more serious things to worry about than whether he
will load a module.
</p><p>
Modules are for dynamically loading support for a particular device
that may be infrequently used.  On server machines, or firewalls for
instance, this is very unlikely to happen.  For this reason, it would
make more sense to compile support directly into the kernel for
machines acting as a server.  Modules are also slower than support
compiled directly in the kernel.
</p></li><li class="listitem"><p>
 Why does logging in as root from a remote machine always fail?
</p><p>
Answer: See <a class="xref" href="#root-security" title="4.2. Root Security">Section 4.2, &#8220;Root Security&#8221;</a>.  This is done
intentionally to prevent remote users from attempting to connect via
<code class="literal">telnet</code> to your machine as <code class="literal">root</code>, which is a serious
security
vulnerability, because then the root password would be transmitted, in
clear text, across the network.  Don't forget: potential intruders have time on their
side, and can run automated programs to find your
password. Additionally, this is done to keep a clear record of who
logged in, not just root.  
</p></li><li class="listitem"><p>
 How do I enable shadow passwords on my Linux box?
</p><p>
Answer:
</p><p>
To enable shadow passwords, run <code class="literal">pwconv</code> as root, and
<code class="literal">/etc/shadow</code> should now exist, and be used by applications.
If you are using RH 4.2 or above, the PAM modules will automatically
adapt to the change from using normal <code class="literal">/etc/passwd</code> to shadow
passwords without any other change.
</p><p>
Some background: shadow passwords is a mechanism for storing your
password in a file other than the normal <code class="literal">/etc/passwd</code> file.  This has
several advantages.  The first one is that the shadow file,
<code class="literal">/etc/shadow</code>, is only readable by root, unlike <code class="literal">/etc/passwd</code>,
which must remain readable by everyone.  The other advantage is that as the
administrator, you can enable or disable accounts without everyone
knowing the status of other users' accounts.
</p><p>
The <code class="literal">/etc/passwd</code> file is then used to store user and group names, used
by programs like <code class="literal">/bin/ls</code> to map the user ID to the proper user name
in a directory listing.
</p><p>
The <code class="literal">/etc/shadow</code> file then only contains the user name and his/her
password, and perhaps accounting information, like when the account
expires, etc.
</p><p>
To enable shadow passwords, run <code class="literal">pwconv</code> as root, and
<code class="literal">/etc/shadow</code> should now exist, and be used by applications.
Since you are using RH 4.2 or above, the PAM modules will automatically
adapt to the change from using normal <code class="literal">/etc/passwd</code> to shadow
passwords without any other change.
</p><p>
Since you're interested in securing your passwords, perhaps you would
also be interested in generating good passwords to begin with.  For
this you can use the <code class="literal">pam_cracklib</code> module, which is part of PAM.  It
runs your password against the Crack libraries to help you decide if
it is too-easily guessable by password-cracking programs.
</p></li><li class="listitem"><p>
 How can I enable the Apache SSL extensions?
</p><p>
Answer:
</p><p>

</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>
Get SSLeay 0.8.0 or later from <a class="ulink" href="ftp://ftp.psy.uq.oz.au/pub/Crypto/SSL" target="_top">&#65533;</a>
</p></li><li class="listitem"><p>
Build and test and install it!
</p></li><li class="listitem"><p>
Get Apache source
</p></li><li class="listitem"><p>
Get Apache SSLeay extensions from
<a class="ulink" href="ftp://ftp.ox.ac.uk/pub/crypto/SSL/" target="_top">here</a>
</p></li><li class="listitem"><p>
Unpack it in the apache source directory and patch Apache as
per the README.
</p></li><li class="listitem"><p>
Configure and build it.
</p></li></ol></div><p>

</p><p>
You might also try <a class="ulink" href="http://www.zedz.net" target="_top">ZEDZ net</a>
which has many pre-built packages, and is located outside of the United States.
</p></li><li class="listitem"><p>
 How can I manipulate user accounts, and still retain security?
</p><p>
Answer:  most distributions contain a great number of tools to change
the properties of user accounts. 
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
The <code class="literal">pwconv</code> and <code class="literal">unpwconv</code> programs can be used to convert 
between shadow and non-shadowed passwords.
</p></li><li class="listitem"><p>
The <code class="literal">pwck</code> and <code class="literal">grpck</code> programs can be used to verify proper
organization of the <code class="literal">passwd</code> and <code class="literal">group</code> files.
</p></li><li class="listitem"><p>
The <code class="literal">useradd</code>, <code class="literal">usermod</code>, and <code class="literal">userdel</code> programs can be used to
add, delete and modify user accounts.  The <code class="literal">groupadd</code>,
<code class="literal">groupmod</code>, and <code class="literal">groupdel</code> programs will do the same for groups.
</p></li><li class="listitem"><p>
Group passwords can be created using <code class="literal">gpasswd</code>.
</p></li></ul></div><p>

</p><p>
All these programs are "shadow-aware" -- that is, if you enable shadow
they will use <code class="literal">/etc/shadow</code> for password information, otherwise they won't.
</p><p>
See the respective man pages for further information.
</p></li><li class="listitem"><p>
 How can I password-protect specific HTML documents using
Apache?
</p><p>
I bet you didn't know about <a class="ulink" href="http://www.apacheweek.com" target="_top">http://www.apacheweek.org</a>, did you?
</p><p>
You can find information on user authentication at <a class="ulink" href="http://www.apacheweek.com/features/userauth" target="_top">http://www.apacheweek.com/features/userauth</a> as well as other
web server security tips from <a class="ulink" href="http://www.apache.org/docs/misc/security_tips.html" target="_top">http://www.apache.org/docs/misc/security_tips.html</a>
</p></li></ol></div><p>

</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="conclusion"></a>14. Conclusion</h2></div></div></div><p>
By subscribing to the security alert mailing lists, and keeping
current, you can do a lot towards securing your machine. If you pay
attention to your log files and run something like <code class="literal">tripwire</code> regularly,
you can do even more. 
</p><p>
A reasonable level of computer security is not difficult to maintain
on a home machine. More effort is required on business machines, but
Linux can indeed be a secure platform. Due to the nature of Linux
development, security fixes often come out much faster than they do on
commercial operating systems, making Linux an ideal platform when
security is a requirement. 
</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm1505"></a>15. Acknowledgments</h2></div></div></div><p>
Information here is collected from many sources. Thanks to the
following who either indirectly or directly have contributed:
</p><p>
</p><pre class="screen">
Rob Riggs
<a class="ulink" href="mailto:rob@DevilsThumb.com" target="_top">rob@DevilsThumb.com</a>
</pre><p>
</p><p>
S. Coffin
<a class="ulink" href="mailto:scoffin@netcom.com" target="_top">scoffin@netcom.com</a>
</p><p>
Viktor Przebinda
<a class="ulink" href="mailto:viktor@CRYSTAL.MATH.ou.edu" target="_top">viktor@CRYSTAL.MATH.ou.edu</a> 
</p><p>
Roelof Osinga
<a class="ulink" href="mailto:roelof@eboa.com" target="_top">roelof@eboa.com</a>
</p><p>
Kyle Hasselbacher
<a class="ulink" href="mailto:kyle@carefree.quux.soltec.net" target="_top">kyle@carefree.quux.soltc.net</a>
</p><p>
David S. Jackson
<a class="ulink" href="mailto:dsj@dsj.net" target="_top">dsj@dsj.net</a>
</p><p>
Todd G. Ruskell
<a class="ulink" href="mailto:ruskell@boulder.nist.gov" target="_top">ruskell@boulder.nist.gov</a> 
</p><p>
Rogier Wolff
<a class="ulink" href="mailto:R.E.Wolff@BitWizard.nl" target="_top">R.E.Wolff@BitWizard.nl</a>
</p><p>
Antonomasia <a class="ulink" href="mailto:ant@notatla.demon.co.uk" target="_top">ant@notatla.demon.co.uk</a> 
</p><p>
Nic Bellamy <a class="ulink" href="mailto:sky@wibble.net" target="_top">sky@wibble.net</a> 
</p><p>
Eric Hanchrow <a class="ulink" href="mailto:offby1@blarg.net" target="_top">offby1@blarg.net</a> 
</p><p>
Robert J. Berger<a class="ulink" href="mailto:rberger@ibd.com" target="_top">rberger@ibd.com</a> 
</p><p>
Ulrich Alpers <a class="ulink" href="mailto:lurchi@cdrom.uni-stuttgart.de" target="_top">lurchi@cdrom.uni-stuttgart.de</a> 
</p><p>
David Noha <a class="ulink" href="mailto:dave@c-c-s.com" target="_top">dave@c-c-s.com</a> 
</p><p>
Pavel Epifanov. <a class="ulink" href="mailto:epv@ibm.net" target="_top">epv@ibm.net</a>
</p><p>
Joe Germuska. <a class="ulink" href="mailto:joe@germuska.com" target="_top">joe@germuska.com</a>
</p><p>
Franklin S. Werren <a class="ulink" href="mailto:fswerren@bagpipes.net" target="_top">fswerren@bagpipes.net</a> 
</p><p>
Paul Rusty Russell <a class="ulink" href="mailto:Paul.Russell@rustcorp.com.au" target="_top">&lt;Paul.Russell@rustcorp.com.au&gt;</a> 
</p><p>
Christine Gaunt <a class="ulink" href="mailto:cgaunt@umich.edu" target="_top">&lt;cgaunt@umich.edu&gt;</a> 
</p><p>
lin <a class="ulink" href="mailto:bhewitt@refmntutl01.afsc.noaa.gov" target="_top">bhewitt@refmntutl01.afsc.noaa.gov</a> 
</p><p>
A. Steinmetz <a class="ulink" href="mailto:astmail@yahoo.com" target="_top">astmail@yahoo.com</a> 
</p><p>
Jun Morimoto <a class="ulink" href="mailto:morimoto@xantia.citroen.org" target="_top">morimoto@xantia.citroen.org</a> 
</p><p>
Xiaotian Sun <a class="ulink" href="mailto:sunx@newton.me.berkeley.edu" target="_top">sunx@newton.me.berkeley.edu</a> 
</p><p>
Eric Hanchrow <a class="ulink" href="mailto:offby1@blarg.net" target="_top">offby1@blarg.net</a> 
</p><p>
Camille Begnis <a class="ulink" href="mailto:camille@mandrakesoft.com" target="_top">camille@mandrakesoft.com</a>
</p><p>
Neil D <a class="ulink" href="mailto:neild@sympatico.ca" target="_top">neild@sympatico.ca</a>
</p><p>
Michael Tandy <a class="ulink" href="mailto:Michael.Tandy@BTInternet.com" target="_top">Michael.Tandy@BTInternet.com</a>
</p><p>
Tony Foiani <a class="ulink" href="mailto:tkil@scrye.com" target="_top">tkil@scrye.com</a>
</p><p>
Matt Johnston <a class="ulink" href="mailto:mattj@flashmail.com" target="_top">mattj@flashmail.com</a>
</p><p>
Geoff Billin <a class="ulink" href="mailto:gbillin@turbonet.com" target="_top">gbillin@turbonet.com</a>
</p><p>
Hal Burgiss <a class="ulink" href="mailto:hburgiss@bellsouth.net" target="_top">hburgiss@bellsouth.net</a>
</p><p>
Ian Macdonald <a class="ulink" href="mailto:ian@linuxcare.com" target="_top">ian@linuxcare.com</a>
</p><p>
M.Kiesel <a class="ulink" href="mailto:m.kiesel@iname.com" target="_top">m.kiesel@iname.com</a>
</p><p>
Mario Kratzer <a class="ulink" href="mailto:kratzer@mathematik.uni-marburg.de" target="_top">kratzer@mathematik.uni-marburg.de</a>
</p><p>
Othmar Pasteka <a class="ulink" href="mailto:pasteka@kabsi.at" target="_top">pasteka@kabsi.at</a>
</p><p>
Robert M <a class="ulink" href="mailto:rom@romab.com" target="_top">rom@romab.com</a>
</p><p>
Cinnamon Lowe <a class="ulink" href="mailto:clowe@cinci.rr.com" target="_top">clowe@cinci.rr.com</a>
</p><p>
Rob McMeekin <a class="ulink" href="mailto:blind_mordecai@yahoo.com" target="_top">blind_mordecai@yahoo.com</a>
</p><p>
Gunnar Ritter <a class="ulink" href="mailto:g-r@bigfoot.de" target="_top"> g-r@bigfoot.de</a>
</p><p>
 Frank Lichtenheld<a class="ulink" href="mailto:frank@lichtenheld.de" target="_top">frank@lichtenheld.de</a>
</p><p>
BjÃ¶rn Lotz<a class="ulink" href="mailto:blotz@suse.de" target="_top">blotz@suse.de</a>
</p><p>
Othon Marcelo Nunes Batista<a class="ulink" href="mailto:othonb@superig.com.br" target="_top">othonb@superig.com.br</a>
</p><p>
The following have translated this HOWTO into various other languages!
</p><p>
A special thank you to all of them for help spreading the Linux word...
</p><p>
Polish: Ziemek Borowski <a class="ulink" href="mailto:ziembor@FAQ-bot.ZiemBor.Waw.PL" target="_top">ziembor@FAQ-bot.ZiemBor.Waw.PL</a> 
</p><p>
Japanese: FUJIWARA Teruyoshi <a class="ulink" href="mailto:fjwr@mtj.biglobe.ne.jp" target="_top">fjwr@mtj.biglobe.ne.jp</a> 
</p><p>
Indonesian: Tedi Heriyanto <a class="ulink" href="mailto:22941219@students.ukdw.ac.id" target="_top">22941219@students.ukdw.ac.id</a> 
</p><p>
Korean: Bume Chang <a class="ulink" href="mailto:Boxcar0001@aol.com" target="_top">Boxcar0001@aol.com</a> 
</p><p>
Spanish: Juan Carlos Fernandez <a class="ulink" href="mailto:piwiman@visionnetware.com" target="_top">piwiman@visionnetware.com</a>
</p><p>
Dutch: "Nine Matthijssen" <a class="ulink" href="mailto:nine@matthijssen.nl" target="_top">nine@matthijssen.nl</a> 
</p><p>
Norwegian: ketil@vestby.com <a class="ulink" href="mailto:ketil@vestby.com" target="_top">ketil@vestby.com</a>
</p><p>
Turkish: tufan karadere <a class="ulink" href="mailto:tufank@metu.edu.tr" target="_top">tufank@metu.edu.tr</a>
</p></div></div></body></html>
