<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>4. Linux Directory Hierarchy: Oriented to the Software Parts</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Designing Integrated High Quality Linux Applications"><link rel="up" href="index.html" title="Designing Integrated High Quality Linux Applications"><link rel="prev" href="ar01s03.html" title="3. The Four Universal Parts of Any Software"><link rel="next" href="ar01s05.html" title="5. Provide Architecture for Extensions and Plugins"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. Linux Directory Hierarchy: Oriented to the Software Parts</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s03.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s05.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="fhs"></a>4. Linux Directory Hierarchy: Oriented to the Software Parts</h2></div></div></div><p>By now, all discussion are OS independent. On Linux, the <a class="link" href="ar01s03.html" title="3. The Four Universal Parts of Any Software">Four Software Parts</a> theory is expressed in his directory structure, which is classified and documented in the <a class="ulink" href="http://www.pathname.com/fhs/" target="_top">Filesystem Hierarchy Standard</a>. The <acronym class="acronym">FHS</acronym> is part of the <a class="ulink" href="http://www.linuxbase.org/" target="_top"><acronym class="acronym">LSB</acronym> (Linux Standard Base)</a>, which makes him a good thing because all the industry is moving thowards it, and is a constant preoccupation to all distributions. <acronym class="acronym">FHS</acronym> defines in which directories each peace of Apache, Samba, Mozilla, KDE <span class="emphasis"><em>and your Software</em></span> must go, and you don't have any other reason to not use it while thinking in developing your Software, but I'll give you some more:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><acronym class="acronym">FHS</acronym> is a standard, and we can't live without standards</p></li><li class="listitem"><p>This is the most basic OS organization, that are related to access levels and <a class="link" href="ar01s07.html" title="7. Security: The Omnipresent Concept"><span class="strong"><strong>security</strong></span></a>, where users intuitively find each type of file, etc</p></li><li class="listitem"><p><span class="emphasis"><em>Makes user's life easyer</em></span></p></li></ol></div><p>This last reason already justifies FHS adoption, so <span class="strong">allways use the <acronym class="acronym">FHS</acronym></span> !!!</p><p>More about <acronym class="acronym">FHS</acronym> importance and sharing the same directory structure can be found in <a class="ulink" href="http://www.redhat.com/docs/manuals/linux/RHL-7.2-Manual/ref-guide/ch-filesystem.html" target="_top">Red Hat website.</a></p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fhs.fhs"></a>4.1. <acronym class="acronym">FHS</acronym> Summary</h3></div></div></div><p>So let's summarize what the <acronym class="acronym">FHS</acronym> has to say about Linux directories:</p><div class="variablelist"><p class="title"><b>Linux system directories</b></p><dl class="variablelist"><dt><span class="term"><code class="filename">/usr/bin</code></span></dt><dd><p>Directory for the executables that are accessed by all users (everybody have this directory in their <code class="varname">$PATH</code>). The main files of your Software will probably be here. You should never create a subdirectory under this folder.</p></dd><dt><span class="term"><code class="filename">/bin</code></span></dt><dd><p>Like <code class="filename">/usr/bin</code>, but here you'll find only boot process vital executables, that are simple and small. Your Software (being high-level) probably doesn't have nothing to install here.</p></dd><dt><span class="term"><code class="filename">/usr/sbin</code></span></dt><dd><p>Like <code class="filename">/usr/bin</code>, but contains only the executables that must be accessed by the administrator (root user). Regular users should never have this directory in their <code class="varname">$PATH</code>. If your Software is a daemon, This is the directory for some of executables.</p></dd><dt><span class="term"><code class="filename">/sbin</code></span></dt><dd><p>Like <code class="filename">/usr/sbin</code>, but only for the boot process vital executables, and that will be accessed by sysadmin for some system maintaining. Commands like <span class="command"><strong>fsck</strong></span> (filesystem check), <span class="command"><strong>init</strong></span> (father of all processes), <span class="command"><strong>ifconfig</strong></span> (network configuration), <span class="command"><strong>mount</strong></span>, etc can be found here. It is the system's most vital directory.</p></dd><dt><span class="term"><code class="filename">/usr/lib</code></span></dt><dd><p>Contains dynamic libraries and support static files for the executables at <code class="filename">/usr/bin</code> and <code class="filename">/usr/sbin</code>. You can create a subdirectory like <code class="filename">/usr/lib/myproduct</code> to contain your helper files, or dynamic libraries that will be accessed only by your Software, without user intervention. A subdirectory here can be used as a container for <a class="link" href="ar01s05.html" title="5. Provide Architecture for Extensions and Plugins">plugins and extensions</a>.</p></dd><dt><span class="term"><code class="filename">/lib</code></span></dt><dd><p>Like <code class="filename">/usr/lib</code> but contains dynamic libraries and support static files needed in the boot process. You'll never find an executable at <code class="filename">/bin</code> or <code class="filename">/sbin</code> that needs a library that is outside this directory. Kernel modules (device drivers) are under <code class="filename">/lib</code>.</p></dd><dt><span class="term"><code class="filename">/etc</code></span></dt><dd><p>Contains configuration files. If your Software uses several files, put them under a subfolder like <code class="filename">/etc/myproduct/</code></p></dd><dt><span class="term"><code class="filename">/var</code></span></dt><dd><p>The name comes from "<span class="emphasis"><em>variable</em></span>", because everything that is under this directory changes frequently, and the package system (RPM) doesn't keep control of. Usually <code class="filename">/var</code> is mounted over a separate high-performance partition. In <code class="filename">/var/log</code> logfiles grow up. For web content we use <code class="filename">/var/www</code>, and so on.</p></dd><dt><span class="term"><code class="filename">/home</code></span></dt><dd><p>Contains the user's (real human beings) <span class="emphasis"><em>home</em></span> directories. Your Software package should <span class="emphasis"><em>never</em></span> install files here (in installation time). If <span class="emphasis"><em>your</em></span> business logic requires a special <acronym class="acronym">UNIX</acronym> user (not a human being) to be created, you should assign him a home directory under <code class="filename">/var</code> or other place <span class="emphasis"><em>outside</em></span> <code class="filename">/home</code>. Please, never forget that.</p></dd><dt><span class="term"><code class="filename">/usr/share/doc</code>, </span><span class="term"><code class="filename">/usr/share/man</code></span></dt><dd><p>The "share" word is used because what is under <code class="filename">/usr/share</code> is platform independent, and can be shared among several machines across a network filesystem. Therefore this is the place for manuals, documentations, examples etc.</p></dd><dt><span class="term"><code class="filename">/usr/local</code>, </span><span class="term"><code class="filename">/opt</code></span></dt><dd><p>These are obsolete folders. When <acronym class="acronym">UNIX</acronym> didn't have a package system (like RPM), sysadmins needed to separate an <span class="emphasis"><em>optional</em></span> (or <span class="emphasis"><em>local</em></span>) Software from the main OS. These were the directories used for that.</p></dd></dl></div><p>You may think is a bad idea to break your Software (as a whole) in many pieces, instead of keeping it all under a self-contained directory. But a <a class="link" href="ar01s06.html" title="6. Allways Provide RPM Packages of Your Softwares">package system (RPM)</a> has a database that manages it all for you in a very professional way, taking care of configuration files, directories etc. And if you spread your Software using the <acronym class="acronym">FHS</acronym>, beyond the user friendliness, you'll bring an intuitive way to the sysadmin configure it, and work better with performance and security.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="newtable"></a>4.2. Examples Using the <acronym class="acronym">FHS</acronym></h3></div></div></div><p>Now that we know where each part of our software must be installed, lets review the <a class="link" href="ar01s03.html#partstable" title="Table 1. Universality of 4 Parts">Universal Parts Table</a> applied to the <acronym class="acronym">FHS</acronym>.</p><div class="table"><a name="idm513"></a><p class="title"><b>Table 2. Same Software, applying <acronym class="acronym">FHS</acronym></b></p><div class="table-contents"><table class="table" summary="Same Software, applying FHS" width="100%" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> </th><th><a class="link" href="ar01s03.html#software.body">Software on its Own</a></th><th><a class="link" href="ar01s03.html#software.soul">Configurations</a></th><th><a class="link" href="ar01s03.html#software.content">Content</a></th><th><a class="link" href="ar01s03.html#software.logs">Logs, Dumps etc</a></th></tr></thead><tbody><tr><td><span class="strong"><strong>Data Base Server</strong></span></td><td><code class="filename">/usr/bin/</code>, <code class="filename">/usr/lib/</code>, <code class="filename">/usr/share/doc/mydb/</code>, <code class="filename">/usr/share/doc/mydb/examples/</code></td><td><code class="filename">/etc/mydb/</code></td><td><code class="filename">/var/db/instance1/</code>, <code class="filename">/var/db/instance2/</code>, etc</td><td><code class="filename">/var/db/instance1/transactions/</code>, <code class="filename">/var/log/db/access-instance1.log</code>, <code class="filename">/var/log/db/access-instance2.log</code></td></tr><tr><td><span class="strong"><strong>Text Editor</strong></span></td><td><code class="filename">/usr/bin/</code>, <code class="filename">/usr/lib/</code>, <code class="filename">/usr/lib/myeditor/plugins/</code>, <code class="filename">/usr/share/myeditor/templates/</code>, <code class="filename">/usr/share/doc/myeditor/</code></td><td><code class="filename">$HOME/.myeditor.conf</code></td><td><code class="filename">$HOME/Docs/</code></td><td><code class="filename">$HOME/.myeditor-tmp/</code></td></tr><tr><td><span class="strong"><strong>MP3 Generator</strong></span></td><td><code class="filename">/usr/bin/</code>, <code class="filename">/usr/lib/</code>, <code class="filename">/usr/lib/mymp3/plugins/</code>, <code class="filename">/usr/share/doc/mymp3/</code></td><td><code class="filename">$HOME/.mymp3.conf</code></td><td><code class="filename">$HOME/Music/</code></td><td><code class="filename">$HOME/.mymp3-tmp/</code></td></tr><tr><td><span class="strong"><strong>Web Server</strong></span></td><td><code class="filename">/usr/sbin/</code>, <code class="filename">/usr/bin/</code>, <code class="filename">/usr/lib/httpd-modules/</code>, <code class="filename">/usr/share/doc/httpd/</code>, <code class="filename">/usr/share/doc/httpd/examples/</code></td><td><code class="filename">/etc/httpd/</code>, <code class="filename">/etc/httpd/instance1/</code>, <code class="filename">/etc/httpd/instance2/</code></td><td><code class="filename">/var/www/</code>, <code class="filename">/var/www/instance1/</code>, <code class="filename">/var/www/instance2/</code></td><td><code class="filename">/var/logs/httpd/</code>, <code class="filename">/var/logs/httpd/instance1/</code>, <code class="filename">/var/logs/httpd/instance2/</code></td></tr><tr><td><span class="strong"><strong>E-Mail Server</strong></span></td><td><code class="filename">/usr/sbin/</code>, <code class="filename">/usr/bin/</code>, <code class="filename">/usr/lib/</code>, <code class="filename">/usr/share/doc/mymail/</code></td><td><code class="filename">/etc/mail/</code>, <code class="filename">/etc/mailserver.cf</code></td><td><code class="filename">/var/mail/</code></td><td><code class="filename">/var/spool/mailqueue/</code>, <code class="filename">/var/logs/mail.log</code></td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="noopt"></a>4.3. Developer, Do Not Install in <code class="filename">/opt</code> or <code class="filename">/usr/local</code> !</h3></div></div></div><p>If you are a systems administrator, this section is not for you. This is a subject for developers and packagers, to make sysadmin's life easyer.</p><p>The <code class="filename">/opt</code> and <code class="filename">/usr/local</code> directories are used by sysadmins to manualy non-packaged files (without RPM) of a software, precisely to not loose control over those files. Notice how separated this folder are from the rest of the system.</p><p>A manual installation process (without RPM, or based on simple file copy) is documented in forgoten document inside a drawer (if it was documented), and inside the head of who made installation. If he moves to another job, that installations becomes obscure to the rest of the team, and is a time bomb.</p><p>With <a class="link" href="ar01s06.html" title="6. Allways Provide RPM Packages of Your Softwares">RPM</a> is different. RPM (or any other package system) is an installation "process" by itself. It is self-documented in his database and pre and post-install actions, which permits total control. Turns installations independent from who did it, turning installtions in a <span class="emphasis"><em>business process</em></span>.</p><p>Installations based on coping files into <code class="filename">/opt</code> or <code class="filename">/usr/local</code> are far from providing the organization, system visibility and control that RPM provides. I can say <code class="filename">/opt</code> and <code class="filename">/usr/local</code> would be obsoleted when all softwares become RPMized.</p><p>It is very important to Linux evolution and popularization (especially in the desktop battlefield), that developers stop using this hell directories, and start using the <acronym class="acronym">FHS</acronym>. After reading this section, if you still think this folders are good business, please drop me an e-mail.</p><p>Products that are <span class="emphasis"><em>entirely</em></span> installed under <span class="emphasis"><em>one</em></span> directory, use the <span class="emphasis"><em>self-contained</em></span> approach, that has several problems:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Forces the user to change environment variables like <code class="varname">$PATH</code> and <code class="varname">$LD_LIBRARY_PATH</code> to use your product easily.</p></li><li class="listitem"><p>Puts files in non-standard places, complicating system integration, and future installation of extensions to your product.</p></li><li class="listitem"><p>The sysadmin probably didn't prepared disk space in these partitions, generating problems in installation time.</p></li><li class="listitem"><p>It is an accepted approach only for pure graphical application, without the command line concept. This is why it were well accepted in Windows. But...</p></li><li class="listitem"><p>...even using this approach, you can't avoid installing or changing files in standard locations to, for instance, make your icons appear in the user desktop.</p></li></ol></div><p>Many developers believe that the "self-contained" approach let them work with several versions of the same product, for testing purposes, or whatever. Yes, agree, with this or any good reason in the planet. But remember that a High Quality Software (or Commercial Grade Software) objective is to be practical for the final user, and not to be easy to their developers and testers. Invite yourself to visit an unexperienced user (but potential customer) and watch him installing your product.</p><p>Developer, don't be afraid of spreading your files according to <a class="link" href="ar01s04.html" title="4. Linux Directory Hierarchy: Oriented to the Software Parts"><acronym class="acronym">FHS</acronym></a> because RPM will keep an eye on them.</p><p>If you have a business reason to let the user work with several versions of your Product simultaneously (or any other reason), make a <a class="ulink" href="http://www.rpm.org/max-rpm/ch-rpm-reloc.html" target="_top">relocatable package</a>, which is described in the <a class="ulink" href="http://www.rpm.org/max-rpm/" target="_top">Maximum RPM</a> book. Be also aware about the implications of using this feature, <a class="ulink" href="http://www.rpm.org/max-rpm/s1-rpm-reloc-wrinkles.html" target="_top">described in the same book</a>.</p><p>Red Hat and derivated distributions allways use the directory standard, instead of <code class="filename">/opt</code> or <code class="filename">/usr/local</code>. <a class="link" href="apa.html" title="A. Red Hat, About the Filesystem Structure">Read what Red Hat says about this subject</a>, and think about it.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The Makefiles of an OpenSource Software that is portable to other <acronym class="acronym">UNICES</acronym> must have the standard installation in <code class="filename">/usr/local</code> for compatibility reasons. But must also give the option, and induct the packager, to create the package using <a class="link" href="ar01s04.html" title="4. Linux Directory Hierarchy: Oriented to the Software Parts"><acronym class="acronym">FHS</acronym></a> specifications.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s03.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s05.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">3. The Four Universal Parts of Any Software </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 5. Provide Architecture for Extensions and Plugins</td></tr></table></div></body></html>
