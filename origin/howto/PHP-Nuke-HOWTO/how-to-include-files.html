<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>How to include PHP/HTML files in a PHP-Nuke block</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PHP-Nuke: Management and Programming"
HREF="index.html"><LINK
REL="UP"
TITLE="Creating PHP-Nuke blocks"
HREF="blocks.html"><LINK
REL="PREVIOUS"
TITLE="Simple Content block"
HREF="simple-content-block.html"><LINK
REL="NEXT"
TITLE="How to use Javascript in PHP-Nuke blocks"
HREF="javascript-in-php-nuke-blocks.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PHP-Nuke: Management and Programming</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="simple-content-block.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 20. Creating <SPAN
CLASS="APPLICATION"
>PHP-Nuke</SPAN
> blocks</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="javascript-in-php-nuke-blocks.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="HOW-TO-INCLUDE-FILES"
>20.4. How to include PHP/HTML files in a <SPAN
CLASS="APPLICATION"
>PHP-Nuke</SPAN
> block</A
></H1
><P
>Suppose you want to write a block, block-bar.php, that includes the file foo/bar.php. The way <SPAN
CLASS="APPLICATION"
>PHP-Nuke</SPAN
> displays a block is that it first includes the block, with a statement like </P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>include("blocks/block-bar.php");</PRE
></FONT
></TD
></TR
></TABLE
><P
>then makes a table and puts in the title, and makes another table row, and "echo"es the $content variable. Thus, the $content variable must contain all the output of foo/bar.php, if your block has to contain its output. The <ACRONYM
CLASS="ACRONYM"
>PHP</ACRONYM
> output control functions come in here very handy. The <A
HREF="http://www.php.net/manual/en/ref.outcontrol.php"
TARGET="_top"
>PHP output control functions</A
> allow you to control when output is sent from the script. This can be useful in various situations, especially if you need to send headers to the browser after your script has began outputting data. The output control functions (or output buffering functions, as they are often called and as the ob_ prefix in their name suggests) do not affect headers sent using header() or setcookie(), only functions such as echo() and data between blocks of <ACRONYM
CLASS="ACRONYM"
>PHP</ACRONYM
> code.</P
><P
>Output buffering is a powerful tool in <ACRONYM
CLASS="ACRONYM"
>PHP</ACRONYM
> which allows you to buffer a script's output. You can  even edit this buffer before returning it to the client. The <ACRONYM
CLASS="ACRONYM"
>PHP</ACRONYM
> functions that constitute the output buffering toolbox are:</P
><P
></P
><UL
><LI
><P
>ob_start([callback function]) - Starts an output buffering session.</P
></LI
><LI
><P
>ob_flush() - Send the contents of the buffer to the client and clear the buffer.</P
></LI
><LI
><P
>ob_get_contents() - Returns the contents of the buffer. The buffer is not cleared. </P
></LI
><LI
><P
>ob_end_clean() - Ends the current buffering session and purges the buffer. </P
></LI
><LI
><P
>ob_end_flush() - Ends the current buffering session and displays the buffer.</P
></LI
><LI
><P
>ob_get_length() - (Version &#62;= 4.0.2) Return the size of the current buffer. </P
></LI
><LI
><P
>ob_get_clean() - (Version &#62;= 4.3) Composite of ob_get_contents() and</P
></LI
><LI
><P
>ob_end_clean(). The buffer is returned and the session ends.</P
></LI
></UL
><P
>How can we use output buffering to include the output of foo/bar.php in our <SPAN
CLASS="APPLICATION"
>PHP-Nuke</SPAN
> block? The idea is simple: rather than having <ACRONYM
CLASS="ACRONYM"
>PHP</ACRONYM
> send output directly to the standard output device (the browser) as the script gets executed, we will define a special output buffer which stores all the output generated by the script during its lifetime. When we do this, the output of the script is never seen by the user unless we explicitly make the contents of this buffer visible via a call to PHP's output control API (through one of the above functions). We put the foo folder in the main phpnuke directory, and use this code our block:</P
><TABLE
BORDER="1"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><FONT
COLOR="#000000"
><PRE
CLASS="SCREEN"
>ob_start(); 
include("foo/bar.php");
$output = ob_get_contents();
ob_end_clean(); 
$content = $output;</PRE
></FONT
></TD
></TR
></TABLE
><P
>This way the $content variable will contain the output of foo/bar.php, which will thus be shown in the block. To learn more about <ACRONYM
CLASS="ACRONYM"
>PHP</ACRONYM
> output buffering, see <A
HREF="http://www.devshed.com/Server_Side/PHP/OutputBuffering/"
TARGET="_top"
>Output Buffering with PHP</A
> and <A
HREF="http://jinxidoru.com/tutorials/buffering.html"
TARGET="_top"
>PHP Output Buffering tutorial</A
>. See also <A
HREF="http://www.nukeforums.com/forums/viewtopic.php?t=11465"
TARGET="_top"
>Scripting a new Block Problem</A
>, for a complete example of including a <ACRONYM
CLASS="ACRONYM"
>PHP</ACRONYM
> scoring application in a <SPAN
CLASS="APPLICATION"
>PHP-Nuke</SPAN
> block.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="simple-content-block.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="javascript-in-php-nuke-blocks.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Simple Content block</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="blocks.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>How to use Javascript in <SPAN
CLASS="APPLICATION"
>PHP-Nuke</SPAN
> blocks</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>